---
layout: post
title: "Deconvolution vs. Not"
date: 2011-04-07T11:36:00-07:00
categories:
 - iterating
 - cleaning
 - mapping
 - pipeline
---

<div class='post'>
In the W5 maps, everywhere except AFGL 4029 agrees to within about 20% (better than our supposed offset) independent of deconvolution scheme / modeling scheme, but AFGL 4029 disagrees by a factor of 2-3, indicating a severe dependence on map size.<br /><br />Here's the AFGL 4029 comparison originally: <br />BMAJ: 0.00916667  BMIN: 0.00916667  PPBEAM: 23.8028   SUM/PPBEAM: 8.1515<br />Sum: 194.028  Mean: 1.03758  Median: 0.78441  RMS: 0.760825  NPIX: 187<br />BMAJ: 0.00916667  BMIN: 0.00916667  PPBEAM: 23.8028   SUM/PPBEAM: 5.77585<br />Sum: 137.481  Mean: 0.735194  Median: 0.517222  RMS: 0.663245  NPIX: 187<br />BMAJ: 0.00916667  BMIN: 0.00916667  PPBEAM: 23.8028   SUM/PPBEAM: 14.4043<br />Sum: 342.863  Mean: 1.83349  Median: 1.62579  RMS: 0.820079  NPIX: 187<br /><br />Here it is after flagging out another bad bolo:<br />BMAJ: 0.00916667  BMIN: 0.00916667  PPBEAM: 23.8028   SUM/PPBEAM: 8.14533<br />Sum: 193.882  Mean: 1.0368  Median: 0.783409  RMS: 0.764047  NPIX: 187<br />BMAJ: 0.00916667  BMIN: 0.00916667  PPBEAM: 23.8028   SUM/PPBEAM: 10.1518<br />Sum: 241.642  Mean: 1.2922  Median: 1.06321  RMS: 0.777165  NPIX: 187<br />BMAJ: 0.00916667  BMIN: 0.00916667  PPBEAM: 23.8028   SUM/PPBEAM: 13.9344<br />Sum: 331.677  Mean: 1.77367  Median: 1.56277  RMS: 0.820139  NPIX: 187<br /><br />order is deconvtest, nodeconvtest, 'reconv'<br /><br />deconvtest has virtually no change.  nodeconvtest goes up by a LOT... must be something about the weighting.  reconv drops, which is good, but not enough...<br /><br />curiously, it is not clear that nodeconv converges:  [10, 15, 20 iters]<br />BMAJ: 0.00916667  BMIN: 0.00916667  PPBEAM: 23.8028   SUM/PPBEAM: 8.70939<br />Sum: 207.308  Mean: 1.34615  Median: 1.09348  RMS: 0.760452  NPIX: 154<br />BMAJ: 0.00916667  BMIN: 0.00916667  PPBEAM: 23.8028   SUM/PPBEAM: 9.14028<br />Sum: 217.564  Mean: 1.41275  Median: 1.17223  RMS: 0.759027  NPIX: 154<br />BMAJ: 0.00916667  BMIN: 0.00916667  PPBEAM: 23.8028   SUM/PPBEAM: 9.42483<br />Sum: 224.337  Mean: 1.45673  Median: 1.2172  RMS: 0.758978  NPIX: 154<br /><br />similarly, reconv does not converge:<br />BMAJ: 0.00916667  BMIN: 0.00916667  PPBEAM: 23.8028   SUM/PPBEAM: 11.5623<br />Sum: 275.214  Mean: 1.61891  Median: 1.36357  RMS: 0.809771  NPIX: 170<br />BMAJ: 0.00916667  BMIN: 0.00916667  PPBEAM: 23.8028   SUM/PPBEAM: 12.5848<br />Sum: 299.553  Mean: 1.76208  Median: 1.51426  RMS: 0.807963  NPIX: 170<br />BMAJ: 0.00916667  BMIN: 0.00916667  PPBEAM: 23.8028   SUM/PPBEAM: 13.3102<br />Sum: 316.82  Mean: 1.86365  Median: 1.62092  RMS: 0.804582  NPIX: 170<br /><br /><br />by contrast, deconv converges rapidly:<br />BMAJ: 0.00916667  BMIN: 0.00916667  PPBEAM: 23.8028   SUM/PPBEAM: 8.27004<br />Sum: 196.85  Mean: 0.937381  Median: 0.659373  RMS: 0.759002  NPIX: 210<br />BMAJ: 0.00916667  BMIN: 0.00916667  PPBEAM: 23.8028   SUM/PPBEAM: 8.39255<br />Sum: 199.766  Mean: 0.951267  Median: 0.683644  RMS: 0.758766  NPIX: 210<br />BMAJ: 0.00916667  BMIN: 0.00916667  PPBEAM: 23.8028   SUM/PPBEAM: 8.42881<br />Sum: 200.629  Mean: 0.955377  Median: 0.690816  RMS: 0.75878  NPIX: 210<br /><br />while I'm at it, gaussfits for nodeconv and reconv:<br />Guess: 427,1113  Fit peak: 2.90411  Background: 0.0102637  X,Y position: 426.514822,1113.354863  X,Y FWHM: 64.253564,72.615868   Angle: 0.000000<br />Guess: 427,1113  Fit peak: 3.03769  Background: 0.000596982  X,Y position: 426.080980,1113.634660  X,Y FWHM: 77.405551,104.292823   Angle: 329.589335<br />well, isn't that neat!  Better than 5% agreement on the peaks.  Curiously, the background is higher for nodeconv, which is false: it is directly evident that the background is higher in reconv.  So I think this is just a failed fit, unfortunately.  The true peak of the reconv AFGL 4029 is 3.9 Jy, so there's a huge residual<br /><br /><br />Found an error in the noisemap computations that was artificially driving up the noise around NAN pixels in undersampled maps; this probably led to major problems.  I fixed it by only "flagging out" pixels with >2 NAN neighbors, i.e. so sparsely sampled that they should be ignored, I hope....  this may have affected modeling in all maps.<br /><br />Realized the problems with noisemap: if the model exactly equals the weighted mean at a given pixel, the residual will be EXACTLY zero (to within numerical precision).  This leads to underestimates of the noise!  What we really want is an estimate of the standard deviation on the mean, which is easily computed!  Just do a normal weighted sum of the difference between the data and the model (data and the mean); this is also equivalent (conveniently) to a chi^2 statistic, I think... Whoa.  How did I not do this before?  LETS FIND OUT I'M SURE THERE ARE AWFUL CONSEQUENCES!<br /><br /><br />Just had another idea to throw in - what if we downweight the scan edges?  It won't matter for individual maps or maps of the same size if done uniformly, but it could help incorporate "pointing" maps into "real" maps more accurately.</div>
