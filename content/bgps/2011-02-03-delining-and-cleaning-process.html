---
layout: post
title: "Delining and the Cleaning process"
date: 2011-02-03T11:49:00-08:00
categories:
 - cleaning
 - pipeline
 - deline
---

<div class='post'>
One item I forgot to mention last night was the effects of lines/delining on<br />PCA subtraction.  These should be the primary effects on the final map for all<br />epochs except 2010, in which case the primary effect SHOULD be to reduce<br />substantial noise.<br /><br><br />In the examples below, there are PSDs of whole timestreams (left) and<br />example timestreams from single scans (right).  The first thing to note is that<br />the delined timestreams still have correlated components in the line region,<br />but they are suppressed - their amplitudes, and therefore their sort order in<br />the PCA removal scheme, are changed.  Since PCA cleaning is by its nature adaptive<br />(the number of components remains fixed, but the order changes), these effects<br />can be significant and dangerous.  If the line noise is more correlated, a PCA<br />component will be dedicated to removing it instead of atmospheric signal.<br /><br><br />Below are examples from l089 (epoch 0709) first.  These have less correlated<br />line noise and are more typical of BGPS observations. The first PCA component,<br />the average, does not change much with PCA cleaning.  However it is clear that<br />the second component changes substantially, from large-amplitude high-frequency<br />noise to small-amplitude variations that are very likely to describe<br />atmosphere.<br /><br /><hr><table><tr><td>Example 1 - Zeroing out the lines:</tr></td><tr><td><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/_lsgW26mWZnU/TUrs_QRBBHI/AAAAAAAAF9Y/BH4XEdrFdt0/s1600/zero_pca_psds.png" imageanchor="1" style="margin-left:1em; margin-right:1em"><img align='left' border="0" height="214" width="390" src="http://3.bp.blogspot.com/_lsgW26mWZnU/TUrs_QRBBHI/AAAAAAAAF9Y/BH4XEdrFdt0/s320/zero_pca_psds.png" /></a></td> <td><a href="http://3.bp.blogspot.com/_lsgW26mWZnU/TUrs_nWI6YI/AAAAAAAAF9g/1Dcr0zyMBvM/s1600/zero_pca_timestreams.png" imageanchor="1" style="margin-left:1em; margin-right:1em"><img align='right' border="0" height="214" width="390" src="http://3.bp.blogspot.com/_lsgW26mWZnU/TUrs_nWI6YI/AAAAAAAAF9g/1Dcr0zyMBvM/s320/zero_pca_timestreams.png" /></a></div></td></tr> <tr><td colspan=2><br></td></tr><tr><td>Example 2 - Fitting and removing the lines:</tr></td><tr><td><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/_lsgW26mWZnU/TUrs-f7qfqI/AAAAAAAAF9I/Dt3Kk9roeW8/s1600/fitline_pca_psds.png" imageanchor="1" style="margin-left:1em; margin-right:1em"><img align='left' border="0" height="214" width="390" src="http://4.bp.blogspot.com/_lsgW26mWZnU/TUrs-f7qfqI/AAAAAAAAF9I/Dt3Kk9roeW8/s320/fitline_pca_psds.png" /></a></td> <td><a href="http://1.bp.blogspot.com/_lsgW26mWZnU/TUrs-_it9CI/AAAAAAAAF9Q/06KgQOS2vNA/s1600/fitline_pca_timestreams.png" imageanchor="1" style="margin-left:1em; margin-right:1em"><img align='right' border="0" height="214" width="390" src="http://1.bp.blogspot.com/_lsgW26mWZnU/TUrs-_it9CI/AAAAAAAAF9Q/06KgQOS2vNA/s320/fitline_pca_timestreams.png" /></a></div></td></tr>  <tr><td colspan=2><br></td></tr><tr><td>Example 3 - Suppressing the lines with a non-fitted Gaussian:</tr></td><tr><td><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/_lsgW26mWZnU/TUr_QHkPADI/AAAAAAAAF9o/n5ylgDCLKPw/s1600/wingsupp_pca_psds.png" imageanchor="1" style="margin-left:1em; margin-right:1em"><img align='left' border="0" height="214" width="390" src="http://4.bp.blogspot.com/_lsgW26mWZnU/TUr_QHkPADI/AAAAAAAAF9o/n5ylgDCLKPw/s320/wingsupp_pca_psds.png" /></a></td> <td><a href="http://2.bp.blogspot.com/_lsgW26mWZnU/TUr_QnuPZfI/AAAAAAAAF9w/lt4rEB1Qlq0/s1600/wingsupp_pca_timestreams.png" imageanchor="1" style="margin-left:1em; margin-right:1em"><img align='right' border="0" height="214" width="390" src="http://2.bp.blogspot.com/_lsgW26mWZnU/TUr_QnuPZfI/AAAAAAAAF9w/lt4rEB1Qlq0/s320/wingsupp_pca_timestreams.png" /></a></div></td></tr><tr><td colspan=2><br></td></tr><tr><td colspan=2><hr></td></tr> <tr><td colspan=2><br />The next examples are from December 2010 observations of Uranus.  In this case, the correlated noise component is clearly dominant.<br /></td></tr> <tr><td colspan=2><br></td></tr><tr><td>Zeroing lines:</td></tr><tr><td><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/_lsgW26mWZnU/TUsCBUeD67I/AAAAAAAAF94/CCj9gbJOgk8/s1600/zero_pca_psds.png" imageanchor="1" style="clear:right; float:right; margin-left:1em; margin-bottom:1em"><img border="0" height="214" width="390" src="http://2.bp.blogspot.com/_lsgW26mWZnU/TUsCBUeD67I/AAAAAAAAF94/CCj9gbJOgk8/s320/zero_pca_psds.png" /></a><br /></td><td><br /><a href="http://2.bp.blogspot.com/_lsgW26mWZnU/TUsCB4wFnSI/AAAAAAAAF-A/YgbjYlybcOc/s1600/zero_pca_timestreams.png" imageanchor="1" style="clear:right; float:right; margin-left:1em; margin-bottom:1em"><img border="0" height="214" width="390" src="http://2.bp.blogspot.com/_lsgW26mWZnU/TUsCB4wFnSI/AAAAAAAAF-A/YgbjYlybcOc/s320/zero_pca_timestreams.png" /></a></div></td></tr></td></tr> <tr><td><br />Fitted lines:<br /></td></tr><tr><td><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/_lsgW26mWZnU/TUsCCQNHurI/AAAAAAAAF-I/a5_FQ7bqUjI/s1600/fitline_pca_psds.png" imageanchor="1" style="clear:right; float:right; margin-left:1em; margin-bottom:1em"><img border="0" height="214" width="390" src="http://2.bp.blogspot.com/_lsgW26mWZnU/TUsCCQNHurI/AAAAAAAAF-I/a5_FQ7bqUjI/s320/fitline_pca_psds.png" /></a></td> <td><a href="http://3.bp.blogspot.com/_lsgW26mWZnU/TUsCCtO7DTI/AAAAAAAAF-Q/wKBz0UhDruE/s1600/fitline_pca_timestreams.png" imageanchor="1" style="clear:right; float:right; margin-left:1em; margin-bottom:1em"><img border="0" height="214" width="390" src="http://3.bp.blogspot.com/_lsgW26mWZnU/TUsCCtO7DTI/AAAAAAAAF-Q/wKBz0UhDruE/s320/fitline_pca_timestreams.png" /></a></div></td></tr> <tr><td><br />Non-fitted gaussian suppression:<br /></td></tr><tr><td><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/_lsgW26mWZnU/TUsCLgCRbmI/AAAAAAAAF-Y/WzHcr1E5q4s/s1600/wingsupp_pca_psds.png" imageanchor="1" style="clear:right; float:right; margin-left:1em; margin-bottom:1em"><img border="0" height="214" width="390" src="http://1.bp.blogspot.com/_lsgW26mWZnU/TUsCLgCRbmI/AAAAAAAAF-Y/WzHcr1E5q4s/s320/wingsupp_pca_psds.png" /></a></td> <td><a href="http://2.bp.blogspot.com/_lsgW26mWZnU/TUsCL5e9eGI/AAAAAAAAF-g/TgmNWbiJzbs/s1600/wingsupp_pca_timestreams.png" imageanchor="1" style="clear:right; float:right; margin-left:1em; margin-bottom:1em"><img border="0" height="214" width="390" src="http://2.bp.blogspot.com/_lsgW26mWZnU/TUsCL5e9eGI/AAAAAAAAF-g/TgmNWbiJzbs/s320/wingsupp_pca_timestreams.png" /></a></div></td></tr>   <tr><td colspan=2><hr></td></tr><tr><td><br> Finally, these two are demonstrations of what you might expect to see for a purely noiseless images of a planet (it was constructed from a PSF).  PCA is first:<br /></td></tr> <tr><td><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/_lsgW26mWZnU/TUsCyELAZ1I/AAAAAAAAF-o/65L-rwGFscM/s1600/noiselesssim_pca_psds.png" imageanchor="1" style="clear:right; float:right; margin-left:1em; margin-bottom:1em"><img border="0" height="214" width="390" src="http://2.bp.blogspot.com/_lsgW26mWZnU/TUsCyELAZ1I/AAAAAAAAF-o/65L-rwGFscM/s320/noiselesssim_pca_psds.png" /></a></td> <td><a href="http://3.bp.blogspot.com/_lsgW26mWZnU/TUsCyRaYY7I/AAAAAAAAF-w/ZaRL4CPWw2E/s1600/noiselesssim_pca_timestreams.png" imageanchor="1" style="clear:right; float:right; margin-left:1em; margin-bottom:1em"><img border="0" height="214" width="390" src="http://3.bp.blogspot.com/_lsgW26mWZnU/TUsCyRaYY7I/AAAAAAAAF-w/ZaRL4CPWw2E/s320/noiselesssim_pca_timestreams.png" /></a></div></td></tr> <tr><td><br /><br> A single bolometer's timestream and PSD:<br /></td></tr>  <tr><td><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/_lsgW26mWZnU/TUsDgR4xcEI/AAAAAAAAF-4/udxMkuH6kio/s1600/noiselesssim_deline_wingsupp_10hz_noscan_nsig0_psds_000.png" imageanchor="1" style="clear:right; float:right; margin-left:1em; margin-bottom:1em"><img border="0" height="214" width="390" src="http://4.bp.blogspot.com/_lsgW26mWZnU/TUsDgR4xcEI/AAAAAAAAF-4/udxMkuH6kio/s320/noiselesssim_deline_wingsupp_10hz_noscan_nsig0_psds_000.png" /></a></td> <td><a href="http://1.bp.blogspot.com/_lsgW26mWZnU/TUsDgtnBPNI/AAAAAAAAF_A/weQNMCgtrtc/s1600/noiselesssim_deline_wingsupp_10hz_noscan_nsig0_timestreams_000.png" imageanchor="1" style="clear:right; float:right; margin-left:1em; margin-bottom:1em"><img border="0" height="214" width="390" src="http://1.bp.blogspot.com/_lsgW26mWZnU/TUsDgtnBPNI/AAAAAAAAF_A/weQNMCgtrtc/s320/noiselesssim_deline_wingsupp_10hz_noscan_nsig0_timestreams_000.png" /></a></div></td></tr>  </table></div>
