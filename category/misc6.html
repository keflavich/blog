<!DOCTYPE html>
<html lang="en">
<link rel="stylesheet" type="text/css" href="https://keflavich.github.io/blog/theme/css/style.css" />
<link rel="icon" type="image/gif" href="https://keflavich.github.io/blog/theme/favicon8.ico">
<head>
    <base href="https://keflavich.github.io/blog">
        <title>Adam Ginsburg's blog</title>
        <meta charset="utf-8" />
        <link href="https://keflavich.github.io/blog/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Adam Ginsburg's blog Full Atom Feed" />
        <link href="https://keflavich.github.io/blog/feeds/{slug}.atom.xml" type="application/atom+xml" rel="alternate" title="Adam Ginsburg's blog Categories Atom Feed" />
<!-- Using MathJax, with the delimiters $ -->
<!-- Conflict with pygments for the .mo and .mi -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
    "HTML-CSS": {
    styles: {
    ".MathJax .mo, .MathJax .mi": {color: "inherit !important"}},
    'div.typeset': { 'text-align': 'left'}
    },
    tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']],processEscapes: true}
    });
    TeX: {
        extensions: ["AMSmath.js", "AMSsymbols.js"]
    }
    MathJax.Hub.Register.StartupHook("HTML-CSS Jax Ready",function () {
    var VARIANT = MathJax.OutputJax["HTML-CSS"].FONTDATA.VARIANT;
    VARIANT["normal"].fonts.unshift("MathJax_SansSerif");
    VARIANT["bold"].fonts.unshift("MathJax_SansSerif-bold");
    VARIANT["italic"].fonts.unshift("MathJax_SansSerif-italic");
    VARIANT["-tex-mathit"].fonts.unshift("MathJax_SansSerif-italic");
    });
    MathJax.Hub.Register.StartupHook("SVG Jax Ready",function () {
    var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;
    VARIANT["normal"].fonts.unshift("MathJax_SansSerif");
    VARIANT["bold"].fonts.unshift("MathJax_SansSerif-bold");
    VARIANT["italic"].fonts.unshift("MathJax_SansSerif-italic");
    VARIANT["-tex-mathit"].fonts.unshift("MathJax_SansSerif-italic");
    });
</script>

<script type="text/javascript"
src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML">
</script>
        
</head>

<body id="base" class="home">


    <header id="banner" class="body" >
        <div id="header" style='background-image: url("https://keflavich.github.io/blog/images/GC_4096sq_bolo.png"); background-position:left; min-heigt: 200px;  background-repeat: no-repeat; max-width: 80%;'>
            <h1 style="color: #C4C4C4;"><a class="header" href="https://keflavich.github.io/blog">Adam Ginsburg's blog <strong></strong></a></h1>

            <nav id="menu"><ul id="menulist">
                <li><a href="https://www.adamgginsburg.com">Homepage</a></li>
                <li><a href="/index.html">Blog Index</a></li>
                <li><a href="/category/bgps.html">BGPS Blog</a></li>
                <li><a href="/category/publications.html">Publications</a></li>
                <li><a href="/archives.html">Archives</a></li>
                <li><a href="/tags.html">Tags</a></li>
            </ul></nav><!-- /#menu -->
        </div>
    </header><!-- /#banner -->

  <div id="sidebar">
    <ul>
      <li>
        <h3 id='recent_header'>Recent Posts</h3>
        <ul>
              <li class="post">
                  2025/03/15
                  <br>
                  <a href="https://keflavich.github.io/blog/pushing-to-a-pull-request.html">Pushing to a pull request</a>
              </li>
              <li class="post">
                  2023/08/11
                  <br>
                  <a href="https://keflavich.github.io/blog/editing-metadata-in-measurement-sets.html">Editing metadata in measurement sets</a>
              </li>
              <li class="post">
                  2022/05/06
                  <br>
                  <a href="https://keflavich.github.io/blog/casa-mpi-debugging-contd.html">CASA MPI debugging cont'd</a>
              </li>
              <li class="post">
                  2022/05/01
                  <br>
                  <a href="https://keflavich.github.io/blog/co2-monitoring-at-conferences-update-in-2022.html">CO2 Monitoring at Conferences: Update in 2022</a>
              </li>
              <li class="post">
                  2022/04/14
                  <br>
                  <a href="https://keflavich.github.io/blog/alma-cycle-9-corrupted-zip-fix.html">ALMA Cycle 9 corrupted zip fix</a>
              </li>
        </ul>
      </li>
    
    </ul>
  </div><!-- end #sidebar -->

  <div id="content">
<section id="content">
<h2>Articles in the misc category</h2>

<ul id="post-list">
    <li><article class="hentry">
        <header> 
            <h2 class="entry-title">
                <a href="https://keflavich.github.io/blog/fft-comparisons-in-python.html" rel="bookmark" title="Permalink to FFT comparisons in python">
                    FFT comparisons in python</a>
            </h2> 
        </header>
        <footer class="post-info">
            <abbr class="published" title="2015-12-07T11:24:00-07:00"> 2015/12/07 </abbr>
            <!--<address class="vcard author"><a class="url fn" href="https://keflavich.github.io/blog/author/adam-ginsburg-adamgginsburggmailcom.html">Adam Ginsburg (Adam.G.Ginsburg@gmail.com)</a></address>-->
        </footer><!-- /.post-info -->
        <div class="entry-content"> <p>I'm trying to figure out which ffts are fastest, best, etc.</p>
<p>First, it is difficult to get fftw3 + pyfftw installed into python.</p>
<p>For pyfftw to install, you need to <a class="reference external" href="http://www.fftw.org/doc/Installation-on-Unix.html">enable floats and every specific type</a> when compiling <a class="reference external" href="http://www.fftw.org/">fftw3</a> (thanks to <a class="reference external" href="http://linuxtoolkit.blogspot.de/2010/04/cant-find-fftw3f-library-when.html">linux toolkits blog</a>).
Apparently you can't have <tt class="docutils literal"><span class="pre">--enable-long-double</span></tt> and <tt class="docutils literal"><span class="pre">--enable-float</span></tt> simultaneously,
but pyfftw requires both, so you have to install twice or thrice?  Nope, four
times!!  Also, <a class="reference external" href="https://github.com/hgomersall/pyFFTW/issues/16#issuecomment-19422752">my own post</a>
indicates that I should install to a different path to avoid weird conflicts
with other libraries.</p>
<pre class="literal-block">
./configure --enable-threads --enable-openmp --enable-mpi --enable-shared \
            --enable-fortran --enable-avx \
            CFLAGS=&quot;-O3 -fno-common -fomit-frame-pointer -fstrict-aliasing&quot;
make -j 4
sudo make install

./configure --enable-float --enable-threads --enable-openmp --enable-mpi --enable-shared \
            --enable-fortran --enable-avx \
            CFLAGS=&quot;-O3 -fno-common -fomit-frame-pointer -fstrict-aliasing&quot;
make -j 4
sudo make install

# quad precision is not supported in mpi
./configure --enable-quad-precision --enable-threads --enable-openmp --enable-shared \
            --enable-fortran --enable-avx \
             CFLAGS=&quot;-O3 -fno-common -fomit-frame-pointer -fstrict-aliasing&quot;
make -j 4
sudo make install

./configure --enable-long-double --enable-threads --enable-openmp --enable-mpi --enable-shared \
            --enable-fortran --enable-avx \
             CFLAGS=&quot;-O3 -fno-common -fomit-frame-pointer -fstrict-aliasing&quot;
make -j 4
sudo make install
</pre>
<p>Onto speed test comparisons:</p>
<blockquote>
<ul class="simple">
<li><a class="reference external" href="https://gist.github.com/mperrin/5763120">Marshal Perrin's</a></li>
<li><a class="reference external" href="https://gist.github.com/keflavich/5797994">my fork</a></li>
<li><a class="reference external" href="http://code.google.com/p/agpy/source/browse/trunk/tests/test_ffts.py">speed tests on agpy</a></li>
<li><a class="reference external" href="https://github.com/astropy/astropy/pull/4374">profiling convolve_fft with different parameters</a></li>
</ul>
</blockquote>
<p>If you want to use <tt class="docutils literal">fftw3</tt> with astropy's <a class="reference external" href="http://docs.astropy.org/en/stable/api/astropy.convolution.convolve_fft.html#astropy.convolution.convolve_fft">convolve_fft</a>,
use <a class="reference external" href="https://code.google.com/p/agpy/source/browse/trunk/AG_fft_tools/convolve_nd.py?r=479#8">this example</a>.</p>
<p>Onto some comparisons from <a class="reference external" href="https://github.com/astropy/astropy/pull/4374">astropy issue 4374</a>:</p>
<img alt="" src="https://keflavich.github.io/blog/images/time_vs_mem.png" style="width: 600px;" />
<img alt="" src="https://keflavich.github.io/blog/images/psfTfftT.png" style="width: 600px;" />
<img alt="" src="https://keflavich.github.io/blog/images/psfTfftF.png" style="width: 600px;" />
<img alt="" src="https://keflavich.github.io/blog/images/psfFfftT.png" style="width: 600px;" />
<img alt="" src="https://keflavich.github.io/blog/images/psfFfftF.png" style="width: 600px;" />
<p><a class="reference external" href="https://gist.github.com/6a2d338830efdc02959a">Notebook containing comparisons between FFT and FFTW</a></p>
 </div>
        <!-- /.entry-content   not article.summary--> 
    </article></li>
    <hr width=100%>
    <li><article class="hentry">
        <header> 
            <h2 class="entry-title">
                <a href="https://keflavich.github.io/blog/separating-line-from-continuum-in-casa-data.html" rel="bookmark" title="Permalink to Separating Line from Continuum in CASA data">
                    Separating Line from Continuum in CASA data</a>
            </h2> 
        </header>
        <footer class="post-info">
            <abbr class="published" title="2015-11-04T15:57:00-07:00"> 2015/11/04 </abbr>
            <!--<address class="vcard author"><a class="url fn" href="https://keflavich.github.io/blog/author/adam-ginsburg-adamgginsburggmailcom.html">Adam Ginsburg (Adam.G.Ginsburg@gmail.com)</a></address>-->
        </footer><!-- /.post-info -->
        <div class="entry-content"> <p>I'm continuing to try to separate the line forest from the continuum data in my
W51 cube.  Some approaches 'kinda work', some don't.</p>
<p>The iterative approach suggested in the <a class="reference external" href="|static|cvel_w51_fail.rst">previous post</a> <a class="reference external" href="https://github.com/keflavich/W51_ALMA_2013.1.00308.S/blob/630c60e7e57ea7b57877d66b15860b26419a5552/script_12m/uvcontsub_test.py">works reasonably well</a>,
but results in oversubtraction of the continuum, even with
a few iterations.  Note that this approach requires <a class="reference external" href="https://github.com/keflavich/W51_ALMA_2013.1.00308.S/blob/630c60e7e57ea7b57877d66b15860b26419a5552/script_12m/uvcontsub_test.py#L17">copying columns between ms
files using the table toolkit</a>.</p>
<img alt="Oversubtracted spectrum" src="https://keflavich.github.io/blog/images/w51/oversubtracted_spectrum.png" style="width: 400px;" />
<p>Another approach I wanted to try was to image the whole cube, take the minimum
value along the spectral axis, and subtract that.  This would avoid the
oversubtraction issue by force.  However, <a class="reference external" href="https://github.com/keflavich/W51_ALMA_2013.1.00308.S/blob/c58e4fdf755f85b163d1684cc7383ef31d6a1669/script_12m/mincontsub.py">this</a>
leads to failures in the <cite>ft</cite> task:</p>
<pre class="literal-block">
CASA &lt;85&gt;: ft(vis='w51_test_small_imcont.ms', model='test_continuum_min.image', usescratch=True, nterms=1)
2015-11-04 15:01:29 WARN    ft::FTMachine::initMaps No overlap in frequency between image channels and selected data found for this FTMachine
2015-11-04 15:01:29 WARN    ft::FTMachine::initMaps+         Check your data selection and image parameters if you end up with a blank image
</pre>
<p>which I don't understand.  I had to <a class="reference external" href="https://github.com/keflavich/W51_ALMA_2013.1.00308.S/blob/c58e4fdf755f85b163d1684cc7383ef31d6a1669/script_12m/mincontsub.py#L22">hack the header</a>
just to get ft to load the file at all, and apparently my hack wasn't good enough.
It's really unclear to me now how to load a model from a FITS file.</p>
<p>The next approach is to load the whole continuum-subtracted cube into a model,
subtract THAT, then make a continuum image, then subtract that, then maybe
we have line and continuum?  Maybe?  I suspect this approach will require
some sort of cube masking.</p>
<p>Unfortunately, ft is again the problem:</p>
<pre class="literal-block">
2015-11-04 15:09:08 SEVERE  ft::imager::ft() (file /Users/rpmbuild/gradle/workdir/casaautobuild/release-4_5/code/synthesis/MeasurementEquations/Imager.cc, line 4488)       Exception: (/Users/rpmbuild/gradle/workdir/casaautobuild/release-4_5/darwin/include/casacore/lattices/Lattices/Lattice.tcc : 299) Failed AlwaysAssert shapeIn.isEqual (shapeOut)
</pre>
<p>Followup in early 2017: a cube-based approach is generally more successful.
See Sanchez-Monge in prep and the related <a class="reference external" href="https://github.com/radio-astro-tools/statcont">statcont</a> software package.</p>
 </div>
        <!-- /.entry-content   not article.summary--> 
    </article></li>
    <hr width=100%>
    <li><article class="hentry">
        <header> 
            <h2 class="entry-title">
                <a href="https://keflavich.github.io/blog/cvel-errors.html" rel="bookmark" title="Permalink to CVEL errors">
                    CVEL errors</a>
            </h2> 
        </header>
        <footer class="post-info">
            <abbr class="published" title="2015-11-02T20:50:00-07:00"> 2015/11/02 </abbr>
            <!--<address class="vcard author"><a class="url fn" href="https://keflavich.github.io/blog/author/adam-ginsburg-adamgginsburggmailcom.html">Adam Ginsburg (Adam.G.Ginsburg@gmail.com)</a></address>-->
        </footer><!-- /.post-info -->
        <div class="entry-content"> <p>I'm trying to get a good image of the W51 main sources that have line forests.
MFS clean does a pretty good job, but is very limited in dynamic range
presumably because the spectral lines manifest as amplitude errors.</p>
<p>I tried splitting the data to merge my two spectral windows using <cite>cvel</cite>
(<a class="reference external" href="https://github.com/keflavich/W51_ALMA_2013.1.00308.S/blob/4c29c8dc763e3f994279d50db72b9a0dfc2a35b7/script_12m/split_for_localtests.py#L8">code</a>),
but I see thousands of errors like this:</p>
<pre class="literal-block">
2015-11-02 19:52:15     WARN    SubMS::combineSpws()    Averaging failed for the following channel/correllation pairs from output row 44432 up to 44459. Corresponding visibilities will be flagged:
2015-11-02 19:52:15     WARN    SubMS::combineSpws()+   (60, 0) (60, 1) (1804, 0) (1804, 1) (1998, 0) (1998, 1)
</pre>
<p>and when I image the cube, there is a jump at one channel that occurs because
the resolution suddenly changes either because SPW3 (the lo-res SPW) is not
included or because the hi-res one suddenly is.</p>
<img alt="" src="https://keflavich.github.io/blog/images/w51/cvel_jump.png" style="width: 400px;" />
<p>It doesn't look like there's any obvious workaround at the moment, but I'll
probably try sending another helpdesk ticket about this.</p>
<p>My best idea for getting a decent continuum out now is something like this:</p>
<blockquote>
<ul class="simple">
<li>image the whole cube in frequency</li>
<li>determine channels that can approximate the bright continuum</li>
<li>use those to uvcontsub the data</li>
<li>image the uvcontsub'd cube</li>
<li>uvsub the imaged spectral line cube from the original data</li>
<li>re-image the now-continuum-only cube using mfs</li>
</ul>
</blockquote>
<p>EDIT: Dirk replied to the helpdesk ticket, suggesting:</p>
<pre class="literal-block">
Concerning cvel: try to process one SPW at a time. Otherwise cvel will
_combine_ the SPWs and if they are not observed at the same time, this will
lead to problems.
</pre>
<p>So I've now <a class="reference external" href="https://github.com/keflavich/W51_ALMA_2013.1.00308.S/blob/2d15ce46f9ecd75d70ab7ac4ee8f91b272139d9e/script_12m/split_for_localtests.py#L8">split the cvel into two commands</a>.
I also added <cite>outframe='bary'</cite> because otherwise it's not obvious that the
frequency command is doing anything
sensible or useful.  That's actually probably why I was getting non-overlapping
segments before - it tried converting to barycentric, but maybe too late in the
process (i.e., it tried selecting in topo, then converting to bary for output).
I also added a phasecenter, because it was automatically selecting pointing 24
as the phasecenter for cvel before.</p>
<p>This led to a new error:</p>
<pre class="literal-block">
2015-11-03 14:38:27     WARN    cvel::SubMS::convertGridPars     *** Requested new channel width is smaller than smallest original channel width
2015-11-03 14:38:27     WARN    cvel::SubMS::convertGridPars+        which is 488319 Hz
</pre>
<p>which I've fixed by setting the output width to be 0.5 MHz, just a simple round
number greater than the input even accounting for shift.  Unfortunately, this
seems to have produced a dramatically larger output MS, which cannot be
correct.... ahhh, it turns out that was temporary, once regridding was complete,
it turned small again.</p>
 </div>
        <!-- /.entry-content   not article.summary--> 
    </article></li>
    <hr width=100%>
    <li><article class="hentry">
        <header> 
            <h2 class="entry-title">
                <a href="https://keflavich.github.io/blog/casa-clean-errors-related-to-channels.html" rel="bookmark" title="Permalink to CASA clean errors related to channels">
                    CASA clean errors related to channels</a>
            </h2> 
        </header>
        <footer class="post-info">
            <abbr class="published" title="2015-10-28T16:51:00-06:00"> 2015/10/28 </abbr>
            <!--<address class="vcard author"><a class="url fn" href="https://keflavich.github.io/blog/author/adam-ginsburg-adamgginsburggmailcom.html">Adam Ginsburg (Adam.G.Ginsburg@gmail.com)</a></address>-->
        </footer><!-- /.post-info -->
        <div class="entry-content"> <p>When cleaning my ALMA data, especially when trying to <a class="reference external" href="https://github.com/keflavich/SgrB2_ALMA_3mm_Mosaic/blob/master/script_12m/scriptForImaging.py#L120">image the full cube (all
channels)</a>
when there are multiple SBs
with slightly different frequencies, I see this error frequently:</p>
<blockquote>
No valid data, skip CLEANing this channel</blockquote>
<p>It seems that the channel really is being skipped in many cases.  In the Sgr B2
cube, this wasn't a problem because I unintentionally cleaned only one of the
observations.  For the W51 and Orion data, I tried to <a class="reference external" href="https://github.com/keflavich/W51_ALMA_2013.1.00308.S/blob/master/script_12m/scriptForImaging_fullcube.py">include all of the data</a>,
but that is causing problems.  Perhaps CASA does not work at all when 'channel'
is specified and the channels aren't aligned?  Or maybe it only accepts channels
when all channels exist?</p>
<p>I've now redone the 'full cube' imaging to separately image the two SBs in W51.
I'll see if that works...</p>
<p>Nope, the resulting error is much worse:</p>
<pre class="literal-block">
Log:
2015-10-28 15:49:01     INFO    imager::clean() Fitted beam used in restoration: 1.07809 by 0.913862 (arcsec) at pa -63.3899 (deg)
2015-10-28 15:49:01     INFO    imager::iClean()        Restoring Image(s) with the clean-beam
2015-10-28 15:49:02     SEVERE  clean::::       An error occurred running task clean.

Terminal:
*** Error ***  The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()
2015-10-28 15:49:02     SEVERE  clean::::       An error occurred running task clean.
</pre>
<p>This is an indication of a major underlying python bug.</p>
 </div>
        <!-- /.entry-content   not article.summary--> 
    </article></li>
    <hr width=100%>
    <li><article class="hentry">
        <header> 
            <h2 class="entry-title">
                <a href="https://keflavich.github.io/blog/pyspeckit-is-py3-compatible.html" rel="bookmark" title="Permalink to pyspeckit is py3-compatible">
                    pyspeckit is py3-compatible</a>
            </h2> 
        </header>
        <footer class="post-info">
            <abbr class="published" title="2015-10-28T10:28:00-06:00"> 2015/10/28 </abbr>
            <!--<address class="vcard author"><a class="url fn" href="https://keflavich.github.io/blog/author/adam-ginsburg-adamgginsburggmailcom.html">Adam Ginsburg (Adam.G.Ginsburg@gmail.com)</a></address>-->
        </footer><!-- /.post-info -->
        <div class="entry-content"> <p>With PR <a class="reference external" href="https://github.com/pyspeckit/pyspeckit/pull/110">#110</a> and <a class="reference external" href="https://github.com/pyspeckit/pyspeckit/pull/111">#111</a>, pyspeckit is now (apparently)
fully python3-compatible.  The test suite passes, but that's not a guarantee
that I've caught all bugs in the translation.</p>
 </div>
        <!-- /.entry-content   not article.summary--> 
    </article></li>
    <hr width=100%>
    <li><article class="hentry">
        <header> 
            <h2 class="entry-title">
                <a href="https://keflavich.github.io/blog/self-calibration-of-sgr-b2-mosaic.html" rel="bookmark" title="Permalink to Self-calibration of Sgr B2 Mosaic">
                    Self-calibration of Sgr B2 Mosaic</a>
            </h2> 
        </header>
        <footer class="post-info">
            <abbr class="published" title="2015-10-14T14:30:00-06:00"> 2015/10/14 </abbr>
            <!--<address class="vcard author"><a class="url fn" href="https://keflavich.github.io/blog/author/adam-ginsburg-adamgginsburggmailcom.html">Adam Ginsburg (Adam.G.Ginsburg@gmail.com)</a></address>-->
        </footer><!-- /.post-info -->
        <div class="entry-content"> <p>The Sgr B2 ALMA data from project 2013.1.00269.S has imaging problems around
the brightest sources, especially Sgr B2 M.
Crystal Brogan &amp; Todd Hunter gave some useful advice, essentially the following:</p>
<blockquote>
<ul class="simple">
<li>the line forest is causing trouble, so line-containing regions of the spectrum
must be excluded when mapping</li>
<li>there is some nasty curvature in the spectral baseline that needs to be removed
probably by flagging out some of the data</li>
<li>Self-calibration is needed to exceed a dynamic range ~100</li>
</ul>
</blockquote>
<p>Todd developed a <cite>fitcontinuum.py</cite> script to address the first point, but I ended up
doing this custom (<a class="reference external" href="https://github.com/keflavich/SgrB2_ALMA_3mm_Mosaic/blob/master/script_12m/test_split_spw1.py">script</a>) because of the problem introduced by the second point.</p>
<p>To exclude the lines, I had to use <em>frequency-based</em> selection, not channel based, because my
spectral windows from different dates were offset by 10 MHz.  The approach to use in CASA is
ugly: you flag the line-containing data, then split (and in splitting, average) the continuum
into another MS.  From there, a phase-only selfcal is straigtforward (<a class="reference external" href="https://github.com/keflavich/SgrB2_ALMA_3mm_Mosaic/blob/master/script_12m/selfcal_spw1_center.py">script</a>).</p>
<img alt="" src="https://keflavich.github.io/blog/images/sgrb2/selfcal_compare.png" style="width: 800px;" />
 </div>
        <!-- /.entry-content   not article.summary--> 
    </article></li>
    <hr width=100%>
    <li><article class="hentry">
        <header> 
            <h2 class="entry-title">
                <a href="https://keflavich.github.io/blog/sensitivity-plots-using-astroquery-nrao-tool.html" rel="bookmark" title="Permalink to Sensitivity Plots using astroquery NRAO tool">
                    Sensitivity Plots using astroquery NRAO tool</a>
            </h2> 
        </header>
        <footer class="post-info">
            <abbr class="published" title="2015-10-09T14:00:00-06:00"> 2015/10/09 </abbr>
            <!--<address class="vcard author"><a class="url fn" href="https://keflavich.github.io/blog/author/adam-ginsburg-adamgginsburggmailcom.html">Adam Ginsburg (Adam.G.Ginsburg@gmail.com)</a></address>-->
        </footer><!-- /.post-info -->
        <div class="entry-content"> <p>I wanted to see what the approximate depth achieved by (repeated)
VLA observations of a few sources was, at least theoretically.
This is relatively easy to do:</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">astropy</span> <span class="kn">import</span> <span class="n">units</span> <span class="k">as</span> <span class="n">u</span>
<span class="kn">from</span> <span class="nn">astroquery.nrao</span> <span class="kn">import</span> <span class="n">Nrao</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">Nrao</span><span class="p">()</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">coordinates</span><span class="o">=</span><span class="n">coordinates</span><span class="o">.</span><span class="n">SkyCoord</span><span class="o">.</span><span class="n">from_name</span><span class="p">(</span><span class="s1">&#39;Sgr B2(M)&#39;</span><span class="p">),</span>
                      <span class="n">radius</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">arcmin</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">pylab</span> <span class="k">as</span> <span class="nn">pl</span>

<span class="n">pl</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;Observing Freq&#39;</span><span class="p">]</span><span class="o">/</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">result</span><span class="p">[</span><span class="s1">&#39;TOS&#39;</span><span class="p">],</span> <span class="s1">&#39;.&#39;</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Observed Frequency (GHz)&quot;</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Time-on-Source (s)&quot;</span><span class="p">)</span>

<span class="n">pl</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;Observing Freq&#39;</span><span class="p">]</span><span class="o">/</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">result</span><span class="p">[</span><span class="s1">&#39;TOS&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;Bandwidth&#39;</span><span class="p">],</span> <span class="s1">&#39;.&#39;</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Observed Frequency (GHz)&quot;</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Relative depth (Hz s)&quot;</span><span class="p">)</span>
</pre></div>
<img alt="" src="https://keflavich.github.io/blog/images/TOS_vs_freq.png" style="width: 800px;" />
<img alt="" src="https://keflavich.github.io/blog/images/depth_vs_freq.png" style="width: 800px;" />
 </div>
        <!-- /.entry-content   not article.summary--> 
    </article></li>
    <hr width=100%>
    <li><article class="hentry">
        <header> 
            <h2 class="entry-title">
                <a href="https://keflavich.github.io/blog/alma-qa2-restoration.html" rel="bookmark" title="Permalink to ALMA QA2 restoration">
                    ALMA QA2 restoration</a>
            </h2> 
        </header>
        <footer class="post-info">
            <abbr class="published" title="2015-10-02T09:00:00-06:00"> 2015/10/02 </abbr>
            <!--<address class="vcard author"><a class="url fn" href="https://keflavich.github.io/blog/author/adam-keflavichgmailcom.html">Adam (keflavich@gmail.com)</a></address>-->
        </footer><!-- /.post-info -->
        <div class="entry-content"> <p>In case you ever encounter this error about a missing <cite>Source.xml</cite> file:</p>
<pre class="literal-block">
IOError: [Errno 2] No such file or directory: '/diskb/aginsbur/orion/2013.1.00546.S/science_goal.uid___A001_X122_X35c/group.uid___A001_X122_X35d/member.uid___A001_X122_X35e/calibrated/working/uid___A002_X960614_X39db.ms/Source.xml'
WARNING: Failure executing file: &lt;scriptForPI.py&gt;
</pre>
<p>the solution is this ticket: <a class="reference external" href="https://help.almascience.org/index.php?/Knowledgebase/Article/View/266/5/what-should-i-do-if-scriptforpi-aborts-at-the-importasdm-step-with-error">https://help.almascience.org/index.php?/Knowledgebase/Article/View/266/5/what-should-i-do-if-scriptforpi-aborts-at-the-importasdm-step-with-error</a></p>
<p>So my solution:</p>
<pre class="literal-block">
orion /diskb/aginsbur/atca master$ mv /diskb/aginsbur/casa/casapy-42.2.30986-pipe-1-64b/lib64/libxml2.so.2 /diskb/aginsbur/casa/casapy-42.2.30986-pipe-1-64b/lib64/origlibxml2.so.2
orion /diskb/aginsbur/atca master$ locate libxml2.so.2
/diskb/aginsbur/casa/casapy-42.2.30986-pipe-1-64b/lib64/libxml2.so.2
/diskb/aginsbur/casa/casapy-42.2.30986-pipe-1-64b/lib64/libxml2.so.2.6.26
/home/aginsbur/anaconda/lib/libxml2.so.2
/home/aginsbur/anaconda/lib/libxml2.so.2.9.2
/home/aginsbur/anaconda/pkgs/libxml2-2.9.2-0/lib/libxml2.so.2
/home/aginsbur/anaconda/pkgs/libxml2-2.9.2-0/lib/libxml2.so.2.9.2
/opt/anaconda/lib/libxml2.so.2
/opt/anaconda/lib/libxml2.so.2.9.2
/opt/anaconda/pkgs/libxml2-2.9.2-0/lib/libxml2.so.2
/opt/anaconda/pkgs/libxml2-2.9.2-0/lib/libxml2.so.2.9.2
/usr/lib64/libxml2.so.2
/usr/lib64/libxml2.so.2.9.1
orion /diskb/aginsbur/atca master$ ln -sf /usr/lib64/libxml2.so.2 /diskb/aginsbur/casa/casapy-42.2.30986-pipe-1-64b/lib64/libxml2.so.2
</pre>
 </div>
        <!-- /.entry-content   not article.summary--> 
    </article></li>
    <hr width=100%>
    <li><article class="hentry">
        <header> 
            <h2 class="entry-title">
                <a href="https://keflavich.github.io/blog/export-to-fits-with-miriad.html" rel="bookmark" title="Permalink to Export to FITS with MIRIAD">
                    Export to FITS with MIRIAD</a>
            </h2> 
        </header>
        <footer class="post-info">
            <abbr class="published" title="2015-09-15T15:30:00-06:00"> 2015/09/15 </abbr>
            <!--<address class="vcard author"><a class="url fn" href="https://keflavich.github.io/blog/author/adam-ginsburg-adamgginsburggmailcom.html">Adam Ginsburg (adam.g.ginsburg@gmail.com)</a></address>-->
        </footer><!-- /.post-info -->
        <div class="entry-content"> <p>To convert from MIRIAD map files to FITS, use:</p>
<pre class="literal-block">
miriad% fits in=h2comos1.clr out=h2comos1.fits op=xyout
</pre>
<p>(see <a class="reference external" href="converting-gildas-class-data-cubes-lmv-files-to-fits.rst">the CLASS conversion post</a>)</p>
 </div>
        <!-- /.entry-content   not article.summary--> 
    </article></li>
    <hr width=100%>
    <li><article class="hentry">
        <header> 
            <h2 class="entry-title">
                <a href="https://keflavich.github.io/blog/installing-miriad.html" rel="bookmark" title="Permalink to Installing Miriad">
                    Installing Miriad</a>
            </h2> 
        </header>
        <footer class="post-info">
            <abbr class="published" title="2015-09-14T00:00:00-06:00"> 2015/09/14 </abbr>
            <!--<address class="vcard author"><a class="url fn" href="https://keflavich.github.io/blog/author/adam.html">Adam <keflavich@gmail.com></a></address>-->
        </footer><!-- /.post-info -->
        <div class="entry-content"> <p>From Andrew Walsh, a script to install MIRIAD:</p>
<div class="highlight"><pre><span></span>wget<span class="w"> </span>ftp://ftp.atnf.csiro.au/pub/software/miriad/miriad-common.tar.bz2
wget<span class="w"> </span>ftp://ftp.atnf.csiro.au/pub/software/miriad/miriad-linux64.tar.bz2
bzcat<span class="w"> </span>miriad-common.tar.bz2<span class="w"> </span><span class="p">|</span><span class="w"> </span>tar<span class="w"> </span>xvf<span class="w"> </span>-
bzcat<span class="w"> </span>miriad-linux64.tar.bz2<span class="w">  </span><span class="p">|</span><span class="w"> </span>tar<span class="w"> </span>xvf<span class="w"> </span>-
<span class="nb">cd</span><span class="w"> </span>miriad
<span class="nb">export</span><span class="w"> </span><span class="nv">MIR</span><span class="o">=</span><span class="nv">$PWD</span>
<span class="c1"># define the MIR variable in your bashrc</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;export MIR=</span><span class="nv">$MIR</span><span class="s2">&quot;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>~/.bashrc
sed<span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;s,@MIRROOT@,</span><span class="nv">$MIR</span><span class="s2">,&quot;</span><span class="w"> </span>scripts/MIRRC.in<span class="w"> </span>&gt;<span class="w"> </span>MIRRC
sed<span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;s,@MIRROOT@,</span><span class="nv">$MIR</span><span class="s2">,&quot;</span><span class="w"> </span>scripts/MIRRC.sh.in<span class="w"> </span>&gt;<span class="w"> </span>MIRRC.sh
chmod<span class="w"> </span><span class="m">644</span><span class="w"> </span>MIRRC*

<span class="c1"># Put these into .bashrc, or call them each time you want to run MIRIAD</span>
.<span class="w"> </span><span class="nv">$MIR</span>/MIRRC.sh
<span class="nb">export</span><span class="w"> </span><span class="nv">PATH</span><span class="o">=</span><span class="nv">$PATH</span>:<span class="nv">$MIRBIN</span>
</pre></div>
 </div>
        <!-- /.entry-content   not article.summary--> 
    </article></li>
    <hr width=100%>
</ul><!-- /#posts-list -->
<p class="paginator">
            <a href="https://keflavich.github.io/blog/category/misc5.html">&laquo;</a>
    Page 6 / 25
        <a href="https://keflavich.github.io/blog/category/misc7.html">&raquo;</a>
</p>
</section><!-- /#content -->
  </div>

    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-37306139-1']);
    _gaq.push(['_trackPageview']);
    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();

    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-37306139-1');
    ga('send', 'pageview');
</script>
<script type="text/javascript">
  var disqus_shortname = 'adamginsburgsblog';
  (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
   })();
</script>
</body>
</html>
