<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>Adam Ginsburg's blog - misc</title><link href="https://keflavich.github.io/blog/" rel="alternate"></link><link href="https://keflavich.github.io/blog/feeds/misc.atom.xml" rel="self"></link><id>https://keflavich.github.io/blog/</id><updated>2025-03-15T00:00:00-06:00</updated><entry><title>Pushing to a pull request</title><link href="https://keflavich.github.io/blog/pushing-to-a-pull-request.html" rel="alternate"></link><published>2025-03-15T00:00:00-06:00</published><updated>2025-03-15T00:00:00-06:00</updated><author><name>Adam Ginsburg (Adam.G.Ginsburg@gmail.com)</name></author><id>tag:keflavich.github.io,2025-03-15:/blog/pushing-to-a-pull-request.html</id><summary type="html">&lt;p&gt;A very common workflow in open source development is for someone to open a pull request onto your (or the upstream) repository from their fork, and then if &amp;quot;Maintainers are allowed to edit this pull request.&amp;quot; is checked, you want to edit their PR.&lt;/p&gt;
&lt;p&gt;This is a pain in the …&lt;/p&gt;</summary><content type="html">&lt;p&gt;A very common workflow in open source development is for someone to open a pull request onto your (or the upstream) repository from their fork, and then if &amp;quot;Maintainers are allowed to edit this pull request.&amp;quot; is checked, you want to edit their PR.&lt;/p&gt;
&lt;p&gt;This is a pain in the ass if you try to use any documented command line tools.  Github docs tell you how to check out the PR, but not how to push it back - all of the online docs I found, and both chatGPT and Claude, require that you add the PR's fork as a remote.   That's stupid.&lt;/p&gt;
&lt;p&gt;The better way is:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;git&lt;span class="w"&gt; &lt;/span&gt;fetch&lt;span class="w"&gt; &lt;/span&gt;origin&lt;span class="w"&gt; &lt;/span&gt;pull/&amp;lt;PULL_REQUEST_NUMBER&amp;gt;/head:&amp;lt;LOCAL_BRANCH_NAME&amp;gt;
&lt;span class="c1"&gt;# ... make edits ...&lt;/span&gt;
git&lt;span class="w"&gt; &lt;/span&gt;commit&lt;span class="w"&gt; &lt;/span&gt;-am&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;I edited the PR&amp;#39;&lt;/span&gt;
git&lt;span class="w"&gt; &lt;/span&gt;push&lt;span class="w"&gt; &lt;/span&gt;git@github.com:&amp;lt;contributor-name&amp;gt;/&amp;lt;repo-name&amp;gt;.git&lt;span class="w"&gt; &lt;/span&gt;&amp;lt;LOCAL_BRANCH_NAME&amp;gt;:&amp;lt;REMOTE_BRANCH_NAME&amp;gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;so, for example, we tried this on my CV from &lt;tt class="docutils literal"&gt;alissapajer&lt;/tt&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;git&lt;span class="w"&gt; &lt;/span&gt;fetch&lt;span class="w"&gt; &lt;/span&gt;origin&lt;span class="w"&gt; &lt;/span&gt;pull/1/head:alissapajer-patch-1
git&lt;span class="w"&gt; &lt;/span&gt;checkout&lt;span class="w"&gt; &lt;/span&gt;alissapajer-patch-1
git&lt;span class="w"&gt; &lt;/span&gt;commit&lt;span class="w"&gt; &lt;/span&gt;-am&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;blah&amp;#39;&lt;/span&gt;
git&lt;span class="w"&gt; &lt;/span&gt;push&lt;span class="w"&gt; &lt;/span&gt;git@github.com:alissapajer/keflavich-cv.git&lt;span class="w"&gt; &lt;/span&gt;HEAD:alissapajer-patch-1
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;(&lt;cite&gt;HEAD&lt;/cite&gt; works here b/c I was still on that branch)&lt;/p&gt;
&lt;p&gt;It would also work, and be more explicit, to use the remote name:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;git&lt;span class="w"&gt; &lt;/span&gt;fetch&lt;span class="w"&gt; &lt;/span&gt;git@github.com:alissapajer/keflavich-cv.git&lt;span class="w"&gt; &lt;/span&gt;alissapajer-patch-1
&lt;/pre&gt;&lt;/div&gt;
</content><category term="misc"></category><category term="github"></category></entry><entry><title>Editing metadata in measurement sets</title><link href="https://keflavich.github.io/blog/editing-metadata-in-measurement-sets.html" rel="alternate"></link><published>2023-08-11T15:34:00-06:00</published><updated>2023-08-11T15:34:00-06:00</updated><author><name>Adam Ginsburg (Adam.G.Ginsburg@gmail.com)</name></author><id>tag:keflavich.github.io,2023-08-11:/blog/editing-metadata-in-measurement-sets.html</id><summary type="html">&lt;p&gt;I needed to update the position of VLA phase calibrator &lt;a class="reference external" href="http://simbad.u-strasbg.fr/simbad/sim-id?Ident=%402384864&amp;amp;Name=QSO%20J1744-3116&amp;amp;submit=submit"&gt;J1744-3116&lt;/a&gt; in my measurement sets.  The VLA coordinate is:&lt;/p&gt;
&lt;blockquote&gt;
&lt;tt class="docutils literal"&gt;17:33:02.705790 &lt;span class="pre"&gt;-13.04.49.54823&lt;/span&gt; J2000&lt;/tt&gt;&lt;/blockquote&gt;
&lt;p&gt;while the ALMA coordinate is&lt;/p&gt;
&lt;blockquote&gt;
&lt;tt class="docutils literal"&gt;17:44:23.578227 &lt;span class="pre"&gt;-31.16.36.29204&lt;/span&gt; ICRS&lt;/tt&gt;&lt;/blockquote&gt;
&lt;p&gt;and the SIMBAD coordinate is&lt;/p&gt;
&lt;blockquote&gt;
&lt;tt class="docutils literal"&gt;17 44 23 …&lt;/tt&gt;&lt;/blockquote&gt;</summary><content type="html">&lt;p&gt;I needed to update the position of VLA phase calibrator &lt;a class="reference external" href="http://simbad.u-strasbg.fr/simbad/sim-id?Ident=%402384864&amp;amp;Name=QSO%20J1744-3116&amp;amp;submit=submit"&gt;J1744-3116&lt;/a&gt; in my measurement sets.  The VLA coordinate is:&lt;/p&gt;
&lt;blockquote&gt;
&lt;tt class="docutils literal"&gt;17:33:02.705790 &lt;span class="pre"&gt;-13.04.49.54823&lt;/span&gt; J2000&lt;/tt&gt;&lt;/blockquote&gt;
&lt;p&gt;while the ALMA coordinate is&lt;/p&gt;
&lt;blockquote&gt;
&lt;tt class="docutils literal"&gt;17:44:23.578227 &lt;span class="pre"&gt;-31.16.36.29204&lt;/span&gt; ICRS&lt;/tt&gt;&lt;/blockquote&gt;
&lt;p&gt;and the SIMBAD coordinate is&lt;/p&gt;
&lt;blockquote&gt;
&lt;tt class="docutils literal"&gt;17 44 23.57824 &lt;span class="pre"&gt;-31&lt;/span&gt; 16 36.2943 ICRS&lt;/tt&gt;&lt;/blockquote&gt;
&lt;p&gt;These are separated by a significant amount:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;astropy&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;units&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;coordinates&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;

&lt;span class="n"&gt;vla_coord&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;coordinates&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SkyCoord&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;17:33:02.705790 -13:04:49.54823&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;unit&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;h&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;deg&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;frame&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;fk5&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;alma_coord&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;coordinates&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SkyCoord&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;17:44:23.578227 -31:16:36.29204&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;unit&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;h&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;deg&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;frame&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;icrs&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;simbad_coord&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;coordinates&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SkyCoord&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;17 44 23.57824 -31 16 36.2943&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;unit&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;h&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;deg&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;frame&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;icrs&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;alma_coord&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;separation&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vla_coord&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;to&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;arcsec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="c1"&gt;# &amp;lt;Angle 0.28848595 arcsec&amp;gt;&lt;/span&gt;

&lt;span class="n"&gt;simbad_coord&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;separation&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vla_coord&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;to&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;arcsec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="c1"&gt;# &amp;lt;Angle 0.29071513 arcsec&amp;gt;&lt;/span&gt;

&lt;span class="n"&gt;simbad_coord&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;separation&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;alma_coord&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;to&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;arcsec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="c1"&gt;# &amp;lt;Angle 0.00226614 arcsec&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This is caused by a typo in the VLA calibrator catalog (Lorant Sjouwerman, private communication).&lt;/p&gt;
&lt;p&gt;To fix it:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;tb&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;22A-020.sb41257746.eb41788351.59700.31502699074/22A-020.sb41257746.eb41788351.59700.31502699074.ms/FIELD&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;# get the existing PHASE_DIR.  Shape is [coordinates, ?, sourceID]&lt;/span&gt;
&lt;span class="n"&gt;phasedir&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;tb&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;getcol&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;PHASE_DIR&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="c1"&gt;# figure out which row contains the to-be-modified source&lt;/span&gt;
&lt;span class="n"&gt;rownr&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;argmax&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tb&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;getcol&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NAME&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;J1744-3116&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="c1"&gt;# modify the phasedir.  CASA expects coordinates to be wrapped at 180 deg&lt;/span&gt;
&lt;span class="n"&gt;phasedir&lt;/span&gt;&lt;span class="p"&gt;[:,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rownr&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;simbad_coord&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fk5&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ra&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;wrap_at&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;180&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;deg&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rad&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;simbad_coord&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fk5&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dec&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rad&lt;/span&gt;

&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;shutil&lt;/span&gt;
&lt;span class="n"&gt;shutil&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;copytree&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;22A-020.sb41257746.eb41788351.59700.31502699074/22A-020.sb41257746.eb41788351.59700.31502699074.ms/FIELD&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;22A-020.sb41257746.eb41788351.59700.31502699074/22A-020.sb41257746.eb41788351.59700.31502699074.ms/FIELD.backup&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;tb&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;22A-020.sb41257746.eb41788351.59700.31502699074/22A-020.sb41257746.eb41788351.59700.31502699074.ms/FIELD&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;nomodify&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;False&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;tb&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;putcol&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;columnname&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;PHASE_DIR&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;phasedir&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;tb&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;flush&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;tb&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Put all together:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;astropy&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;units&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;coordinates&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;

&lt;span class="n"&gt;simbad_coord&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;coordinates&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SkyCoord&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;17 44 23.57824 -31 16 36.2943&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;unit&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;h&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;deg&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;frame&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;icrs&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;glob&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nn"&gt;shutil&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;vis&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;glob&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;glob&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;*/*.ms&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;shutil&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;copytree&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vis&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/FIELD&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vis&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/FIELD.backup&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;tb&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vis&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/FIELD&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;phasedir&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;tb&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;getcol&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;PHASE_DIR&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;rownr&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;argmax&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tb&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;getcol&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NAME&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;J1744-3116&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;assert&lt;/span&gt; &lt;span class="n"&gt;rownr&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
    &lt;span class="n"&gt;phasedir&lt;/span&gt;&lt;span class="p"&gt;[:,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rownr&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;simbad_coord&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fk5&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ra&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;wrap_at&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;180&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;deg&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rad&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;simbad_coord&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fk5&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dec&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rad&lt;/span&gt;
    &lt;span class="n"&gt;tb&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vis&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/FIELD&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;nomodify&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;False&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;tb&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;putcol&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;columnname&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;PHASE_DIR&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;phasedir&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;tb&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;flush&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;tb&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
</content><category term="misc"></category><category term="casa"></category></entry><entry><title>CASA MPI debugging cont'd</title><link href="https://keflavich.github.io/blog/casa-mpi-debugging-contd.html" rel="alternate"></link><published>2022-05-06T09:08:00-06:00</published><updated>2022-05-06T09:08:00-06:00</updated><author><name>Adam Ginsburg (Adam.G.Ginsburg@gmail.com)</name></author><id>tag:keflavich.github.io,2022-05-06:/blog/casa-mpi-debugging-contd.html</id><summary type="html">&lt;p&gt;I continue to try to get MPI to run to completion.&lt;/p&gt;
&lt;p&gt;Using casa-6.5.0-9-py3.8, the latest error on the W51 B3 mosaic (biggest in ALMA-IMF, approximately):
2022-05-03 06:36:06     SEVERE  MPICommandServer::command_request_handler_service::CubeMajorCycleAlgorithm::task::MPIServer-2 (file src/code/synthesis/ImagerObjects/CubeMajorCycleAlgorithm.cc, line 137 …&lt;/p&gt;</summary><content type="html">&lt;p&gt;I continue to try to get MPI to run to completion.&lt;/p&gt;
&lt;p&gt;Using casa-6.5.0-9-py3.8, the latest error on the W51 B3 mosaic (biggest in ALMA-IMF, approximately):
2022-05-03 06:36:06     SEVERE  MPICommandServer::command_request_handler_service::CubeMajorCycleAlgorithm::task::MPIServer-2 (file src/code/synthesis/ImagerObjects/CubeMajorCycleAlgorithm.cc, line 137)      Exception (std): ArrayBase::validateConformance shape [3] differs from [4]&lt;/p&gt;
&lt;p&gt;This leads to a lot of frozen nodes:
2022-05-03 19:29:17     SEVERE  MPIMonitorClient::monitor_status_service::MPIMonitorClient::monitor_status_service::casa        Ping status response from server 1 not received in the last 420s. Setting its status to 'timeout'&lt;/p&gt;
&lt;p&gt;This happens during the MakePSF stage.&lt;/p&gt;
&lt;p&gt;On G333.60 B6, which is smaller, the first exception I see is:
2022-05-05 17:31:47     SEVERE  MPIMonitorClient::monitor_status_service::MPIMonitorClient::monitor_status_service::casa        Ping status response from server 4 not received in the last 85s. Setting its status to 'timeout'
but... it looks like the clean actually finished!&lt;/p&gt;
&lt;p&gt;This is an odd one that happened during a major cycle, I think:&lt;/p&gt;
&lt;p&gt;2022-05-13 17:47:25     WARN    MPICommandServer::command_request_handler_service::SynthesisImagerVi2::CubeMajorCycle::MPIServer-19 (file src/code/synthesis/ImagerObjects/CubeMajorCycleAlgorithm.cc, line 336)        Exception for chan range [144, 151] ---   Setting masked pixels to zero for input startmodel : Er
ror (Resource deadlock avoided) when acquiring lock on /blue/adamginsburg/adamginsburg/almaimf/workdir/G328.25_B6_spw4_12M_spw4.contcube.model/table.lock&lt;/p&gt;
&lt;p&gt;This one resulted in the residual and image being identical past some point in the spectrum, i.e., it gave up partway through writing to disk.  There was NO CASA error!  Just a miserable segfault&lt;/p&gt;
&lt;p&gt;[c0711a-s25:60411] &lt;strong&gt;* Process received signal *&lt;/strong&gt;
[c0711a-s25:60411] Signal: Segmentation fault (11)
[c0711a-s25:60411] Signal code: Address not mapped (1)
[c0711a-s25:60411] Failing at address: 0x2d867e04f000&lt;/p&gt;
</content><category term="misc"></category><category term="CASA"></category></entry><entry><title>CO2 Monitoring at Conferences: Update in 2022</title><link href="https://keflavich.github.io/blog/co2-monitoring-at-conferences-update-in-2022.html" rel="alternate"></link><published>2022-05-01T09:15:00-06:00</published><updated>2022-05-01T09:15:00-06:00</updated><author><name>Adam Ginsburg (Adam.G.Ginsburg@gmail.com)</name></author><id>tag:keflavich.github.io,2022-05-01:/blog/co2-monitoring-at-conferences-update-in-2022.html</id><summary type="html">&lt;p&gt;I started monitoring CO2 levels at conferences a couple years back, and now
that we're having in-person conferences again, I'm doing more monitoring.&lt;/p&gt;
&lt;p&gt;The last I attended was &lt;a class="reference external" href="https://www2.mpia-hd.mpg.de/homes/stein/EPoS/2022/epos2022.php"&gt;EPOS 2022&lt;/a&gt;, which is
probably my favorite recurring conference because of its venue, size, and schedule.
There is time to talk to …&lt;/p&gt;</summary><content type="html">&lt;p&gt;I started monitoring CO2 levels at conferences a couple years back, and now
that we're having in-person conferences again, I'm doing more monitoring.&lt;/p&gt;
&lt;p&gt;The last I attended was &lt;a class="reference external" href="https://www2.mpia-hd.mpg.de/homes/stein/EPoS/2022/epos2022.php"&gt;EPOS 2022&lt;/a&gt;, which is
probably my favorite recurring conference because of its venue, size, and schedule.
There is time to talk to everyone you want to about all topics.&lt;/p&gt;
&lt;p&gt;I gave a &lt;a class="reference external" href="https://keflavich.github.io/talks/EPOS_2022.html"&gt;talk&lt;/a&gt; on the
small disks in Orion.&lt;/p&gt;
&lt;p&gt;The monitoring results are here:&lt;/p&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/EPOS2022.png" style="width: 600px;" /&gt;
&lt;p&gt;I missed day 1 because I forgot the USB cable in my room, then I had some
electrical connection problems day 2 (the USB-C port on my computer is...
finnicky).  But besides that, you can see clear trends on day 1 and part of
day 2 where the CO2 was rapidly rising to uncomfortable levels.&lt;/p&gt;
&lt;p&gt;The blue zones are the scheduled breaks.  During the breaks, the room was
almost totally empty and we usually opened the doors and windows.&lt;/p&gt;
&lt;p&gt;I shared the day 2 data with the conference organizers and they then
prioritized opening the windows.  There was one period I think we opted
not to because it started snowing for a few minutes.&lt;/p&gt;
&lt;p&gt;On the last day, I'm not sure why the CO2 didn't go down during the break - it
may be that windows were open only one one side of the room, so there was only
diffusion, not flow.&lt;/p&gt;
</content><category term="misc"></category><category term="CO2"></category><category term="conferences"></category></entry><entry><title>ALMA Cycle 9 corrupted zip fix</title><link href="https://keflavich.github.io/blog/alma-cycle-9-corrupted-zip-fix.html" rel="alternate"></link><published>2022-04-14T09:18:00-06:00</published><updated>2022-04-14T09:18:00-06:00</updated><author><name>Adam Ginsburg (Adam.G.Ginsburg@gmail.com)</name></author><id>tag:keflavich.github.io,2022-04-14:/blog/alma-cycle-9-corrupted-zip-fix.html</id><summary type="html">&lt;p&gt;If you encounter a bug like this:&lt;/p&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/ALMAC9ZipBug.png" style="width: 600px;" /&gt;
&lt;p&gt;&amp;quot;XML (syntax or validity) error&amp;quot; because you hit issue &lt;a class="reference external" href="https://almascience.eso.org/documents-and-tools/cycle9/known-issues"&gt;C1_032&lt;/a&gt;,
the fix is really easy:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;zipfile&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;os&lt;/span&gt;

&lt;span class="c1"&gt;# not strictly necessary, but important if you want to avoid filling your directory with files&lt;/span&gt;
&lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;mkdir&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;recovery&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;chdir&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;recovery&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;# replace with …&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;</summary><content type="html">&lt;p&gt;If you encounter a bug like this:&lt;/p&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/ALMAC9ZipBug.png" style="width: 600px;" /&gt;
&lt;p&gt;&amp;quot;XML (syntax or validity) error&amp;quot; because you hit issue &lt;a class="reference external" href="https://almascience.eso.org/documents-and-tools/cycle9/known-issues"&gt;C1_032&lt;/a&gt;,
the fix is really easy:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;zipfile&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;os&lt;/span&gt;

&lt;span class="c1"&gt;# not strictly necessary, but important if you want to avoid filling your directory with files&lt;/span&gt;
&lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;mkdir&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;recovery&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;chdir&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;recovery&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;# replace with your AOT file name&lt;/span&gt;
&lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="n"&gt;zipfile&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ZipFile&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;../corrupted.aot&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;r&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;aot&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="c1"&gt;# this will extract all the files into the current directory&lt;/span&gt;
    &lt;span class="n"&gt;aot&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;extractall&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;files&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;aot&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;filelist&lt;/span&gt;

&lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="n"&gt;zipfile&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ZipFile&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;../recovered.aot&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;w&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;aot&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;fh&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;files&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;aot&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fh&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;filename&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;At least, this worked on the one case where I got bitten.&lt;/p&gt;
&lt;p&gt;This fix is based on &lt;a class="reference external" href="https://github.com/low-sky/alma_proposal_tools"&gt;Erik Rosolowsky's ALMA proposal tools&lt;/a&gt;&lt;/p&gt;
</content><category term="misc"></category><category term="alma"></category><category term="proposals"></category></entry><entry><title>Hacking plotms to let pipeline run</title><link href="https://keflavich.github.io/blog/hacking-plotms-to-let-pipeline-run.html" rel="alternate"></link><published>2022-04-11T08:02:00-06:00</published><updated>2022-04-11T08:02:00-06:00</updated><author><name>Adam Ginsburg (Adam.G.Ginsburg@gmail.com)</name></author><id>tag:keflavich.github.io,2022-04-11:/blog/hacking-plotms-to-let-pipeline-run.html</id><summary type="html">&lt;p&gt;For the ACES project, I'm re-running the ALMA pipeline using MPI.&lt;/p&gt;
&lt;p&gt;However, this results in all runs crashing with the following error:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;2022-04-06 04:22:43 INFO: Executing plotms(vis=&amp;#39;uid___A002_Xf512ae_X2626.ms&amp;#39;, xaxis=&amp;#39;azimuth&amp;#39;, yaxis=&amp;#39;elevation&amp;#39;, spw=&amp;#39;25:0~0,27:0~0,29:0~0,31 …&lt;/pre&gt;&lt;/div&gt;</summary><content type="html">&lt;p&gt;For the ACES project, I'm re-running the ALMA pipeline using MPI.&lt;/p&gt;
&lt;p&gt;However, this results in all runs crashing with the following error:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;2022-04-06 04:22:43 INFO: Executing plotms(vis=&amp;#39;uid___A002_Xf512ae_X2626.ms&amp;#39;, xaxis=&amp;#39;azimuth&amp;#39;, yaxis=&amp;#39;elevation&amp;#39;, spw=&amp;#39;25:0~0,27:0~0,29:0~0,31:0~0,33:0~0,35:0~0&amp;#39;, antenna=&amp;#39;0&amp;amp;&amp;amp;*&amp;#39;, avgchannel=&amp;#39;9000&amp;#39;, avgtime=&amp;#39;10&amp;#39;, coloraxis=&amp;#39;field&amp;#39;, customflaggedsymbol=True, flaggedsymbolshape=&amp;#39;autoscaling&amp;#39;, title=&amp;#39;Elevation vs Azimuth for uid___A002_Xf512ae_X2626.ms&amp;#39;, plotfile=&amp;#39;azel.png&amp;#39;, showgui=False, clearplots=True)
fuse: failed to exec fusermount: No such file or directory

Cannot mount AppImage, please check your FUSE setup.
You might still be able to extract the contents of this AppImage
if you run it with the --appimage-extract option.
See https://github.com/AppImage/AppImageKit/wiki/FUSE
for more information
open dir error: No such file or directory
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This fails even if I set the global APPIMAGE_EXTRACT_AND_RUN as &lt;a class="reference external" href="https://docs.appimage.org/user-guide/troubleshooting/fuse.html#extract-and-run-type-2-appimages"&gt;directed&lt;/a&gt;
on the appimage.org docs.&lt;/p&gt;
&lt;p&gt;This indicates that the appimage is older than the environmental variable.&lt;/p&gt;
&lt;p&gt;Running the full command &amp;quot;works&amp;quot;:
&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;/orange/adamginsburg/casa/casa-6.2.1-7-pipeline-2021.2.0.128/lib/py/lib/python3.6/site-packages/casaplotms/__bin__/casaplotms-x86_64.AppImage&lt;/span&gt; &lt;span class="pre"&gt;--appimage-extract&lt;/span&gt;&lt;/tt&gt;
but &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;--appimage-extract-and-run&lt;/span&gt;&lt;/tt&gt; gives &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;--appimage-extract-and-run&lt;/span&gt; is not yet implemented in version &lt;span class="pre"&gt;continuous-1-g6f3138f&lt;/span&gt;&lt;/tt&gt;&lt;/p&gt;
&lt;p&gt;So to run plotms, we need to use the &lt;tt class="docutils literal"&gt;AppRun&lt;/tt&gt; executable in the extracted &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;squashfs-root&lt;/span&gt;&lt;/tt&gt; directory.&lt;/p&gt;
&lt;p&gt;My original hack was to just tell plotms not to run at all, which I accomplished by editing the
&lt;tt class="docutils literal"&gt;plotmstool.py&lt;/tt&gt; file (&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;lib/py/lib/python3.6/site-packages/casaplotms/private/plotmstool.py&lt;/span&gt;&lt;/tt&gt;) to
just skip the &lt;tt class="docutils literal"&gt;__launch&lt;/tt&gt; command:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;__launch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;uri&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;None&lt;/span&gt; &lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;However, in writing this post, I've changed to instead modifying the &lt;tt class="docutils literal"&gt;app_path&lt;/tt&gt; to this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;app_path&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;/tmp/casaplotms/squashfs-root/AppRun&amp;quot;&lt;/span&gt;
&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="n"&gt;__os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exists&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;app_path&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;f&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Did not find extracted path &lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="n"&gt;app_path&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;app_path&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;__os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;__os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;abspath&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;__os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;__os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dirname&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="vm"&gt;__file__&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;..&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;__bin__/casaplotms-x86_64.AppImage&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;I haven't tried it but I'm slightly hopeful.&lt;/p&gt;
</content><category term="misc"></category><category term="casa"></category></entry><entry><title>Astronomical Software Development &amp; Career</title><link href="https://keflavich.github.io/blog/astronomical-software-development-career.html" rel="alternate"></link><published>2022-03-19T13:04:00-06:00</published><updated>2022-03-19T13:04:00-06:00</updated><author><name>Adam Ginsburg (Adam.G.Ginsburg@gmail.com)</name></author><id>tag:keflavich.github.io,2022-03-19:/blog/astronomical-software-development-career.html</id><summary type="html">&lt;p&gt;I recently visited the &lt;a class="reference external" href="https://www.astro.umd.edu/"&gt;University of Maryland&lt;/a&gt;
to give a &lt;a class="reference external" href="https://www.astro.umd.edu/events/colloquia/colloquium/cal.0316.html"&gt;colloquium&lt;/a&gt;
(&lt;a class="reference external" href="https://keflavich.github.io/talks/colloquium_Mar2022_UMD.html"&gt;slides here&lt;/a&gt;).
This was my first in-person colloquium as faculty because of COVID.&lt;/p&gt;
&lt;p&gt;I had a great meeting with the grad students over lunch, and they asked several good
questions.  I've thought over some of them a little more …&lt;/p&gt;</summary><content type="html">&lt;p&gt;I recently visited the &lt;a class="reference external" href="https://www.astro.umd.edu/"&gt;University of Maryland&lt;/a&gt;
to give a &lt;a class="reference external" href="https://www.astro.umd.edu/events/colloquia/colloquium/cal.0316.html"&gt;colloquium&lt;/a&gt;
(&lt;a class="reference external" href="https://keflavich.github.io/talks/colloquium_Mar2022_UMD.html"&gt;slides here&lt;/a&gt;).
This was my first in-person colloquium as faculty because of COVID.&lt;/p&gt;
&lt;p&gt;I had a great meeting with the grad students over lunch, and they asked several good
questions.  I've thought over some of them a little more and wanted to fill out my answers.
I'll paraphrase two questions:&lt;/p&gt;
&lt;p&gt;&amp;quot;How do you balance coding work with other research work?&amp;quot;&lt;/p&gt;
&lt;p&gt;My answer was essentially, &amp;quot;All of my coding work is research work - I don't write
code that doesn't contribute to my research.&amp;quot;  That is broadly true, but not exclusively
so, and there are some exceptions.&lt;/p&gt;
&lt;p&gt;All of the coding work I have done has been either to enable my research, support
someone else's research, enable my research career, or (in theory) make my life easier.&lt;/p&gt;
&lt;p&gt;The research stuff is mostly obvious - my work on and with data reduction software
(see all the CASA-tagged blog posts here, all development on radio-astro-tools, etc),
pyspeckit, and most of astroquery.  On the astroquery side, a lot of my research work
wasn't directly going to papers, but was instead to dig through the archives to see
if data were available, or if I needed to obtain new data.  It was then useful
for supporting observing proposal writing.&lt;/p&gt;
&lt;p&gt;The &amp;quot;enable my research career&amp;quot; component included a lot of side-work on things
that aren't directly research, but are research-adjacent.  These projects
included building tools to deploy my papers to github (which was a bit
obsoleted by overleaf), automatically &lt;a class="reference external" href="https://github.com/keflavich/cv/blob/master/update_journals.py"&gt;updating reference lists&lt;/a&gt; (it turns
out I often cite 5-10 arXiv papers in an article, but by publication time, I
need to update them to official journal article citations), assemble lists of
coauthors, &lt;a class="reference external" href="https://github.com/keflavich/cv/blob/master/add_citations.py"&gt;add citation counts to the CV&lt;/a&gt;, writing this
blog, etc.&lt;/p&gt;
&lt;p&gt;The exceptions are some of the 'pure service' coding.  This necessarily had to
be the lowest priority most of the time, but this is still career-motivated.
Some of the contributions I've made to astropy &amp;amp; other open-source projects are
just to improve their code bases, either with bugfixes, added features, or
things to improve robustness.  Most of my contributions were directly motivated
by need, of course - either there was something basic missing, or I was the
expert in that particular subtopic.  A good example is the &lt;a class="reference external" href="https://docs.astropy.org/en/stable/api/astropy.units.brightness_temperature.html"&gt;J-to-K equivalency&lt;/a&gt;;
it wasn't directly research-motivated, but was something I found myself needing
in day-to-day work.&lt;/p&gt;
&lt;p&gt;The 'pure service' coding also entails maintaining projects.  There is still a
selfish motivation here: if the code is maintained (if other people are using
iti and finding bugs), it is more likely to be functional when I need it next.
But, most of this work isn't triggered by my own needs, but by others.
The astropy Moore grant now funds some of this work, which helps ensure that
I'm motivated to continue the maintenance - but I was doing a lot of this work
as a postdoc long before I could be directly paid for it.&lt;/p&gt;
&lt;p&gt;&amp;quot;How do you avoid being typecast as a coder?&amp;quot;&lt;/p&gt;
&lt;p&gt;This question came from students who got to be known in their research
collaborations as &amp;quot;good at coding&amp;quot;.  My answer was basically, &amp;quot;learn to say
no&amp;quot;, but there's more nuance to add.&lt;/p&gt;
&lt;p&gt;First, there are some solid career paths to follow by being the science coder
in a group.  Many observatory jobs, for example, would prioritize this coding
experience.  There are a lot of positions in observatory jobs at places
like STSCI, NRAO, NOAO, etc. that value this sort of skill over many others.
So if you want to pursue one of these paths, or an industry path, because
you &amp;lt;i&amp;gt; enjoy &amp;lt;/i&amp;gt; the coding, then great!  Do it!&lt;/p&gt;
&lt;p&gt;If you really enjoy the coding, you'll get to do a lot more of it in a job
focused on software development than in an R1 research job.&lt;/p&gt;
&lt;p&gt;That said, if you are interested in pursuing an R1 faculty job, you need to
strike a more careful balance.  It's fine if you're the coder in the group -
that can land you a coauthorship on a lot of papers, which is a good thing!
However, first and foremost, you need to publish your own (first-author)
papers, which means prioritizing your work over collaborative work.  Ideally,
you'd just do both - that's what's expected of faculty members (faculty members
can't choose to prioritize teaching or research, really - they have to do well
at both, which often means just putting in more hours).  But if you're faced
with the choice, a few first-author papers are more important than many
co-author papers.&lt;/p&gt;
&lt;p&gt;The way I struck the balance was to focus entirely on research papers during my
grad school career, but still do a lot of software support work on the side - I
put in more time, but it was all stuff that was useful both for me and for
collaborators.  Later, in my second postdoc, I started publishing code-only
papers; I would advise grad students to do this sooner, though.  Since AAS
journals now accept code papers, if you want coding to be a big part of your
research portfolio, it's a good idea to have a refereed paper on a piece of
software.  Note that some of the most highly-cited papers in astronomy are code
papers, like the DAOPHOT, SEXTRACTOR, and astropy papers.&lt;/p&gt;
&lt;p&gt;Last bit of advice closing this out: Avoid GUI development.  That way lays madness.&lt;/p&gt;
</content><category term="misc"></category><category term="career"></category><category term="colloquium"></category></entry><entry><title>My blog is now deployed with gh-actions</title><link href="https://keflavich.github.io/blog/my-blog-is-now-deployed-with-gh-actions.html" rel="alternate"></link><published>2022-02-23T20:21:00-07:00</published><updated>2022-02-23T20:21:00-07:00</updated><author><name>Adam Ginsburg (Adam.G.Ginsburg@gmail.com)</name></author><id>tag:keflavich.github.io,2022-02-23:/blog/my-blog-is-now-deployed-with-gh-actions.html</id><content type="html">&lt;p&gt;This is mostly a test post to prove it.&lt;/p&gt;
&lt;p&gt;I'm now using this gh-deployment script:
&lt;a class="reference external" href="https://github.com/keflavich/gh-pages-pelican-action"&gt;https://github.com/keflavich/gh-pages-pelican-action&lt;/a&gt; (forked from &lt;a class="reference external" href="https://github.com/nelsonjchen/gh-pages-pelican-action"&gt;https://github.com/nelsonjchen/gh-pages-pelican-action&lt;/a&gt;)
in conjunction with gh-actions.&lt;/p&gt;
</content><category term="misc"></category><category term="blog deployment"></category></entry><entry><title>CASA MPI Errors continued in early 2022</title><link href="https://keflavich.github.io/blog/casa-mpi-errors-continued-in-early-2022.html" rel="alternate"></link><published>2022-01-23T07:54:00-07:00</published><updated>2022-01-23T07:54:00-07:00</updated><author><name>Adam Ginsburg (Adam.G.Ginsburg@gmail.com)</name></author><id>tag:keflavich.github.io,2022-01-23:/blog/casa-mpi-errors-continued-in-early-2022.html</id><summary type="html">&lt;p&gt;Running 7m+12m combination, the following errors show up:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
Exception: Error in making PSF : Invalid Table operation: Rows cannot be removed from table /blue/adamginsburg/adamginsburg/almaimf/workdir/G333.60_spw5_12M_B6/IMAGING_WEIGHT_1390794_230801956263_230804885819_bwtaper_0_interp_1; its storage managers do not support it
&lt;/pre&gt;
&lt;p&gt;This …&lt;/p&gt;</summary><content type="html">&lt;p&gt;Running 7m+12m combination, the following errors show up:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
Exception: Error in making PSF : Invalid Table operation: Rows cannot be removed from table /blue/adamginsburg/adamginsburg/almaimf/workdir/G333.60_spw5_12M_B6/IMAGING_WEIGHT_1390794_230801956263_230804885819_bwtaper_0_interp_1; its storage managers do not support it
&lt;/pre&gt;
&lt;p&gt;This turns up several times repeatedly:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
G333.60_B6_fullcube_7M12M_5_15827045.log:2022-01-21 18:05:38  WARN    MPICommandServer::command_request_handler_service::SynthesisImagerVi2::CubeMajorCycle::MPIServer-25 (file src/code/synthesis/ImagerObjects/CubeMajorCycleAlgorithm.cc, line 336)      Exception for chan range [496, 499] ---   Error in making PSF : Interpolate1D::operator() data has repeated x values
G333.60_B6_fullcube_7M12M_5_15868985.log:2022-01-22 00:01:20  WARN    MPICommandServer::command_request_handler_service::SynthesisImagerVi2::CubeMajorCycle::MPIServer-19 (file src/code/synthesis/ImagerObjects/CubeMajorCycleAlgorithm.cc, line 336)      Exception for chan range [496, 499] ---   Error in making PSF : Invalid Table operation: Rows cannot be removed from table /blue/adamginsburg/adamginsburg/almaimf/workdir/G333.60_spw5_12M_B6/IMAGING_WEIGHT_1390794_230801956263_230804885819_bwtaper_0_interp_1; its storage managers do not support it
G333.60_B6_fullcube_7M12M_5_15891690.log:2022-01-22 14:37:39  WARN    MPICommandServer::command_request_handler_service::SynthesisImagerVi2::CubeMajorCycle::MPIServer-23 (file src/code/synthesis/ImagerObjects/CubeMajorCycleAlgorithm.cc, line 336)      Exception for chan range [496, 499] ---   Error in making PSF : Invalid Table operation: Rows cannot be removed from table /blue/adamginsburg/adamginsburg/almaimf/workdir/G333.60_spw5_12M_B6/IMAGING_WEIGHT_1390794_230801956263_230804885819_bwtaper_0_interp_1; its storage managers do not support it
G333.60_B6_fullcube_7M12M_5_15914880.log:2022-01-23 02:21:24  WARN    MPICommandServer::command_request_handler_service::SynthesisImagerVi2::CubeMajorCycle::MPIServer-25 (file src/code/synthesis/ImagerObjects/CubeMajorCycleAlgorithm.cc, line 336)      Exception for chan range [496, 499] ---   Error in making PSF : Invalid Table operation: Rows cannot be removed from table /blue/adamginsburg/adamginsburg/almaimf/workdir/G333.60_spw5_12M_B6/IMAGING_WEIGHT_1390794_230801956263_230804885819_bwtaper_0_interp_1; its storage managers do not support it
&lt;/pre&gt;
&lt;p&gt;Looks like it's always the same few channels failing.&lt;/p&gt;
&lt;p&gt;Errors like this one:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
WARN    MPICommandServer::command_request_handler_service::SynthesisImagerVi2::CubeMajorCycle::MPIServer-17 (file src/
code/synthesis/ImagerObjects/CubeMajorCycleAlgorithm.cc, line 336)        Exception for chan range [1152, 1153] ---   Programmer error: sumwt disk image is non existant
&lt;/pre&gt;
&lt;p&gt;are probably cauased by deleting the .sumwt file in the middle of a tclean run -
so that is genuine &amp;quot;user error&amp;quot; (I was deleting the sumwt, psf, and weight
files occasionally b/c they are the 'leftovers' when a tclean run fails for
bad reasons)&lt;/p&gt;
&lt;p&gt;There are some others that don't have obvious explanations:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
casa_log_line_G010.62_B3_fullcube_7M12M_1_2022-01-21_08_17_16.log:2022-01-21 15:29:42   WARN    MPICommandServer::command_request_handler_service::SynthesisImagerVi2::CubeMajorCycle::MPIServer-15 (file src/ code/synthesis/ImagerObjects/CubeMajorCycleAlgorithm.cc, line 336)        Exception for chan range [534, 535] ---   FilebufIO::readBlock - incorrect number of bytes read for file /blue/adamginsburg/adamgins burg/almaimf/workdir/G010.62_B3_spw1_7M12M_spw1.sumwt/table.f0
casa_log_line_G010.62_B3_fullcube_7M12M_1_2022-01-21_08_17_16.log:2022-01-21 17:07:41   WARN    MPICommandServer::command_request_handler_service::SynthesisImagerVi2::CubeMajorCycle::MPIServer-31 (file src/ code/synthesis/ImagerObjects/CubeMajorCycleAlgorithm.cc, line 336)        Exception for chan range [1596, 1597] ---   FilebufIO::readBlock - incorrect number of bytes read for file /blue/adamginsburg/adamgi nsburg/almaimf/workdir/G010.62_B3_spw1_7M12M_spw1.sumwt/table.f0
&lt;/pre&gt;
&lt;p&gt;and this:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
casa_log_line_G333.60_B6_fullcube_7M12M_5_2022-01-21_08_17_16.log:2022-01-21 18:05:38   WARN    MPICommandServer::command_request_handler_service::SynthesisImagerVi2::CubeMajorCycle::MPIServer-25 (file src/code/synthesis/ImagerObjects/CubeMajorCycleAlgorithm.cc, line 336)        Exception for chan range [496, 499] ---   Error in making PSF : Interpolate1D::operator() data has repeated x values
&lt;/pre&gt;
&lt;p&gt;This is an old one that remains unsolved:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
casa_log_line_G338.93_B3_fullcube_7M12M_1_2022-01-22_20_25_52.log:2022-01-23 04:59:57   WARN    MPICommandServer::command_request_handler_service::SynthesisImagerVi2::CubeMajorCycle::MPIServer-8 (file src/code/synthesis/ImagerObjects/CubeMajorCycleAlgorithm.cc, line 336) Exception for chan range [2049, 2049] ---   Error in making PSF : A nasty Visbuffer2 error occured...wait
&lt;/pre&gt;
&lt;p&gt;Got this real nice one after the .image was created:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
*** Error in `/blue/adamginsburg/adamginsburg/casa/casa-6.4.3-4/lib/py/bin/python3': malloc(): smallbin double linked list corrupted: 0x00002af7a40d8000 ***
======= Backtrace: =========
/lib64/libc.so.6(+0x7f804)[0x2af73aa03804]
/lib64/libc.so.6(+0x82f40)[0x2af73aa06f40]
/lib64/libc.so.6(__libc_malloc+0x4c)[0x2af73aa09b1c]
/apps/compilers/gcc/9.3.0/lib64/libstdc++.so.6(_Znwm+0x15)[0x2af751076395]
&lt;/pre&gt;
&lt;p&gt;That happened in the middle of major cycle 1, so the data were probably fine, but I'm just going to restart it&lt;/p&gt;
</content><category term="misc"></category><category term="CASA"></category></entry><entry><title>CASA Errors encountered while imaging LB data</title><link href="https://keflavich.github.io/blog/casa-errors-encountered-while-imaging-lb-data.html" rel="alternate"></link><published>2021-12-08T09:37:00-07:00</published><updated>2021-12-08T09:37:00-07:00</updated><author><name>Adam Ginsburg (Adam.G.Ginsburg@gmail.com)</name></author><id>tag:keflavich.github.io,2021-12-08:/blog/casa-errors-encountered-while-imaging-lb-data.html</id><summary type="html">&lt;p&gt;I'm trying to reduce some new data from ALMA's longest baselines (C10, B6).&lt;/p&gt;
&lt;p&gt;There are several exciting errors:&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;The lines were all flagged out.  Thankfully, there is a &lt;tt class="docutils literal"&gt;calibrated_final.ms.backup&lt;/tt&gt;
file that does not have the lines flagged out.  &lt;tt class="docutils literal"&gt;flagmanager&lt;/tt&gt; was unable to restore
the flags.  The flagging …&lt;/li&gt;&lt;/ol&gt;</summary><content type="html">&lt;p&gt;I'm trying to reduce some new data from ALMA's longest baselines (C10, B6).&lt;/p&gt;
&lt;p&gt;There are several exciting errors:&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;The lines were all flagged out.  Thankfully, there is a &lt;tt class="docutils literal"&gt;calibrated_final.ms.backup&lt;/tt&gt;
file that does not have the lines flagged out.  &lt;tt class="docutils literal"&gt;flagmanager&lt;/tt&gt; was unable to restore
the flags.  The flagging comes from the manual flagging done by the QA2 reducer,
which was used to make the continuum image.  That's fine, but the unflagging step
didn't work.  The uvcontsub data, as a result, contain no line data.  ?????&lt;/li&gt;
&lt;li&gt;I can't image the full cube because of errors like this:&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="mi"&gt;2021&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;08&lt;/span&gt; &lt;span class="mi"&gt;08&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;07&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;34&lt;/span&gt;     &lt;span class="n"&gt;INFO&lt;/span&gt;    &lt;span class="n"&gt;SynthesisImagerVi2&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;defineImage&lt;/span&gt;         &lt;span class="n"&gt;Shape&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;9600&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;9600&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1920&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="n"&gt;Spectral&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mf"&gt;2.31563e+11&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="n"&gt;at&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="n"&gt;increment&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;976510&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="mi"&gt;2021&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;08&lt;/span&gt; &lt;span class="mi"&gt;08&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;07&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;34&lt;/span&gt;     &lt;span class="n"&gt;INFO&lt;/span&gt;    &lt;span class="n"&gt;SynthesisImagerVi2&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;defineImage&lt;/span&gt;         &lt;span class="n"&gt;Set&lt;/span&gt; &lt;span class="n"&gt;Gridding&lt;/span&gt; &lt;span class="n"&gt;options&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;S255IR&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;SMA1_sci&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;spw1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cube&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;I&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;manual&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="n"&gt;ftmachine&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;gridft&lt;/span&gt;
&lt;span class="mi"&gt;2021&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;08&lt;/span&gt; &lt;span class="mi"&gt;08&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;07&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;34&lt;/span&gt;     &lt;span class="n"&gt;INFO&lt;/span&gt;    &lt;span class="n"&gt;SynthesisImagerVi2&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;nSubCubeFitInMemory&lt;/span&gt; &lt;span class="n"&gt;Required&lt;/span&gt; &lt;span class="n"&gt;memory&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mf"&gt;5.468e+05&lt;/span&gt; &lt;span class="n"&gt;GB&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt; &lt;span class="n"&gt;Available&lt;/span&gt; &lt;span class="n"&gt;mem&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mf"&gt;166.3&lt;/span&gt; &lt;span class="n"&gt;GB&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rc&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;mem&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt; &lt;span class="n"&gt;fraction&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;70&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;memory&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;Subcubes&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mf"&gt;1920.&lt;/span&gt; &lt;span class="n"&gt;Processes&lt;/span&gt; &lt;span class="n"&gt;on&lt;/span&gt; &lt;span class="n"&gt;node&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mf"&gt;64.&lt;/span&gt;
&lt;span class="mi"&gt;2021&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;08&lt;/span&gt; &lt;span class="mi"&gt;08&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;07&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;34&lt;/span&gt;     &lt;span class="n"&gt;INFO&lt;/span&gt;    &lt;span class="n"&gt;SynthesisImagerVi2&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;weight&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;    &lt;span class="n"&gt;Set&lt;/span&gt; &lt;span class="n"&gt;imaging&lt;/span&gt; &lt;span class="n"&gt;weights&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;Briggs&lt;/span&gt; &lt;span class="n"&gt;weighting&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;sidelobes&lt;/span&gt; &lt;span class="n"&gt;will&lt;/span&gt; &lt;span class="n"&gt;be&lt;/span&gt; &lt;span class="n"&gt;suppressed&lt;/span&gt; &lt;span class="n"&gt;over&lt;/span&gt; &lt;span class="n"&gt;full&lt;/span&gt; &lt;span class="n"&gt;image&lt;/span&gt;
&lt;span class="mi"&gt;2021&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;08&lt;/span&gt; &lt;span class="mi"&gt;08&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;07&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;34&lt;/span&gt;     &lt;span class="n"&gt;INFO&lt;/span&gt;    &lt;span class="n"&gt;SynthesisImagerVi2&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;weight&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;    &lt;span class="n"&gt;Doing&lt;/span&gt; &lt;span class="n"&gt;spectral&lt;/span&gt; &lt;span class="n"&gt;cube&lt;/span&gt; &lt;span class="n"&gt;Briggs&lt;/span&gt; &lt;span class="n"&gt;weighting&lt;/span&gt; &lt;span class="n"&gt;formula&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;  &lt;span class="n"&gt;norm&lt;/span&gt;
&lt;span class="mi"&gt;2021&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;08&lt;/span&gt; &lt;span class="mi"&gt;08&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;07&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;34&lt;/span&gt;     &lt;span class="n"&gt;INFO&lt;/span&gt;    &lt;span class="n"&gt;task_tclean&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;SynthesisDeconvolver&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;setupDeconvolution&lt;/span&gt;   &lt;span class="n"&gt;Set&lt;/span&gt; &lt;span class="n"&gt;Deconvolution&lt;/span&gt; &lt;span class="n"&gt;Options&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;S255IR&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;SMA1_sci&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;spw1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cube&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;I&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;manual&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;hogbom&lt;/span&gt;
&lt;span class="mi"&gt;2021&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;08&lt;/span&gt; &lt;span class="mi"&gt;08&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;07&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;34&lt;/span&gt;     &lt;span class="n"&gt;WARN&lt;/span&gt;    &lt;span class="n"&gt;tclean&lt;/span&gt;&lt;span class="p"&gt;::::&lt;/span&gt;&lt;span class="n"&gt;casa&lt;/span&gt;  &lt;span class="n"&gt;Memory&lt;/span&gt; &lt;span class="n"&gt;available&lt;/span&gt; &lt;span class="mi"&gt;187904819&lt;/span&gt; &lt;span class="n"&gt;kB&lt;/span&gt; &lt;span class="ow"&gt;is&lt;/span&gt; &lt;span class="n"&gt;very&lt;/span&gt; &lt;span class="n"&gt;close&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;amount&lt;/span&gt; &lt;span class="n"&gt;of&lt;/span&gt; &lt;span class="n"&gt;required&lt;/span&gt; &lt;span class="n"&gt;memory&lt;/span&gt; &lt;span class="mi"&gt;3982754512&lt;/span&gt; &lt;span class="n"&gt;kB&lt;/span&gt;
&lt;span class="mi"&gt;2021&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;08&lt;/span&gt; &lt;span class="mi"&gt;08&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;07&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;34&lt;/span&gt;     &lt;span class="n"&gt;INFO&lt;/span&gt;    &lt;span class="n"&gt;task_tclean&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;SynthesisImager&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;makePSF&lt;/span&gt;   &lt;span class="o"&gt;-----------------------------------------------------------&lt;/span&gt; &lt;span class="n"&gt;Make&lt;/span&gt; &lt;span class="n"&gt;PSF&lt;/span&gt; &lt;span class="o"&gt;---------------------------------------------&lt;/span&gt;
&lt;span class="mi"&gt;2021&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;08&lt;/span&gt; &lt;span class="mi"&gt;08&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;07&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;34&lt;/span&gt;     &lt;span class="n"&gt;INFO&lt;/span&gt;    &lt;span class="n"&gt;task_tclean&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;SynthesisImagerVi2&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;nSubCubeFitInMemory&lt;/span&gt;    &lt;span class="n"&gt;Required&lt;/span&gt; &lt;span class="n"&gt;memory&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mf"&gt;5.468e+05&lt;/span&gt; &lt;span class="n"&gt;GB&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt; &lt;span class="n"&gt;Available&lt;/span&gt; &lt;span class="n"&gt;mem&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mf"&gt;166.3&lt;/span&gt; &lt;span class="n"&gt;GB&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rc&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;mem&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt; &lt;span class="n"&gt;fraction&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;70&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;memory&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;Subcubes&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mf"&gt;1920.&lt;/span&gt; &lt;span class="n"&gt;Processes&lt;/span&gt; &lt;span class="n"&gt;on&lt;/span&gt; &lt;span class="n"&gt;node&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mf"&gt;64.&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Well, there's no error there, but the PSF maker can't handle making even a
single frame.  It had no trouble making a 9600x9600 MTMFS image for the
continuum, though, so it's pretty unclear to me why the cube is getting
OOM-killed.  My best guess is that the 64 processes are too much for CASA to
handle, and I need to run with fewer to &amp;quot;trick&amp;quot; it into not using up that much
memory at once.   Maybe I just need to make the PSFs in serial mode.  I don't
want to wait around to make the cubes, let alone clean them, in serial mode.&lt;/p&gt;
&lt;ol class="arabic simple" start="3"&gt;
&lt;li&gt;Parallel failed with this:&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="mi"&gt;2021&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;08&lt;/span&gt; &lt;span class="mi"&gt;14&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;26&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;19&lt;/span&gt;     &lt;span class="n"&gt;INFO&lt;/span&gt;    &lt;span class="n"&gt;tclean&lt;/span&gt;&lt;span class="p"&gt;::::&lt;/span&gt;&lt;span class="n"&gt;casa&lt;/span&gt;  &lt;span class="c1"&gt;##########################################&lt;/span&gt;
&lt;span class="mi"&gt;2021&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;08&lt;/span&gt; &lt;span class="mi"&gt;14&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;26&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;19&lt;/span&gt;     &lt;span class="n"&gt;INFO&lt;/span&gt;    &lt;span class="n"&gt;tclean&lt;/span&gt;&lt;span class="p"&gt;::::&lt;/span&gt;&lt;span class="n"&gt;casa&lt;/span&gt;  &lt;span class="c1"&gt;##### Begin Task: tclean             #####&lt;/span&gt;
&lt;span class="mi"&gt;2021&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;08&lt;/span&gt; &lt;span class="mi"&gt;14&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;26&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;19&lt;/span&gt;     &lt;span class="n"&gt;INFO&lt;/span&gt;    &lt;span class="n"&gt;tclean&lt;/span&gt;&lt;span class="p"&gt;::::&lt;/span&gt;&lt;span class="n"&gt;casa&lt;/span&gt;  &lt;span class="n"&gt;tclean&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;vis&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;calibrated_final.ms&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;selectdata&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;field&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;S255IR-SMA1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;spw&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;timerange&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;uvrange&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;antenna&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;scan&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;observation&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;intent&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;datacolumn&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;corrected&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;imagename&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;S255IR-SMA1_sci.spw1.cube.I.zoom.manual&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;imsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;500&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;500&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;cell&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;0.0042arcsec&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;phasecenter&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;stokes&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;I&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;projection&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;SIN&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;startmodel&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;specmode&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;cube&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;reffreq&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;nchan&lt;/span&gt;&lt;span class="o"&gt;=-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;start&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;width&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;outframe&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;lsrk&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;veltype&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;radio&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;restfreq&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[],&lt;/span&gt; &lt;span class="n"&gt;interpolation&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;linear&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;perchanweightdensity&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;gridder&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;standard&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;facets&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;psfphasecenter&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;wprojplanes&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vptable&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;mosweight&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;aterm&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;psterm&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;False&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;wbawp&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;conjbeams&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;False&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cfcache&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;usepointing&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;False&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;computepastep&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;360.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rotatepastep&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;360.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pointingoffsetsigdev&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[],&lt;/span&gt; &lt;span class="n"&gt;pblimit&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;normtype&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;flatnoise&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;deconvolver&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;hogbom&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;scales&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[],&lt;/span&gt; &lt;span class="n"&gt;nterms&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;smallscalebias&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;restoration&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;restoringbeam&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[],&lt;/span&gt; &lt;span class="n"&gt;pbcor&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;outlierfile&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;weighting&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;briggs&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;robust&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;noise&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;1.0Jy&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;npixels&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;uvtaper&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[],&lt;/span&gt; &lt;span class="n"&gt;niter&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;10000&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;gain&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;threshold&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;10mJy&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;nsigma&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cycleniter&lt;/span&gt;&lt;span class="o"&gt;=-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cyclefactor&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;minpsffraction&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.05&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;maxpsffraction&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;interactive&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;False&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;usemask&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;user&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;mask&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pbmask&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;sidelobethreshold&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;3.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;noisethreshold&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;5.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;lownoisethreshold&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;1.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;negativethreshold&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;smoothfactor&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;minbeamfrac&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cutthreshold&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.01&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;growiterations&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;75&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dogrowprune&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;minpercentchange&lt;/span&gt;&lt;span class="o"&gt;=-&lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;verbose&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;False&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fastnoise&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;restart&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;savemodel&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;none&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;calcres&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;calcpsf&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;psfcutoff&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.35&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;parallel&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="mi"&gt;2021&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;08&lt;/span&gt; &lt;span class="mi"&gt;14&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;26&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;19&lt;/span&gt;     &lt;span class="n"&gt;INFO&lt;/span&gt;    &lt;span class="n"&gt;tclean&lt;/span&gt;&lt;span class="p"&gt;::::&lt;/span&gt;&lt;span class="n"&gt;casa&lt;/span&gt;  &lt;span class="n"&gt;Verifying&lt;/span&gt; &lt;span class="n"&gt;Input&lt;/span&gt; &lt;span class="n"&gt;Parameters&lt;/span&gt;
&lt;span class="mi"&gt;2021&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;08&lt;/span&gt; &lt;span class="mi"&gt;14&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;26&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;19&lt;/span&gt;     &lt;span class="n"&gt;INFO&lt;/span&gt;    &lt;span class="n"&gt;SynthesisImagerVi2&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;selectData&lt;/span&gt;  &lt;span class="n"&gt;MS&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;calibrated_final&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;Selecting&lt;/span&gt; &lt;span class="n"&gt;on&lt;/span&gt; &lt;span class="n"&gt;fields&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;S255IR&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;SMA1&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;Selecting&lt;/span&gt; &lt;span class="n"&gt;on&lt;/span&gt; &lt;span class="n"&gt;spw&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;Opened&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;readonly&lt;/span&gt; &lt;span class="n"&gt;mode&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="mi"&gt;2021&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;08&lt;/span&gt; &lt;span class="mi"&gt;14&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;26&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;19&lt;/span&gt;     &lt;span class="n"&gt;INFO&lt;/span&gt;    &lt;span class="n"&gt;SynthesisImagerVi2&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;selectData&lt;/span&gt;    &lt;span class="n"&gt;NRows&lt;/span&gt; &lt;span class="n"&gt;selected&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
&lt;span class="mi"&gt;2021&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;08&lt;/span&gt; &lt;span class="mi"&gt;14&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;26&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;19&lt;/span&gt;     &lt;span class="n"&gt;SEVERE&lt;/span&gt;  &lt;span class="n"&gt;tclean&lt;/span&gt;&lt;span class="p"&gt;::::&lt;/span&gt;&lt;span class="n"&gt;casa&lt;/span&gt;  &lt;span class="n"&gt;Task&lt;/span&gt; &lt;span class="n"&gt;tclean&lt;/span&gt; &lt;span class="n"&gt;raised&lt;/span&gt; &lt;span class="n"&gt;an&lt;/span&gt; &lt;span class="n"&gt;exception&lt;/span&gt; &lt;span class="n"&gt;of&lt;/span&gt; &lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;RuntimeError&lt;/span&gt; &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;following&lt;/span&gt; &lt;span class="n"&gt;message&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;Parallel&lt;/span&gt; &lt;span class="n"&gt;transport&lt;/span&gt; &lt;span class="n"&gt;layer&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="n"&gt;initialized&lt;/span&gt;
&lt;span class="mi"&gt;2021&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;08&lt;/span&gt; &lt;span class="mi"&gt;14&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;26&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;19&lt;/span&gt;     &lt;span class="n"&gt;INFO&lt;/span&gt;    &lt;span class="n"&gt;tclean&lt;/span&gt;&lt;span class="p"&gt;::::&lt;/span&gt;&lt;span class="n"&gt;casa&lt;/span&gt;  &lt;span class="n"&gt;Task&lt;/span&gt; &lt;span class="n"&gt;tclean&lt;/span&gt; &lt;span class="n"&gt;complete&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt; &lt;span class="n"&gt;Start&lt;/span&gt; &lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;2021&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;08&lt;/span&gt; &lt;span class="mi"&gt;09&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;26&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;19.103483&lt;/span&gt; &lt;span class="n"&gt;End&lt;/span&gt; &lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;2021&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;08&lt;/span&gt; &lt;span class="mi"&gt;09&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;26&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;19.314353&lt;/span&gt;
&lt;span class="mi"&gt;2021&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;08&lt;/span&gt; &lt;span class="mi"&gt;14&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;26&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;19&lt;/span&gt;     &lt;span class="n"&gt;INFO&lt;/span&gt;    &lt;span class="n"&gt;tclean&lt;/span&gt;&lt;span class="p"&gt;::::&lt;/span&gt;&lt;span class="n"&gt;casa&lt;/span&gt;  &lt;span class="c1"&gt;##### End Task: tclean               #####&lt;/span&gt;
&lt;span class="mi"&gt;2021&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;08&lt;/span&gt; &lt;span class="mi"&gt;14&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;26&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;19&lt;/span&gt;     &lt;span class="n"&gt;INFO&lt;/span&gt;    &lt;span class="n"&gt;tclean&lt;/span&gt;&lt;span class="p"&gt;::::&lt;/span&gt;&lt;span class="n"&gt;casa&lt;/span&gt;  &lt;span class="c1"&gt;##########################################&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;I'm guessing this is a bad error message and the real error is that the data
selection failed.  Probably when I copied over the &lt;tt class="docutils literal"&gt;continuum_final.ms.backup&lt;/tt&gt;
file, it uses the original numbering (spw 25, 27, etc.) instead of the new
numbering.  I guess the renumbering is cased by &lt;tt class="docutils literal"&gt;uvcontsub&lt;/tt&gt;, which I'm now
skipping because it may have broken my data and because I'd rather image the
continuum.  That proved correct; the error message above just means that I
selected a nonexistent SPW.&lt;/p&gt;
&lt;div class="section" id="flagged-out-lines"&gt;
&lt;h2&gt;Flagged Out Lines&lt;/h2&gt;
&lt;p&gt;After re-copying over the calibrated MS and confirming that &lt;cite&gt;no&lt;/cite&gt; lines were flagged out,
I re-imaged... and the lines are again missing.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# show the flags graphically&lt;/span&gt;
&lt;span class="n"&gt;flagdata&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vis&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;calibrated_final.ms&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;mode&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;summary&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;spwchan&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;display&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;both&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="Flag data plot showing evidence of the flagged-out lines" src="https://keflavich.github.io/blog/images/flagdataplot.png" style="width: 600px;" /&gt;
&lt;p&gt;The flags are coming from tclean, which makes no sense.&lt;/p&gt;
&lt;p&gt;There are messages like these:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
2021-12-08 15:27:19     WARN    MPICommandServer::command_request_handler_service::SIImageStore::getPSFGaussian::MPIServer-51 (file src/code/synthesis/ImagerObjects/SIImageStore.cc, line 2037)        PSF is blank for[C9:P0] [C10:P0] [C11:P0] [C12:P0] [C13:P0] [C14:P0] [C15:P0] [C16:P0] [C17:P0] [C23:P0] [C24:P0] [C25:P0] [C26:P0]
&lt;/pre&gt;
&lt;p&gt;scattered throughout the PSF making.&lt;/p&gt;
&lt;p&gt;The PSF spectrum ends up like this:&lt;/p&gt;
&lt;img alt="PSF vs frequency showing flagged out channels" src="https://keflavich.github.io/blog/images/PSF_vs_Frq.png" style="width: 600px;" /&gt;
&lt;p&gt;Channels are totally flagged out.  But in the data, they are not:&lt;/p&gt;
&lt;img alt="The data not flagged out" src="https://keflavich.github.io/blog/images/notflagged_data.png" style="width: 600px;" /&gt;
&lt;p&gt;Running the &lt;tt class="docutils literal"&gt;tclean&lt;/tt&gt; without parallel, i.e. with &lt;tt class="docutils literal"&gt;parallel=False&lt;/tt&gt;, resulted
in a smooth, unbroken PSF.&lt;/p&gt;
&lt;p&gt;So, if we dig back into what happened in the parallel tclean....&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="mi"&gt;2021&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;08&lt;/span&gt; &lt;span class="mi"&gt;15&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;26&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;     &lt;span class="n"&gt;INFO&lt;/span&gt;    &lt;span class="n"&gt;SynthesisImagerVi2&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;selectData&lt;/span&gt;    &lt;span class="n"&gt;NRows&lt;/span&gt; &lt;span class="n"&gt;selected&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;848700&lt;/span&gt;
&lt;span class="mi"&gt;2021&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;08&lt;/span&gt; &lt;span class="mi"&gt;15&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;26&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;15&lt;/span&gt;     &lt;span class="n"&gt;INFO&lt;/span&gt;    &lt;span class="n"&gt;SynthesisImagerVi2&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;defineImage&lt;/span&gt;         &lt;span class="n"&gt;Define&lt;/span&gt; &lt;span class="n"&gt;image&lt;/span&gt; &lt;span class="n"&gt;coordinates&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;S255IR&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;SMA1_sci&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;spw0&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cube&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;I&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zoom&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;manual&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt;
&lt;span class="mi"&gt;2021&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;08&lt;/span&gt; &lt;span class="mi"&gt;15&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;26&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;     &lt;span class="n"&gt;INFO&lt;/span&gt;    &lt;span class="n"&gt;MSTransformRegridder&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;calcChanFreqs&lt;/span&gt;      &lt;span class="n"&gt;phaseCenter&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Direction: [-0.0535075, 0.949606, 0.308847]&amp;#39;&lt;/span&gt;  &lt;span class="n"&gt;Channels&lt;/span&gt; &lt;span class="n"&gt;equidistant&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;freq&lt;/span&gt;
&lt;span class="mi"&gt;2021&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;08&lt;/span&gt; &lt;span class="mi"&gt;15&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;26&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;     &lt;span class="n"&gt;INFO&lt;/span&gt;    &lt;span class="n"&gt;MSTransformRegridder&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;calcChanFreqs&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;     &lt;span class="n"&gt;Central&lt;/span&gt; &lt;span class="n"&gt;frequency&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;output&lt;/span&gt; &lt;span class="n"&gt;frame&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;2.345e+11&lt;/span&gt; &lt;span class="n"&gt;Hz&lt;/span&gt;
&lt;span class="mi"&gt;2021&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;08&lt;/span&gt; &lt;span class="mi"&gt;15&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;26&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;     &lt;span class="n"&gt;INFO&lt;/span&gt;    &lt;span class="n"&gt;MSTransformRegridder&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;calcChanFreqs&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;     &lt;span class="n"&gt;Width&lt;/span&gt; &lt;span class="n"&gt;of&lt;/span&gt; &lt;span class="n"&gt;central&lt;/span&gt; &lt;span class="n"&gt;channel&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;output&lt;/span&gt; &lt;span class="n"&gt;frame&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;976510&lt;/span&gt; &lt;span class="n"&gt;Hz&lt;/span&gt;
&lt;span class="mi"&gt;2021&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;08&lt;/span&gt; &lt;span class="mi"&gt;15&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;26&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;     &lt;span class="n"&gt;INFO&lt;/span&gt;    &lt;span class="n"&gt;MSTransformRegridder&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;calcChanFreqs&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;     &lt;span class="n"&gt;Number&lt;/span&gt; &lt;span class="n"&gt;of&lt;/span&gt; &lt;span class="n"&gt;channels&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1920&lt;/span&gt;
&lt;span class="mi"&gt;2021&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;08&lt;/span&gt; &lt;span class="mi"&gt;15&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;26&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;     &lt;span class="n"&gt;INFO&lt;/span&gt;    &lt;span class="n"&gt;MSTransformRegridder&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;calcChanFreqs&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;     &lt;span class="n"&gt;Total&lt;/span&gt; &lt;span class="n"&gt;width&lt;/span&gt; &lt;span class="n"&gt;of&lt;/span&gt; &lt;span class="n"&gt;SPW&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;output&lt;/span&gt; &lt;span class="n"&gt;frame&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;1.8749e+09&lt;/span&gt; &lt;span class="n"&gt;Hz&lt;/span&gt;
&lt;span class="mi"&gt;2021&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;08&lt;/span&gt; &lt;span class="mi"&gt;15&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;26&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;     &lt;span class="n"&gt;INFO&lt;/span&gt;    &lt;span class="n"&gt;MSTransformRegridder&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;calcChanFreqs&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;     &lt;span class="n"&gt;Lower&lt;/span&gt; &lt;span class="n"&gt;edge&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;2.33563e+11&lt;/span&gt; &lt;span class="n"&gt;Hz&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;upper&lt;/span&gt; &lt;span class="n"&gt;edge&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;2.35437e+11&lt;/span&gt; &lt;span class="n"&gt;Hz&lt;/span&gt;
&lt;span class="mi"&gt;2021&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;08&lt;/span&gt; &lt;span class="mi"&gt;15&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;26&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;     &lt;span class="n"&gt;INFO&lt;/span&gt;    &lt;span class="n"&gt;SynthesisImagerVi2&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;defineImage&lt;/span&gt;         &lt;span class="n"&gt;Impars&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;start&lt;/span&gt;
&lt;span class="mi"&gt;2021&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;08&lt;/span&gt; &lt;span class="mi"&gt;15&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;26&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;     &lt;span class="n"&gt;INFO&lt;/span&gt;    &lt;span class="n"&gt;SynthesisImagerVi2&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;defineImage&lt;/span&gt;         &lt;span class="n"&gt;Shape&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;500&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;500&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1920&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="n"&gt;Spectral&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mf"&gt;2.33563e+11&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="n"&gt;at&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="n"&gt;increment&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;976510&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="mi"&gt;2021&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;08&lt;/span&gt; &lt;span class="mi"&gt;15&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;26&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;     &lt;span class="n"&gt;INFO&lt;/span&gt;    &lt;span class="n"&gt;SynthesisImagerVi2&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;defineImage&lt;/span&gt;         &lt;span class="n"&gt;Set&lt;/span&gt; &lt;span class="n"&gt;Gridding&lt;/span&gt; &lt;span class="n"&gt;options&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;S255IR&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;SMA1_sci&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;spw0&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cube&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;I&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zoom&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;manual&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="n"&gt;ftmachine&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;gridft&lt;/span&gt;
&lt;span class="mi"&gt;2021&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;08&lt;/span&gt; &lt;span class="mi"&gt;15&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;26&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;     &lt;span class="n"&gt;INFO&lt;/span&gt;    &lt;span class="n"&gt;SynthesisImagerVi2&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;nSubCubeFitInMemory&lt;/span&gt; &lt;span class="n"&gt;Required&lt;/span&gt; &lt;span class="n"&gt;memory&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;1483&lt;/span&gt; &lt;span class="n"&gt;GB&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt; &lt;span class="n"&gt;Available&lt;/span&gt; &lt;span class="n"&gt;mem&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mf"&gt;173.6&lt;/span&gt; &lt;span class="n"&gt;GB&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rc&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;mem&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt; &lt;span class="n"&gt;fraction&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;70&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;memory&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;Subcubes&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mf"&gt;9.&lt;/span&gt; &lt;span class="n"&gt;Processes&lt;/span&gt; &lt;span class="n"&gt;on&lt;/span&gt; &lt;span class="n"&gt;node&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mf"&gt;64.&lt;/span&gt;
&lt;span class="mi"&gt;2021&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;08&lt;/span&gt; &lt;span class="mi"&gt;15&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;26&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;     &lt;span class="n"&gt;INFO&lt;/span&gt;    &lt;span class="n"&gt;SynthesisImagerVi2&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;weight&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;    &lt;span class="n"&gt;Set&lt;/span&gt; &lt;span class="n"&gt;imaging&lt;/span&gt; &lt;span class="n"&gt;weights&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;Briggs&lt;/span&gt; &lt;span class="n"&gt;weighting&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;sidelobes&lt;/span&gt; &lt;span class="n"&gt;will&lt;/span&gt; &lt;span class="n"&gt;be&lt;/span&gt; &lt;span class="n"&gt;suppressed&lt;/span&gt; &lt;span class="n"&gt;over&lt;/span&gt; &lt;span class="n"&gt;full&lt;/span&gt; &lt;span class="n"&gt;image&lt;/span&gt;
&lt;span class="mi"&gt;2021&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;08&lt;/span&gt; &lt;span class="mi"&gt;15&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;26&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;     &lt;span class="n"&gt;INFO&lt;/span&gt;    &lt;span class="n"&gt;SynthesisImagerVi2&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;weight&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;    &lt;span class="n"&gt;Doing&lt;/span&gt; &lt;span class="n"&gt;spectral&lt;/span&gt; &lt;span class="n"&gt;cube&lt;/span&gt; &lt;span class="n"&gt;Briggs&lt;/span&gt; &lt;span class="n"&gt;weighting&lt;/span&gt; &lt;span class="n"&gt;formula&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;  &lt;span class="n"&gt;norm&lt;/span&gt;
&lt;span class="mi"&gt;2021&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;08&lt;/span&gt; &lt;span class="mi"&gt;15&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;26&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;     &lt;span class="n"&gt;INFO&lt;/span&gt;    &lt;span class="n"&gt;task_tclean&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;SynthesisDeconvolver&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;setupDeconvolution&lt;/span&gt;   &lt;span class="n"&gt;Set&lt;/span&gt; &lt;span class="n"&gt;Deconvolution&lt;/span&gt; &lt;span class="n"&gt;Options&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;S255IR&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;SMA1_sci&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;spw0&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cube&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;I&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zoom&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;manual&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;hogbom&lt;/span&gt;
&lt;span class="mi"&gt;2021&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;08&lt;/span&gt; &lt;span class="mi"&gt;15&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;26&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;17&lt;/span&gt;     &lt;span class="n"&gt;INFO&lt;/span&gt;    &lt;span class="n"&gt;task_tclean&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;SynthesisImager&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;makePSF&lt;/span&gt;   &lt;span class="o"&gt;-----------------------------------------------------------&lt;/span&gt; &lt;span class="n"&gt;Make&lt;/span&gt; &lt;span class="n"&gt;PSF&lt;/span&gt; &lt;span class="o"&gt;---------------------------------------------&lt;/span&gt;

&lt;span class="o"&gt;...&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="n"&gt;bunch&lt;/span&gt; &lt;span class="n"&gt;of&lt;/span&gt; &lt;span class="n"&gt;stuff&lt;/span&gt; &lt;span class="o"&gt;...&lt;/span&gt;

&lt;span class="mi"&gt;2021&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;08&lt;/span&gt; &lt;span class="mi"&gt;15&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;27&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;11&lt;/span&gt;     &lt;span class="n"&gt;INFO&lt;/span&gt;    &lt;span class="n"&gt;MPICommandServer&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;command_request_handler_service&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;SynthesisImagerVi2&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;makePrimaryBeam&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;MPIServer&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;54&lt;/span&gt;    &lt;span class="n"&gt;vi2&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;Evaluating&lt;/span&gt; &lt;span class="n"&gt;Primary&lt;/span&gt; &lt;span class="n"&gt;Beam&lt;/span&gt; &lt;span class="n"&gt;model&lt;/span&gt; &lt;span class="n"&gt;onto&lt;/span&gt; &lt;span class="n"&gt;image&lt;/span&gt; &lt;span class="n"&gt;grid&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="mi"&gt;2021&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;08&lt;/span&gt; &lt;span class="mi"&gt;15&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;27&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;     &lt;span class="n"&gt;INFO&lt;/span&gt;    &lt;span class="n"&gt;MPICommandServer&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;command_request_handler_service&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;SynthesisImagerVi2&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;makePrimaryBeam&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;MPIServer&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;38&lt;/span&gt;    &lt;span class="n"&gt;vi2&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;Evaluating&lt;/span&gt; &lt;span class="n"&gt;Primary&lt;/span&gt; &lt;span class="n"&gt;Beam&lt;/span&gt; &lt;span class="n"&gt;model&lt;/span&gt; &lt;span class="n"&gt;onto&lt;/span&gt; &lt;span class="n"&gt;image&lt;/span&gt; &lt;span class="n"&gt;grid&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="mi"&gt;2021&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;08&lt;/span&gt; &lt;span class="mi"&gt;15&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;27&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;13&lt;/span&gt;     &lt;span class="n"&gt;INFO&lt;/span&gt;    &lt;span class="n"&gt;MPICommandServer&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;command_request_handler_service&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;SIImageStore&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;calcSensitivity&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;MPIServer&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;54&lt;/span&gt;  &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;S255IR&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;SMA1_sci&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;spw0&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cube&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;I&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zoom&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;manual&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="n"&gt;Theoretical&lt;/span&gt; &lt;span class="n"&gt;sensitivity&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Jy&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;bm&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;&lt;span class="n"&gt;c0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;none&lt;/span&gt; &lt;span class="n"&gt;c1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;none&lt;/span&gt; &lt;span class="n"&gt;c2&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;none&lt;/span&gt; &lt;span class="n"&gt;c3&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;none&lt;/span&gt; &lt;span class="n"&gt;c4&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;none&lt;/span&gt; &lt;span class="n"&gt;c5&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;none&lt;/span&gt; &lt;span class="n"&gt;c6&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;none&lt;/span&gt; &lt;span class="n"&gt;c7&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;none&lt;/span&gt; &lt;span class="n"&gt;c8&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;none&lt;/span&gt; &lt;span class="n"&gt;c9&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;none&lt;/span&gt; &lt;span class="n"&gt;c10&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;none&lt;/span&gt; &lt;span class="n"&gt;c11&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;none&lt;/span&gt; &lt;span class="n"&gt;c12&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;none&lt;/span&gt; &lt;span class="n"&gt;c13&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;0.00121258&lt;/span&gt; &lt;span class="n"&gt;c14&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;0.00121257&lt;/span&gt; &lt;span class="n"&gt;c15&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;0.00121255&lt;/span&gt; &lt;span class="n"&gt;c16&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;none&lt;/span&gt; &lt;span class="n"&gt;c17&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;none&lt;/span&gt; &lt;span class="n"&gt;c18&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;none&lt;/span&gt; &lt;span class="n"&gt;c19&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;none&lt;/span&gt; &lt;span class="n"&gt;c20&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;none&lt;/span&gt; &lt;span class="n"&gt;c21&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;none&lt;/span&gt; &lt;span class="n"&gt;c22&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;none&lt;/span&gt; &lt;span class="n"&gt;c23&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;none&lt;/span&gt; &lt;span class="n"&gt;c24&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;none&lt;/span&gt; &lt;span class="n"&gt;c25&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;none&lt;/span&gt; &lt;span class="n"&gt;c26&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;0.00121253&lt;/span&gt; &lt;span class="n"&gt;c27&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;0.00121253&lt;/span&gt; &lt;span class="n"&gt;c28&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;0.00121252&lt;/span&gt; &lt;span class="n"&gt;c29&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;0.00121251&lt;/span&gt;
&lt;span class="mi"&gt;2021&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;08&lt;/span&gt; &lt;span class="mi"&gt;15&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;27&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;13&lt;/span&gt;     &lt;span class="n"&gt;WARN&lt;/span&gt;    &lt;span class="n"&gt;MPICommandServer&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;command_request_handler_service&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;SIImageStore&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;getPSFGaussian&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;MPIServer&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;54&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;file&lt;/span&gt; &lt;span class="n"&gt;src&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;code&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;synthesis&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;ImagerObjects&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;SIImageStore&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cc&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;line&lt;/span&gt; &lt;span class="mi"&gt;2037&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;        &lt;span class="n"&gt;PSF&lt;/span&gt; &lt;span class="ow"&gt;is&lt;/span&gt; &lt;span class="n"&gt;blank&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;C0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;P0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;C1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;P0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;C2&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;P0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;C3&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;P0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;C4&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;P0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;C5&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;P0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;C6&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;P0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;C7&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;P0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;C8&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;P0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;C9&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;P0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;C10&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;P0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;C11&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;P0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;C12&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;P0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;C16&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;P0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;C17&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;P0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;C18&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;P0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;C19&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;P0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;C20&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;P0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;C21&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;P0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;C22&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;P0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;C23&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;P0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;C24&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;P0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;C25&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;P0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="mi"&gt;2021&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;08&lt;/span&gt; &lt;span class="mi"&gt;15&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;27&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;13&lt;/span&gt;     &lt;span class="n"&gt;INFO&lt;/span&gt;    &lt;span class="n"&gt;MPICommandServer&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;command_request_handler_service&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;SIImageStore&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;getPSFGaussian&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;MPIServer&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;54&lt;/span&gt;   &lt;span class="n"&gt;Time&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;fit&lt;/span&gt; &lt;span class="n"&gt;Gaussian&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;PSF&lt;/span&gt; &lt;span class="mf"&gt;0.12&lt;/span&gt;
&lt;span class="mi"&gt;2021&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;08&lt;/span&gt; &lt;span class="mi"&gt;15&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;27&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;13&lt;/span&gt;     &lt;span class="n"&gt;INFO&lt;/span&gt;    &lt;span class="n"&gt;MPICommandServer&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;command_request_handler_service&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;SIImageStore&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;printBeamSet&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;MPIServer&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;54&lt;/span&gt;     &lt;span class="n"&gt;Restoring&lt;/span&gt; &lt;span class="n"&gt;Beams&lt;/span&gt;
&lt;span class="mi"&gt;2021&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;08&lt;/span&gt; &lt;span class="mi"&gt;15&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;27&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;13&lt;/span&gt;     &lt;span class="n"&gt;INFO&lt;/span&gt;    &lt;span class="n"&gt;MPICommandServer&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;command_request_handler_service&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;SIImageStore&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;printBeamSet&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;MPIServer&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;54&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt;   &lt;span class="n"&gt;Pol&lt;/span&gt;   &lt;span class="n"&gt;Type&lt;/span&gt; &lt;span class="n"&gt;Chan&lt;/span&gt;         &lt;span class="n"&gt;Freq&lt;/span&gt;     &lt;span class="n"&gt;Vel&lt;/span&gt;
&lt;span class="mi"&gt;2021&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;08&lt;/span&gt; &lt;span class="mi"&gt;15&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;27&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;13&lt;/span&gt;     &lt;span class="n"&gt;INFO&lt;/span&gt;    &lt;span class="n"&gt;MPICommandServer&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;command_request_handler_service&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;SIImageStore&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;printBeamSet&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;MPIServer&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;54&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt;     &lt;span class="n"&gt;I&lt;/span&gt;    &lt;span class="n"&gt;Max&lt;/span&gt;    &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="mf"&gt;2.351450e+11&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;824.59&lt;/span&gt;    &lt;span class="mf"&gt;0.0254&lt;/span&gt; &lt;span class="n"&gt;arcsec&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;    &lt;span class="mf"&gt;0.0197&lt;/span&gt; &lt;span class="n"&gt;arcsec&lt;/span&gt; &lt;span class="n"&gt;pa&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;6.8506&lt;/span&gt; &lt;span class="n"&gt;deg&lt;/span&gt;
&lt;span class="mi"&gt;2021&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;08&lt;/span&gt; &lt;span class="mi"&gt;15&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;27&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;13&lt;/span&gt;     &lt;span class="n"&gt;INFO&lt;/span&gt;    &lt;span class="n"&gt;MPICommandServer&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;command_request_handler_service&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;SIImageStore&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;printBeamSet&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;MPIServer&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;54&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt;     &lt;span class="n"&gt;I&lt;/span&gt;    &lt;span class="n"&gt;Min&lt;/span&gt;    &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;2.351460e+11&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;825.84&lt;/span&gt;    &lt;span class="mf"&gt;0.0000&lt;/span&gt; &lt;span class="n"&gt;arcsec&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;    &lt;span class="mf"&gt;0.0000&lt;/span&gt; &lt;span class="n"&gt;arcsec&lt;/span&gt; &lt;span class="n"&gt;pa&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;  &lt;span class="mf"&gt;0.0000&lt;/span&gt; &lt;span class="n"&gt;deg&lt;/span&gt;
&lt;span class="mi"&gt;2021&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;08&lt;/span&gt; &lt;span class="mi"&gt;15&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;27&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;13&lt;/span&gt;     &lt;span class="n"&gt;INFO&lt;/span&gt;    &lt;span class="n"&gt;MPICommandServer&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;command_request_handler_service&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;SIImageStore&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;printBeamSet&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;MPIServer&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;54&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt;     &lt;span class="n"&gt;I&lt;/span&gt; &lt;span class="n"&gt;Median&lt;/span&gt;    &lt;span class="mi"&gt;9&lt;/span&gt; &lt;span class="mf"&gt;2.351538e+11&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;835.82&lt;/span&gt;    &lt;span class="mf"&gt;0.0254&lt;/span&gt; &lt;span class="n"&gt;arcsec&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;    &lt;span class="mf"&gt;0.0197&lt;/span&gt; &lt;span class="n"&gt;arcsec&lt;/span&gt; &lt;span class="n"&gt;pa&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;6.8506&lt;/span&gt; &lt;span class="n"&gt;deg&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;These blank psfs are &lt;cite&gt;wrong&lt;/cite&gt;, there are no flagged data in this data set (no flagged channels).
Something about the parallel version of clean is reading the data wrong.&lt;/p&gt;
&lt;div class="section" id="solution"&gt;
&lt;h3&gt;Solution&lt;/h3&gt;
&lt;p&gt;I finally solved this by manually unflagging the channels.  Thanks to Brian
Svoboda for helping with the antenna selection syntax.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;flagdata&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;linevis&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;spw&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;orig_spw&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;antenna&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;*&amp;amp;*&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;mode&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;unflag&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;I don't understand why flagdata was showing the channels as being unflagged,
as they were clearly flagged in all data sets (original &amp;amp; backup).
I don't understand _when_ they were flagged, either, as it seems they were
flagged even before continuum imaging was done.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
</content><category term="misc"></category><category term="CASA"></category><category term="data reduction"></category></entry><entry><title>CASA reading incorrect number of bytes w/MPI</title><link href="https://keflavich.github.io/blog/casa-reading-incorrect-number-of-bytes-wmpi.html" rel="alternate"></link><published>2021-12-02T08:15:00-07:00</published><updated>2021-12-02T08:15:00-07:00</updated><author><name>Adam Ginsburg (Adam.G.Ginsburg@gmail.com)</name></author><id>tag:keflavich.github.io,2021-12-02:/blog/casa-reading-incorrect-number-of-bytes-wmpi.html</id><summary type="html">&lt;p&gt;Running big MPI runs again, I encounter errors like these one:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
2021-12-02 07:02:26      WARN    MPICommandServer::command_request_handler_service::SynthesisImagerVi2::CubeMajorCycle::MPIServer-25 (file src/code/synthesis/ImagerObjects/CubeMajorCycleAlgorithm.cc, line 336)        Exception for chan range [1434, 1445] ---   FilebufIO::readBlock - incorr
ect number of bytes read for file /blue …&lt;/pre&gt;</summary><content type="html">&lt;p&gt;Running big MPI runs again, I encounter errors like these one:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
2021-12-02 07:02:26      WARN    MPICommandServer::command_request_handler_service::SynthesisImagerVi2::CubeMajorCycle::MPIServer-25 (file src/code/synthesis/ImagerObjects/CubeMajorCycleAlgorithm.cc, line 336)        Exception for chan range [1434, 1445] ---   FilebufIO::readBlock - incorr
ect number of bytes read for file /blue/adamginsburg/adamginsburg/almaimf/workdir/G327.29_B6_spw7_12M_spw7.sumwt/table.f0
##################################
#############################
Exception: FilebufIO::readBlock - incorrect number of bytes read for file /blue/adamginsburg/adamginsburg/almaimf/workdir/G327.29_B6_spw7_12M_spw7.sumwt/table.f0


2021-12-02 06:03:53        WARN    MPICommandServer::command_request_handler_service::SynthesisImagerVi2::CubeMajorCycle::MPIServer-13 (file src/code/synthesis/ImagerObjects/CubeMajorCycleAlgorithm.cc, line 336)        Exception for chan range [550, 560] ---   FilebufIO::readBlock - incorrect number
 of bytes read for file /blue/adamginsburg/adamginsburg/almaimf/workdir/G327.29_B6_spw4_12M_spw4.sumwt/table.f0
##################################
#############################
Exception: FilebufIO::readBlock - incorrect number of bytes read for file /blue/adamginsburg/adamginsburg/almaimf/workdir/G327.29_B6_spw4_12M_spw4.sumwt/table.f0

2021-12-02 04:57:21 WARN    MPICommandServer::command_request_handler_service::SynthesisImagerVi2::CubeMajorCycle::MPIServer-9 (file src/code/synthesis/ImagerObjects/CubeMajorCycleAlgorithm.cc, line 336) Exception for chan range [1563, 1574] ---   FilebufIO::readBlock
- incorrect number of bytes read for file /blue/adamginsburg/adamginsburg/almaimf/workdir/G327.29_B6_spw0_12M_spw0.sumwt/table.f0
##################################
#############################
Exception: FilebufIO::readBlock - incorrect number of bytes read for file /blue/adamginsburg/adamginsburg/almaimf/workdir/G327.29_B6_spw0_12M_spw0.sumwt/table.f0
&lt;/pre&gt;
&lt;p&gt;This is only quasi-repeatable.  For spw4, it happened after the 8th Major Cycle
the first time, then the 6th Major Cycle the second time.  By repeating the
cleans over and over, I was able to eventually get the results to converge.
It looks like these crashes are sporadic but don't affect the data.&lt;/p&gt;
</content><category term="misc"></category><category term="casa"></category></entry><entry><title>CASA table locking with MPI</title><link href="https://keflavich.github.io/blog/casa-table-locking-with-mpi.html" rel="alternate"></link><published>2021-11-11T15:53:00-07:00</published><updated>2021-11-11T15:53:00-07:00</updated><author><name>Adam Ginsburg (Adam.G.Ginsburg@gmail.com)</name></author><id>tag:keflavich.github.io,2021-11-11:/blog/casa-table-locking-with-mpi.html</id><summary type="html">&lt;p&gt;A bunch of CASA MPI runs have race conditioned themselves into a corner, apparently:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="mi"&gt;2021&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;11&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;07&lt;/span&gt; &lt;span class="mi"&gt;23&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;33&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;     &lt;span class="n"&gt;WARN&lt;/span&gt;    &lt;span class="n"&gt;MPICommandServer&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;command_request_handler_service&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;SynthesisImagerVi2&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;CubeMajorCycle&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;MPIServer&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;file&lt;/span&gt; &lt;span class="n"&gt;src&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;code&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;synthesis&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;ImagerObjects&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;CubeMajorCycleAlgorithm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cc&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;line&lt;/span&gt; &lt;span class="mi"&gt;336&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="ne"&gt;Exception&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;chan&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;104&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;129&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;---&lt;/span&gt;   &lt;span class="n"&gt;Setting&lt;/span&gt; &lt;span class="n"&gt;masked&lt;/span&gt; &lt;span class="n"&gt;pixels&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;zero …&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;</summary><content type="html">&lt;p&gt;A bunch of CASA MPI runs have race conditioned themselves into a corner, apparently:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="mi"&gt;2021&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;11&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;07&lt;/span&gt; &lt;span class="mi"&gt;23&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;33&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;     &lt;span class="n"&gt;WARN&lt;/span&gt;    &lt;span class="n"&gt;MPICommandServer&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;command_request_handler_service&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;SynthesisImagerVi2&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;CubeMajorCycle&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;MPIServer&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;file&lt;/span&gt; &lt;span class="n"&gt;src&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;code&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;synthesis&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;ImagerObjects&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;CubeMajorCycleAlgorithm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cc&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;line&lt;/span&gt; &lt;span class="mi"&gt;336&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="ne"&gt;Exception&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;chan&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;104&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;129&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;---&lt;/span&gt;   &lt;span class="n"&gt;Setting&lt;/span&gt; &lt;span class="n"&gt;masked&lt;/span&gt; &lt;span class="n"&gt;pixels&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;zero&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="nb"&gt;input&lt;/span&gt; &lt;span class="n"&gt;startmodel&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;Error&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Resource&lt;/span&gt; &lt;span class="n"&gt;deadlock&lt;/span&gt; &lt;span class="n"&gt;avoided&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="n"&gt;when&lt;/span&gt; &lt;span class="n"&gt;acquiring&lt;/span&gt; &lt;span class="n"&gt;lock&lt;/span&gt; &lt;span class="n"&gt;on&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;blue&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;adamginsburg&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;adamginsburg&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;almaimf&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;workdir&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;G351&lt;/span&gt;&lt;span class="mf"&gt;.77&lt;/span&gt;&lt;span class="n"&gt;_B6_spw1_12M_sio&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;contcube&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;model&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;table&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;lock&lt;/span&gt;
&lt;span class="c1"&gt;##################################&lt;/span&gt;
&lt;span class="c1"&gt;#############################&lt;/span&gt;
&lt;span class="ne"&gt;Exception&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;Setting&lt;/span&gt; &lt;span class="n"&gt;masked&lt;/span&gt; &lt;span class="n"&gt;pixels&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;zero&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="nb"&gt;input&lt;/span&gt; &lt;span class="n"&gt;startmodel&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;Error&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Resource&lt;/span&gt; &lt;span class="n"&gt;deadlock&lt;/span&gt; &lt;span class="n"&gt;avoided&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="n"&gt;when&lt;/span&gt; &lt;span class="n"&gt;acquiring&lt;/span&gt; &lt;span class="n"&gt;lock&lt;/span&gt; &lt;span class="n"&gt;on&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;blue&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;adamginsburg&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;adamginsburg&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;almaimf&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;workdir&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;G351&lt;/span&gt;&lt;span class="mf"&gt;.77&lt;/span&gt;&lt;span class="n"&gt;_B6_spw1_12M_sio&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;contcube&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;model&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;table&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;lock&lt;/span&gt;
&lt;span class="mi"&gt;2021&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;11&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;07&lt;/span&gt; &lt;span class="mi"&gt;23&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;33&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;     &lt;span class="n"&gt;WARN&lt;/span&gt;    &lt;span class="n"&gt;MPICommandServer&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;command_request_handler_service&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;SynthesisImagerVi2&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;CubeMajorCycle&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;MPIServer&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;file&lt;/span&gt; &lt;span class="n"&gt;src&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;code&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;synthesis&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;ImagerObjects&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;CubeMajorCycleAlgorithm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cc&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;line&lt;/span&gt; &lt;span class="mi"&gt;336&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;        &lt;span class="ne"&gt;Exception&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;chan&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;234&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;258&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;---&lt;/span&gt;   &lt;span class="n"&gt;Setting&lt;/span&gt; &lt;span class="n"&gt;masked&lt;/span&gt; &lt;span class="n"&gt;pixels&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;zero&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="nb"&gt;input&lt;/span&gt; &lt;span class="n"&gt;startmodel&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;Error&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Resource&lt;/span&gt; &lt;span class="n"&gt;deadlock&lt;/span&gt; &lt;span class="n"&gt;avoided&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="n"&gt;when&lt;/span&gt; &lt;span class="n"&gt;acquiring&lt;/span&gt; &lt;span class="n"&gt;lock&lt;/span&gt; &lt;span class="n"&gt;on&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;blue&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;adamginsburg&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;adamginsburg&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;almaimf&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;workdir&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;G351&lt;/span&gt;&lt;span class="mf"&gt;.77&lt;/span&gt;&lt;span class="n"&gt;_B6_spw1_12M_sio&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;contcube&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;model&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;table&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;lock&lt;/span&gt;
&lt;span class="c1"&gt;##################################&lt;/span&gt;
&lt;span class="c1"&gt;#############################&lt;/span&gt;
&lt;span class="ne"&gt;Exception&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;Setting&lt;/span&gt; &lt;span class="n"&gt;masked&lt;/span&gt; &lt;span class="n"&gt;pixels&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;zero&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="nb"&gt;input&lt;/span&gt; &lt;span class="n"&gt;startmodel&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;Error&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Resource&lt;/span&gt; &lt;span class="n"&gt;deadlock&lt;/span&gt; &lt;span class="n"&gt;avoided&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="n"&gt;when&lt;/span&gt; &lt;span class="n"&gt;acquiring&lt;/span&gt; &lt;span class="n"&gt;lock&lt;/span&gt; &lt;span class="n"&gt;on&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;blue&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;adamginsburg&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;adamginsburg&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;almaimf&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;workdir&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;G351&lt;/span&gt;&lt;span class="mf"&gt;.77&lt;/span&gt;&lt;span class="n"&gt;_B6_spw1_12M_sio&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;contcube&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;model&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;table&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;lock&lt;/span&gt;
&lt;span class="mi"&gt;2021&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;11&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;07&lt;/span&gt; &lt;span class="mi"&gt;23&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;33&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;     &lt;span class="n"&gt;WARN&lt;/span&gt;    &lt;span class="n"&gt;MPICommandServer&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;command_request_handler_service&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;SynthesisImagerVi2&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;CubeMajorCycle&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;MPIServer&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;9&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;file&lt;/span&gt; &lt;span class="n"&gt;src&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;code&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;synthesis&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;ImagerObjects&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;CubeMajorCycleAlgorithm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cc&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;line&lt;/span&gt; &lt;span class="mi"&gt;336&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="ne"&gt;Exception&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;chan&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;208&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;233&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;---&lt;/span&gt;   &lt;span class="n"&gt;Setting&lt;/span&gt; &lt;span class="n"&gt;masked&lt;/span&gt; &lt;span class="n"&gt;pixels&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;zero&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="nb"&gt;input&lt;/span&gt; &lt;span class="n"&gt;startmodel&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;Error&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Resource&lt;/span&gt; &lt;span class="n"&gt;deadlock&lt;/span&gt; &lt;span class="n"&gt;avoided&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="n"&gt;when&lt;/span&gt; &lt;span class="n"&gt;acquiring&lt;/span&gt; &lt;span class="n"&gt;lock&lt;/span&gt; &lt;span class="n"&gt;on&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;blue&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;adamginsburg&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;adamginsburg&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;almaimf&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;workdir&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;G351&lt;/span&gt;&lt;span class="mf"&gt;.77&lt;/span&gt;&lt;span class="n"&gt;_B6_spw1_12M_sio&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;contcube&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;model&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;table&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;lock&lt;/span&gt;
&lt;span class="c1"&gt;##################################&lt;/span&gt;
&lt;span class="c1"&gt;#############################&lt;/span&gt;
&lt;span class="ne"&gt;Exception&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;Setting&lt;/span&gt; &lt;span class="n"&gt;masked&lt;/span&gt; &lt;span class="n"&gt;pixels&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;zero&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="nb"&gt;input&lt;/span&gt; &lt;span class="n"&gt;startmodel&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;Error&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Resource&lt;/span&gt; &lt;span class="n"&gt;deadlock&lt;/span&gt; &lt;span class="n"&gt;avoided&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="n"&gt;when&lt;/span&gt; &lt;span class="n"&gt;acquiring&lt;/span&gt; &lt;span class="n"&gt;lock&lt;/span&gt; &lt;span class="n"&gt;on&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;blue&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;adamginsburg&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;adamginsburg&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;almaimf&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;workdir&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;G351&lt;/span&gt;&lt;span class="mf"&gt;.77&lt;/span&gt;&lt;span class="n"&gt;_B6_spw1_12M_sio&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;contcube&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;model&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;table&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;lock&lt;/span&gt;
&lt;span class="mi"&gt;2021&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;11&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;07&lt;/span&gt; &lt;span class="mi"&gt;23&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;33&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;     &lt;span class="n"&gt;WARN&lt;/span&gt;    &lt;span class="n"&gt;MPICommandServer&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;command_request_handler_service&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;SynthesisImagerVi2&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;CubeMajorCycle&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;MPIServer&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;file&lt;/span&gt; &lt;span class="n"&gt;src&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;code&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;synthesis&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;ImagerObjects&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;CubeMajorCycleAlgorithm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cc&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;line&lt;/span&gt; &lt;span class="mi"&gt;336&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="ne"&gt;Exception&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;chan&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;26&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;51&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;---&lt;/span&gt;   &lt;span class="n"&gt;Setting&lt;/span&gt; &lt;span class="n"&gt;masked&lt;/span&gt; &lt;span class="n"&gt;pixels&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;zero&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="nb"&gt;input&lt;/span&gt; &lt;span class="n"&gt;startmodel&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;Error&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Resource&lt;/span&gt; &lt;span class="n"&gt;deadlock&lt;/span&gt; &lt;span class="n"&gt;avoided&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="n"&gt;when&lt;/span&gt; &lt;span class="n"&gt;acquiring&lt;/span&gt; &lt;span class="n"&gt;lock&lt;/span&gt; &lt;span class="n"&gt;on&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;blue&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;adamginsburg&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;adamginsburg&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;almaimf&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;workdir&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;G351&lt;/span&gt;&lt;span class="mf"&gt;.77&lt;/span&gt;&lt;span class="n"&gt;_B6_spw1_12M_sio&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;contcube&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;model&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;table&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;lock&lt;/span&gt;
&lt;span class="c1"&gt;##################################&lt;/span&gt;
&lt;span class="c1"&gt;#############################&lt;/span&gt;
&lt;span class="ne"&gt;Exception&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;Setting&lt;/span&gt; &lt;span class="n"&gt;masked&lt;/span&gt; &lt;span class="n"&gt;pixels&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;zero&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="nb"&gt;input&lt;/span&gt; &lt;span class="n"&gt;startmodel&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;Error&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Resource&lt;/span&gt; &lt;span class="n"&gt;deadlock&lt;/span&gt; &lt;span class="n"&gt;avoided&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="n"&gt;when&lt;/span&gt; &lt;span class="n"&gt;acquiring&lt;/span&gt; &lt;span class="n"&gt;lock&lt;/span&gt; &lt;span class="n"&gt;on&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;blue&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;adamginsburg&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;adamginsburg&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;almaimf&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;workdir&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;G351&lt;/span&gt;&lt;span class="mf"&gt;.77&lt;/span&gt;&lt;span class="n"&gt;_B6_spw1_12M_sio&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;contcube&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;model&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;table&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;lock&lt;/span&gt;
&lt;span class="mi"&gt;2021&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;11&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;07&lt;/span&gt; &lt;span class="mi"&gt;23&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;33&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;     &lt;span class="n"&gt;WARN&lt;/span&gt;    &lt;span class="n"&gt;MPICommandServer&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;command_request_handler_service&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;SynthesisImagerVi2&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;CubeMajorCycle&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;MPIServer&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;15&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;file&lt;/span&gt; &lt;span class="n"&gt;src&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;code&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;synthesis&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;ImagerObjects&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;CubeMajorCycleAlgorithm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cc&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;line&lt;/span&gt; &lt;span class="mi"&gt;336&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;        &lt;span class="ne"&gt;Exception&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;chan&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;359&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;383&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;---&lt;/span&gt;   &lt;span class="n"&gt;Setting&lt;/span&gt; &lt;span class="n"&gt;masked&lt;/span&gt; &lt;span class="n"&gt;pixels&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;zero&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="nb"&gt;input&lt;/span&gt; &lt;span class="n"&gt;startmodel&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;Error&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Resource&lt;/span&gt; &lt;span class="n"&gt;deadlock&lt;/span&gt; &lt;span class="n"&gt;avoided&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="n"&gt;when&lt;/span&gt; &lt;span class="n"&gt;acquiring&lt;/span&gt; &lt;span class="n"&gt;lock&lt;/span&gt; &lt;span class="n"&gt;on&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;blue&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;adamginsburg&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;adamginsburg&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;almaimf&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;workdir&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;G351&lt;/span&gt;&lt;span class="mf"&gt;.77&lt;/span&gt;&lt;span class="n"&gt;_B6_spw1_12M_sio&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;contcube&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;model&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;table&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;lock&lt;/span&gt;
&lt;span class="c1"&gt;##################################&lt;/span&gt;
&lt;span class="c1"&gt;#############################&lt;/span&gt;
&lt;span class="ne"&gt;Exception&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;Setting&lt;/span&gt; &lt;span class="n"&gt;masked&lt;/span&gt; &lt;span class="n"&gt;pixels&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;zero&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="nb"&gt;input&lt;/span&gt; &lt;span class="n"&gt;startmodel&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;Error&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Resource&lt;/span&gt; &lt;span class="n"&gt;deadlock&lt;/span&gt; &lt;span class="n"&gt;avoided&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="n"&gt;when&lt;/span&gt; &lt;span class="n"&gt;acquiring&lt;/span&gt; &lt;span class="n"&gt;lock&lt;/span&gt; &lt;span class="n"&gt;on&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;blue&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;adamginsburg&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;adamginsburg&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;almaimf&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;workdir&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;G351&lt;/span&gt;&lt;span class="mf"&gt;.77&lt;/span&gt;&lt;span class="n"&gt;_B6_spw1_12M_sio&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;contcube&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;model&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;table&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;lock&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This shows up in ~10 runs that I started around the same time, but I don't usually see it.&lt;/p&gt;
&lt;p&gt;This looks like a serious bug having to do with using a startmodel: there is a line earlier copying the startmodel to the model:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
2021-11-07 23:27:44     INFO    SIImageStore::setModelImageOne  Copying input model /blue/adamginsburg/adamginsburg/almaimf/workdir//G351.77_B6_spw1_12M_sio.contcube.model to /blue/adamginsburg/adamginsburg/almaimf/workdir/G351.77_B6_spw1_12M_sio.model
&lt;/pre&gt;
&lt;p&gt;but MPI seems to have gotten mixed up and is sill trying to write to the contcube.model&lt;/p&gt;
</content><category term="misc"></category><category term="casa"></category></entry><entry><title>CASA doesn't like VaryingResolutionSpectralCubes</title><link href="https://keflavich.github.io/blog/casa-doesnt-like-varyingresolutionspectralcubes.html" rel="alternate"></link><published>2021-11-09T19:53:00-07:00</published><updated>2021-11-09T19:53:00-07:00</updated><author><name>Adam Ginsburg (Adam.G.Ginsburg@gmail.com)</name></author><id>tag:keflavich.github.io,2021-11-09:/blog/casa-doesnt-like-varyingresolutionspectralcubes.html</id><summary type="html">&lt;p&gt;I get this from trying to run &lt;tt class="docutils literal"&gt;makemask&lt;/tt&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt; &lt;span class="n"&gt;makemask&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mode&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;copy&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
         &lt;span class="n"&gt;inpimage&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;lineimagename&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;.image&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
         &lt;span class="n"&gt;inpmask&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;lineimagename&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;.image:mask0&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
         &lt;span class="n"&gt;output&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;lineimagename&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;.mask&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

 &lt;span class="mi"&gt;2021&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;11&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;09&lt;/span&gt; &lt;span class="mi"&gt;02&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;27&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;     &lt;span class="n"&gt;INFO&lt;/span&gt;    &lt;span class="n"&gt;makemask&lt;/span&gt;&lt;span class="p"&gt;::::&lt;/span&gt;&lt;span class="n"&gt;casa&lt;/span&gt;        &lt;span class="c1"&gt;##########################################&lt;/span&gt;
 &lt;span class="mi"&gt;2021&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;11&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;09&lt;/span&gt; &lt;span class="mi"&gt;02&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;27&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;     &lt;span class="n"&gt;INFO&lt;/span&gt;    &lt;span class="n"&gt;makemask&lt;/span&gt;&lt;span class="p"&gt;::::&lt;/span&gt;&lt;span class="n"&gt;casa&lt;/span&gt;        &lt;span class="c1"&gt;##### Begin Task: makemask           #####&lt;/span&gt;
 &lt;span class="mi"&gt;2021&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;11&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;09&lt;/span&gt; &lt;span class="mi"&gt;02&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;27&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;     &lt;span class="n"&gt;INFO&lt;/span&gt;    &lt;span class="n"&gt;makemask …&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;</summary><content type="html">&lt;p&gt;I get this from trying to run &lt;tt class="docutils literal"&gt;makemask&lt;/tt&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt; &lt;span class="n"&gt;makemask&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mode&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;copy&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
         &lt;span class="n"&gt;inpimage&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;lineimagename&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;.image&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
         &lt;span class="n"&gt;inpmask&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;lineimagename&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;.image:mask0&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
         &lt;span class="n"&gt;output&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;lineimagename&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;.mask&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

 &lt;span class="mi"&gt;2021&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;11&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;09&lt;/span&gt; &lt;span class="mi"&gt;02&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;27&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;     &lt;span class="n"&gt;INFO&lt;/span&gt;    &lt;span class="n"&gt;makemask&lt;/span&gt;&lt;span class="p"&gt;::::&lt;/span&gt;&lt;span class="n"&gt;casa&lt;/span&gt;        &lt;span class="c1"&gt;##########################################&lt;/span&gt;
 &lt;span class="mi"&gt;2021&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;11&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;09&lt;/span&gt; &lt;span class="mi"&gt;02&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;27&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;     &lt;span class="n"&gt;INFO&lt;/span&gt;    &lt;span class="n"&gt;makemask&lt;/span&gt;&lt;span class="p"&gt;::::&lt;/span&gt;&lt;span class="n"&gt;casa&lt;/span&gt;        &lt;span class="c1"&gt;##### Begin Task: makemask           #####&lt;/span&gt;
 &lt;span class="mi"&gt;2021&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;11&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;09&lt;/span&gt; &lt;span class="mi"&gt;02&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;27&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;     &lt;span class="n"&gt;INFO&lt;/span&gt;    &lt;span class="n"&gt;makemask&lt;/span&gt;&lt;span class="p"&gt;::::&lt;/span&gt;&lt;span class="n"&gt;casa&lt;/span&gt;        &lt;span class="n"&gt;makemask&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;mode&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;copy&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;inpimage&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/blue/adamginsburg/adamginsburg/almaimf/workdir/G353.41_B6_spw5_12M_spw5.image&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;inpmask&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/blue/adamginsburg/adamginsburg/almaimf/workdir/G353.41_B6_spw5_12M_spw5.image:mask0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;output&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/blue/adamginsburg/adamginsburg/almaimf/workdir/G353.41_B6_spw5_12M_spw5.mask&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;overwrite&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;False&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;inpfreqs&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[],&lt;/span&gt; &lt;span class="n"&gt;outfreqs&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[]&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
 &lt;span class="mi"&gt;2021&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;11&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;09&lt;/span&gt; &lt;span class="mi"&gt;02&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;27&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;11&lt;/span&gt;     &lt;span class="n"&gt;INFO&lt;/span&gt;    &lt;span class="n"&gt;makemask&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;ImageFactory&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;createImage&lt;/span&gt;     &lt;span class="n"&gt;Created&lt;/span&gt; &lt;span class="n"&gt;Paged&lt;/span&gt; &lt;span class="n"&gt;image&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;__tmp_outputmask_22199&amp;#39;&lt;/span&gt; &lt;span class="n"&gt;of&lt;/span&gt; &lt;span class="n"&gt;shape&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1080&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;900&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;480&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="nb"&gt;float&lt;/span&gt; &lt;span class="n"&gt;valued&lt;/span&gt; &lt;span class="n"&gt;pixels&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;
 &lt;span class="mi"&gt;2021&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;11&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;09&lt;/span&gt; &lt;span class="mi"&gt;02&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;27&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;11&lt;/span&gt;     &lt;span class="n"&gt;INFO&lt;/span&gt;    &lt;span class="n"&gt;makemask&lt;/span&gt;&lt;span class="p"&gt;::::&lt;/span&gt;&lt;span class="n"&gt;casa&lt;/span&gt;        &lt;span class="n"&gt;Summing&lt;/span&gt; &lt;span class="nb"&gt;all&lt;/span&gt; &lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;F&lt;/span&gt; &lt;span class="n"&gt;mask&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;inpmask&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="n"&gt;normalized&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;mask&lt;/span&gt;
 &lt;span class="mi"&gt;2021&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;11&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;09&lt;/span&gt; &lt;span class="mi"&gt;02&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;27&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;51&lt;/span&gt;     &lt;span class="n"&gt;SEVERE&lt;/span&gt;  &lt;span class="n"&gt;image&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;regrid&lt;/span&gt;   &lt;span class="ne"&gt;Exception&lt;/span&gt; &lt;span class="n"&gt;Reported&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="ne"&gt;Exception&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;An&lt;/span&gt; &lt;span class="n"&gt;image&lt;/span&gt; &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="n"&gt;multiple&lt;/span&gt; &lt;span class="n"&gt;beams&lt;/span&gt; &lt;span class="n"&gt;cannot&lt;/span&gt; &lt;span class="n"&gt;be&lt;/span&gt; &lt;span class="n"&gt;regridded&lt;/span&gt; &lt;span class="n"&gt;along&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;spectral&lt;/span&gt; &lt;span class="n"&gt;axis&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt; &lt;span class="n"&gt;You&lt;/span&gt; &lt;span class="n"&gt;may&lt;/span&gt; &lt;span class="n"&gt;wish&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;convolve&lt;/span&gt; &lt;span class="nb"&gt;all&lt;/span&gt; &lt;span class="n"&gt;channels&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="n"&gt;common&lt;/span&gt; &lt;span class="n"&gt;resolution&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="n"&gt;retry&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;
 &lt;span class="mi"&gt;2021&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;11&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;09&lt;/span&gt; &lt;span class="mi"&gt;02&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;27&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;51&lt;/span&gt;     &lt;span class="n"&gt;SEVERE&lt;/span&gt;  &lt;span class="n"&gt;image&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;regrid&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;  &lt;span class="o"&gt;...&lt;/span&gt; &lt;span class="n"&gt;thrown&lt;/span&gt; &lt;span class="n"&gt;by&lt;/span&gt; &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;shared_ptr&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;casa6core&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;ImageInterface&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;casa&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;ImageRegridder&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;regrid&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="n"&gt;const&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="n"&gt;T&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;float&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="n"&gt;at&lt;/span&gt; &lt;span class="n"&gt;File&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;src&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;code&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;imageanalysis&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;ImageAnalysis&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;ImageRegridder&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tcc&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;line&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;102&lt;/span&gt;
 &lt;span class="mi"&gt;2021&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;11&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;09&lt;/span&gt; &lt;span class="mi"&gt;02&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;27&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;52&lt;/span&gt;     &lt;span class="n"&gt;INFO&lt;/span&gt;            &lt;span class="n"&gt;deleted&lt;/span&gt; &lt;span class="n"&gt;table&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;blue&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;adamginsburg&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;adamginsburg&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;almaimf&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;workdir&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;G353&lt;/span&gt;&lt;span class="mf"&gt;.41&lt;/span&gt;&lt;span class="n"&gt;_spw5_12M_B6&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;_tmp_copy___tmp_frominmask_22199&lt;/span&gt;
 &lt;span class="mi"&gt;2021&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;11&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;09&lt;/span&gt; &lt;span class="mi"&gt;02&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;27&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;56&lt;/span&gt;     &lt;span class="n"&gt;SEVERE&lt;/span&gt;  &lt;span class="n"&gt;image&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;calc&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;file&lt;/span&gt; &lt;span class="n"&gt;src&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;tools&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;image&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;image_cmpt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cc&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;line&lt;/span&gt; &lt;span class="mi"&gt;553&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;      &lt;span class="ne"&gt;Exception&lt;/span&gt; &lt;span class="n"&gt;Reported&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;ImageExprParse&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;__tmp_fromTFmask_22199&amp;#39;&lt;/span&gt; &lt;span class="ow"&gt;is&lt;/span&gt; &lt;span class="n"&gt;an&lt;/span&gt; &lt;span class="n"&gt;unknown&lt;/span&gt; &lt;span class="n"&gt;lattice&lt;/span&gt; &lt;span class="ow"&gt;or&lt;/span&gt; &lt;span class="n"&gt;image&lt;/span&gt; &lt;span class="ow"&gt;or&lt;/span&gt; &lt;span class="n"&gt;it&lt;/span&gt; &lt;span class="ow"&gt;is&lt;/span&gt; &lt;span class="n"&gt;an&lt;/span&gt; &lt;span class="n"&gt;unqualified&lt;/span&gt; &lt;span class="n"&gt;region&lt;/span&gt;
 &lt;span class="mi"&gt;2021&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;11&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;09&lt;/span&gt; &lt;span class="mi"&gt;02&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;27&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;56&lt;/span&gt;     &lt;span class="n"&gt;SEVERE&lt;/span&gt;  &lt;span class="n"&gt;image&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;calc&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;file&lt;/span&gt; &lt;span class="n"&gt;src&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;tools&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;image&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;image_cmpt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cc&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;line&lt;/span&gt; &lt;span class="mi"&gt;553&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;     &lt;span class="n"&gt;Scanned&lt;/span&gt; &lt;span class="n"&gt;so&lt;/span&gt; &lt;span class="n"&gt;far&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;iif&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;__tmp_fromTFmask_22199&amp;quot;&lt;/span&gt;
 &lt;span class="mi"&gt;2021&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;11&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;09&lt;/span&gt; &lt;span class="mi"&gt;02&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;27&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;56&lt;/span&gt;     &lt;span class="n"&gt;SEVERE&lt;/span&gt;  &lt;span class="n"&gt;makemask&lt;/span&gt;&lt;span class="p"&gt;::::&lt;/span&gt;&lt;span class="n"&gt;casa&lt;/span&gt;        &lt;span class="n"&gt;Task&lt;/span&gt; &lt;span class="n"&gt;makemask&lt;/span&gt; &lt;span class="n"&gt;raised&lt;/span&gt; &lt;span class="n"&gt;an&lt;/span&gt; &lt;span class="n"&gt;exception&lt;/span&gt; &lt;span class="n"&gt;of&lt;/span&gt; &lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;RuntimeError&lt;/span&gt; &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;following&lt;/span&gt; &lt;span class="n"&gt;message&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="o"&gt;***&lt;/span&gt; &lt;span class="n"&gt;Error&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;mode&lt;/span&gt; &lt;span class="n"&gt;copy&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="o"&gt;***&lt;/span&gt; &lt;span class="n"&gt;ImageExprParse&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;__tmp_fromTFmask_22199&amp;#39;&lt;/span&gt; &lt;span class="ow"&gt;is&lt;/span&gt; &lt;span class="n"&gt;an&lt;/span&gt; &lt;span class="n"&gt;unknown&lt;/span&gt; &lt;span class="n"&gt;lattice&lt;/span&gt; &lt;span class="ow"&gt;or&lt;/span&gt; &lt;span class="n"&gt;image&lt;/span&gt; &lt;span class="ow"&gt;or&lt;/span&gt; &lt;span class="n"&gt;it&lt;/span&gt; &lt;span class="ow"&gt;is&lt;/span&gt; &lt;span class="n"&gt;an&lt;/span&gt; &lt;span class="n"&gt;unqualified&lt;/span&gt; &lt;span class="n"&gt;region&lt;/span&gt;
 &lt;span class="mi"&gt;2021&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;11&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;09&lt;/span&gt; &lt;span class="mi"&gt;02&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;27&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;56&lt;/span&gt;     &lt;span class="n"&gt;SEVERE&lt;/span&gt;  &lt;span class="n"&gt;makemask&lt;/span&gt;&lt;span class="p"&gt;::::&lt;/span&gt;&lt;span class="n"&gt;casa&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;       &lt;span class="n"&gt;Scanned&lt;/span&gt; &lt;span class="n"&gt;so&lt;/span&gt; &lt;span class="n"&gt;far&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;iif&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;__tmp_fromTFmask_22199&amp;quot;&lt;/span&gt;
 &lt;span class="mi"&gt;2021&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;11&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;09&lt;/span&gt; &lt;span class="mi"&gt;02&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;27&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;56&lt;/span&gt;     &lt;span class="n"&gt;INFO&lt;/span&gt;    &lt;span class="n"&gt;makemask&lt;/span&gt;&lt;span class="p"&gt;::::&lt;/span&gt;&lt;span class="n"&gt;casa&lt;/span&gt;        &lt;span class="n"&gt;Task&lt;/span&gt; &lt;span class="n"&gt;makemask&lt;/span&gt; &lt;span class="n"&gt;complete&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt; &lt;span class="n"&gt;Start&lt;/span&gt; &lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;2021&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;11&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;08&lt;/span&gt; &lt;span class="mi"&gt;21&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;27&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;09.614534&lt;/span&gt; &lt;span class="n"&gt;End&lt;/span&gt; &lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;2021&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;11&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;08&lt;/span&gt; &lt;span class="mi"&gt;21&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;27&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;56.399654&lt;/span&gt;
 &lt;span class="mi"&gt;2021&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;11&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;09&lt;/span&gt; &lt;span class="mi"&gt;02&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;27&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;56&lt;/span&gt;     &lt;span class="n"&gt;INFO&lt;/span&gt;    &lt;span class="n"&gt;makemask&lt;/span&gt;&lt;span class="p"&gt;::::&lt;/span&gt;&lt;span class="n"&gt;casa&lt;/span&gt;        &lt;span class="c1"&gt;##### End Task: makemask             #####&lt;/span&gt;
 &lt;span class="mi"&gt;2021&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;11&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;09&lt;/span&gt; &lt;span class="mi"&gt;02&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;27&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;56&lt;/span&gt;     &lt;span class="n"&gt;INFO&lt;/span&gt;    &lt;span class="n"&gt;makemask&lt;/span&gt;&lt;span class="p"&gt;::::&lt;/span&gt;&lt;span class="n"&gt;casa&lt;/span&gt;        &lt;span class="c1"&gt;##########################################&lt;/span&gt;


&lt;span class="mi"&gt;2021&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;11&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;09&lt;/span&gt; &lt;span class="mi"&gt;02&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;27&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;51&lt;/span&gt;     &lt;span class="n"&gt;SEVERE&lt;/span&gt;  &lt;span class="n"&gt;image&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;regrid&lt;/span&gt;   &lt;span class="ne"&gt;Exception&lt;/span&gt; &lt;span class="n"&gt;Reported&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="ne"&gt;Exception&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;An&lt;/span&gt; &lt;span class="n"&gt;image&lt;/span&gt; &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="n"&gt;multiple&lt;/span&gt; &lt;span class="n"&gt;beams&lt;/span&gt; &lt;span class="n"&gt;cannot&lt;/span&gt; &lt;span class="n"&gt;be&lt;/span&gt; &lt;span class="n"&gt;regridded&lt;/span&gt; &lt;span class="n"&gt;along&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;spectral&lt;/span&gt; &lt;span class="n"&gt;axis&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt; &lt;span class="n"&gt;You&lt;/span&gt; &lt;span class="n"&gt;may&lt;/span&gt; &lt;span class="n"&gt;wish&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;convolve&lt;/span&gt; &lt;span class="nb"&gt;all&lt;/span&gt; &lt;span class="n"&gt;channels&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="n"&gt;common&lt;/span&gt;
 &lt;span class="n"&gt;resolution&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="n"&gt;retry&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;
&lt;span class="mi"&gt;2021&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;11&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;09&lt;/span&gt; &lt;span class="mi"&gt;02&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;27&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;51&lt;/span&gt;     &lt;span class="n"&gt;SEVERE&lt;/span&gt;  &lt;span class="n"&gt;image&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;regrid&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;  &lt;span class="o"&gt;...&lt;/span&gt; &lt;span class="n"&gt;thrown&lt;/span&gt; &lt;span class="n"&gt;by&lt;/span&gt; &lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;shared_ptr&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;casa6core&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;ImageInterface&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;casa&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;ImageRegridder&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;regrid&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="n"&gt;const&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="n"&gt;T&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;float&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="n"&gt;at&lt;/span&gt; &lt;span class="n"&gt;File&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;src&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;code&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;imageanalysis&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;Imag&lt;/span&gt;
&lt;span class="n"&gt;eAnalysis&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;ImageRegridder&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tcc&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;line&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;102&lt;/span&gt;
&lt;span class="mi"&gt;2021&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;11&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;09&lt;/span&gt; &lt;span class="mi"&gt;02&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;27&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;56&lt;/span&gt;     &lt;span class="n"&gt;SEVERE&lt;/span&gt;  &lt;span class="n"&gt;image&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;calc&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;file&lt;/span&gt; &lt;span class="n"&gt;src&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;tools&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;image&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;image_cmpt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cc&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;line&lt;/span&gt; &lt;span class="mi"&gt;553&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;      &lt;span class="ne"&gt;Exception&lt;/span&gt; &lt;span class="n"&gt;Reported&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;ImageExprParse&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;__tmp_fromTFmask_22199&amp;#39;&lt;/span&gt; &lt;span class="ow"&gt;is&lt;/span&gt; &lt;span class="n"&gt;an&lt;/span&gt; &lt;span class="n"&gt;unknown&lt;/span&gt; &lt;span class="n"&gt;lattice&lt;/span&gt; &lt;span class="ow"&gt;or&lt;/span&gt; &lt;span class="n"&gt;image&lt;/span&gt; &lt;span class="ow"&gt;or&lt;/span&gt; &lt;span class="n"&gt;it&lt;/span&gt; &lt;span class="ow"&gt;is&lt;/span&gt; &lt;span class="n"&gt;an&lt;/span&gt; &lt;span class="n"&gt;un&lt;/span&gt;
&lt;span class="n"&gt;qualified&lt;/span&gt; &lt;span class="n"&gt;region&lt;/span&gt;
&lt;span class="mi"&gt;2021&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;11&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;09&lt;/span&gt; &lt;span class="mi"&gt;02&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;27&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;56&lt;/span&gt;     &lt;span class="n"&gt;SEVERE&lt;/span&gt;  &lt;span class="n"&gt;image&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;calc&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;file&lt;/span&gt; &lt;span class="n"&gt;src&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;tools&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;image&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;image_cmpt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cc&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;line&lt;/span&gt; &lt;span class="mi"&gt;553&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;     &lt;span class="n"&gt;Scanned&lt;/span&gt; &lt;span class="n"&gt;so&lt;/span&gt; &lt;span class="n"&gt;far&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;iif&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;__tmp_fromTFmask_22199&amp;quot;&lt;/span&gt;
&lt;span class="mi"&gt;2021&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;11&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;09&lt;/span&gt; &lt;span class="mi"&gt;02&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;27&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;56&lt;/span&gt;     &lt;span class="n"&gt;SEVERE&lt;/span&gt;  &lt;span class="n"&gt;makemask&lt;/span&gt;&lt;span class="p"&gt;::::&lt;/span&gt;&lt;span class="n"&gt;casa&lt;/span&gt;        &lt;span class="n"&gt;Task&lt;/span&gt; &lt;span class="n"&gt;makemask&lt;/span&gt; &lt;span class="n"&gt;raised&lt;/span&gt; &lt;span class="n"&gt;an&lt;/span&gt; &lt;span class="n"&gt;exception&lt;/span&gt; &lt;span class="n"&gt;of&lt;/span&gt; &lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;RuntimeError&lt;/span&gt; &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;following&lt;/span&gt; &lt;span class="n"&gt;message&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="o"&gt;***&lt;/span&gt; &lt;span class="n"&gt;Error&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;mode&lt;/span&gt; &lt;span class="n"&gt;copy&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="o"&gt;***&lt;/span&gt; &lt;span class="n"&gt;ImageExprParse&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;__tmp_fromTF&lt;/span&gt;
&lt;span class="n"&gt;mask_22199&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39; is an unknown lattice or image or it is an unqualified region&lt;/span&gt;
&lt;span class="mi"&gt;2021&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;11&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;09&lt;/span&gt; &lt;span class="mi"&gt;02&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;27&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;56&lt;/span&gt;     &lt;span class="n"&gt;SEVERE&lt;/span&gt;  &lt;span class="n"&gt;makemask&lt;/span&gt;&lt;span class="p"&gt;::::&lt;/span&gt;&lt;span class="n"&gt;casa&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;       &lt;span class="n"&gt;Scanned&lt;/span&gt; &lt;span class="n"&gt;so&lt;/span&gt; &lt;span class="n"&gt;far&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;iif&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;__tmp_fromTFmask_22199&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;I'm pretty sure the complaint is caused by the top line: there are multiple
beams in the image.  This is _absurd_, though, because the &lt;cite&gt;makemask&lt;/cite&gt; command
should not care at all about beams, there is no spectral regridding happening.&lt;/p&gt;
&lt;p&gt;This might be new to CASA 6.4, not sure.&lt;/p&gt;
&lt;p&gt;EDIT 2021-11-11 15:51:
The workaround is easy and maybe better:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;ia&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;lineimagename&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;.image&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;shape&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ia&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;csys&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ia&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;coordsys&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;torecord&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;ia&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="n"&gt;ia&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fromshape&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;outfile&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;lineimagename&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;.mask&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;csys&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;csys&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;f&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
</content><category term="misc"></category><category term="casa"></category><category term="bug"></category></entry><entry><title>Walkthrough of PSF characterization</title><link href="https://keflavich.github.io/blog/walkthrough-of-psf-characterization.html" rel="alternate"></link><published>2021-11-06T17:37:00-06:00</published><updated>2021-11-06T17:37:00-06:00</updated><author><name>Adam Ginsburg (Adam.G.Ginsburg@gmail.com)</name></author><id>tag:keflavich.github.io,2021-11-06:/blog/walkthrough-of-psf-characterization.html</id><summary type="html">&lt;p&gt;For ALMA-IMF, we want to characterize the PSF shapes and the recovered
beam sizes.&lt;/p&gt;
&lt;p&gt;We showed the beams and a few features of the PSFs, but they were only
described tersely in the paper. This document goes through what we did
in a little more detail&lt;/p&gt;
&lt;div class="section" id="front-matter-imports"&gt;
&lt;h2&gt;Front matter (imports)&lt;/h2&gt;
&lt;pre class="code python literal-block"&gt;
&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;matplotlib …&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;</summary><content type="html">&lt;p&gt;For ALMA-IMF, we want to characterize the PSF shapes and the recovered
beam sizes.&lt;/p&gt;
&lt;p&gt;We showed the beams and a few features of the PSFs, but they were only
described tersely in the paper. This document goes through what we did
in a little more detail&lt;/p&gt;
&lt;div class="section" id="front-matter-imports"&gt;
&lt;h2&gt;Front matter (imports)&lt;/h2&gt;
&lt;pre class="code python literal-block"&gt;
&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;matplotlib&lt;/span&gt; &lt;span class="n"&gt;inline&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;pylab&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;pl&lt;/span&gt;&lt;span class="w"&gt;

&lt;/span&gt;&lt;span class="c1"&gt;# for display within notebook&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="n"&gt;pl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rcParams&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'figure.facecolor'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;'w'&lt;/span&gt;&lt;span class="w"&gt;

&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;spectral_cube&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;SpectralCube&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;astropy&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;units&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="w"&gt;

&lt;/span&gt;&lt;span class="c1"&gt;# Debuggy loading: this approach needed b/c the code isn't properly packaged&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;imp&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;sys&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'/orange/adamginsburg/ALMA_IMF/reduction/analysis'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;imstats&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="n"&gt;imp&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;reload&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;imstats&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;imstats&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;get_psf_secondpeak&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="n2h"&gt;
&lt;h2&gt;N2H+&lt;/h2&gt;
&lt;p&gt;I chose to do this only for an N&lt;span class="math"&gt;\(_2\)&lt;/span&gt;H+ example; the
N&lt;span class="math"&gt;\(_2\)&lt;/span&gt;H+ line cubes seem to have the worst-behaved beams in our
samples.&lt;/p&gt;
&lt;pre class="code python literal-block"&gt;
&lt;span class="n"&gt;basename&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;'/orange/adamginsburg/ALMAIMF_Images/G327.29/B3/linecubes_12m/G327.29_B3_spw0_12M_n2hp'&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="n"&gt;img&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;SpectralCube&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;f&lt;/span&gt;&lt;span class="s1"&gt;'&lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="n"&gt;basename&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s1"&gt;.image'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="n"&gt;psf&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;SpectralCube&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;f&lt;/span&gt;&lt;span class="s1"&gt;'&lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="n"&gt;basename&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s1"&gt;.psf'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;format&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'casa_image'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;The code &lt;tt class="docutils literal"&gt;get_psf_secondpeak&lt;/tt&gt; does all of the work, we’re just going
to talk about what gets plotted.&lt;/p&gt;
&lt;pre class="code python literal-block"&gt;
&lt;span class="n"&gt;psffn&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="sa"&gt;f&lt;/span&gt;&lt;span class="s1"&gt;'&lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="n"&gt;basename&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s1"&gt;.psf'&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;psf_secondpeak&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;psf_secondpeak_loc&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;psf_sidelobe1_fraction&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;epsilon&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;firstnull&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;r_sidelobe&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rr&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pixscale&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cutout&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;beam&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fullbeam&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;view&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;bmfit_residual&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; \
        &lt;span class="n"&gt;get_psf_secondpeak&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;psffn&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;show_image&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;min_radial_extent&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;2.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;arcsec&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;                   &lt;span class="n"&gt;max_radial_extent&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;arcsec&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;                           &lt;span class="n"&gt;specslice&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;slice&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;50&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;51&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;                  &lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;
&lt;pre class="literal-block"&gt;
INFO: first_sidelobe_ind=44, first_min_ind = 43 [imstats]
&lt;/pre&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/output_6_1.png" /&gt;
&lt;p&gt;The plot is showing:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;in red contours, the 10th, 50th, and 90th percentile of the Gaussian
synthesized beam&lt;/li&gt;
&lt;li&gt;in grayscale, the &lt;em&gt;residual&lt;/em&gt; of the dirty beam minus the synthesized
beam&lt;/li&gt;
&lt;li&gt;in green dashed (faint, outermost ellipse), the location of the first
sidelobe peak. The first sidelobe is defined as the first peak
outside of the first null.&lt;/li&gt;
&lt;li&gt;in blue dashed (inner ellipse), the location of the first null. This
may not be a true null: it is the first minimum of the radial profile&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Next, we show the radial profile. The radial profile is an &lt;em&gt;elliptical&lt;/em&gt;
profile, which is why the elliptical synthesized beam has a single
profile.&lt;/p&gt;
&lt;p&gt;The X-axis is calculated as:&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
r = \left(C^2 (x \cos \theta + y \sin \theta)^2 + (x \sin \theta - y \cos \theta)^2\right)^{1/2}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;where &lt;span class="math"&gt;\(C = \theta_{min} / \theta_{maj}\)&lt;/span&gt;. So the radial axis is
scaled to the major axis of the beam; the true beam is smaller along one
axis than shown in these plots.&lt;/p&gt;
&lt;pre class="code python literal-block"&gt;
&lt;span class="c1"&gt;# radial profile&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="n"&gt;pl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="n"&gt;ax2&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;pl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="n"&gt;ax1&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;pl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;


&lt;/span&gt;&lt;span class="n"&gt;ax2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_title&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'G327 N2H+'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="n"&gt;rr_inds&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;rr&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ravel&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;argsort&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="n"&gt;sorted_synth&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fullbeam&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ravel&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;fullbeam&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;max&lt;/span&gt;&lt;span class="p"&gt;())[&lt;/span&gt;&lt;span class="n"&gt;rr_inds&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="n"&gt;pixscale&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pixscale&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;to&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;arcsec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="n"&gt;ax2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pixscale&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;rr&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ravel&lt;/span&gt;&lt;span class="p"&gt;()[&lt;/span&gt;&lt;span class="n"&gt;rr_inds&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;sorted_synth&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'-'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'Synth'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="n"&gt;ax2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pixscale&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;rr&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ravel&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;         &lt;span class="n"&gt;cutout&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ravel&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;cutout&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;max&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'.'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'Dirty'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.75&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;markersize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="n"&gt;ax2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;axvline&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;firstnull&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;linestyle&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'--'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;color&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'b'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="n"&gt;ax2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xlim&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;firstnull&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="c1"&gt;# rr[view].max())&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="n"&gt;ax2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;firstnull&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="mf"&gt;1.4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.9&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;f&lt;/span&gt;&lt;span class="s1"&gt;'$\epsilon=&lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="n"&gt;epsilon&lt;/span&gt;&lt;span class="si"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;0.2f&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s1"&gt;$'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fontsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;14&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="n"&gt;ax2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;firstnull&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="mf"&gt;1.4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.85&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;f&lt;/span&gt;&lt;span class="s1"&gt;'$&lt;/span&gt;&lt;span class="se"&gt;\\&lt;/span&gt;&lt;span class="s1"&gt;theta_&lt;/span&gt;&lt;span class="se"&gt;{{&lt;/span&gt;&lt;span class="s1"&gt;maj&lt;/span&gt;&lt;span class="se"&gt;}}&lt;/span&gt;&lt;span class="s1"&gt;=&lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="n"&gt;beam&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;major&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="si"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;0.2f&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s1"&gt;$&amp;quot;'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fontsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;14&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="n"&gt;ax2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;firstnull&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="mf"&gt;1.4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;f&lt;/span&gt;&lt;span class="s1"&gt;'$&lt;/span&gt;&lt;span class="se"&gt;\\&lt;/span&gt;&lt;span class="s1"&gt;theta_&lt;/span&gt;&lt;span class="se"&gt;{{&lt;/span&gt;&lt;span class="s1"&gt;min&lt;/span&gt;&lt;span class="se"&gt;}}&lt;/span&gt;&lt;span class="s1"&gt;=&lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="n"&gt;beam&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;minor&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="si"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;0.2f&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s1"&gt;$&amp;quot;'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fontsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;14&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;

&lt;/span&gt;&lt;span class="n"&gt;ax2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;axvline&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;psf_secondpeak_loc&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;linestyle&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;':'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;color&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'k'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="n"&gt;ax2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;axvline&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r_sidelobe&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;linestyle&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;':'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;color&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'g'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;

&lt;/span&gt;&lt;span class="n"&gt;ax2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;beam&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;major&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;beam&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;major&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;         &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;         &lt;span class="n"&gt;color&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'k'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;


&lt;/span&gt;&lt;span class="n"&gt;ax1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_title&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'G327 N2H+'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="n"&gt;ax1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pixscale&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;rr&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ravel&lt;/span&gt;&lt;span class="p"&gt;()[&lt;/span&gt;&lt;span class="n"&gt;rr_inds&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;sorted_synth&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'-'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'Synth'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="n"&gt;ax1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pixscale&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;rr&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ravel&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;         &lt;span class="n"&gt;cutout&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ravel&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;cutout&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;max&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'.'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'Dirty'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.75&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;markersize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="n"&gt;ax1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;axvline&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;firstnull&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;linestyle&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'--'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;color&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'b'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="n"&gt;ax1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;axvline&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;psf_secondpeak_loc&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;linestyle&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;':'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;color&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'k'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="n"&gt;ax1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;axvline&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r_sidelobe&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;linestyle&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;':'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;color&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'g'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;

&lt;/span&gt;&lt;span class="n"&gt;ax1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xlim&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;firstnull&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="c1"&gt;# rr[view].max())&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="n"&gt;ax1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_ylim&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;0.035&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;

&lt;/span&gt;&lt;span class="n"&gt;ax1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Radius along PSF (&lt;/span&gt;&lt;span class="se"&gt;\&amp;quot;&lt;/span&gt;&lt;span class="s2"&gt;)&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="n"&gt;ax2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Radius along PSF (&lt;/span&gt;&lt;span class="se"&gt;\&amp;quot;&lt;/span&gt;&lt;span class="s2"&gt;)&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="n"&gt;ax1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Normalized PSF profile&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;
&lt;pre class="literal-block"&gt;
Text(0, 0.5, 'Normalized PSF profile')
&lt;/pre&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/output_9_1.png" /&gt;
&lt;p&gt;The right plot is a vertical zoom-in of the left plot.&lt;/p&gt;
&lt;p&gt;The light blue line shows the synthesized beam.&lt;/p&gt;
&lt;p&gt;The orange dots are the individual pixel values from the dirty beam.&lt;/p&gt;
&lt;p&gt;The vertical dotted black line shows the peak of the residual - it’s not
used for anything, it just highlights where the “shelf” is most
prominent (and it is &lt;em&gt;very&lt;/em&gt; prominent in this example).&lt;/p&gt;
&lt;p&gt;The blue vertical dashed line shows the location of the first null.&lt;/p&gt;
&lt;p&gt;The green vertical dotted line shows the location of the first sidelobe.&lt;/p&gt;
&lt;p&gt;&lt;span class="math"&gt;\(\epsilon\)&lt;/span&gt; is the ratio of the integral of the synthesized beam to
the integral of the dirty beam out to the first null. It is the
correction factor to apply to the residuals (multiply the residuals by
this number) to convert the residuals from Jy/dirtybeam to
Jy/synthesizedbeam.&lt;/p&gt;
&lt;p&gt;&lt;span class="math"&gt;\(\theta_{min}\)&lt;/span&gt; and &lt;span class="math"&gt;\(\theta_{maj}\)&lt;/span&gt; are the FWHM widths of the
beam along the major and minor axes. The grey right-angle line is drawn
at &lt;span class="math"&gt;\(y=0.5\)&lt;/span&gt; out to &lt;span class="math"&gt;\(\theta = \theta_{maj}/2\)&lt;/span&gt; (the half-width
half-max)&lt;/p&gt;
&lt;/div&gt;
&lt;script type='text/javascript'&gt;if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width &lt; 768) ? "left" : align;
        indent = (screen.width &lt; 768) ? "0em" : indent;
        linebreak = (screen.width &lt; 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/latest.js?config=TeX-AMS-MML_HTMLorMML';

    var configscript = document.createElement('script');
    configscript.type = 'text/x-mathjax-config';
    configscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'none' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        availableFonts: ['STIX', 'TeX']," +
        "        preferredFont: 'STIX'," +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";

    (document.body || document.getElementsByTagName('head')[0]).appendChild(configscript);
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
&lt;/script&gt;</content><category term="misc"></category><category term="casa"></category><category term="psf"></category></entry><entry><title>CASA MPI problems</title><link href="https://keflavich.github.io/blog/casa-mpi-problems.html" rel="alternate"></link><published>2021-10-17T20:40:00-06:00</published><updated>2021-10-17T20:40:00-06:00</updated><author><name>Adam Ginsburg (Adam.G.Ginsburg@gmail.com)</name></author><id>tag:keflavich.github.io,2021-10-17:/blog/casa-mpi-problems.html</id><summary type="html">&lt;p&gt;There are several CASA MPI errors I encounter regularly.&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
2021-10-17 15:56:06     SEVERE  task_tclean::SynthesisImagerVi2::runCubeGridding (file src/code/synthesis/ImagerObjects/SynthesisImagerVi2.cc, line 1579)       remainder rank 7 failed
master 1 init 1
2021-10-17 15:59:21     SEVERE  tclean::::casa  Task tclean raised an exception of class RuntimeError …&lt;/pre&gt;</summary><content type="html">&lt;p&gt;There are several CASA MPI errors I encounter regularly.&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
2021-10-17 15:56:06     SEVERE  task_tclean::SynthesisImagerVi2::runCubeGridding (file src/code/synthesis/ImagerObjects/SynthesisImagerVi2.cc, line 1579)       remainder rank 7 failed
master 1 init 1
2021-10-17 15:59:21     SEVERE  tclean::::casa  Task tclean raised an exception of class RuntimeError with the following message: Error in making PSF : One or more  of the cube section failed in de/grid
ding. Return values for the sections: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]

 Traceback (most recent call last):
   File &amp;quot;/blue/adamginsburg/adamginsburg/casa/casa-6.4.0-12/lib/py/lib/python3.6/site-packages/casashell/private/init_system.py&amp;quot;, line 238, in __evprop__
     exec(stmt)
   File &amp;quot;&amp;lt;string&amp;gt;&amp;quot;, line 1, in &amp;lt;module&amp;gt;
   File &amp;quot;/blue/adamginsburg/adamginsburg/casa/casa-6.4.0-12/lib/py/lib/python3.6/site-packages/casashell/private/init_system.py&amp;quot;, line 175, in execfile
     newglob = run_path( filename, init_globals=globals )
   File &amp;quot;/blue/adamginsburg/adamginsburg/casa/casa-6.4.0-12/lib/py/lib/python3.6/runpy.py&amp;quot;, line 263, in run_path
     pkg_name=pkg_name, script_name=fname)
   File &amp;quot;/blue/adamginsburg/adamginsburg/casa/casa-6.4.0-12/lib/py/lib/python3.6/runpy.py&amp;quot;, line 96, in _run_module_code
     mod_name, mod_spec, pkg_name, script_name)
   File &amp;quot;/blue/adamginsburg/adamginsburg/casa/casa-6.4.0-12/lib/py/lib/python3.6/runpy.py&amp;quot;, line 85, in _run_code
     exec(code, run_globals)
   File &amp;quot;/orange/adamginsburg/ALMA_IMF/reduction/reduction/line_imaging.py&amp;quot;, line 935, in &amp;lt;module&amp;gt;
     **impars
   File &amp;quot;/blue/adamginsburg/adamginsburg/casa/casa-6.4.0-12/lib/py/lib/python3.6/site-packages/casatasks/tclean.py&amp;quot;, line 1660, in __call__
     task_result = _tclean_t( _pc.document['vis'], _pc.document['selectdata'], _pc.document['field'], _pc.document['spw'], _pc.document['timerange'], _pc.document['uvrange'], _pc.document['antenna'], _pc.document['scan'], _pc.document['observation'], _pc.document['intent'], _pc.document['datacolumn'], _pc.document['imagename'], _pc.document['imsize'], _pc.document['cell'], _pc.document['phasecenter'], _pc.document['stokes'], _pc.document['projection'], _pc.document['startmodel'], _pc.document['specmode'], _pc.document['reffreq'], _pc.document['nchan'], _pc.document['start'], _pc.document['width'], _pc.document['outframe'], _pc.document['veltype'], _pc.document['restfreq'], _pc.document['interpolation'], _pc.document['perchanweightdensity'], _pc.document['gridder'], _pc.document['facets'], _pc.document['psfphasecenter'], _pc.document['wprojplanes'], _pc.document['vptable'], _pc.document['mosweight'], _pc.document['aterm'], _pc.document['psterm'], _pc.document['wbawp'], _pc.document['conjbeams'], _pc.document['cfcache'], _pc.document['usepointing'], _pc.document['computepastep'], _pc.document['rotatepastep'], _pc.document['pointingoffsetsigdev'], _pc.document['pblimit'], _pc.document['normtype'], _pc.document['deconvolver'], _pc.document['scales'], _pc.document['nterms'], _pc.document['smallscalebias'], _pc.document['restoration'], _pc.document['restoringbeam'], _pc.document['pbcor'], _pc.document['outlierfile'], _pc.document['weighting'], _pc.document['robust'], _pc.document['noise'], _pc.document['npixels'], _pc.document['uvtaper'], _pc.document['niter'], _pc.document['gain'], _pc.document['threshold'], _pc.document['nsigma'], _pc.document['cycleniter'], _pc.document['cyclefactor'], _pc.document['minpsffraction'], _pc.document['maxpsffraction'], _pc.document['interactive'], _pc.document['usemask'], _pc.document['mask'], _pc.document['pbmask'], _pc.document['sidelobethreshold'], _pc.document['noisethreshold'], _pc.document['lownoisethreshold'], _pc.document['negativethreshold'], _pc.document['smoothfactor'], _pc.document['minbeamfrac'], _pc.document['cutthreshold'], _pc.document['growiterations'], _pc.document['dogrowprune'], _pc.document['minpercentchange'], _pc.document['verbose'], _pc.document['fastnoise'], _pc.document['restart'], _pc.document['savemodel'], _pc.document['calcres'], _pc.document['calcpsf'], _pc.document['psfcutoff'], _pc.document['parallel'] )
   File &amp;quot;/blue/adamginsburg/adamginsburg/casa/casa-6.4.0-12/lib/py/lib/python3.6/site-packages/casatasks/private/task_tclean.py&amp;quot;, line 364, in tclean
     imager.makePSF()
   File &amp;quot;/blue/adamginsburg/adamginsburg/casa/casa-6.4.0-12/lib/py/lib/python3.6/site-packages/casatasks/private/imagerhelpers/imager_base.py&amp;quot;, line 344, in makePSF
     self.makePSFCore()
   File &amp;quot;/blue/adamginsburg/adamginsburg/casa/casa-6.4.0-12/lib/py/lib/python3.6/site-packages/casatasks/private/imagerhelpers/imager_base.py&amp;quot;, line 496, in makePSFCore
     self.SItool.makepsf()
   File &amp;quot;/blue/adamginsburg/adamginsburg/casa/casa-6.4.0-12/lib/py/lib/python3.6/site-packages/casatools/synthesisimager.py&amp;quot;, line 70, in makepsf
     return self._swigobj.makepsf()
   File &amp;quot;/blue/adamginsburg/adamginsburg/casa/casa-6.4.0-12/lib/py/lib/python3.6/site-packages/casatools/__casac__/synthesisimager.py&amp;quot;, line 322, in makepsf
     return _synthesisimager.synthesisimager_makepsf(self)
 RuntimeError: Error in making PSF : One or more  of the cube section failed in de/gridding. Return values for the sections: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
&lt;/pre&gt;
&lt;p&gt;That one appears to be caused by:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
2021-10-17 15:53:34     WARN    MPICommandServer::command_request_handler_service::SynthesisImagerVi2::CubeMajorCycle::MPIServer-7 (file src/code/synthesis/ImagerObjects/CubeMajorCycleAlgorithm.cc, line
 A) Exception for chan range [1921, 1924] ---   Error in making PSF : Interpolate1D::operator() data has repeated x values
##################################
#############################
Exception: Error in making PSF : Interpolate1D::operator() data has repeated x values
&lt;/pre&gt;
&lt;p&gt;This happened after a lot of apparently successful cleaning, as an .image was created.  However, the failure caused
CASA to exit.&lt;/p&gt;
&lt;p&gt;This tclean command:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
2021-10-17 15:19:43     INFO    tclean::::casa  tclean( vis='/blue/adamginsburg/adamginsburg/almaimf/workdir/G008.67_B3_spw2_12M.concat.ms', selectdata=True, field='G008.67', spw='', timerange='', uvrange='', antenna='', scan='', observation='', intent='', datacolumn='corrected', imagename='/blue/adamginsburg/adamginsburg/almaimf/workdir/G008.67_B3_spw2_12M_spw2', imsize=[2880, 2250], cell=['0.08arcsec', '0.08arcsec'], phasecenter='ICRS 271.5877979623041deg -21.620789662367244deg', stokes='I', projection='SIN', startmodel='', specmode='cube', reffreq='', nchan=-1, start='', width='', outframe='LSRK', veltype='radio', restfreq=[], interpolation='linear', perchanweightdensity=True, gridder='mosaic', facets=1, psfphasecenter='', wprojplanes=1, vptable='', mosweight=True, aterm=True, psterm=False, wbawp=True, conjbeams=False, cfcache='', usepointing=False, computepastep=360.0, rotatepastep=360.0, pointingoffsetsigdev=[], pblimit=0.05, normtype='flatnoise', deconvolver='multiscale', scales=[0, 4, 8, 16, 32], nterms=2, smallscalebias=0.5, restoration=True, restoringbeam='', pbcor=False, outlierfile='', weighting='briggsbwtaper', robust=0.0, noise='1.0Jy', npixels=0, uvtaper=[''], niter=5000000, gain=0.1, threshold='0.0168Jy', nsigma=0.0, cycleniter=-1, cyclefactor=2.0, minpsffraction=0.05, maxpsffraction=0.8, interactive=0, usemask='user', mask='', pbmask=0.1, sidelobethreshold=3.0, noisethreshold=5.0, lownoisethreshold=1.5, negativethreshold=0.0, smoothfactor=1.0, minbeamfrac=0.3, cutthreshold=0.01, growiterations=75, dogrowprune=True, minpercentchange=-1.0, verbose=False, fastnoise=True, restart=True, savemodel='none', calcres=False, calcpsf=True, psfcutoff=0.35, parallel=True )
&lt;/pre&gt;
&lt;p&gt;using concatenated data caused the failure.  It was run as an MPI job with 32 cores and 128 GB RAM.
The same issue recurred for the next MS (spw3), but not for spw0 or spw1 - yet, they're still running.&lt;/p&gt;
&lt;p&gt;This: &amp;quot;Exception for chan range [1921, 1924] ---   Error in making PSF : Interpolate1D::operator() data has repeated x values&amp;quot; suggests to me that there's
a problem with the gridder thinking there are more channels than there actually are; &lt;tt class="docutils literal"&gt;tclean&lt;/tt&gt;'s behavior is not consistent between operating on concatenated
data sets and on lists of data sets.  This issue may be a manifestation of tclean misunderstanding the grid when operating with MPI enabled.
This could also prove not to be an MPI error, but one that is only encountered if MPI is enabled b/c MPI gets to channel 1921 while non-MPI never gets
there before the job is canceled for time.&lt;/p&gt;
&lt;p&gt;W51 spw2 had similar:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
WARN    MPICommandServer::command_request_handler_service::SynthesisImagerVi2::CubeMajorCycle::MPIServer-21 (file src/code/synthesis/ImagerObjects/CubeMajorCycleAlgorithm.cc, line 336)        Exception for chan range [1269, 1277] ---   FilebufIO::readBlock - incorrect number of bytes read for file /blue/adamginsburg/adamginsburg/almaimf/workdir/W51-E_B3_spw2_12M_spw2.sumwt/table.f0
Exception: FilebufIO::readBlock - incorrect number of bytes read for file /blue/adamginsburg/adamginsburg/almaimf/workdir/W51-E_B3_spw2_12M_spw2.sumwt/table.f0
WARN    MPICommandServer::command_request_handler_service::SynthesisImagerVi2::CubeMajorCycle::MPIServer-9 (file src/code/synthesis/ImagerObjects/CubeMajorCycleAlgorithm.cc, line 336) Exception for chan range [1314, 1322] ---   FilebufIO::readBlock - incorrect number of bytes read for file /blue/adamginsburg/adamginsburg/almaimf/workdir/W51-E_B3_spw2_12M_spw2.sumwt/table.f0
Exception: FilebufIO::readBlock - incorrect number of bytes read for file /blue/adamginsburg/adamginsburg/almaimf/workdir/W51-E_B3_spw2_12M_spw2.sumwt/table.f0
&lt;/pre&gt;
&lt;p&gt;I have not found solutions to any of these; the workaround appears to be just to not use MPI.&lt;/p&gt;
&lt;p&gt;EDIT: here's another one&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
2021-10-22 22:36:53     WARN    MPICommandServer::command_request_handler_service::SynthesisImagerVi2::CubeMajorCycle::MPIServer-2 (file src/code/synthesis/ImagerObjects/CubeMajorCycleAlgorithm.cc, line 336) Exception for chan range [55, 109] ---   Setting masked pixels to zero for input startmodel : Error (Resource deadlock avoided) when acquiring lock on /blue/adamginsburg/adamginsburg/almaimf/workdir/G327.29_B6_spw1_12M_sio.contcube.model/table.lock
##################################
#############################
Exception: Setting masked pixels to zero for input startmodel : Error (Resource deadlock avoided) when acquiring lock on /blue/adamginsburg/adamginsburg/almaimf/workdir/G327.29_B6_spw1_12M_sio.contcube.model/table.lock
2021-10-22 22:36:54     WARN    MPICommandServer::command_request_handler_service::SynthesisImagerVi2::CubeMajorCycle::MPIServer-4 (file src/code/synthesis/ImagerObjects/CubeMajorCycleAlgorithm.cc, line 336) Exception for chan range [165, 219] ---   Setting masked pixels to zero for input startmodel : Error (Resource deadlock avoided) when acquiring lock on /blue/adamginsburg/adamginsburg/almaimf/workdir/G327.29_B6_spw1_12M_sio.contcube.model/table.lock
##################################
#############################
Exception: Setting masked pixels to zero for input startmodel : Error (Resource deadlock avoided) when acquiring lock on /blue/adamginsburg/adamginsburg/almaimf/workdir/G327.29_B6_spw1_12M_sio.contcube.model/table.lock
2021-10-22 22:36:57     WARN    MPICommandServer::command_request_handler_service::SynthesisImagerVi2::CubeMajorCycle::MPIServer-1 (file src/code/synthesis/ImagerObjects/CubeMajorCycleAlgorithm.cc, line 336) Exception for chan range [0, 54] ---   Setting masked pixels to zero for input startmodel : Error (Resource deadlock avoided) when acquiring lock on /blue/adamginsburg/adamginsburg/almaimf/workdir/G327.29_B6_spw1_12M_sio.contcube.model/table.lock
##################################
#############################
Exception: Setting masked pixels to zero for input startmodel : Error (Resource deadlock avoided) when acquiring lock on /blue/adamginsburg/adamginsburg/almaimf/workdir/G327.29_B6_spw1_12M_sio.contcube.model/table.lock
&lt;/pre&gt;
</content><category term="misc"></category><category term="tags"></category></entry><entry><title>Confetti artifacts in clean</title><link href="https://keflavich.github.io/blog/confetti-artifacts-in-clean.html" rel="alternate"></link><published>2021-10-15T10:21:00-06:00</published><updated>2021-10-15T10:21:00-06:00</updated><author><name>Adam Ginsburg (Adam.G.Ginsburg@gmail.com)</name></author><id>tag:keflavich.github.io,2021-10-15:/blog/confetti-artifacts-in-clean.html</id><summary type="html">&lt;p&gt;We have noted a “confetti” problem in some of the ALMA-IMF cube images.
It is called confetti because &lt;em&gt;one&lt;/em&gt; of its manifestations is individual
bright pixels in the model image.&lt;/p&gt;
&lt;p&gt;This notebook shows where confetti is - and is not a problem.&lt;/p&gt;
&lt;p&gt;&lt;a class="reference external" href="https://github.com/ALMA-IMF/notebooks/blob/master/ConfettiQA.ipynb"&gt;https://github.com/ALMA-IMF/notebooks/blob/master/ConfettiQA.ipynb …&lt;/a&gt;&lt;/p&gt;</summary><content type="html">&lt;p&gt;We have noted a “confetti” problem in some of the ALMA-IMF cube images.
It is called confetti because &lt;em&gt;one&lt;/em&gt; of its manifestations is individual
bright pixels in the model image.&lt;/p&gt;
&lt;p&gt;This notebook shows where confetti is - and is not a problem.&lt;/p&gt;
&lt;p&gt;&lt;a class="reference external" href="https://github.com/ALMA-IMF/notebooks/blob/master/ConfettiQA.ipynb"&gt;https://github.com/ALMA-IMF/notebooks/blob/master/ConfettiQA.ipynb&lt;/a&gt;&lt;/p&gt;
&lt;div class="section" id="preliminaries-skip-this"&gt;
&lt;h2&gt;Preliminaries: skip this&lt;/h2&gt;
&lt;pre class="code python literal-block"&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;spectral_cube&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;SpectralCube&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;warnings&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="n"&gt;warnings&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;simplefilter&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'ignore'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;
&lt;pre class="code python literal-block"&gt;
&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;matplotlib&lt;/span&gt; &lt;span class="n"&gt;inline&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;pylab&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;pl&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;astropy.visualization&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;simple_norm&lt;/span&gt;
&lt;/pre&gt;
&lt;pre class="code python literal-block"&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;astropy&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;units&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;u&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="g008-67-continuum"&gt;
&lt;h2&gt;G008.67 Continuum&lt;/h2&gt;
&lt;p&gt;This is the G008.67 continuum image in Band 3.&lt;/p&gt;
&lt;p&gt;It has “confetti” pieces in the model image, but there is no problem: no
artificial point sources are introduced.&lt;/p&gt;
&lt;pre class="code python literal-block"&gt;
&lt;span class="n"&gt;contmodel&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;SpectralCube&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'/orange/adamginsburg/ALMA_IMF/2017.1.01355.L/imaging_results/G008.67_B3_uid___A001_X1296_X1c1_continuum_merged_12M_robust-0.5_selfcal5_finaliter.model.tt0'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;format&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'casa_image'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="n"&gt;contimage&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;SpectralCube&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'/orange/adamginsburg/ALMA_IMF/2017.1.01355.L/imaging_results/G008.67_B3_uid___A001_X1296_X1c1_continuum_merged_12M_robust-0.5_selfcal5_finaliter.image.tt0'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;format&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'casa_image'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="n"&gt;contresid&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;SpectralCube&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'/orange/adamginsburg/ALMA_IMF/2017.1.01355.L/imaging_results/G008.67_B3_uid___A001_X1296_X1c1_continuum_merged_12M_robust-0.5_selfcal5_finaliter.residual.tt0'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;format&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'casa_image'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;
&lt;pre class="code python literal-block"&gt;
&lt;span class="c1"&gt;# zoom in&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="n"&gt;contslc&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;slice&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;950&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1050&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="nb"&gt;slice&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1900&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2050&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;
&lt;pre class="code python literal-block"&gt;
&lt;span class="n"&gt;pl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;15&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;15&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="n"&gt;pl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;imshow&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;contmodel&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;contslc&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;simple_norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;contmodel&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;contslc&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;max_percent&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;99.995&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;stretch&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'asinh'&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;interpolation&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'none'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;origin&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'lower'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="n"&gt;_&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;pl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;title&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;model&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/output_8_0.png" /&gt;
&lt;pre class="code python literal-block"&gt;
&lt;span class="n"&gt;pl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;15&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;15&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="n"&gt;im&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;contimage&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;contslc&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:]]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="n"&gt;pl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;imshow&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;im&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;simple_norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;im&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;stretch&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'log'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;max_percent&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;99.995&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;interpolation&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'none'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="n"&gt;origin&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'lower'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="n"&gt;_&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;pl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;title&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;image&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/output_9_0.png" /&gt;
&lt;pre class="code python literal-block"&gt;
&lt;span class="n"&gt;pl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;15&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;15&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="n"&gt;im&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;contresid&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;contslc&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:]]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="n"&gt;pl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;imshow&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;im&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;simple_norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;im&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;stretch&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'linear'&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;interpolation&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'none'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="n"&gt;origin&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'lower'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="n"&gt;_&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;pl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;title&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Residual&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/output_10_0.png" /&gt;
&lt;div class="section" id="g008-67-cube"&gt;
&lt;h3&gt;G008.67 Cube&lt;/h3&gt;
&lt;p&gt;The G008.67 cube &lt;em&gt;does&lt;/em&gt; have a problem!&lt;/p&gt;
&lt;pre class="code python literal-block"&gt;
&lt;span class="n"&gt;cube&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;SpectralCube&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'/orange/adamginsburg/ALMA_IMF/2017.1.01355.L/imaging_results/G008.67_B3_spw0_12M_n2hp.image'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;format&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'casa_image'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;with_spectral_unit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;km&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;velocity_convention&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'radio'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="n"&gt;resid&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;SpectralCube&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'/orange/adamginsburg/ALMA_IMF/2017.1.01355.L/imaging_results/G008.67_B3_spw0_12M_n2hp.residual'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;format&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'casa_image'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;with_spectral_unit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;km&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;velocity_convention&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'radio'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="n"&gt;model&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;SpectralCube&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'/orange/adamginsburg/ALMA_IMF/2017.1.01355.L/imaging_results/G008.67_B3_spw0_12M_n2hp.model'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;format&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'casa_image'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;with_spectral_unit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;km&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;velocity_convention&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'radio'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;
&lt;pre class="code python literal-block"&gt;
&lt;span class="n"&gt;xslc&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;slice&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1620&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1654&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="n"&gt;yslc&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;slice&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;709&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;743&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="n"&gt;cubeslice&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;slice&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;yslc&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;xslc&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="n"&gt;cube1slice&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;98&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;yslc&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;xslc&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="confetti-a-false-point-source"&gt;
&lt;h2&gt;Confetti: a false (?) point source&lt;/h2&gt;
&lt;p&gt;In the image below, we see a new source introduced in the 35.140 km/s
panel.&lt;/p&gt;
&lt;p&gt;There is no comparable source in either of the adjacent panels!&lt;/p&gt;
&lt;p&gt;That means either there is a genuinely pointlike source with linewidth
much narrower than 0.77 km/s, or this source is fake.&lt;/p&gt;
&lt;pre class="code python literal-block"&gt;
&lt;span class="n"&gt;specpix&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;arange&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;94&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;94&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;9&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="n"&gt;panels&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;cube&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cubeslice&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot_channel_maps&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;specpix&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fig_smallest_dim_inches&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;15&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;simple_norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cube&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cube1slice&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/output_15_0.png" /&gt;
&lt;p&gt;It is caused by one hot (bright) pixel surrounded by many faint pixels&lt;/p&gt;
&lt;pre class="code python literal-block"&gt;
&lt;span class="n"&gt;panels&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;model&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cubeslice&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot_channel_maps&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;specpix&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fig_smallest_dim_inches&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;15&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;simple_norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;model&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cube1slice&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;stretch&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'log'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;max_percent&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;99.93&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/output_17_0.png" /&gt;
&lt;p&gt;There is no sign of it in the residual - it is apparently canceled out
between positive and negative components added to the model&lt;/p&gt;
&lt;pre class="code python literal-block"&gt;
&lt;span class="n"&gt;panels&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;resid&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cubeslice&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot_channel_maps&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;specpix&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fig_smallest_dim_inches&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;15&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/output_19_0.png" /&gt;
&lt;p&gt;The manifestation in the spectra is a very sharp peak at just one pixel.&lt;/p&gt;
&lt;pre class="code python literal-block"&gt;
&lt;span class="n"&gt;pl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;14&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="n"&gt;xx&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;yy&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1638&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;725&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="n"&gt;cube&lt;/span&gt;&lt;span class="p"&gt;[:,&lt;/span&gt;&lt;span class="n"&gt;yy&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;xx&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;quicklook&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="n"&gt;resid&lt;/span&gt;&lt;span class="p"&gt;[:,&lt;/span&gt;&lt;span class="n"&gt;yy&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;xx&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;quicklook&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="n"&gt;modspec&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;model&lt;/span&gt;&lt;span class="p"&gt;[:,&lt;/span&gt;&lt;span class="n"&gt;yy&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;xx&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="n"&gt;pl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cube&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;spectral_axis&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;modspec&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;cube&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pixels_per_beam&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'model'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/output_21_1.png" /&gt;
&lt;p&gt;Pixels to either side look fine&lt;/p&gt;
&lt;pre class="code python literal-block"&gt;
&lt;span class="n"&gt;pl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;14&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;14&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="n"&gt;ii&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;dx&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;dy&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;        &lt;span class="n"&gt;ax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ii&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;        &lt;span class="n"&gt;ii&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;        &lt;span class="n"&gt;cube&lt;/span&gt;&lt;span class="p"&gt;[:,&lt;/span&gt;&lt;span class="n"&gt;yy&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;dy&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;xx&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;quicklook&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;        &lt;span class="n"&gt;resid&lt;/span&gt;&lt;span class="p"&gt;[:,&lt;/span&gt;&lt;span class="n"&gt;yy&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;dy&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;xx&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;quicklook&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;        &lt;span class="n"&gt;modspec&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;model&lt;/span&gt;&lt;span class="p"&gt;[:,&lt;/span&gt;&lt;span class="n"&gt;yy&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;dy&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;xx&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;        &lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cube&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;spectral_axis&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;modspec&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;cube&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pixels_per_beam&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'model'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;        &lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_title&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;f&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;dx=&lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt; dy=&lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="n"&gt;dy&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/output_23_0.png" /&gt;
&lt;div class="section" id="when-is-confetti-not-a-problem"&gt;
&lt;h3&gt;When is confetti &lt;em&gt;not&lt;/em&gt; a problem?&lt;/h3&gt;
&lt;p&gt;Here is an example you might think is “confetti”, but is a &lt;em&gt;real&lt;/em&gt; source&lt;/p&gt;
&lt;pre class="code python literal-block"&gt;
&lt;span class="n"&gt;xc&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;yc&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1812&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;905&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="n"&gt;xslc&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;slice&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;xc&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;xc&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="n"&gt;yslc&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;slice&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;yc&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;yc&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="n"&gt;cubeslice&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;slice&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;94&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;94&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;9&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;yslc&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;xslc&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="n"&gt;cube1slice&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;94&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;yslc&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;xslc&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;
&lt;pre class="code python literal-block"&gt;
&lt;span class="n"&gt;specpix&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;arange&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;9&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="n"&gt;panels&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;cube&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cubeslice&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot_channel_maps&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;specpix&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fig_smallest_dim_inches&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;15&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;simple_norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cube&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cube1slice&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;min_cut&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;cube&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cubeslice&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;min&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;max_cut&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;cube&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cubeslice&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;max&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;stretch&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'linear'&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/output_26_0.png" /&gt;
&lt;pre class="code python literal-block"&gt;
&lt;span class="n"&gt;panels&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;model&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cubeslice&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot_channel_maps&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;specpix&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fig_smallest_dim_inches&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;15&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;simple_norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;model&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cube1slice&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;stretch&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'asinh'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;max_percent&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;99.9&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;min_cut&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;model&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cubeslice&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;min&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;max_cut&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;model&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cubeslice&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;max&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/output_27_0.png" /&gt;
&lt;pre class="code python literal-block"&gt;
&lt;span class="n"&gt;panels&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;resid&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cubeslice&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot_channel_maps&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;specpix&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fig_smallest_dim_inches&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;15&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/output_28_0.png" /&gt;
&lt;pre class="code python literal-block"&gt;
&lt;span class="n"&gt;pl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;14&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;14&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="n"&gt;ii&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;dx&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;dy&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;        &lt;span class="n"&gt;ax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ii&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;        &lt;span class="n"&gt;ii&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;        &lt;span class="n"&gt;cube&lt;/span&gt;&lt;span class="p"&gt;[:,&lt;/span&gt;&lt;span class="n"&gt;yc&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;dy&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;xc&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;quicklook&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;        &lt;span class="n"&gt;resid&lt;/span&gt;&lt;span class="p"&gt;[:,&lt;/span&gt;&lt;span class="n"&gt;yc&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;dy&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;xc&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;quicklook&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;        &lt;span class="n"&gt;modspec&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;model&lt;/span&gt;&lt;span class="p"&gt;[:,&lt;/span&gt;&lt;span class="n"&gt;yc&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;dy&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;xc&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;        &lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cube&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;spectral_axis&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;modspec&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;cube&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pixels_per_beam&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'model'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;        &lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_title&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;f&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;dx=&lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt; dy=&lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="n"&gt;dy&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/output_29_0.png" /&gt;
&lt;/div&gt;
&lt;div class="section" id="conclusion"&gt;
&lt;h3&gt;Conclusion&lt;/h3&gt;
&lt;p&gt;“Confetti” is a problem, but it is not trivial to find in the model data
alone. It exhibits no features in the residual.&lt;/p&gt;
&lt;p&gt;Key features to look out for are:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Narrow-line features (single channel)&lt;/li&gt;
&lt;li&gt;Extremely bright pointlike peaks in the model (note that this is
&lt;em&gt;not&lt;/em&gt; independent evidence of a problem! All point sources occupy
single pixels in the model image by definition!)&lt;/li&gt;
&lt;li&gt;Bright pointlike peaks sitting on top of slightly extended negative
backgrounds in the model (this is how the model is “canceled out” in
the residual)&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
</content><category term="misc"></category><category term="CASA"></category></entry><entry><title>casa's plotms in a notebook</title><link href="https://keflavich.github.io/blog/casas-plotms-in-a-notebook.html" rel="alternate"></link><published>2021-06-14T12:30:00-06:00</published><updated>2021-06-14T12:30:00-06:00</updated><author><name>Adam Ginsburg (Adam.G.Ginsburg@gmail.com)</name></author><id>tag:keflavich.github.io,2021-06-14:/blog/casas-plotms-in-a-notebook.html</id><summary type="html">&lt;p&gt;CASA's plotms requires an X11 frontend to work properly, so you either need to run it with xvfb or
with X.&lt;/p&gt;
&lt;p&gt;I want to just make UV data plots in jupyter notebooks.&lt;/p&gt;
&lt;p&gt;This is harder than it sounds, particularly for concatenated data sets.&lt;/p&gt;
&lt;p&gt;First step is that you need to …&lt;/p&gt;</summary><content type="html">&lt;p&gt;CASA's plotms requires an X11 frontend to work properly, so you either need to run it with xvfb or
with X.&lt;/p&gt;
&lt;p&gt;I want to just make UV data plots in jupyter notebooks.&lt;/p&gt;
&lt;p&gt;This is harder than it sounds, particularly for concatenated data sets.&lt;/p&gt;
&lt;p&gt;First step is that you need to assemble the metadata:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;msmd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;scvis&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;scsum&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;msmd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;summary&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;msmd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The resulting &lt;tt class="docutils literal"&gt;scsum&lt;/tt&gt; is a nested dictionary containing a ton of information.
We need only some of it.&lt;/p&gt;
&lt;p&gt;To get out some flattened information, such as the &amp;quot;data description IDs&amp;quot; associated
with data that are actually in my concatenated MS (in my case, 8 of 11 observation blocks
in the metadata are not present in the data), this tool gets and flattens the resulting
information:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;walk_summary&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;summary&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nb"&gt;isinstance&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;summary&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;dict&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;key&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;summary&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;summary&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
            &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                &lt;span class="n"&gt;result&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;walk_summary&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;summary&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;kk&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;kk&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;summary&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
                &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                    &lt;span class="n"&gt;result&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;unique&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;result&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="ow"&gt;is&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
                    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;result&lt;/span&gt;
                &lt;span class="k"&gt;except&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;result&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="ow"&gt;is&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
        &lt;span class="k"&gt;except&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="ne"&gt;KeyError&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="ne"&gt;TypeError&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Then we grab the usable observation and data description IDs:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;obsids&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;key&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;key&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;scsum&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;observationID&amp;#39;&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;key&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="n"&gt;scsum&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="p"&gt;{}]&lt;/span&gt;
&lt;span class="n"&gt;ddids&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;walk_summary&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;scsum&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;data description IDs&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Now we have to load the actual data.  I needed to create new versions of the &lt;tt class="docutils literal"&gt;mstool&lt;/tt&gt; each time
because I was getting weird errors where &lt;tt class="docutils literal"&gt;ms.close()&lt;/tt&gt; followed by &lt;tt class="docutils literal"&gt;ms.open(fn)&lt;/tt&gt; was not properly
resetting, which resulted in &lt;tt class="docutils literal"&gt;ms.getdata&lt;/tt&gt; returning the same data for two different MSes - BAD!&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;ms6&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mstool&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;ms6&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;scvis&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;scdata_all&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{}&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;ddid&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;ddids&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;ms6&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;selectinit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ddid&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;reset&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;ms6&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;selectinit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ddid&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;scdata_all&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ddid&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ms6&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;getdata&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;amplitude&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;weight&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;uvdist&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;axis_info&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;flag&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;corrected_amplitude&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;ifraxis&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;ms6&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Then plotting is a hassle, but at least is not insane - it's just normal array manipulation:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;pl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;colors&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;itertools&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cycle&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rcParams&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;axes.prop_cycle&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;by_key&lt;/span&gt;&lt;span class="p"&gt;()[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;color&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;key&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;scdata_all&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="c1"&gt;# the keys are SPW numbers from the multi-MS file&lt;/span&gt;
    &lt;span class="n"&gt;weight&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;scdata_all&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;weight&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="n"&gt;uvd&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;scdata_all&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;uvdist&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="n"&gt;pl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;semilogy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;uvd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ravel&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;weight&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;reshape&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;weight&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;uvd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;color&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;next&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;colors&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;pl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;loc&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;best&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;pl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;UV Distance (m)&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;pl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Weight&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;That is basically equivalent to &lt;tt class="docutils literal"&gt;plotms(vis, &lt;span class="pre"&gt;xaxis='uvdist',&lt;/span&gt; &lt;span class="pre"&gt;yaxis='weight',&lt;/span&gt; &lt;span class="pre"&gt;coloraxis='spw')&lt;/span&gt;&lt;/tt&gt;.  It's just slightly more flexible, since
you can also make waterfall plots, etc.&lt;/p&gt;
&lt;p&gt;Selecting along various axes, like antenna, gets tricky.  You'd rather not go back to &lt;tt class="docutils literal"&gt;ms.getdata&lt;/tt&gt; because it is _slow_.&lt;/p&gt;
&lt;p&gt;The &amp;quot;identifying baselines&amp;quot; step that you can do in plotms can be achieved through normal boolean array selection, with a result that's somewhat easier to read than CASA's logger:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;highwt&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;scdata_all&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;56&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;weight&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="mf"&gt;1e5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;scdata_all&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;56&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;axis_info&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;ifr_axis&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;ifr_name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;highwt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;any&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;axis&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;))]&lt;/span&gt;
&lt;span class="c1"&gt;# array([&amp;#39;DA41-DV12&amp;#39;, &amp;#39;DA42-DV12&amp;#39;, &amp;#39;DA43-DV12&amp;#39;, &amp;#39;DA44-DV12&amp;#39;, &amp;#39;DA45-DV12&amp;#39;,&lt;/span&gt;
&lt;span class="c1"&gt;#  &amp;#39;DA46-DV12&amp;#39;, &amp;#39;DA47-DV12&amp;#39;, &amp;#39;DA48-DV12&amp;#39;, &amp;#39;DA49-DV12&amp;#39;, &amp;#39;DA50-DV12&amp;#39;,&lt;/span&gt;
&lt;span class="c1"&gt;#  &amp;#39;DA51-DV12&amp;#39;, &amp;#39;DA52-DV12&amp;#39;, &amp;#39;DA53-DV12&amp;#39;, &amp;#39;DA54-DV12&amp;#39;, &amp;#39;DA55-DV12&amp;#39;,&lt;/span&gt;
&lt;span class="c1"&gt;#  &amp;#39;DA56-DV12&amp;#39;, &amp;#39;DA57-DV12&amp;#39;, &amp;#39;DA58-DV12&amp;#39;, &amp;#39;DA60-DV12&amp;#39;, &amp;#39;DA61-DV12&amp;#39;,&lt;/span&gt;
&lt;span class="c1"&gt;#  &amp;#39;DA62-DV12&amp;#39;, &amp;#39;DA63-DV12&amp;#39;, &amp;#39;DA64-DV12&amp;#39;, &amp;#39;DA65-DV12&amp;#39;, &amp;#39;DV01-DV12&amp;#39;,&lt;/span&gt;
&lt;span class="c1"&gt;#  &amp;#39;DV02-DV12&amp;#39;, &amp;#39;DV03-DV12&amp;#39;, &amp;#39;DV04-DV12&amp;#39;, &amp;#39;DV05-DV12&amp;#39;, &amp;#39;DV06-DV12&amp;#39;,&lt;/span&gt;
&lt;span class="c1"&gt;#  &amp;#39;DV07-DV12&amp;#39;, &amp;#39;DV08-DV12&amp;#39;, &amp;#39;DV09-DV12&amp;#39;, &amp;#39;DV10-DV12&amp;#39;, &amp;#39;DV11-DV12&amp;#39;,&lt;/span&gt;
&lt;span class="c1"&gt;#  &amp;#39;DV12-DV14&amp;#39;, &amp;#39;DV12-DV16&amp;#39;, &amp;#39;DV12-DV17&amp;#39;, &amp;#39;DV12-DV19&amp;#39;, &amp;#39;DV12-DV20&amp;#39;,&lt;/span&gt;
&lt;span class="c1"&gt;#  &amp;#39;DV12-DV21&amp;#39;, &amp;#39;DV12-DV22&amp;#39;, &amp;#39;DV12-DV23&amp;#39;, &amp;#39;DV12-DV24&amp;#39;, &amp;#39;DV12-DV25&amp;#39;],&lt;/span&gt;
&lt;span class="c1"&gt;# dtype=&amp;#39;&amp;lt;U16&amp;#39;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;in this case, the output shows that DV12 is clearly the antenna that's overweighted.&lt;/p&gt;
&lt;p&gt;Handling flags is tricky.  The 'weight' array has shape &lt;tt class="docutils literal"&gt;[2,nbaseline,ntime]&lt;/tt&gt;, but I don't know if that 2 refers to frequency
or polarization, since I have two of each and there is no information about this in the &lt;tt class="docutils literal"&gt;axis_info&lt;/tt&gt; dictionary.  So... I'm
doing the conservative thing and ignoring any row of frequency or polarization if _any_ of the data are flagged.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;pl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;colors&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;itertools&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cycle&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rcParams&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;axes.prop_cycle&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;by_key&lt;/span&gt;&lt;span class="p"&gt;()[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;color&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;key&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;scdata_all&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;weight&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;scdata_all&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;weight&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="n"&gt;uvd&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;scdata_all&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;uvdist&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="n"&gt;flag&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;scdata_all&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;flag&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="n"&gt;okflag&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;~&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;any&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;flag&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;axis&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
    &lt;span class="n"&gt;pl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;semilogy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;uvd&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;okflag&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;weight&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;reshape&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;weight&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;uvd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;okflag&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ravel&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="p"&gt;:],&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;color&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;next&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;colors&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;pl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;loc&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;best&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;_&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;pl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;UV Distance (m)&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;_&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;pl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Weight&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;And, indeed, doing this revealed that the super-high-weight antenna was already flagged out.&lt;/p&gt;
&lt;p&gt;This has been a demo of how to do some stuff with CASA to replicate plotms&lt;/p&gt;
&lt;div class="section" id="errors"&gt;
&lt;h2&gt;Errors&lt;/h2&gt;
&lt;p&gt;Along the way, I hit a ton of errors I didn't understand, so I need a record of what they mean.&lt;/p&gt;
&lt;div class="section" id="data-shape-varies-selecting-first-data-desc-id-only"&gt;
&lt;h3&gt;&amp;quot;Data shape varies, selecting first data desc id only&amp;quot;&lt;/h3&gt;
&lt;p&gt;This is the worst.  It means that you have a multi-ms file (mms) that has been produced by &lt;tt class="docutils literal"&gt;concat&lt;/tt&gt;.  It is therefore doing something &lt;em&gt;explicitly wrong&lt;/em&gt; and returning only the first data description ID.&lt;/p&gt;
&lt;p&gt;Data description IDs are super counterintuitive.  They refer, afaict, to SPW numbers.  If you have an MMS with unmerged SPWs (same frequency, but you didn't merge them because of tolerances or something),
each SPW will correspond to a single observation ID.&lt;/p&gt;
&lt;p&gt;The solution is to explicitly &lt;tt class="docutils literal"&gt;ms.selectinit&lt;/tt&gt;, i.e.:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vis&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;selectinit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;datadescid&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;# note: &amp;quot;reset=True&amp;quot; appears to _override_ the selection&lt;/span&gt;
&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;select&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;...&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;# use this as needed&lt;/span&gt;
&lt;span class="n"&gt;data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;getdata&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;...&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;but &lt;tt class="docutils literal"&gt;datadescid&lt;/tt&gt; is _not_ the observation ID.  It's just... some number you need to get from the metadata.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="mismatched-data-shapes-when-comparing-two-mses"&gt;
&lt;h3&gt;Mismatched data shapes when comparing two MSes&lt;/h3&gt;
&lt;p&gt;I got into this whole thing because I wanted to compare the data in two MSes to determine where we went wrong (we did go wrong).&lt;/p&gt;
&lt;p&gt;Unfortunately, somewhere along the way, the autocorrelations got dropped.  I don't know how it happened because I never did it
(but I wish I had earlier), but that means that now the data shapes are mismatched.&lt;/p&gt;
&lt;p&gt;The solution was to use &lt;tt class="docutils literal"&gt;ms.select&lt;/tt&gt; and explicitly downselect to the baselines from MS #1 in MS #2 using MS #1's &lt;tt class="docutils literal"&gt;axis_info&lt;/tt&gt;: &lt;tt class="docutils literal"&gt;{'ifr_number': &lt;span class="pre"&gt;scdata['axis_info']['ifr_axis']['ifr_number']}&lt;/span&gt;&lt;/tt&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;ms3&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mstool&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;ms3&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;newvis&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;ms3&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;selectinit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;80&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;# 80? what the hell kind of datadescid is that?!&lt;/span&gt;
&lt;span class="n"&gt;ms3&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;select&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;ifr_number&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;scdata&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;axis_info&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;ifr_axis&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;ifr_number&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]})&lt;/span&gt;
&lt;span class="n"&gt;newdata&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ms3&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;getdata&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;amplitude&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;uvdist&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;axis_info&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;corrected_amplitude&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;ifraxis&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;ms3&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;newdata&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;keys&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;That downselected the baselines to match the baselines present in &lt;tt class="docutils literal"&gt;scdata&lt;/tt&gt;, which was MS 1.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="the-wrong-data-are-showing-up-when-i-open-a-new-ms"&gt;
&lt;h3&gt;The wrong data are showing up when I open a new MS&lt;/h3&gt;
&lt;p&gt;I was comparing several MSes, and sometimes the data looked the same for MSes I was &lt;em&gt;dead certain&lt;/em&gt; were different.
I was right, and the problem was apparently reusing the ms tool.&lt;/p&gt;
&lt;p&gt;I didn't show the import statement above, but it was this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;casatools&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;msmetadata&lt;/span&gt;
&lt;span class="n"&gt;mstool&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ms&lt;/span&gt;
&lt;span class="n"&gt;ms&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;msmd&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;msmetadata&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;If I tried to reuse &lt;tt class="docutils literal"&gt;ms&lt;/tt&gt; as normal, like so:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vis1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;selectinit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;80&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;data1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;getdata&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;...&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vis2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;selectinit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;80&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;data2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;getdata&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;...&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;then I can't say exactly what &lt;tt class="docutils literal"&gt;data1&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;data2&lt;/tt&gt; are, but they weren't the same.&lt;/p&gt;
&lt;p&gt;So, instead, I created a new &lt;tt class="docutils literal"&gt;mstool&lt;/tt&gt; instance each time:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mstool&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vis1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;selectinit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;80&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;data1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;getdata&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;...&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="n"&gt;ms&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mstool&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vis2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;selectinit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;80&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;data2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;getdata&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;...&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="put-all-together"&gt;
&lt;h2&gt;Put all together...&lt;/h2&gt;
&lt;p&gt;Here's some code to loop over a list of MSes and plot both amp and weight vs. uvdist for the field W43-MM3.&lt;/p&gt;
&lt;p&gt;Of course this crashed immediately because it exceeded the available memory.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;vis&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;mses&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;msmd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vis&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;vissum&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;msmd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;summary&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;msmd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

    &lt;span class="n"&gt;vobsids&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;key&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;key&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;vissum&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;observationID&amp;#39;&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;key&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="n"&gt;vissum&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="p"&gt;{}]&lt;/span&gt;
    &lt;span class="n"&gt;vddids&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;walk_summary&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vissum&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;data description IDs&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;fids&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;where&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vissum&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;fields&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;W43-MM3&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;f&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;obsids: &lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="n"&gt;vobsids&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;, ddids: &lt;/span&gt;&lt;span class="si"&gt;{&lt;/span&gt;&lt;span class="n"&gt;vddids&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="n"&gt;ms&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mstool&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vis&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;msdata_all&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{}&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;ddid&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;vddids&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;selectinit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ddid&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;reset&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;selectinit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ddid&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;select&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;field_id&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;fids&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt;
        &lt;span class="n"&gt;msdata_all&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ddid&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;getdata&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;amplitude&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;weight&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;uvdist&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;axis_info&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;flag&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;corrected_amplitude&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;ifraxis&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

    &lt;span class="n"&gt;colors&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;itertools&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cycle&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rcParams&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;axes.prop_cycle&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;by_key&lt;/span&gt;&lt;span class="p"&gt;()[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;color&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
    &lt;span class="n"&gt;pl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;

    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;key&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;msdata_all&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;weight&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;msdata_all&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;weight&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
        &lt;span class="n"&gt;uvd&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;msdata_all&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;uvdist&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
        &lt;span class="n"&gt;flag&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;msdata_all&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;flag&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
        &lt;span class="n"&gt;okflag&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;~&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;any&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;flag&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;axis&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
        &lt;span class="n"&gt;pl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;semilogy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;uvd&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;okflag&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;weight&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;reshape&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;weight&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;uvd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;okflag&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ravel&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="p"&gt;:],&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;color&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;next&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;colors&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;pl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;loc&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;best&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;pl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_title&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vis&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;_&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;pl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;UV Distance (m)&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;_&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;pl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Weight&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="n"&gt;colors&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;itertools&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cycle&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rcParams&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;axes.prop_cycle&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;by_key&lt;/span&gt;&lt;span class="p"&gt;()[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;color&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
    &lt;span class="n"&gt;pl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;

    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;key&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;msdata_all&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;amp&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;msdata_all&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;amplitude&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
        &lt;span class="n"&gt;uvd&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;msdata_all&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;uvdist&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
        &lt;span class="n"&gt;flag&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;msdata_all&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;flag&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
        &lt;span class="n"&gt;okflag&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;~&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;any&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;flag&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;axis&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
        &lt;span class="n"&gt;pl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;uvd&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;okflag&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;amp&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;reshape&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;amp&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;amp&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;uvd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;okflag&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ravel&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="p"&gt;:],&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;color&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;next&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;colors&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;pl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;loc&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;best&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;pl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_title&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vis&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;_&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;pl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;UV Distance (m)&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;_&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;pl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Amplitude&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
</content><category term="misc"></category><category term="casa"></category></entry><entry><title>Reading a getsf catalog</title><link href="https://keflavich.github.io/blog/reading-a-getsf-catalog.html" rel="alternate"></link><published>2021-05-15T21:23:00-06:00</published><updated>2021-05-15T21:23:00-06:00</updated><author><name>Adam Ginsburg (Adam.G.Ginsburg@gmail.com)</name></author><id>tag:keflavich.github.io,2021-05-15:/blog/reading-a-getsf-catalog.html</id><content type="html">&lt;p&gt;To read a &lt;a class="reference external" href="http://irfu.cea.fr/Pisp/alexander.menshchikov/#method"&gt;getsf&lt;/a&gt; catalog, you can do:&lt;/p&gt;
&lt;pre class="code python literal-block"&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;astropy.io&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;ascii&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="n"&gt;cat&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ascii&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'getsf.cat'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;data_start&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;format&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'commented_header'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;header_start&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;110&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;comment&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;\&lt;span class="s2"&gt;&amp;quot;!&lt;/span&gt;&lt;span class="se"&gt;\&amp;quot;&lt;/span&gt;&lt;span class="s2"&gt;)&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;though &lt;tt class="docutils literal"&gt;header_start&lt;/tt&gt; may be different; I've seen 110 and 120 at least.&lt;/p&gt;
</content><category term="misc"></category><category term="getsf"></category></entry><entry><title>Determing ALMA Array Configurations</title><link href="https://keflavich.github.io/blog/determing-alma-array-configurations.html" rel="alternate"></link><published>2021-04-27T08:51:00-06:00</published><updated>2021-04-27T08:51:00-06:00</updated><author><name>Adam Ginsburg (Adam.G.Ginsburg@gmail.com)</name></author><id>tag:keflavich.github.io,2021-04-27:/blog/determing-alma-array-configurations.html</id><summary type="html">&lt;p&gt;ALMA's named array configurations are not accessible through CASA.
They are available from &lt;a class="reference external" href="https://almascience.eso.org/observing/observing-configuration-schedule/prior-cycle-observing-and-configuration-schedule"&gt;https://almascience.eso.org/observing/observing-configuration-schedule/prior-cycle-observing-and-configuration-schedule&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;This snippet will let you grab the tables and create a mapping from date to array config name.&lt;/p&gt;
&lt;p&gt;However, it's a HUGE waste of time, because these data are stored …&lt;/p&gt;</summary><content type="html">&lt;p&gt;ALMA's named array configurations are not accessible through CASA.
They are available from &lt;a class="reference external" href="https://almascience.eso.org/observing/observing-configuration-schedule/prior-cycle-observing-and-configuration-schedule"&gt;https://almascience.eso.org/observing/observing-configuration-schedule/prior-cycle-observing-and-configuration-schedule&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;This snippet will let you grab the tables and create a mapping from date to array config name.&lt;/p&gt;
&lt;p&gt;However, it's a HUGE waste of time, because these data are stored directly in the MS!&lt;/p&gt;
&lt;p&gt;This is the right way:&lt;/p&gt;
&lt;pre class="code python literal-block"&gt;
&lt;span class="n"&gt;tb&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vis&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="s1"&gt;'/ASDM_EXECBLOCK'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="n"&gt;tb&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;getcol&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'configName'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="c1"&gt;# array(['C43-3'], dtype='&amp;lt;U16')&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;This is the hacky, reconstructed from the website, bad way:&lt;/p&gt;
&lt;pre class="code python literal-block"&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;requests&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;bs4&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;BeautifulSoup&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;astropy.table&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Table&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vstack&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;astropy.io&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;ascii&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;astropy.time&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Time&lt;/span&gt;&lt;span class="w"&gt;

&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;https://almascience.eso.org/observing/observing-configuration-schedule/prior-cycle-observing-and-configuration-schedule&amp;quot;&lt;/span&gt;&lt;span class="w"&gt;

&lt;/span&gt;&lt;span class="n"&gt;response&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;requests&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;raise_for_status&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="n"&gt;soup&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;BeautifulSoup&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="n"&gt;tables&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;soup&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;findAll&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'table'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;class_&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;grid listing&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;

&lt;/span&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;clean_lines&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;soup&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;badrows&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'Long Baseline Campaign'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;                               &lt;span class="s1"&gt;'February Maintenance Period'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;                               &lt;span class="s1"&gt;'End of Cycle'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;                               &lt;span class="s1"&gt;'Engineering/Software'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;                               &lt;span class="s1"&gt;'Engineering/Software Time'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;                                   &lt;span class="p"&gt;]):&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tr&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;soup&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'tr'&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nb"&gt;any&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;bad&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tr&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;bad&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;badrows&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;             &lt;span class="n"&gt;_&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;tr&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;extract&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;soup&lt;/span&gt;&lt;span class="w"&gt;

&lt;/span&gt;&lt;span class="n"&gt;tables&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;soup&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;findAll&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'table'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;class_&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;grid listing&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="n"&gt;tables&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ascii&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;clean_lines&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tbl&lt;/span&gt;&lt;span class="p"&gt;)),&lt;/span&gt; &lt;span class="nb"&gt;format&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'html'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tbl&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;tables&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="n"&gt;tables&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;tables&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;][:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="n"&gt;tables&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="s1"&gt;'Block'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;tables&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="s1"&gt;'Block'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;astype&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'int'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="n"&gt;tables&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="s1"&gt;'maximumrecoverablescale2(&amp;quot;)'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;tables&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="s1"&gt;'maximumrecoverablescale2(&amp;quot;)'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;astype&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'str'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;

&lt;/span&gt;&lt;span class="n"&gt;stacked&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;vstack&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tables&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="n"&gt;start_times&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Time&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;stacked&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'Start date'&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="n"&gt;end_times&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Time&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;stacked&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'End date'&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;Then, say you have a list of measurement sets &lt;tt class="docutils literal"&gt;mses&lt;/tt&gt;, you can look up the
array configuration for each date and field.  The choice of &lt;tt class="docutils literal"&gt;fields[0]&lt;/tt&gt; here
only makes sense if your data had a single target; it's a bad choice if there
are multiple targets in a scheduling block:&lt;/p&gt;
&lt;pre class="code python literal-block"&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;json&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;casatools&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;msmetadata&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;span class="n"&gt;msmd&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;msmetadata&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt;

&lt;/span&gt;&lt;span class="n"&gt;results&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{}&lt;/span&gt;&lt;span class="w"&gt;

&lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;vis&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;mses&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;    &lt;span class="n"&gt;msmd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mses&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;    &lt;span class="n"&gt;obstime&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Time&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;msmd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;timerangeforobs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)[&lt;/span&gt;&lt;span class="s1"&gt;'begin'&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="s1"&gt;'m0'&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="s1"&gt;'value'&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="nb"&gt;format&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'mjd'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;    &lt;span class="n"&gt;fieldnames&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;msmd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fieldnames&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;    &lt;span class="n"&gt;fields&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;unique&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fieldnames&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;msmd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fieldsforintent&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'OBSERVE_TARGET#ON_SOURCE'&lt;/span&gt;&lt;span class="p"&gt;)])&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;    &lt;span class="n"&gt;msmd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt;

&lt;/span&gt;    &lt;span class="n"&gt;array_config&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;stacked&lt;/span&gt;&lt;span class="p"&gt;[(&lt;/span&gt;&lt;span class="n"&gt;obstime&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;start_times&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;obstime&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;end_times&lt;/span&gt;&lt;span class="p"&gt;)][&lt;/span&gt;&lt;span class="s1"&gt;'Approx&lt;/span&gt;&lt;span class="se"&gt;\xa0&lt;/span&gt;&lt;span class="s1"&gt;Config.'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;fields&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;results&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;        &lt;span class="n"&gt;results&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;fields&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]][&lt;/span&gt;&lt;span class="n"&gt;obstime&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;strftime&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'%Y-%m-&lt;/span&gt;&lt;span class="si"&gt;%d&lt;/span&gt;&lt;span class="s1"&gt;'&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;array_config&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;    &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;        &lt;span class="n"&gt;results&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;fields&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="n"&gt;obstime&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;strftime&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'%Y-%m-&lt;/span&gt;&lt;span class="si"&gt;%d&lt;/span&gt;&lt;span class="s1"&gt;'&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt; &lt;span class="n"&gt;array_config&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]}&lt;/span&gt;&lt;span class="w"&gt;

&lt;/span&gt;&lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'array_configurations.json'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'w'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;fh&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;    &lt;span class="n"&gt;json&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dump&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;results&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fh&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;
</content><category term="misc"></category><category term="alma"></category></entry><entry><title>CASA: Logfiles &amp; tclean from pysynthesisimager</title><link href="https://keflavich.github.io/blog/casa-logfiles-tclean-from-pysynthesisimager.html" rel="alternate"></link><published>2020-05-09T14:59:00-06:00</published><updated>2020-05-09T14:59:00-06:00</updated><author><name>Adam Ginsburg (Adam.G.Ginsburg@gmail.com)</name></author><id>tag:keflavich.github.io,2020-05-09:/blog/casa-logfiles-tclean-from-pysynthesisimager.html</id><summary type="html">&lt;p&gt;A few brief notes I don't want to forget, so I'm posting them here:&lt;/p&gt;
&lt;p&gt;The name of the log file being used by the currently active CASA session is in &lt;tt class="docutils literal"&gt;casalog.logfile()&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;I'm trying to get the pysynthesisimager version of tclean to work.  This is, in
theory, &amp;quot;exactly the same …&lt;/p&gt;</summary><content type="html">&lt;p&gt;A few brief notes I don't want to forget, so I'm posting them here:&lt;/p&gt;
&lt;p&gt;The name of the log file being used by the currently active CASA session is in &lt;tt class="docutils literal"&gt;casalog.logfile()&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;I'm trying to get the pysynthesisimager version of tclean to work.  This is, in
theory, &amp;quot;exactly the same thing as tclean&amp;quot;, except you (the user) have the
ability to control individual steps.  The process is documented in the &lt;a class="reference external" href="https://casa.nrao.edu/casadocs-devel/stable/global-task-list/task_tclean/examples"&gt;tclean documentation
under examples&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;However, it is not a one-to-one mapping.  &lt;tt class="docutils literal"&gt;tclean&lt;/tt&gt; is not implemented using the exact script quoted
in the examples.  The differences are the variety that shouldn't matter but inevitably do.&lt;/p&gt;
&lt;p&gt;I'm working on a translation of &lt;tt class="docutils literal"&gt;tclean&lt;/tt&gt;'s input parameters to
&lt;tt class="docutils literal"&gt;pysynthesisimager&lt;/tt&gt;'s, but it's not complete:
&lt;a class="reference external" href="https://gist.github.com/keflavich/a9953c88cbe098b5e9bb4bdac6485f09"&gt;https://gist.github.com/keflavich/a9953c88cbe098b5e9bb4bdac6485f09&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;That was dumb anyway, because
&lt;a class="reference external" href="https://github.com/radio-astro/casa/blob/master/gcwrap/python/scripts/task_tclean.py"&gt;https://github.com/radio-astro/casa/blob/master/gcwrap/python/scripts/task_tclean.py&lt;/a&gt;
does everything I really needed.&lt;/p&gt;
&lt;p&gt;My version saves the image, residual, and model at each major cycle.&lt;/p&gt;
</content><category term="misc"></category><category term="casa"></category></entry><entry><title>CASA Cross-Calibration Application</title><link href="https://keflavich.github.io/blog/casa-cross-calibration-application.html" rel="alternate"></link><published>2019-08-22T13:06:00-06:00</published><updated>2019-08-22T13:06:00-06:00</updated><author><name>Adam Ginsburg (Adam.G.Ginsburg@gmail.com)</name></author><id>tag:keflavich.github.io,2019-08-22:/blog/casa-cross-calibration-application.html</id><summary type="html">&lt;p&gt;On several independent occasions, I've had data where the continuum is bright
enough to self-calibrate, but the lines aren't.  In these cases, I want to apply
the continuum-derived selfcal solutions to the line data.&lt;/p&gt;
&lt;p&gt;In all of these cases, I have several independent execution blocks that I've
split and downsampled …&lt;/p&gt;</summary><content type="html">&lt;p&gt;On several independent occasions, I've had data where the continuum is bright
enough to self-calibrate, but the lines aren't.  In these cases, I want to apply
the continuum-derived selfcal solutions to the line data.&lt;/p&gt;
&lt;p&gt;In all of these cases, I have several independent execution blocks that I've
split and downsampled before combining to make the continuum image.&lt;/p&gt;
&lt;p&gt;I got stuck trying to make this happen, but we reconvened on the topic in early
2021, and Manuel Fernandez and Roberto Galvan-Madrid and I came up with this
tool to match spectral windows in a concatenated data set to the appropriate
windows in the original:
&lt;a class="reference external" href="https://github.com/ALMA-IMF/reduction/blob/master/misc/applycal_tests.py"&gt;https://github.com/ALMA-IMF/reduction/blob/master/misc/applycal_tests.py&lt;/a&gt;&lt;/p&gt;
</content><category term="misc"></category><category term="tags"></category></entry><entry><title>CASA corrupted measurement sets</title><link href="https://keflavich.github.io/blog/casa-corrupted-measurement-sets.html" rel="alternate"></link><published>2019-07-23T13:11:00-06:00</published><updated>2019-07-23T13:11:00-06:00</updated><author><name>Adam Ginsburg (Adam.G.Ginsburg@gmail.com)</name></author><id>tag:keflavich.github.io,2019-07-23:/blog/casa-corrupted-measurement-sets.html</id><summary type="html">&lt;p&gt;Over the weekend, I had a huge quantity of ALMA data get corrupted. The
corruption appears to have been caused by an incorrectly-mounted lustre system
that had &amp;quot;flock&amp;quot; disabled.  When they re-mounted the filesystem, every
measurement set I had touched was unreadable.&lt;/p&gt;
&lt;p&gt;Corrupted data sets had messages like this when …&lt;/p&gt;</summary><content type="html">&lt;p&gt;Over the weekend, I had a huge quantity of ALMA data get corrupted. The
corruption appears to have been caused by an incorrectly-mounted lustre system
that had &amp;quot;flock&amp;quot; disabled.  When they re-mounted the filesystem, every
measurement set I had touched was unreadable.&lt;/p&gt;
&lt;p&gt;Corrupted data sets had messages like this when opened with &lt;tt class="docutils literal"&gt;msmd.open&lt;/tt&gt;:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
RuntimeError: Exception: Illegal DATA_DESC_ID value 30 found in main table. /lustre/cv/projects/ALMA_IMF/2017.1.01355.L/science_goal.uid___A001_X1296_X211/group.uid___A001_X1296_X212/member.uid___A001_X1296_X217/calibrated/uid___A002_Xcbdb2a_X6e67.ms.split.cal/DATA_DESCRIPTION only has 0 rows (IDs).
... thrown by void casa::MSChecker::checkReferentialIntegrity() const at File: ../../msvis/MSVis/MSChecker.cc, line: 78
&lt;/pre&gt;
&lt;p&gt;The solution was to replace all of the &lt;tt class="docutils literal"&gt;table.dat&lt;/tt&gt; files in the
&lt;tt class="docutils literal"&gt;DATA_DESCRIPTION&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;POLARIZATION&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;STATE&lt;/tt&gt;, and &lt;tt class="docutils literal"&gt;PROCESSOR&lt;/tt&gt; folders
with &amp;quot;backups&amp;quot; from the parent measurement set.  Luckily, all of my data were
split from other measurement sets that still existed, and they were split with
&lt;tt class="docutils literal"&gt;reindex=False&lt;/tt&gt;, which meant that these tables were actually usable.  There's
no guarantee they would be in general.&lt;/p&gt;
&lt;p&gt;My fix script is this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;getdata&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;rb&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;fh&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;fh&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;diff&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="n"&gt;ii&lt;/span&gt;&lt;span class="p"&gt;:(&lt;/span&gt;&lt;span class="n"&gt;xx&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;yy&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;ii&lt;/span&gt;&lt;span class="p"&gt;,(&lt;/span&gt;&lt;span class="n"&gt;xx&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;yy&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;zip&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;xx&lt;/span&gt;&lt;span class="o"&gt;!=&lt;/span&gt;&lt;span class="n"&gt;yy&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;fix_bad_mses&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;dirpath&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dirnames&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;filenames&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;walk&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;.&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;fn&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;dirnames&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;fn&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;:]&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;.split.cal&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                &lt;span class="n"&gt;ffn&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dirpath&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fn&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
                &lt;span class="n"&gt;workingfn&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dirpath&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;working&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fn&lt;/span&gt;&lt;span class="p"&gt;[:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;

                &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exists&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;workingfn&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
                    &lt;span class="c1"&gt;#print(&amp;quot;Working on files {0} and {1}&amp;quot;.format(ffn, workingfn))&lt;/span&gt;
                    &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ffn&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

                    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;dn&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;POLARIZATION&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;PROCESSOR&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;DATA_DESCRIPTION&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;STATE&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]:&lt;/span&gt;
                        &lt;span class="n"&gt;tbpth1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ffn&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dn&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;table.dat&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
                        &lt;span class="n"&gt;tbpth2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;workingfn&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dn&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;table.dat&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

                        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exists&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tbpth1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exists&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tbpth2&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
                            &lt;span class="n"&gt;d1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;getdata&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tbpth1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
                            &lt;span class="n"&gt;d2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;getdata&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tbpth2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
                            &lt;span class="n"&gt;delta&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;diff&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;d1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;d2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
                            &lt;span class="c1"&gt;#print(&amp;quot;Diff from {0} to {1} is {2}&amp;quot;.format(tbpth1, tbpth2, delta))&lt;/span&gt;

                            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;delta&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                                &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;FIXING: Diff for &lt;/span&gt;&lt;span class="si"&gt;{0}&lt;/span&gt;&lt;span class="s2"&gt; is &lt;/span&gt;&lt;span class="si"&gt;{1}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dn&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;delta&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
                                &lt;span class="n"&gt;shutil&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;copy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tbpth1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;tbpth1&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;.bck&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
                                &lt;span class="n"&gt;shutil&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;copy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tbpth2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;tbpth1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;which spewed out a bunch of messages like this:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
FIXING: Diff for POLARIZATION is {24: ('\x00', '\x01'), 1059: ('\x00', '\x01')}
FIXING: Diff for PROCESSOR is {24: ('\x00', '\x03'), 1078: ('\x00', '\x03')}
FIXING: Diff for DATA_DESCRIPTION is {24: ('\x00', '\x18'), 772: ('\x00', '\x18')}
FIXING: Diff for STATE is {24: ('\x00', '\x1d'), 1699: ('\x00', '\x1d')}
&lt;/pre&gt;
&lt;p&gt;showing that for each bad file, two bytes were flipped.  I don't know how or why.  Notably, though,
the byte flips that corrupted the data did &lt;em&gt;not&lt;/em&gt; change the file modification date - somehow CASA
hid this operation from the filesystem.&lt;/p&gt;
</content><category term="misc"></category><category term="CASA"></category></entry><entry><title>FeO Nondetection in Orion</title><link href="https://keflavich.github.io/blog/feo-nondetection-in-orion.html" rel="alternate"></link><published>2018-10-14T15:09:00-06:00</published><updated>2018-10-14T15:09:00-06:00</updated><author><name>Adam Ginsburg (Adam.G.Ginsburg@gmail.com)</name></author><id>tag:keflavich.github.io,2018-10-14:/blog/feo-nondetection-in-orion.html</id><summary type="html">&lt;p&gt;I had a Cycle 3 ALMA program &lt;a class="reference external" href="https://almascience.nrao.edu/observing/highest-priority-projects"&gt;2015.1.00262.S:
Digging for rusty bullets at an explosion site&lt;/a&gt;
that aimed to detect &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Iron(II)_oxide"&gt;ferrous oxide, FeO&lt;/a&gt;
in the shocked outflows of the Orion nebula.&lt;/p&gt;
&lt;p&gt;I haven't published anything on this data set because it resulted in a fairly
boring non-detection …&lt;/p&gt;</summary><content type="html">&lt;p&gt;I had a Cycle 3 ALMA program &lt;a class="reference external" href="https://almascience.nrao.edu/observing/highest-priority-projects"&gt;2015.1.00262.S:
Digging for rusty bullets at an explosion site&lt;/a&gt;
that aimed to detect &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Iron(II)_oxide"&gt;ferrous oxide, FeO&lt;/a&gt;
in the shocked outflows of the Orion nebula.&lt;/p&gt;
&lt;p&gt;I haven't published anything on this data set because it resulted in a fairly
boring non-detection.  You can find the source code to retrieve and process
the data from &lt;a class="reference external" href="https://github.com/keflavich/FeO_2015.1.00262.S"&gt;here&lt;/a&gt;.
The nondetection is several orders of magnitude deeper than previous
ones, but to demonstrate this definitively, we need to do some more modeling
work, which my co-I's and I have decided isn't worth the time, since we're
all flooded with very exciting new ALMA data that has interesting detections
in it (see salts soon).&lt;/p&gt;
&lt;p&gt;In brief, we were looking at a location where we know molecules (H2, molecular
hydrogen) and gas-phase iron (Fe II, as seen in in the [Fe II] 1.64 micron lines)
are approximately coincident.  The most likely (and broadly accepted)
explanation is that dust particles are being destroyed (sputtered) in the
high-velocity ($&amp;gt;30$ km/s, up to about $100-200$ km/s) shocks produced in an
outflow.  Since iron in the interstellar medium mostly lives in the cores of
dust grains, we thought it might be released in a molecular form detectable by
ALMA before being split into an atomic, ionized form.&lt;/p&gt;
&lt;p&gt;Despite having a good location and a sensitive observation, we didn't detect
any.  It might mean that iron is mostly in a different molecular form, or it
might mean that when iron gets sputtered out of grains, it never goes into
a molecular form at all, instead dissociating straight into atomic form.&lt;/p&gt;
&lt;p&gt;There are a few things that, with infinite time, I would do with this data set:&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;Come up with a formal upper limit on the FeO abundance.&lt;/li&gt;
&lt;li&gt;Compare the lines we did detect to the outflows and see if we can better
constrain their physical conditions&lt;/li&gt;
&lt;li&gt;Catalog the stars and publish the catalog for comparison to other data sets.
(actually, this is done: &lt;a class="reference external" href="https://github.com/keflavich/FeO_2015.1.00262.S/blob/master/tables/gaussian_fit_table.ipac"&gt;this table&lt;/a&gt;
contains Gaussian fits to each of the stars in the continuum image (&lt;a class="reference external" href="https://github.com/keflavich/FeO_2015.1.00262.S/blob/master/analysis/contsource_centroids.py"&gt;source&lt;/a&gt;).)&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;These figure show the apertures we used to extract spectra and search for the
lines, then the spectra of different species for one of the apertures.  The
background image is the H2 (orange) + FeII (cyan) + K-band (mostly white) I
made for my &lt;a class="reference external" href="http://adsabs.harvard.edu/abs/2015A%26A...579A.130B"&gt;2015 paper with John Bally&lt;/a&gt;.&lt;/p&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/feo/aperture_overlays.png" style="width: 600px;" /&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/feo/BulletHeads4_alllines.png" style="width: 600px;" /&gt;
</content><category term="misc"></category><category term="alma"></category></entry><entry><title>Talks: Now using revealjs</title><link href="https://keflavich.github.io/blog/talks-now-using-revealjs.html" rel="alternate"></link><published>2018-07-08T12:37:00-06:00</published><updated>2018-07-08T12:37:00-06:00</updated><author><name>Adam Ginsburg (Adam.G.Ginsburg@gmail.com)</name></author><id>tag:keflavich.github.io,2018-07-08:/blog/talks-now-using-revealjs.html</id><summary type="html">&lt;p&gt;I'm attempting to wean myself off of Mac-specific technology, inspired by some
impending hardware failures (see below), the not-falling cost of not-improving
hardware, and the lack of budget growth.&lt;/p&gt;
&lt;p&gt;Following a suggestion from &lt;a class="reference external" href="https://github.com/pkgw/"&gt;Peter Williams&lt;/a&gt;, I'm
using reveal.js based on &lt;a class="reference external" href="https://github.com/pkgw/htmltalk"&gt;Peter's template&lt;/a&gt;, which I have previously played with a …&lt;/p&gt;</summary><content type="html">&lt;p&gt;I'm attempting to wean myself off of Mac-specific technology, inspired by some
impending hardware failures (see below), the not-falling cost of not-improving
hardware, and the lack of budget growth.&lt;/p&gt;
&lt;p&gt;Following a suggestion from &lt;a class="reference external" href="https://github.com/pkgw/"&gt;Peter Williams&lt;/a&gt;, I'm
using reveal.js based on &lt;a class="reference external" href="https://github.com/pkgw/htmltalk"&gt;Peter's template&lt;/a&gt;, which I have previously played with a
little with mixed success.  The slid.es editor seems nearly fully featured as a
replacement for keynote, but I quickly dropped it because of its
subscription-only paid features; the cost-benefit analysis is that Keynote is
much cheaper than slid.es for someone like me, since Keynote cost
30 dollars one-time for ~10 years of use, while the minimum usable plan
for slid.es is 10 dollars/month,
or 1200 dollars over the same
period.  If that was the tradeoff I was considering, mac+keynote would be about
the same as linux+slid.es, since I'd be paying a few thousand dollars for the mac.&lt;/p&gt;
&lt;p&gt;I'm taking the somewhat ridiculous approach of raw HTML/CSS editing with the
Chrome inspector as my interactive testing tool.  This is a little tedious
because of the html tagging, but that's honestly not so bad; it lets me do the
hard work with the keyboard instead of the mouse.  The biggest problem is the
learning curve of css, but I look at that as skill and knowledge worth having.
If you don't, this is probably not the approach for you.  I hope, though, that
some day there is a slid.es-like solution that is reasonably priced.&lt;/p&gt;
&lt;p&gt;Another problem is image editing, which was pretty convenient in keynote, but
there are plenty of other decent-to-good image editors out there, e.g., gimp,
preview, etc.  For cropping and opacity, which are most of what you want to do,
css works and can even be tested interactively in the browser.  But, this
should also give more motivation to just make the figures presentation-ready in
the code.&lt;/p&gt;
&lt;p&gt;Anyway, the talks I've created are hosted at github, and they're fully-featured:
you should be able to just click these links and walk through the talks.&lt;/p&gt;
&lt;p&gt;My &amp;quot;Tracing the Flow&amp;quot; invited talk on High Mass Cluster Formation:
&lt;a class="reference external" href="https://keflavich.github.io/talks/HighMassClusterFormation_TracingTheFlow2018.html"&gt;https://keflavich.github.io/talks/HighMassClusterFormation_TracingTheFlow2018.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Some slides for a work meeting on the ALMA-IMF project, with a technical bent:
&lt;a class="reference external" href="https://keflavich.github.io/talks/ALMA_IMF_W51_SgrB2.html"&gt;https://keflavich.github.io/talks/ALMA_IMF_W51_SgrB2.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;If you want the pdf version of either of these, add &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;?print_pdf&lt;/span&gt;&lt;/tt&gt; to the end
of the URL, then use your browser to print and save to pdf.&lt;/p&gt;
&lt;p&gt;Some pictures of the impending failure.  My mac doesn't close any more, and
the charger cable has frayed severely:&lt;/p&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/frayed_adapter.jpg" style="width: 600px;" /&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/lappy_wont_close.jpg" style="width: 600px;" /&gt;
</content><category term="misc"></category><category term="talks"></category><category term="w51"></category><category term="sgrb2"></category><category term="clusters"></category></entry><entry><title>Brief review of cluster formation simulations</title><link href="https://keflavich.github.io/blog/brief-review-of-cluster-formation-simulations.html" rel="alternate"></link><published>2018-06-18T10:32:00-06:00</published><updated>2018-06-18T10:32:00-06:00</updated><author><name>Adam Ginsburg (Adam.G.Ginsburg@gmail.com)</name></author><id>tag:keflavich.github.io,2018-06-18:/blog/brief-review-of-cluster-formation-simulations.html</id><summary type="html">&lt;p&gt;In preparing for an upcoming talk, I'm taking some notes on cluster formation
simulations, and I want to keep these notes available &amp;amp; public so others can
correct anything that's missing.  In particular, I want to note the resolution of
these simulations.&lt;/p&gt;
&lt;dl class="docutils"&gt;
&lt;dt&gt;First, Jim Dale has several long series of papers …&lt;/dt&gt;&lt;/dl&gt;</summary><content type="html">&lt;p&gt;In preparing for an upcoming talk, I'm taking some notes on cluster formation
simulations, and I want to keep these notes available &amp;amp; public so others can
correct anything that's missing.  In particular, I want to note the resolution of
these simulations.&lt;/p&gt;
&lt;dl class="docutils"&gt;
&lt;dt&gt;First, Jim Dale has several long series of papers on cluster formation simulations:&lt;/dt&gt;
&lt;dd&gt;&lt;ul class="first last simple"&gt;
&lt;li&gt;&lt;a class="reference external" href="http://adsabs.harvard.edu/abs/2015NewAR..68....1D"&gt;Review Article&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://adsabs.harvard.edu/abs/2012MNRAS.427.2852D"&gt;Ionization-induced star formation - IV. Triggering in bound clusters&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://adsabs.harvard.edu/abs/2013MNRAS.431.1062D"&gt;Ionization-induced star formation - V. Triggering in partially unbound clusters&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://adsabs.harvard.edu/abs/2018arXiv180404664K"&gt;Kim, Kim, Ostriker 2018&lt;/a&gt; ~240 Msun&lt;/li&gt;
&lt;/ul&gt;
&lt;/dd&gt;
&lt;/dl&gt;
&lt;p&gt;Unfortunately, I stopped taking notes and started focusing on just the talk, so
this ended up quite incomplete.  I'm not going to try to archive this any further...&lt;/p&gt;
&lt;p&gt;If you're interested, instead just see my talk: &lt;a class="reference external" href="https://keflavich.github.io/talks/HighMassClusterFormation_TracingTheFlow2018.html"&gt;https://keflavich.github.io/talks/HighMassClusterFormation_TracingTheFlow2018.html&lt;/a&gt;&lt;/p&gt;
</content><category term="misc"></category><category term="cluster formation"></category></entry><entry><title>Derivation of CO Column Density</title><link href="https://keflavich.github.io/blog/derivation-of-co-column-density.html" rel="alternate"></link><published>2018-04-18T11:10:00-06:00</published><updated>2018-04-18T11:10:00-06:00</updated><author><name>Adam Ginsburg (Adam.G.Ginsburg@gmail.com)</name></author><id>tag:keflavich.github.io,2018-04-18:/blog/derivation-of-co-column-density.html</id><summary type="html">&lt;p&gt;I've regularly had to calculate masses and column densities from CO
isotopologues, as have many others.  I found a textbooklike derivation in my
old notes, so I figured I'd publish them.&lt;/p&gt;
&lt;p&gt;I don't have time to nicely format things now, but the code, associated figures,
and a 3-page tex document …&lt;/p&gt;</summary><content type="html">&lt;p&gt;I've regularly had to calculate masses and column densities from CO
isotopologues, as have many others.  I found a textbooklike derivation in my
old notes, so I figured I'd publish them.&lt;/p&gt;
&lt;p&gt;I don't have time to nicely format things now, but the code, associated figures,
and a 3-page tex document with equations are all here:
&lt;a class="reference external" href="https://github.com/keflavich/co_properties"&gt;https://github.com/keflavich/co_properties&lt;/a&gt;
I'm pretty sure this all comes from a homework assignment in 2007 or 2008, so
it's likely there are errors.&lt;/p&gt;
</content><category term="misc"></category><category term="co"></category><category term="column"></category><category term="calculation"></category></entry><entry><title>The extragalactic view of W51 at 220 and 290 GHz</title><link href="https://keflavich.github.io/blog/the-extragalactic-view-of-w51-at-220-and-290-ghz.html" rel="alternate"></link><published>2017-12-01T11:23:00-07:00</published><updated>2017-12-01T11:23:00-07:00</updated><author><name>Adam Ginsburg (Adam.G.Ginsburg@gmail.com)</name></author><id>tag:keflavich.github.io,2017-12-01:/blog/the-extragalactic-view-of-w51-at-220-and-290-ghz.html</id><summary type="html">&lt;p&gt;These are APEX data covering 5.5' x 5.5' centered on W51 Main:
&lt;a class="reference external" href="https://dataverse.harvard.edu/dataset.xhtml?persistentId=doi:10.7910/DVN/RYEANM"&gt;https://dataverse.harvard.edu/dataset.xhtml?persistentId=doi:10.7910/DVN/RYEANM&lt;/a&gt;
These are calibrated to T_A* units.  APEX telescope efficiencies can be found
here: &lt;a class="reference external" href="http://www.apex-telescope.org/telescope/efficiency/"&gt;http://www.apex-telescope.org/telescope/efficiency/&lt;/a&gt; and are approximately
0 …&lt;/p&gt;</summary><content type="html">&lt;p&gt;These are APEX data covering 5.5' x 5.5' centered on W51 Main:
&lt;a class="reference external" href="https://dataverse.harvard.edu/dataset.xhtml?persistentId=doi:10.7910/DVN/RYEANM"&gt;https://dataverse.harvard.edu/dataset.xhtml?persistentId=doi:10.7910/DVN/RYEANM&lt;/a&gt;
These are calibrated to T_A* units.  APEX telescope efficiencies can be found
here: &lt;a class="reference external" href="http://www.apex-telescope.org/telescope/efficiency/"&gt;http://www.apex-telescope.org/telescope/efficiency/&lt;/a&gt; and are approximately
0.75 at the observed frequencies.&lt;/p&gt;
&lt;p&gt;W51 is at a distance of 5.1 kpc, so this field of view is equivalent to 8.1 pc, or 1.7&amp;quot; at
1 Mpc or 0.33&amp;quot; at 5 Mpc.&lt;/p&gt;
&lt;p&gt;The linewidth is 12.7-15.2 km/s (H2CO 4-3, CO 2-1) FWHM averaged over this full field.&lt;/p&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/w51/gaussfit_h2co4-3_velocity.png" style="width: 200px;" /&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/w51/gaussfit_12co2-1_velocity.png" style="width: 200px;" /&gt;
&lt;p&gt;Images of the spectra, with some lines identified, are shown here (open them in
a new tab to see the full resolution).  The baselines aren't great, but it's
easy to fit a local linear baseline around any of the fairly narrow lines.&lt;/p&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/w51/lineid_avg_W51_12CO_merge.png" style="width: 200px;" /&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/w51/lineid_avg_W51_217GHz_merge.png" style="width: 200px;" /&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/w51/lineid_avg_W51_218GHz_merge.png" style="width: 200px;" /&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/w51/lineid_avg_W51_232GHz_merge.png" style="width: 200px;" /&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/w51/lineid_avg_W51_291GHz_merge.png" style="width: 200px;" /&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/w51/lineid_avg_W51_293GHz_merge.png" style="width: 200px;" /&gt;
&lt;p&gt;The same images, but not zoomed in the y-direction.  Note that 12CO 2-1 is very
near the edge of the band; it peaks around 20 K:&lt;/p&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/w51/avg_W51_12CO_merge.png" style="width: 200px;" /&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/w51/avg_W51_217GHz_merge.png" style="width: 200px;" /&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/w51/avg_W51_218GHz_merge.png" style="width: 200px;" /&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/w51/avg_W51_232GHz_merge.png" style="width: 200px;" /&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/w51/avg_W51_291GHz_merge.png" style="width: 200px;" /&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/w51/avg_W51_293GHz_merge.png" style="width: 200px;" /&gt;
&lt;p&gt;Scripts to obtain the data and process them are here:
&lt;a class="reference external" href="https://github.com/keflavich/W51_APEX_H2CO"&gt;https://github.com/keflavich/W51_APEX_H2CO&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;See the related project by Watanabe et al looking at W51 in the 3mm band:
&lt;a class="reference external" href="http://adsabs.harvard.edu/abs/2017ApJ...845..116W"&gt;http://adsabs.harvard.edu/abs/2017ApJ...845..116W&lt;/a&gt;&lt;/p&gt;
</content><category term="misc"></category><category term="w51"></category><category term="alma"></category><category term="synthetic extragalactic"></category></entry><entry><title>Understanding Millimeter Source Counts</title><link href="https://keflavich.github.io/blog/understanding-millimeter-source-counts.html" rel="alternate"></link><published>2017-10-07T14:48:00-06:00</published><updated>2017-10-07T14:48:00-06:00</updated><author><name>Adam Ginsburg (Adam.G.Ginsburg@gmail.com)</name></author><id>tag:keflavich.github.io,2017-10-07:/blog/understanding-millimeter-source-counts.html</id><summary type="html">&lt;p&gt;A few recent projects (&lt;a class="reference external" href="https://github.com/keflavich/W51_ALMA_2013.1.00308.S"&gt;ALMA W51&lt;/a&gt; and &lt;a class="reference external" href="https://github.com/keflavich/SgrB2_ALMA_3mm_Mosaic/"&gt;ALMA Sgr B2&lt;/a&gt;) have raised
the question: How do we interpret unresolved millimeter sources?&lt;/p&gt;
&lt;p&gt;In the two linked works, I concluded that most of the 1mm and 3mm point sources
we detected with ALMA at D&amp;gt;5 kpc are protostars with dust envelopes …&lt;/p&gt;</summary><content type="html">&lt;p&gt;A few recent projects (&lt;a class="reference external" href="https://github.com/keflavich/W51_ALMA_2013.1.00308.S"&gt;ALMA W51&lt;/a&gt; and &lt;a class="reference external" href="https://github.com/keflavich/SgrB2_ALMA_3mm_Mosaic/"&gt;ALMA Sgr B2&lt;/a&gt;) have raised
the question: How do we interpret unresolved millimeter sources?&lt;/p&gt;
&lt;p&gt;In the two linked works, I concluded that most of the 1mm and 3mm point sources
we detected with ALMA at D&amp;gt;5 kpc are protostars with dust envelopes - i.e.,
they are &amp;quot;Class 0/I&amp;quot;-like sources, but they are generally more luminous (and
therefore more massive) than their local analogs.&lt;/p&gt;
&lt;p&gt;One of the appeals of the dust continuum, the wavelength range from about 0.5
to 2 mm, for studying star formation is that we usually assume that the source
brightness is proportional to the source mass.  For optically thin dust, this
assumption is pretty good.  The (systematic, unmeasurable) uncertainty is, to
first order, just the uncertainty in the dust temperature.&lt;/p&gt;
&lt;p&gt;However, protostellar cores - dust cores that contain a YSO or any luminous
object (whether the luminosity is nuclear or gravitational in nature doesn't
matter) - violate those assumptions.  First, the dust is not isothermal, so the
emission is weighted toward the hotter dust that represents less of the total
mass.  Second, the dust is not necessarily optically thin - a centrally
concentrated source is likely to have a significant optical depth, particularly
at the shorter wavelengths.  Third, once the optically thin assumption is
broken, the source geometry matters; there may be some axes along which the
source is substantially brighter.&lt;/p&gt;
&lt;p&gt;The &lt;a class="reference external" href="https://almascience.nrao.edu/observing/highest-priority-projects#flyout_2017.1.01355.L"&gt;ALMA-IMF program&lt;/a&gt;,
which I am co-leading with Frederique Motte, Patricio Sanhueza, and Fabien Louvet, has the broad goal of
understanding the formation of the IMF in the Galaxy.  In practice, we will
measure some form of 1 mm luminosity function.  In the long term, we may be
able to obtain some additional constraints on the internal temperature
structures of the sources.  The imminence of this large data set motivates the
development of a general systematic analysis tool for assessing the
implications of the mm luminosity function on the underlying mass function.&lt;/p&gt;
&lt;p&gt;In the related &lt;a class="reference external" href="blog/protostellar-mass-functions.html"&gt;Protostellar Mass Functions&lt;/a&gt; post, I implemented the
protostellar mass functions described by &lt;a class="reference external" href="http://adsabs.harvard.edu/abs/2010ApJ...716..167M"&gt;McKee and Offner&lt;/a&gt;.  These functions
provide the mapping between a stellar mass function and a protostellar mass
function given some assumed accretion history.  The assumed accretion histories
for the stars are very simple (in reality, accretion is probably quite
stochastic), but that's fine since it provides something testable.&lt;/p&gt;
&lt;p&gt;I've then tried to follow up by implementing the next step toward producing
something comparable to observables as defined in &lt;a class="reference external" href="http://adsabs.harvard.edu/abs/2011ApJ...736...53O"&gt;Offner and McKee&lt;/a&gt;, but
unfortunately this is a good deal more challenging.  We need a means to map a
protostellar mass to a luminosity, and there is no simple one-to-one function
to do this.&lt;/p&gt;
&lt;div class="section" id="protostellar-evolution-models"&gt;
&lt;h2&gt;Protostellar Evolution Models&lt;/h2&gt;
&lt;p&gt;Several authors have described protostellar evolution models.  They mostly
refer back to &lt;a class="reference external" href="http://adsabs.harvard.edu/abs/1991ApJ...375..288P"&gt;Palla &amp;amp; Stahler I&lt;/a&gt; and &lt;a class="reference external" href="Palla&amp;amp;StahlerII"&gt;II&lt;/a&gt;.  The &lt;a class="reference external" href="Offner+2009"&gt;Offner
&amp;amp; McKee model&lt;/a&gt; is based on &lt;a class="reference external" href="http://adsabs.harvard.edu/abs/2004ApJ...603..383T"&gt;Tan &amp;amp; McKee 2004&lt;/a&gt;.  There is a
similar model by &lt;a class="reference external" href="http://adsabs.harvard.edu/abs/2009ApJ...691..823H"&gt;Hosokawa &amp;amp; Omukai&lt;/a&gt;, who have shown that high-mass stars can
have substantially varying structures (radii -&amp;gt; luminosities) depending on
their accretion rates.  Mikhail Klassen implemented the &lt;a class="reference external" href="http://adsabs.harvard.edu/abs/2009ApJ...703..131O"&gt;Offner+ 2009&lt;/a&gt;
protostellar evolution models &lt;a class="reference external" href="MikhailKlassen"&gt;in fortran&lt;/a&gt; in &lt;a class="reference external" href="Klassen+2012"&gt;this paper&lt;/a&gt;, with only slight differences assumed in the polytropic
parameters and the accretion luminosity (&lt;a class="reference external" href="Offner+2009"&gt;Offner+&lt;/a&gt; assumed 25%
of the accretion energy is lost to wind and treated the disk and star accretion
luminosity separately, according to &lt;a class="reference external" href="http://adsabs.harvard.edu/abs/2012MNRAS.421.2861K"&gt;Klassen+ 2012&lt;/a&gt;).&lt;/p&gt;
&lt;p&gt;The Klassen implementation is the best immediately available to me.  Both they
and &lt;a class="reference external" href="http://adsabs.harvard.edu/abs/2011ApJ...736...53O"&gt;Offner and McKee&lt;/a&gt; compared their results to &lt;a class="reference external" href="http://adsabs.harvard.edu/abs/2009ApJ...691..823H"&gt;Hosokawa &amp;amp; Omukai&lt;/a&gt;,
considering the latter to be more accurate, and found &amp;quot;good&amp;quot; agreement (&amp;lt;2x
disagreement) in the radius as a function of mass.  The same comparison is
shown below; these figures match &lt;a class="reference external" href="http://adsabs.harvard.edu/abs/2012MNRAS.421.2861K"&gt;Klassen+ 2012&lt;/a&gt; Figures 1 and 2 (though I
don't plot exactly the same things).&lt;/p&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/Klassen_vs_Hosokawa_model_comparison.png" style="width: 600px;" /&gt;
&lt;p&gt;At least in priniple, these tools give us a mechanism to determine L(M, M_f),
the luminosity as a function of the current mass and the final mass of a star.
Alternatively, that can be written as L(t, M_f), the luminosity as a function
of time and final mass.  However, there is at least one major practical concern:
the protostellar evolution models have the free variable mdot, not M_f, so
in order to use these models, we need to populate a 'fully sampled' L(M, M_f) table.
Offner et al computed such a table, but then used an approximation for
R(M) - the stellar radius as a function of its mass - for their calculations.&lt;/p&gt;
&lt;!-- There are two types of accretion histories considered by Offner.  First, they --&gt;
&lt;!-- consider a series of constant (time-independent) accretion histories with mdot --&gt;
&lt;!-- determined by the final mass.  Second, they consider an accelerating --&gt;
&lt;!-- (time-dependent) accretion history.  Grids based on the former are easier to build; --&gt;
&lt;!-- grids based on the latter require modification of the Klassen code. --&gt;
&lt;p&gt;Following Offner, though, the accretion histories are not constant.  Instead,
they use a variety of accretion histories: isothermal sphere, turbulent core,
and competitive accretion.
To compute the L(M, M_f) tables, we need to run a
modified version of the Klassen code with a variable accretion history.&lt;/p&gt;
&lt;p&gt;The isothermal sphere case is actually a constant accretion rate, so that one is
pretty easy.  The turbulent core and competitive accretion models have an accretion
rate that depends on time or mass.&lt;/p&gt;
&lt;div class="section" id="turbulent-core-protostellar-evolution"&gt;
&lt;h3&gt;Turbulent Core Protostellar Evolution&lt;/h3&gt;
&lt;p&gt;I've implemented the turbulent core accretion history in my &lt;a class="reference external" href="https://github.com/keflavich/protostellar_evolution"&gt;fork&lt;/a&gt; of Mikhail
Klassen's repository.  The modification is fairly straightforward: the
accretion rate is set at each timestep according to Equation 23 of &lt;a class="reference external" href="http://adsabs.harvard.edu/abs/2010ApJ...716..167M"&gt;McKee and
Offner&lt;/a&gt; using the numerical constants they computed.  Then, if the stellar
mass has reached (or exceeds) the target stellar mass, set the accretion rate
to zero.  The stellar evolution code can then proceed with no further
accretion.&lt;/p&gt;
&lt;p&gt;I've run this using the default initial conditions, a clump surface density
$Sigma_{cl} = 0.1$ g cm$^{-2}$.  The results are in the next figure: nearly
all of the interesting evolution happens before the stars reach 10 Msun.  The
accretion luminosity is almost always subdominant, at least once anything
reaches 10 Lsun.  The most massive star seems to shrink below its main sequence
size prior to reaching the main sequence, which is a little weird.  I'm not
sure if I trust that.&lt;/p&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/Klassen_turbulentcore_model.png" style="width: 600px;" /&gt;
&lt;p&gt;Further exploration of accretion history parameter space is future work.
I now at least know how to set up the basic models and assemble lookup
tables for L(mf,t).&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="protostellar-sed-models"&gt;
&lt;h2&gt;Protostellar SED Models&lt;/h2&gt;
&lt;p&gt;The next step in computing a millimeter luminosity distribution is to convert
from stellar luminosity to the reprocessed flux at a given wavelength.  This
step has an enormous number of free parameters, since the surrounding structure
may include both a disk and a core whose shapes will both vary.&lt;/p&gt;
&lt;p&gt;There are two large grids of radiative transfer models that have been computed
for this purpose.  The &lt;a class="reference external" href="https://zenodo.org/record/166732#.WdlXwmK3xcw"&gt;Robitaille grid&lt;/a&gt; is complete and open, and it should
cover all stellar masses.  The &lt;a class="reference external" href="http://adsabs.harvard.edu/abs/2017arXiv170808853Z"&gt;Zhang+ 2017&lt;/a&gt; grid is not yet available, but it
may be more self-consistent.&lt;/p&gt;
&lt;p&gt;I plan to use the protostellar evolutionary model parameters, i.e., the radius
and luminosity, to select models from this grid.  However, the Robitaille grid
uses surface temperature and radius, not luminosity and radius.  So we either
need to compute the stellar luminosity in the Robitaille models assuming the
stars are perfect blackbodies, then use the stellar luminosity to select from
that grid, or we need to compute the stellar surface temperature from
the evolutionary model.&lt;/p&gt;
&lt;p&gt;Since the Robitaille models cover a large number of parameters, but do so in a
fairly sparse grid, it is not trivial to map from radius+luminosity to the
models.  For example, for a $2-3x10^5$ Lsun star with radius 40-50 Rsun,
there are 860 models in the &lt;tt class="docutils literal"&gt;spubhmi&lt;/tt&gt; grid, most of which lack flux measurements
in many apertures.&lt;/p&gt;
&lt;div class="section" id="example-model-selection"&gt;
&lt;h3&gt;Example Model Selection&lt;/h3&gt;
&lt;p&gt;For this example, I'm looking at an mf=10 Msun star at t=0.58 Myr, at which
point it has m=6.5 Msun.  Its radius at this time is 9.0 Rsun and &lt;em&gt;stellar&lt;/em&gt;
luminosity 1300 Lsun.  This is the line of output from the Klassen model:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
            Time        Stellar_Mass      Accretion_Rate      Stellar_Radius    Polytropic_Index      Deuterium_Mass       Intrinsic_Lum    Total_Luminosity    Stage
0.1842924478E+14    0.1300261603E+35    0.1404188516E+22    0.6278790980E+12    0.3000000000E+01    0.0000000000E+00    0.5084830934E+37    0.6525577133E+37        4
&lt;/pre&gt;
&lt;p&gt;I select models within 5% of this one's radius and luminosity:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;lum&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.5084830934E+37&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;erg&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;to&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;L_sun&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;rad&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.6278790980E+12&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cm&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;to&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;R_sun&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;selpars&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pars&lt;/span&gt;&lt;span class="p"&gt;[(&lt;/span&gt;&lt;span class="n"&gt;pars&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Luminosity&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;lum&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="mf"&gt;0.95&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pars&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Luminosity&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;lum&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="mf"&gt;1.05&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pars&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;star.radius&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;rad&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="mf"&gt;0.95&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pars&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;star.radius&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;rad&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="mf"&gt;1.05&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;My first attempt at this, with the &lt;tt class="docutils literal"&gt;spubhmi&lt;/tt&gt; model, resulted in one that has
no flux in small (4000 AU) aperture, which I don't yet know how to interpret -
it is certainly possible for such a source, with a non-negligible envelope, to
exist, and it would certainly produce some flux.&lt;/p&gt;
&lt;p&gt;More lenient parameters are needed:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;lum&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.5084830934E+37&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;erg&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;to&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;L_sun&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;rad&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.6278790980E+12&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cm&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;to&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;R_sun&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;apnum&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;argmin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;abs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;seds&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;apertures&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;2000&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;au&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;wav&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;95&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;GHz&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;to&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;mm&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;spectral&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;span class="n"&gt;wavnum&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;argmin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;abs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;seds&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;wav&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;wav&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;ok&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;isfinite&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;seds&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;val&lt;/span&gt;&lt;span class="p"&gt;[:,&lt;/span&gt;&lt;span class="n"&gt;wavnum&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;apnum&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;span class="n"&gt;selpars&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pars&lt;/span&gt;&lt;span class="p"&gt;[(&lt;/span&gt;&lt;span class="n"&gt;pars&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Luminosity&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;lum&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="mf"&gt;0.9&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pars&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Luminosity&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;lum&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="mf"&gt;1.10&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pars&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;star.radius&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;rad&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="mf"&gt;0.9&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pars&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;star.radius&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;rad&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="mf"&gt;1.10&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;ok&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This one at least results in some hits.  There are three models with fluxes (at
Sgr B2, in a 2000 AU radius aperture, at 95 GHz) of 15-25, 155-170, and 55-60 mJy.
To build a model cluster, we would randomly select one of these models.
Robitaille notes, however, that some of the models are nonphysical; at the moment,
we have no way to assess that, so we have to do the selection blindly.  The brightest
model has a denser envelope and more massive disk.&lt;/p&gt;
&lt;p&gt;We can use this to make a model cluster, but this is a pretty discouraging first model
given my previous work; this is presently a low-luminosity source that is surprisingly
intense at 3mm.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="full-workflow"&gt;
&lt;h2&gt;Full Workflow&lt;/h2&gt;
&lt;p&gt;We first create a cluster by sampling from a stellar initial mass function.
This part is straightforward, at least.&lt;/p&gt;
&lt;p&gt;Then, for each source, we 'rewind' to a specific time and select model parameters
from the protostellar evolution models described above.  The 'rewind' could be
from the point at which the stars reach &amp;quot;stage 5&amp;quot;, main sequence, or we could
select some other criteria.&lt;/p&gt;
&lt;p&gt;Finally, we sample from the Robitaille parameters.  For this first example,
we just randomly select from some parameters that are within 5-10% of the target
parameters.  In the longer term, we'll want to be much more accurate
and find a way to interpolate the Robitaille models onto a &amp;quot;fully sampled&amp;quot; grid
of the parameter space we're interested in.  The Zhang models are probably
better to use once they become available since they may have accretion histories
consistent with those used for the evolutionary model.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="final-comments"&gt;
&lt;h2&gt;Final comments&lt;/h2&gt;
&lt;p&gt;For the next post, I hope to actually generate some clusters and see what sorts
of uncertainties we're dealing with.  The above examples suggest they could be
truly extreme, and perhaps that the Robitaille models will be inadequate for
this purpose.  We'll see.&lt;/p&gt;
&lt;/div&gt;
</content><category term="misc"></category><category term="plf"></category><category term="pmf"></category><category term="cmf"></category></entry><entry><title>Protostellar Mass Functions</title><link href="https://keflavich.github.io/blog/protostellar-mass-functions.html" rel="alternate"></link><published>2017-08-30T15:18:00-06:00</published><updated>2017-08-30T15:18:00-06:00</updated><author><name>Adam Ginsburg (Adam.G.Ginsburg@gmail.com)</name></author><id>tag:keflavich.github.io,2017-08-30:/blog/protostellar-mass-functions.html</id><summary type="html">&lt;p&gt;The stellar &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Initial_mass_function"&gt;initial mass function&lt;/a&gt; is important for a wide
variety of astronomical topics, and I'm interested in studying its formation.
The &lt;a class="reference external" href="http://adsabs.harvard.edu/abs/2010ApJ...716..167M"&gt;protostellar mass function&lt;/a&gt;, by contrast, is much
less well-studied, but understanding it can provide important insights into the
formation of the IMF.  In particular, we assume both for …&lt;/p&gt;</summary><content type="html">&lt;p&gt;The stellar &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Initial_mass_function"&gt;initial mass function&lt;/a&gt; is important for a wide
variety of astronomical topics, and I'm interested in studying its formation.
The &lt;a class="reference external" href="http://adsabs.harvard.edu/abs/2010ApJ...716..167M"&gt;protostellar mass function&lt;/a&gt;, by contrast, is much
less well-studied, but understanding it can provide important insights into the
formation of the IMF.  In particular, we assume both for simplicity and because
of a lack of contrary evidence, that the IMF is uniform in time in space.  In
other words, given that a star is going to form at some point, it has a
likelihood to become a star of a given mass described exclusively by the IMF.
While this assertion is entirely absurd - if you are &amp;quot;about to form&amp;quot; a star in
a blob of gas that only has 0.1 Msun in a 1 pc radius, it certainly cannot form
a 100 Msun star - it remains consistent with nearly all observations and is
therefore used in this time- and space-invariant form.&lt;/p&gt;
&lt;p&gt;It is likely that new studies of stellar populations, e.g., GAIA's observations
of a huge population of stars with well-determined distances (and therefore
luminosities), will reveal some variations in the IMF.  However, many studies
based on evolved stellar populations are subject to ambiguities in the initial
conditions.  So, it is still quite useful to study those initial conditions
directly.&lt;/p&gt;
&lt;p&gt;There has not been a huge amount of work on protostellar mass functions.
&lt;a class="reference external" href="http://adsabs.harvard.edu/abs/2010ApJ...716..167M"&gt;McKee and Offner&lt;/a&gt; defined the PMF as the distribution of masses of
protostellar sources that would produce a given IMF.  Their PMFs are therefore
strongly dependent on the underlying IMF assumed.&lt;/p&gt;
&lt;p&gt;I have implemented the mass functions they defined in &lt;a class="reference external" href="https://github.com/keflavich/imf/blob/master/imf/pmf.py"&gt;this code&lt;/a&gt;.  The code
is generalized such that you can input other mass functions.  McKee &amp;amp; Offner
only used the &lt;a class="reference external" href="http://adsabs.harvard.edu/abs/2005ASSL..327...41C"&gt;Chabrier 2005&lt;/a&gt; mass function; I include the &lt;a class="reference external" href="http://adsabs.harvard.edu/abs/2001MNRAS.322..231K"&gt;Kroupa 2001&lt;/a&gt; mass
function as well for comparison&lt;/p&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/steadystate_pmf_chabrier_mmax3.png" style="width: 400px;" /&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/steadystate_pmf_kroupa_mmax3.png" style="width: 400px;" /&gt;
&lt;p&gt;The comparison between the Chabrier and Kroupa mass functions is shown above.
Note that these are somewhat deceptive plots, since they show P(M) vs log(M).
The plot shows the most likely individual masses by number, but the plots are
actually quite squished to the left in linear space, such that the most common
range of stars (the integral of both functions) is closer to the same (~0.2-0.3
Msun).  The more commonly shown version of these plots is the integral form,
which has a positive power-law slope in the lowest bin in the Kroupa MF,
showing the usual peak at 0.3 Msun.  This version of the functions is
nontrivial to compute, especially for the modified PMFs.&lt;/p&gt;
&lt;p&gt;The mass-weighted versions of these may be more familiar, and they are more
similar to the P(log M) version used in &lt;a class="reference external" href="http://adsabs.harvard.edu/abs/2010ApJ...716..167M"&gt;McKee and Offner&lt;/a&gt; and &lt;a class="reference external" href="http://adsabs.harvard.edu/abs/2005ASSL..327...41C"&gt;Chabrier 2005&lt;/a&gt;:&lt;/p&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/steadystate_pmf_chabrier_integral_mmax3.png" style="width: 400px;" /&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/steadystate_pmf_kroupa_integral_mmax3.png" style="width: 400px;" /&gt;
&lt;p&gt;The Chabrier version is a near-perfect match to Figure 3 of &lt;a class="reference external" href="http://adsabs.harvard.edu/abs/2010ApJ...716..167M"&gt;McKee and
Offner&lt;/a&gt;, with slightly different normalization (and I'm expressing P(M), not
P(log M); a previous version showed P(log M), but was incorrect).  A notable
feature of this plot is that it cuts off at 3 Msun.  I want to examine the same
distribution at higher masses.&lt;/p&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/taperedaccretion_pmf_chabrier_mmax3.png" style="width: 400px;" /&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/taperedaccretion_pmf_kroupa_mmax3.png" style="width: 400px;" /&gt;
&lt;p&gt;The above plots are the same as before, but with tapered accretion following
the prescription in &lt;a class="reference external" href="http://adsabs.harvard.edu/abs/2010ApJ...716..167M"&gt;McKee and Offner&lt;/a&gt;.  The tapering function is apparently
arbitrary, and picked purely to enforce smoothness (i.e., prevent a possibly
nonphysical instantaneous shutoff of accretion).&lt;/p&gt;
&lt;div class="section" id="extending-to-higher-masses"&gt;
&lt;h2&gt;Extending to higher masses&lt;/h2&gt;
&lt;p&gt;When we reevaluate the same functions with mmax=120 instead of 3, we can start
to see the high mass end, which is of course power-law dominated.   In all cases,
the PMF is dominated by the highest-mass sources, since in all cases they take
the longest to form.&lt;/p&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/steadystate_pmf_chabrier_mmax120.png" style="width: 400px;" /&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/steadystate_pmf_kroupa_mmax120.png" style="width: 400px;" /&gt;
&lt;p&gt;The accretion model changes the slope and the overall ratio of high- to
low-mass stars.&lt;/p&gt;
&lt;p&gt;These are the mass fractions of various MFs:&lt;/p&gt;
&lt;blockquote&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Mass fraction for ChabrierIMF M&amp;gt;10 = 0.192&lt;/li&gt;
&lt;li&gt;Mass fraction for ChabrierPMF_2CTC M&amp;gt;10 = 0.334&lt;/li&gt;
&lt;li&gt;Mass fraction for ChabrierPMF_CA M&amp;gt;10 = 0.150&lt;/li&gt;
&lt;li&gt;Mass fraction for ChabrierPMF_IS M&amp;gt;10 = 0.765&lt;/li&gt;
&lt;li&gt;Mass fraction for ChabrierPMF_TC M&amp;gt;10 = 0.288&lt;/li&gt;
&lt;li&gt;Mass fraction for KroupaIMF M&amp;gt;10 = 0.185&lt;/li&gt;
&lt;li&gt;Mass fraction for KroupaPMF_2CTC M&amp;gt;10 = 0.348&lt;/li&gt;
&lt;li&gt;Mass fraction for KroupaPMF_CA M&amp;gt;10 = 0.148&lt;/li&gt;
&lt;li&gt;Mass fraction for KroupaPMF_IS M&amp;gt;10 = 0.781&lt;/li&gt;
&lt;li&gt;Mass fraction for KroupaPMF_TC M&amp;gt;10 = 0.294&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;p&gt;The isothermal sphere case is pretty extremely top-heavy, but all except
competitive accretion result in a more top-heavy MF, which is a fairly neat
result - it means that simple binning can distinguish between these theories
(assuming the parametrization is right).  It also means that the SFRs
inferred from integrating the high-mass end of the mass function (as I have
done in &lt;a class="reference external" href="https://github.com/keflavich/SgrB2_ALMA_3mm_Mosaic/"&gt;my Sgr B2 paper&lt;/a&gt;) is subject to a factor of +/-2x uncertainty
depending on the accretion history if we assume steady state.&lt;/p&gt;
&lt;p&gt;The next step is to extend this to different accretion histories (tapered,
accelerating) and then possibly different star formation histories.
I will also create some 'synthetic clusters' using the &lt;a class="reference external" href="https://zenodo.org/record/166732"&gt;Robitaille&lt;/a&gt;
and &lt;a class="reference external" href="https://arxiv.org/abs/1708.08853"&gt;Zhang&lt;/a&gt; models.&lt;/p&gt;
&lt;/div&gt;
</content><category term="misc"></category><category term="imf"></category><category term="pmf"></category></entry><entry><title>A quick performance test on CASA cleaning</title><link href="https://keflavich.github.io/blog/a-quick-performance-test-on-casa-cleaning.html" rel="alternate"></link><published>2017-04-26T11:03:00-06:00</published><updated>2017-04-26T11:03:00-06:00</updated><author><name>Adam Ginsburg (Adam.G.Ginsburg@gmail.com)</name></author><id>tag:keflavich.github.io,2017-04-26:/blog/a-quick-performance-test-on-casa-cleaning.html</id><summary type="html">&lt;p&gt;I ran some speed tests to compare CASA's speed when imaging single channels vs
blocks of channels.  The tests were run with savemodel='none' on a lustre node&lt;/p&gt;
&lt;pre class="literal-block"&gt;
'speedtest_nchan1_concat': 249,
'speedtest_nchan1_individual': 523,
'speedtest_nchan5_concat': 803,
'speedtest_nchan5_individual': 916,
'speedtest_nchan20_concat': 2303,
'speedtest_nchan20 …&lt;/pre&gt;</summary><content type="html">&lt;p&gt;I ran some speed tests to compare CASA's speed when imaging single channels vs
blocks of channels.  The tests were run with savemodel='none' on a lustre node&lt;/p&gt;
&lt;pre class="literal-block"&gt;
'speedtest_nchan1_concat': 249,
'speedtest_nchan1_individual': 523,
'speedtest_nchan5_concat': 803,
'speedtest_nchan5_individual': 916,
'speedtest_nchan20_concat': 2303,
'speedtest_nchan20_individual': 2346,
'speedtest_nchan40_concat': 4010,
'speedtest_nchan40_individual': 4136,
'speedtest_nchan80_concat': 8101,
'speedtest_nchan80_individual': 9298,
&lt;/pre&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/casa/cube_performance.png" style="width: 600px;" /&gt;
&lt;p&gt;The fit is y = 98x + 237&lt;/p&gt;
&lt;p&gt;So at least until swapping happens, there is no serious advantage or
disadvantage to running a different # of channels simultaneously.&lt;/p&gt;
</content><category term="misc"></category><category term="CASA"></category><category term="clean"></category><category term="tclean"></category></entry><entry><title>High-mass Protostellar SiO Masers</title><link href="https://keflavich.github.io/blog/high-mass-protostellar-sio-masers.html" rel="alternate"></link><published>2017-01-30T12:26:00-07:00</published><updated>2017-01-30T12:26:00-07:00</updated><author><name>Adam Ginsburg (Adam.G.Ginsburg@gmail.com)</name></author><id>tag:keflavich.github.io,2017-01-30:/blog/high-mass-protostellar-sio-masers.html</id><summary type="html">&lt;p&gt;In working on a high-mass star formation proposal, I reviewed the discovery
of SiO vibrationally-excited masers toward high-mass star-forming regions.&lt;/p&gt;
&lt;p&gt;Known sources include (with discovery articles listed):&lt;/p&gt;
&lt;blockquote&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Sgr B2 M (&lt;a class="reference external" href="http://adsabs.harvard.edu/abs/1986mmmo.conf..275H"&gt;Hasegawa&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;Sgr B2 N (&lt;a class="reference external" href="http://esoads.eso.org/abs/2015ApJ...815..106H"&gt;Higuchi&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;W51N (&lt;a class="reference external" href="http://adsabs.harvard.edu/abs/1986mmmo.conf..275H"&gt;Hasegawa&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;Orion BN/KL (&lt;a class="reference external" href="http://adsabs.harvard.edu/abs/1974ApJ...189L..31S"&gt;Snyder&lt;/a&gt;, first mm maser)&lt;/li&gt;
&lt;li&gt;G19.61-0.23 (&lt;a class="reference external" href="http://esoads.eso.org/abs/2016ApJ...826..157C"&gt;Cho&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;G75.78 …&lt;/li&gt;&lt;/ul&gt;&lt;/blockquote&gt;</summary><content type="html">&lt;p&gt;In working on a high-mass star formation proposal, I reviewed the discovery
of SiO vibrationally-excited masers toward high-mass star-forming regions.&lt;/p&gt;
&lt;p&gt;Known sources include (with discovery articles listed):&lt;/p&gt;
&lt;blockquote&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Sgr B2 M (&lt;a class="reference external" href="http://adsabs.harvard.edu/abs/1986mmmo.conf..275H"&gt;Hasegawa&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;Sgr B2 N (&lt;a class="reference external" href="http://esoads.eso.org/abs/2015ApJ...815..106H"&gt;Higuchi&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;W51N (&lt;a class="reference external" href="http://adsabs.harvard.edu/abs/1986mmmo.conf..275H"&gt;Hasegawa&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;Orion BN/KL (&lt;a class="reference external" href="http://adsabs.harvard.edu/abs/1974ApJ...189L..31S"&gt;Snyder&lt;/a&gt;, first mm maser)&lt;/li&gt;
&lt;li&gt;G19.61-0.23 (&lt;a class="reference external" href="http://esoads.eso.org/abs/2016ApJ...826..157C"&gt;Cho&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;G75.78+0.34 (&lt;a class="reference external" href="http://esoads.eso.org/abs/2016ApJ...826..157C"&gt;Cho&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;G0.38+0.04 &amp;quot;Cloud C&amp;quot; (&lt;a class="reference external" href="http://esoads.eso.org/abs/2015A%26A...584L...7G"&gt;Ginsburg&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;IRAS 19312+1950 (&lt;a class="reference external" href="http://esoads.eso.org/abs/2016ApJ...828...51C"&gt;Cordiner&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;DR 21(OH) (&lt;a class="reference external" href="http://adsabs.harvard.edu/abs/2010ARep...54..295K"&gt;Kalenskii, tentative&lt;/a&gt;)&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;p&gt;If you know of any I missed, or have a better collection of these masers, let
me know.&lt;/p&gt;
</content><category term="misc"></category><category term="SiO Masers"></category><category term="HMSF"></category></entry><entry><title>CASA synthetic observations</title><link href="https://keflavich.github.io/blog/casa-synthetic-observations.html" rel="alternate"></link><published>2016-08-15T09:36:00-06:00</published><updated>2016-08-15T09:36:00-06:00</updated><author><name>Adam Ginsburg (Adam.G.Ginsburg@gmail.com)</name></author><id>tag:keflavich.github.io,2016-08-15:/blog/casa-synthetic-observations.html</id><summary type="html">&lt;p&gt;To evaluate imaging robustness &amp;amp; quality, it is necessary to do some sort of
synthetic observation.  These synthetic observations can be done on real
images, e.g. Herschel data shifted to greater distances, or on simulated data.&lt;/p&gt;
&lt;p&gt;Some examples:&lt;/p&gt;
&lt;blockquote&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;a class="reference external" href="https://github.com/keflavich/W51_ALMA_2013.1.00308.S/blob/master/analysis/synth_imaging_perseus.py"&gt;https://github.com/keflavich/W51_ALMA_2013.1.00308.S/blob/master …&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/blockquote&gt;</summary><content type="html">&lt;p&gt;To evaluate imaging robustness &amp;amp; quality, it is necessary to do some sort of
synthetic observation.  These synthetic observations can be done on real
images, e.g. Herschel data shifted to greater distances, or on simulated data.&lt;/p&gt;
&lt;p&gt;Some examples:&lt;/p&gt;
&lt;blockquote&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;a class="reference external" href="https://github.com/keflavich/W51_ALMA_2013.1.00308.S/blob/master/analysis/synth_imaging_perseus.py"&gt;https://github.com/keflavich/W51_ALMA_2013.1.00308.S/blob/master/analysis/synth_imaging_perseus.py&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="https://github.com/keflavich/W51_ALMA_2013.1.00308.S/blob/master/analysis/synth_imaging_perseus_2.py"&gt;https://github.com/keflavich/W51_ALMA_2013.1.00308.S/blob/master/analysis/synth_imaging_perseus_2.py&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="https://github.com/keflavich/W51_ALMA_2013.1.00308.S/blob/master/analysis/synth_imaging_aquila.py"&gt;https://github.com/keflavich/W51_ALMA_2013.1.00308.S/blob/master/analysis/synth_imaging_aquila.py&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;p&gt;General process:&lt;/p&gt;
&lt;blockquote&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;Import file into CASA .image form (e.g., &lt;tt class="docutils literal"&gt;importfits&lt;/tt&gt;)&lt;/li&gt;
&lt;li&gt;Load the .ms file and replace visibilities w/fourier transform of image&lt;/li&gt;
&lt;li&gt;Clean.&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;
&lt;p&gt;The hard part is setting up the files to be imported.&lt;/p&gt;
&lt;p&gt;For example, you can import a FITS file, which to me seems to be the most
straightforward approach:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
importfits(fitsimage=perseus_rescaled,
           imagename=perseus_casa_image,
           overwrite=True,
           defaultaxes=True,#['RA---TAN','DEC--TAN','FREQUENCY','STOKES'],
           defaultaxesvalues=['2.909234541667E+02deg',
                              '1.451177222222E+01deg',
                              '233.9468GHz','I'],
           # 18&amp;quot; = 1.22 lambda/D
           beam=[&amp;quot;{0}deg&amp;quot;.format(18/3600.*distance_scaling),
                 &amp;quot;{0}deg&amp;quot;.format(18/3600.*distance_scaling),
                 &amp;quot;0deg&amp;quot;],
          )
&lt;/pre&gt;
&lt;p&gt;The beam probably matters for Jy-&amp;gt;K, or Jy/beam-&amp;gt;Jy conversion.  The
&lt;tt class="docutils literal"&gt;defaultaxesvalues&lt;/tt&gt; should correspond to the pointing center of the
interferometer pointing or mosaic.&lt;/p&gt;
&lt;p&gt;Next is bringing this image - which we now pray is in the correct units - into UV space.:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
sm.openfromms(&amp;quot;continuum_7m12m_noflag.ms&amp;quot;)
sm.setvp()
success = sm.predict(perseus_casa_image)
assert success
# TODO: get these from ASDM_CALWVR and WEATHER
success2 = sm.setnoise(mode='tsys-atm', relhum=60.0, pwv='2mm', tatmos=265.0, )
success3 = sm.corrupt()
sm.done()
sm.close()
&lt;/pre&gt;
&lt;p&gt;This snippet loads the .ms file (the visibilities), then overwrites them with
the fourier transform of the image using &lt;tt class="docutils literal"&gt;sm.predict&lt;/tt&gt;.  It's not clear whether
&lt;tt class="docutils literal"&gt;setvp&lt;/tt&gt; is necessary.  &lt;tt class="docutils literal"&gt;setnoise&lt;/tt&gt; + &lt;tt class="docutils literal"&gt;corrupt&lt;/tt&gt; just adds &amp;quot;appropriate&amp;quot;
atmospheric noise to the visibilities.&lt;/p&gt;
&lt;p&gt;From there, you should just use the same &lt;tt class="docutils literal"&gt;clean&lt;/tt&gt; parameters as for the
original data, or try to optimize &lt;tt class="docutils literal"&gt;clean&lt;/tt&gt; here and use these parameters on
the real data.&lt;/p&gt;
&lt;p&gt;The result will be the 'perfect' (no phase error, no amplitude error)
interferometric image.&lt;/p&gt;
</content><category term="misc"></category><category term="CASA"></category><category term="simulation"></category><category term="synthetic observation"></category></entry><entry><title>CASA clean: "splotchy" artifacts</title><link href="https://keflavich.github.io/blog/casa-clean-splotchy-artifacts.html" rel="alternate"></link><published>2016-06-14T09:31:00-06:00</published><updated>2016-06-14T09:31:00-06:00</updated><author><name>Adam Ginsburg (Adam.G.Ginsburg@gmail.com)</name></author><id>tag:keflavich.github.io,2016-06-14:/blog/casa-clean-splotchy-artifacts.html</id><summary type="html">&lt;p&gt;This image shows artifacts that look &amp;quot;splotchy&amp;quot;.  They are locations clean has
placed a negative model component where none belongs, so the residual is highly
positive and the resulting image is negative.&lt;/p&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/casa/splotchy.png" style="width: 600px;" /&gt;
&lt;p&gt;Discussing with others, it appears that this artifact may be unique to
multiscale clean and therefore may be …&lt;/p&gt;</summary><content type="html">&lt;p&gt;This image shows artifacts that look &amp;quot;splotchy&amp;quot;.  They are locations clean has
placed a negative model component where none belongs, so the residual is highly
positive and the resulting image is negative.&lt;/p&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/casa/splotchy.png" style="width: 600px;" /&gt;
&lt;p&gt;Discussing with others, it appears that this artifact may be unique to
multiscale clean and therefore may be a result of a too-strong component being
added on a large scale.  It is not yet clear how to suppress these artifacts,
but I'm attempting to change the scales included.  Other ideas would be welcome
in the comments.&lt;/p&gt;
</content><category term="misc"></category><category term="CASA"></category><category term="clean"></category><category term="artifacts"></category></entry><entry><title>Single Dish Combination Continued</title><link href="https://keflavich.github.io/blog/single-dish-combination-continued.html" rel="alternate"></link><published>2016-06-02T16:59:00-06:00</published><updated>2016-06-02T16:59:00-06:00</updated><author><name>Adam Ginsburg (Adam.G.Ginsburg@gmail.com)</name></author><id>tag:keflavich.github.io,2016-06-02:/blog/single-dish-combination-continued.html</id><summary type="html">&lt;p&gt;Continuing from yesterday, I've done some more analysis of my HC3N data on
different scales.  The first critical note is that there appears to be
disagreement between the 7m and 12m data.
In principle, smoothing the 12m data to the 7m resolution should at most
recover the 7m brightness; instead …&lt;/p&gt;</summary><content type="html">&lt;p&gt;Continuing from yesterday, I've done some more analysis of my HC3N data on
different scales.  The first critical note is that there appears to be
disagreement between the 7m and 12m data.
In principle, smoothing the 12m data to the 7m resolution should at most
recover the 7m brightness; instead it seems that the 12m data significantly
overpredict the 7m brightness.&lt;/p&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/sgrb2/array_imagecomparison.png" style="width: 600px;" /&gt;
&lt;p&gt;This discrepancy is also evident in the power spectra, where there appears to be missing flux
on 20-100 arcsecond scales.&lt;/p&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/sgrb2/array_pspeccomparison.png" style="width: 600px;" /&gt;
&lt;p&gt;So maybe it's just that the 7m data are bad?&lt;/p&gt;
&lt;p&gt;I discussed the image combination process with Baobab, and he suggested that it
may not be the flux calibration of the images (their absolute scaling) but the
relative weights used to combine them.  The default weights, and pretty much
all variants I had experimented with, use the single-dish beam as the starting
point: you weight the interferometer data by (1-SDbeam) in the fourier domain.&lt;/p&gt;
&lt;p&gt;It turns out that, while this weighting scheme is the obvious thing to do
because the single-dish beam is well-characterized, it may not be the best.
The interferometer data may lose sensitivity on larger scales much faster than
(1-SDbeam) would suggest.&lt;/p&gt;
&lt;p&gt;Carrying the single-dish weight down to smaller angular scales does a better
job of ensuring there are no negatives, but is it really &amp;quot;right&amp;quot;?
Unfortunately, there's no good answer to this; the process is essentially the
same as modifying the Briggs parameter when weighting intereferometric clean
data.  You just have to choose a scale, or a weighting function, and go with
it.  As long as the weights are conservative (i.e., sum to 1), the resulting
image should in some sense be correct.&lt;/p&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/sgrb2/combination_weighting_scales.png" style="width: 600px;" /&gt;
&lt;p&gt;In that figure, the weighting scheme for the large angular scale data was set
to a series of different Gaussians.  The resolution of the 7m+TP data is
(theoretically) 24x11 arcseconds, but preserving the large angular scales below
the major beam axis seems to do a better job of preserving the image's
positivity.&lt;/p&gt;
&lt;p&gt;The effect is more pronounced if we just combine the 12m+TP data, ignoring the
7m data (which might be wrong anyway).  For weighting FWHM above 30 arcseconds,
the interferometric data dominates the map.&lt;/p&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/sgrb2/combination_weighting_scales_no7m.png" style="width: 600px;" /&gt;
</content><category term="misc"></category><category term="CASA"></category><category term="data"></category></entry><entry><title>Single Dish - Interferometer Combination Experiments</title><link href="https://keflavich.github.io/blog/single-dish-interferometer-combination-experiments.html" rel="alternate"></link><published>2016-06-01T11:17:00-06:00</published><updated>2016-06-01T11:17:00-06:00</updated><author><name>Adam Ginsburg (Adam.G.Ginsburg@gmail.com)</name></author><id>tag:keflavich.github.io,2016-06-01:/blog/single-dish-interferometer-combination-experiments.html</id><summary type="html">&lt;p&gt;I spent 3 days in Köln with Alvaro Sanchez-Mongé, Peter Schilke, Fanyi Meng,
and Anika Schmiedeke working on Sgr B2 data and specifically on trying to
combine the single dish (total power) data with my merged ACA+12m data from
ALMA program 2013.1.00269.S.&lt;/p&gt;
&lt;p&gt;tl;dr: feathering appears …&lt;/p&gt;</summary><content type="html">&lt;p&gt;I spent 3 days in Köln with Alvaro Sanchez-Mongé, Peter Schilke, Fanyi Meng,
and Anika Schmiedeke working on Sgr B2 data and specifically on trying to
combine the single dish (total power) data with my merged ACA+12m data from
ALMA program 2013.1.00269.S.&lt;/p&gt;
&lt;p&gt;tl;dr: feathering appears to work fine, and many other methods work equally
well (assuming they can be implemented, which is uniformly harder).  Negative
bowls persisting after feathering are an indication of a problem with the input
data.&lt;/p&gt;
&lt;div class="section" id="feathering"&gt;
&lt;h2&gt;Feathering&lt;/h2&gt;
&lt;p&gt;Fourier space combination of the single-dish and interferometric data is by
far the most straightforward to implement and the fastest.  However, in the HC3N
data, it left strong negative bowls, which should not be possible.&lt;/p&gt;
&lt;p&gt;On the Einstein image, the image quality from feathering was not great, but
there were no negative bowls left.  The dynamic range is lower in the Einstein
data, but this still hints that there is a problem with the HC3N images.  We're
investigating the possibility that the 7m data are improperly calibrated or
weighted.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="miriad"&gt;
&lt;h2&gt;Miriad&lt;/h2&gt;
&lt;p&gt;We never managed to create UV data from the single dish data because of complaints about
the pointing information.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="cleaning-with-a-single-dish-image-as-an-input-model"&gt;
&lt;h2&gt;Cleaning with a single dish image as an input model&lt;/h2&gt;
&lt;p&gt;We attempted to clean the data using the single dish image as an input model.&lt;/p&gt;
&lt;p&gt;On the real data, this failed with both tclean and clean.  With &lt;tt class="docutils literal"&gt;tclean&lt;/tt&gt;, there
was no error message, it just hung indefinitely.
With &lt;tt class="docutils literal"&gt;clean&lt;/tt&gt;, the error message is:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
*** Error ***  LatticeExprNode - coordinates of operands mismatch
Scanned so far: modelos_0 + __temp_model2

2016-06-01 10:35:05     SEVERE  clean::::       An error occurred running task clean.
&lt;/pre&gt;
&lt;p&gt;Changing CDELT to 1 GHz, which solved a previous issue, had no effect here.&lt;/p&gt;
&lt;p&gt;It turns out &lt;tt class="docutils literal"&gt;tclean&lt;/tt&gt; will fail silently if it doesn't find the
&lt;tt class="docutils literal"&gt;startmodel&lt;/tt&gt;, which has to be specified as an image &lt;em&gt;prefix&lt;/em&gt; for version
&amp;lt;=4.6, and the image has to exist as a &lt;tt class="docutils literal"&gt;.model&lt;/tt&gt; file.  For higher versions, 4.6+,
the model can be directly referenced (as in clean).  Eventually, tclean seems to have
completed, though the results indicate that it does not treat the units as I expected;
the total power data seems to be over-weighted by a factor of 10^3+, probably by the ratio
of the beam areas:&lt;/p&gt;
&lt;img alt="" src="http://i.imgur.com/8dW7t8I.png" style="width: 600px;" /&gt;
&lt;p&gt;For the simulated images (einstein), we get the error:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
2016-06-01 10:55:11 SEVERE  SynthesisImager::defineImage (file /Users/rpmbuild/gradle/workdir/casasources/release-4_5/code/synthesis/ImagerObjects/SynthesisImager.cc, line 668)    Error in adding Mapper : Error in createImStore : ::operator!= (const IPosition&amp;amp;, const IPosition&amp;amp;) - left and right operand do not conform
2016-06-01 10:55:11 SEVERE  tclean::task_tclean::   Exception from task_tclean : 2016-06-01 10:55:11        SEVERE  SynthesisImager::defineImage (file /Users/rpmbuild/gradle/workdir/casasources/release-4_5/code/synthesis/ImagerObjects/SynthesisImager.cc, line 668)    Error in adding Mapper : Error in createImStore : ::operator!= (const IPosition&amp;amp;, const IPosition&amp;amp;) - left and right operand do not conform
&lt;/pre&gt;
&lt;p&gt;This is probably an issue with regridding.  &lt;tt class="docutils literal"&gt;imregrid&lt;/tt&gt; doesn't like our data:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
2016-06-01 11:00:41 SEVERE  imregrid::image::regrid Exception Reported: Exception: The number of pixel axes in the output shape and Coordinate System must be the same. Shape has size 4. Output coordinate system has 3 axes.
2016-06-01 11:00:41 SEVERE  imregrid::image::regrid+        ... thrown by SPIIF casa::ImageRegridder::_regrid() const at File: /Users/rpmbuild/gradle/workdir/casasources/release-4_5/code/imageanalysis/ImageAnalysis/ImageRegridder.cc, line: 138
&lt;/pre&gt;
&lt;p&gt;Adding a frequency axis to the FITS data (which was missing before...) seems to
have fixed this error for the Einstein data, but not for the real HC3N data.&lt;/p&gt;
&lt;!-- (this is now incorporated in an above paragraph) --&gt;
&lt;!-- tclean appears to use the wrong units for the input model, treating that model --&gt;
&lt;!-- very differently than ``clean`` does.  This error may be limited to CASA &lt;= --&gt;
&lt;!-- 4.5, since the tclean documentation regarding models changed substantially from --&gt;
&lt;!-- 4.5 to 4.6. --&gt;
&lt;/div&gt;
&lt;div class="section" id="linear-combination-in-image-space"&gt;
&lt;h2&gt;Linear Combination in Image Space&lt;/h2&gt;
&lt;p&gt;Linear combination of the single dish and interferometer data in image space,
followed by image-space deconvolution, has been used successfully on HI data.
In principle, this is very straightforward, except for the need for
deconvolution.  CASA now has an image-space deconvolution program
(&lt;tt class="docutils literal"&gt;deconvolve&lt;/tt&gt;), so I was able to implement this approach.  However, the
deconvolver seems to only work on the inner 1/4 of the image in each dimension,
which left incomplete images that were difficult to compare.  Additionally,
CASA does not (obviously) carry the appropriate machinery for computing the
residual image and adding the convolved model back to the residual image.
Still, this is a promising route forward as it is computationally relatively
cheap and mostly easy to implement.&lt;/p&gt;
&lt;p&gt;Linear combination is partly implemented now using the CASA &lt;tt class="docutils literal"&gt;deconvolve&lt;/tt&gt; task;
it hasn't been generalized but you can see the outline / single working case at
&lt;a class="reference external" href="https://github.com/radio-astro-tools/uvcombine/blob/master/uvcombine/realspace_combine.py"&gt;this link&lt;/a&gt;.&lt;/p&gt;
&lt;!-- this is how you include images --&gt;
&lt;!-- .. image:: |static|/images/psfFfftF.png --&gt;
&lt;!-- :width: 600px --&gt;
&lt;/div&gt;
</content><category term="misc"></category><category term="CASA"></category><category term="uv combination"></category></entry><entry><title>What does feather do?</title><link href="https://keflavich.github.io/blog/what-does-feather-do.html" rel="alternate"></link><published>2016-05-26T08:29:00-06:00</published><updated>2016-05-26T08:29:00-06:00</updated><author><name>Adam Ginsburg (Adam.G.Ginsburg@gmail.com)</name></author><id>tag:keflavich.github.io,2016-05-26:/blog/what-does-feather-do.html</id><summary type="html">&lt;p&gt;This is an examination of the 'feather' task in CASA.&lt;/p&gt;
&lt;p&gt;First we have to track down what code is actually called.&lt;/p&gt;
&lt;p&gt;On mac, this is:&lt;/p&gt;
&lt;blockquote&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;/Applications/CASA.app/Contents/Resources/python/feather_cli.py -&amp;gt; feather_cli&lt;/li&gt;
&lt;li&gt;/Applications/CASA.app/Contents/Resources/python/task_feather.py -&amp;gt; feather&lt;/li&gt;
&lt;li&gt;/Applications/CASA.app/Contents …&lt;/li&gt;&lt;/ul&gt;&lt;/blockquote&gt;</summary><content type="html">&lt;p&gt;This is an examination of the 'feather' task in CASA.&lt;/p&gt;
&lt;p&gt;First we have to track down what code is actually called.&lt;/p&gt;
&lt;p&gt;On mac, this is:&lt;/p&gt;
&lt;blockquote&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;/Applications/CASA.app/Contents/Resources/python/feather_cli.py -&amp;gt; feather_cli&lt;/li&gt;
&lt;li&gt;/Applications/CASA.app/Contents/Resources/python/task_feather.py -&amp;gt; feather&lt;/li&gt;
&lt;li&gt;/Applications/CASA.app/Contents/Resources/python/taskinit.py -&amp;gt; imtool-&amp;gt;imager-&amp;gt;casac.imager-&amp;gt;/Applications/CASA.app/Contents/Resources/python/feather_cli.py&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="https://github.com/radio-astro/casa/blob/160955adf4de4ee561cfc691904317953e08d7d6/code/synthesis/MeasurementEquations/Imager.cc#L2257"&gt;Imager.cc&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;p&gt;Within the imager, &lt;cite&gt;setvp&lt;/cite&gt; is used to do something with the primary beam.  As
far as I can tell, this function spews a lot of text into the logger, sets
local variables, sets one larger-scope variable &lt;cite&gt;BeamSquint::&lt;/cite&gt;, then does
&lt;cite&gt;destroySkyEquation();&lt;/cite&gt;.  In short, I don't know what this does.  Probably my
reading of the C code is incorrect and these variables are &lt;em&gt;not&lt;/em&gt; local, in
which case it is just setting a bunch of default beam parameters.&lt;/p&gt;
&lt;p&gt;Then, &lt;cite&gt;Imager.cc&lt;/cite&gt; calls &lt;a class="reference external" href="https://github.com/radio-astro/casa/blob/160955adf4de4ee561cfc691904317953e08d7d6/code/synthesis/MeasurementEquations/Feather.cc#L1211"&gt;Feather.cc&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Feather sets parameters based on the effective dish diameter.  It uses
&lt;a class="reference external" href="https://github.com/radio-astro/casa/blob/160955adf4de4ee561cfc691904317953e08d7d6/code/synthesis/MeasurementEquations/Feather.cc#L244"&gt;1.22*(speed of light)/frequency/dish_diameter&lt;/a&gt;,
so it is retrieving the FWHM
assuming a Gaussian beam by default.&lt;/p&gt;
&lt;p&gt;A lovely aside: &lt;cite&gt;Imager.cc&lt;/cite&gt; passes the local variable &lt;a class="reference external" href="https://github.com/radio-astro/casa/blob/160955adf4de4ee561cfc691904317953e08d7d6/code/synthesis/MeasurementEquations/Imager.cc#L2320"&gt;lowPassFilterSD&lt;/a&gt;
to &lt;cite&gt;Feather.cc&lt;/cite&gt;, which is read in to the input boolean parameter
&lt;a class="reference external" href="https://github.com/radio-astro/casa/blob/160955adf4de4ee561cfc691904317953e08d7d6/code/synthesis/MeasurementEquations/Feather.cc#L244"&gt;doHiPassFilterOnSD&lt;/a&gt;.
That seems like a potential place for confusion.&lt;/p&gt;
&lt;p&gt;If &lt;cite&gt;doHiPassFilterOnSD&lt;/cite&gt; is set &lt;em&gt;or&lt;/em&gt; the effective beam diameter is set as a
parameter, the single dish image is deconvolved with its beam using the
GaussianDeconvolver.  This is actually disabled by default, though.&lt;/p&gt;
&lt;p&gt;The low resolution image is &lt;a class="reference external" href="https://github.com/radio-astro/casa/blob/160955adf4de4ee561cfc691904317953e08d7d6/code/synthesis/MeasurementEquations/Feather.cc#L142"&gt;regridded&lt;/a&gt;
to match the high resolution image.&lt;/p&gt;
&lt;p&gt;The &lt;a class="reference external" href="https://github.com/radio-astro/casa/blob/160955adf4de4ee561cfc691904317953e08d7d6/code/synthesis/MeasurementEquations/Feather.cc#L375"&gt;applyFeather&lt;/a&gt;
command seems to do the actual work.
It starts with &lt;a class="reference external" href="https://github.com/radio-astro/casa/blob/160955adf4de4ee561cfc691904317953e08d7d6/code/synthesis/MeasurementEquations/Feather.cc#L414"&gt;calcCWeightImage&lt;/a&gt;,
which sets the &amp;quot;weight&amp;quot; to one minus the peak-normalized fourier transform of
the low-resolution (single-dish) beam
&lt;a class="reference external" href="https://github.com/radio-astro/casa/blob/160955adf4de4ee561cfc691904317953e08d7d6/code/synthesis/MeasurementEquations/Feather.cc#L427"&gt;Feather.cc line 427&lt;/a&gt;,
with the result stored in the variable &lt;cite&gt;cwImage_p&lt;/cite&gt;.
&lt;a class="reference external" href="https://github.com/radio-astro/casa/blob/160955adf4de4ee561cfc691904317953e08d7d6/code/synthesis/MeasurementEquations/Feather.cc#L408"&gt;applyFeather&lt;/a&gt; then just
multiplies the high-resolution image by this weight.&lt;/p&gt;
&lt;p&gt;Back in the &lt;a class="reference external" href="https://github.com/radio-astro/casa/blob/160955adf4de4ee561cfc691904317953e08d7d6/code/synthesis/MeasurementEquations/Feather.cc#L695"&gt;saveFeatheredImage&lt;/a&gt;
task, the single-dish data are fourier transformed, then a scaling factor, the ratio
between the low and high beam areas, is computed.  Finally, the single-dish
(scaled) and interferometer &lt;a class="reference external" href="https://github.com/radio-astro/casa/blob/160955adf4de4ee561cfc691904317953e08d7d6/code/synthesis/MeasurementEquations/Feather.cc#L694"&gt;fourier-transformed&lt;/a&gt; images are &lt;a class="reference external" href="https://github.com/radio-astro/casa/blob/160955adf4de4ee561cfc691904317953e08d7d6/code/synthesis/MeasurementEquations/Feather.cc#L703"&gt;added&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Is the single-dish image weighted by the beam at all?  The single-dish image will
be convolved with a kernel only if &lt;a class="reference external" href="https://github.com/radio-astro/casa/blob/160955adf4de4ee561cfc691904317953e08d7d6/code/synthesis/MeasurementEquations/Feather.cc#L1235"&gt;doHighPassFilterOnSD&lt;/a&gt; is set
or if the effective dish diameter is set.  If the beam is the same size as the original
beam, nothing will happen.
In &lt;a class="reference external" href="https://github.com/radio-astro/casa/blob/160955adf4de4ee561cfc691904317953e08d7d6/code/synthesis/MeasurementEquations/Feather.cc#L256"&gt;setEffectiveDishDiam&lt;/a&gt;
the low-resolution image is convolved with the &lt;a class="reference external" href="https://github.com/radio-astro/casa/blob/160955adf4de4ee561cfc691904317953e08d7d6/code/components/ComponentModels/GaussianDeconvolver.cc#L34"&gt;*deconvolved*&lt;/a&gt;
beam.&lt;/p&gt;
&lt;p&gt;The most important note in this post is that the single-dish image is &lt;em&gt;not&lt;/em&gt;
weighted unless &lt;cite&gt;doHighPassFilterOnSD&lt;/cite&gt; is set, and even then nothing will be
done if the single-dish beam size passed as a parameter is the same as the beam
size specified in the header.  That means only the interferometer image is
weighted.  Maybe that is the correct behavior?  By weighting by (1-convolved
beam), which means setting the total flux in the interferometer image to zero,
the process is guaranteed to be flux conserving.&lt;/p&gt;
&lt;!-- this is how you include images --&gt;
&lt;!-- .. image:: |static|/images/psfFfftF.png --&gt;
&lt;!-- :width: 600px --&gt;
</content><category term="misc"></category><category term="casa"></category></entry><entry><title>CASA coordinate defaults</title><link href="https://keflavich.github.io/blog/casa-coordinate-defaults.html" rel="alternate"></link><published>2016-05-19T09:31:00-06:00</published><updated>2016-05-19T09:31:00-06:00</updated><author><name>Adam Ginsburg (Adam.G.Ginsburg@gmail.com)</name></author><id>tag:keflavich.github.io,2016-05-19:/blog/casa-coordinate-defaults.html</id><summary type="html">&lt;p&gt;A brief public service announcement: CASA coordinate strings follow a
convention of their own making that I at least find thoroughly
counterintuitive.  If you specify a sexagesimal coordinate, e.g. 05:12:15.3
-5:10:20.5 or something similar, CASA interprets that as 5 hours, -5 hours.
The …&lt;/p&gt;</summary><content type="html">&lt;p&gt;A brief public service announcement: CASA coordinate strings follow a
convention of their own making that I at least find thoroughly
counterintuitive.  If you specify a sexagesimal coordinate, e.g. 05:12:15.3
-5:10:20.5 or something similar, CASA interprets that as 5 hours, -5 hours.
The declination is interpreted as being in hours.  Those are units no one has
ever used.  The CASA version requires the second half of the sexagesimal string
to be decimal separated:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
2016-05-19 00:45:13     WARN    SynthesisParams::stringToMDirection (file /var/rpmbuild/BUILD/casa-prerelease/casa-prerelease-4.6.0/code/synthesis/ImagerObjects/SynthesisUtilMethods.cc, line 786)     You provided the Declination/Latitude value &amp;quot;-28:23:29.22&amp;quot; which is understood to be in units of hours.
2016-05-19 00:45:13     WARN    SynthesisParams::stringToMDirection (file /var/rpmbuild/BUILD/casa-prerelease/casa-prerelease-4.6.0/code/synthesis/ImagerObjects/SynthesisUtilMethods.cc, line 786)+    If you meant degrees, please replace &amp;quot;:&amp;quot; by &amp;quot;.&amp;quot;.
&lt;/pre&gt;
&lt;p&gt;This has broken my scripts more than a handful of times now, since copying &amp;amp;
pasting coordinates from any other program inevitably has the &amp;quot;wrong&amp;quot;
units.&lt;/p&gt;
</content><category term="misc"></category><category term="CASA"></category></entry><entry><title>CASA tclean adds negative components</title><link href="https://keflavich.github.io/blog/casa-tclean-adds-negative-components.html" rel="alternate"></link><published>2016-05-01T10:21:00-06:00</published><updated>2016-05-01T10:21:00-06:00</updated><author><name>Adam Ginsburg (Adam.G.Ginsburg@gmail.com)</name></author><id>tag:keflavich.github.io,2016-05-01:/blog/casa-tclean-adds-negative-components.html</id><summary type="html">&lt;p&gt;I'm trying to examine some of my 7m+12m combined data and have run into yet another
mysterious behavior of CASA.  &lt;tt class="docutils literal"&gt;tclean&lt;/tt&gt; is adding negative components in regions with
exclusively positive emission.&lt;/p&gt;
&lt;p&gt;In this image, the &lt;em&gt;left&lt;/em&gt; is the clean image, which doesn't make any sense; it
looks like it …&lt;/p&gt;</summary><content type="html">&lt;p&gt;I'm trying to examine some of my 7m+12m combined data and have run into yet another
mysterious behavior of CASA.  &lt;tt class="docutils literal"&gt;tclean&lt;/tt&gt; is adding negative components in regions with
exclusively positive emission.&lt;/p&gt;
&lt;p&gt;In this image, the &lt;em&gt;left&lt;/em&gt; is the clean image, which doesn't make any sense; it
looks like it should be a residual image but it is not.  2nd image is the clean
components (negative!!), 3rd is the residual, 4th is the dirty map.&lt;/p&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/casa/bad_cleancomps.png" style="width: 600px;" /&gt;
&lt;p&gt;One tricky thing for this particular image is that the emission is real, BUT it
is also directly on top of a major sidelobe of the brightest source in the
region.  Nonetheless, I cannot imagine any way to explain the negative
component.  I don't really understand when a negative component is added, but
presumably it ought to happen when the residual has a negative value but also
the highest amplitude in the map; this obviously never happens here since the
residual in fact has one of the highest &lt;em&gt;positive&lt;/em&gt; amplitudes in the map.&lt;/p&gt;
&lt;p&gt;The imaging parameters seem not to affect this problem. I attempted reducing the
gain to 0.05 to no avail.  Changing from natural to robust weighting actually
removed most of the negative components.&lt;/p&gt;
&lt;div class="section" id="failed-combination-of-7m-and-12m-data"&gt;
&lt;h2&gt;Failed combination of 7m and 12m data&lt;/h2&gt;
&lt;p&gt;The above was a tangent.  The real reason I was working on this data set was to
combine the 7m and 12m spectral data.  The problem I keep seeing is very large,
smooth blobs that are spatially distinct from the more compact emission.  It's
as if someone took the two independent cubes (12m and 7m) and just added them
together; it looks like flux is not being conserved.&lt;/p&gt;
&lt;p&gt;The UV plots, especially weight vs uvdist, look fine.  The 7m antenna are
downweighted relative to the 7m antennae by a factor ~2.&lt;/p&gt;
&lt;p&gt;One of the bigger problems is that I have a vague - possibly not justified -
sense that there is a velocity offset of ~1 km/s between the 7m and 12m data.
If this is the case, there's no wonder the combination isn't working.
However, it's nearly inconceivable.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="followup-feb-2017"&gt;
&lt;h2&gt;Followup Feb 2017&lt;/h2&gt;
&lt;p&gt;That vague fear turned out to be entirely justified.  It turned out that the 7m
and 12m array data sets were not in a common frame, and they were therefore
offset by something like the Earth's change in velocity between the observation
dates.  The solution was to cvel the data sets to the LSRK frame prior to
concatenating them.  While I know I made these changes, I unfortunately can't
find the specific commit where I made them.&lt;/p&gt;
&lt;/div&gt;
</content><category term="misc"></category><category term="casa"></category><category term="tclean"></category></entry><entry><title>CASA simulated imaging: now FTMachine is whining</title><link href="https://keflavich.github.io/blog/casa-simulated-imaging-now-ftmachine-is-whining.html" rel="alternate"></link><published>2016-04-26T15:12:00-06:00</published><updated>2016-04-26T15:12:00-06:00</updated><author><name>Adam Ginsburg (Adam.G.Ginsburg@gmail.com)</name></author><id>tag:keflavich.github.io,2016-04-26:/blog/casa-simulated-imaging-now-ftmachine-is-whining.html</id><summary type="html">&lt;p&gt;&lt;a class="reference external" href="https://keflavich.github.io/blog/casa_simulation_debugging.rst"&gt;A few days ago&lt;/a&gt;
I apparently got my broken simulator working again.  Today, in my first
attempt to repeat those results, I... have broken it again.:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
WARN        FTMachine::initMaps     No overlap in frequency between image channels and selected data found for this FTMachine
WARN        FTMachine::initMaps+     Check your data selection …&lt;/pre&gt;</summary><content type="html">&lt;p&gt;&lt;a class="reference external" href="https://keflavich.github.io/blog/casa_simulation_debugging.rst"&gt;A few days ago&lt;/a&gt;
I apparently got my broken simulator working again.  Today, in my first
attempt to repeat those results, I... have broken it again.:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
WARN        FTMachine::initMaps     No overlap in frequency between image channels and selected data found for this FTMachine
WARN        FTMachine::initMaps+     Check your data selection and image parameters if you end up with a blank image
&lt;/pre&gt;
&lt;p&gt;This warning is not a simple warning, it means nothing is being done.  My
images are empty, pure noise (which, interestingly enough, is far from
gaussian).&lt;/p&gt;
&lt;p&gt;I have encountered these errors &lt;cite&gt;before
&amp;lt;|static|/separating_line_and_continuum.rst&amp;gt;&lt;/cite&gt;, but unfortunately did not
resolve the issue.&lt;/p&gt;
&lt;p&gt;Turns out, the difference was the .ms file I used,
&lt;tt class="docutils literal"&gt;continuum_7m12m_noflag.ms&lt;/tt&gt;, which works, vs the useful one,
&lt;tt class="docutils literal"&gt;w51_contvis_selfcal_3.ms&lt;/tt&gt;, which doesn't.&lt;/p&gt;
&lt;p&gt;Checking out their headers, the continuum image does overlap with the
data but the selfcal version doesn't.  Wonderful.  Now I'll bet it's only
populating one channel at a time when I invert too...&lt;/p&gt;
&lt;p&gt;This leads me to try:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
split(vis='w51_contvis_selfcal_3.ms', outputvis='simulation_continuum.ms', datacolumn='data', width=100)
&lt;/pre&gt;
&lt;p&gt;then use (borrowed from &lt;a class="reference external" href="https://github.com/radio-astro-tools/sandbox/blob/master/casa_7m12m_tools/weight_density_uv_plot.py"&gt;this tool&lt;/a&gt;):&lt;/p&gt;
&lt;pre class="literal-block"&gt;
mymsmd = msmdtool()
mymsmd.open(vis)

reffreq = &amp;quot;{value}{unit}&amp;quot;.format(**mymsmd.reffreq(spw)['m0'])
&lt;/pre&gt;
&lt;p&gt;to get the frequency to write into the header each time.&lt;/p&gt;
&lt;p&gt;At a glance, just changing the frequency of the FITS file to match the first
SPW seems to work.  However, I haven't yet examined whether the other SPWs
are populated.&lt;/p&gt;
&lt;p&gt;This assumption proved wrong.  No, it simply doesn't work.  The warnings went away,
but the output images are empty.  Also, the noise went up, which I don't understand.&lt;/p&gt;
&lt;p&gt;Imaging just spw1 kind of worked, but resulted in an image with the wrong
resolution by factors of many.&lt;/p&gt;
&lt;p&gt;Trying to loop over all spws failed miserably, resulting in &lt;em&gt;nothing&lt;/em&gt; being done by
predict and &lt;em&gt;no warning&lt;/em&gt; being given.&lt;/p&gt;
&lt;p&gt;OK, finally, solution is to make sure CDELT is large enough to cover &lt;em&gt;all&lt;/em&gt; SPWs.&lt;/p&gt;
&lt;p&gt;Another important note: Jy/beam and Jy/pixel inputs into CASA result in identical images.
In both cases, they are wrong images: they correspond to multiplying the input data by
factors of at least 100.  Therefore, my conclusion now is that I have to divide everything
by some fact, which I &lt;em&gt;sincerely&lt;/em&gt; hope is ppbeam, to correct the data.&lt;/p&gt;
&lt;p&gt;It looked vaguely like the divide-by-ppbeam trick worked, but my tests kept coming up funny
because the &lt;em&gt;original&lt;/em&gt; images were scaled down.  So I tried unscaling them.  Somehow,
without changing anything about the headers, I landed on another failed predict error:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
2016-04-27 19:14:42 SEVERE  Simulator::createSkyEquation() (file /Users/rpmbuild/gradle/workdir/casasources/release-4_5/code/synthesis/MeasurementEquations/Simulator.cc, line 2200)        Caught exception: (/Users/rpmbuild/gradle/workdir/casasources/release-4_5/code/synthesis/MeasurementEquations/Simulator.cc : 2266) Failed AlwaysAssert spectralIndex&amp;gt;=0
2016-04-27 19:14:42 SEVERE  Simulator::predict() (file /Users/rpmbuild/gradle/workdir/casasources/release-4_5/code/synthesis/MeasurementEquations/Simulator.cc, line 2118)  Failed to create SkyEquation
&lt;/pre&gt;
&lt;p&gt;Spectral Index?  I encountered this &lt;a class="reference external" href="|static|/casa_simulating.rst"&gt;previously&lt;/a&gt;, but didn't record any solution.
After checking the header, it appears that my files are &lt;em&gt;now&lt;/em&gt; missing axes 3 and 4.
I didn't make any changes that should cause this; the axes are just not being added
on importfits despite being forcibly added in the command.&lt;/p&gt;
&lt;p&gt;The problem is unfortunately not in the FITS part, but again in the CASA part.
Re-importing the FITS file to .image without forcing &lt;tt class="docutils literal"&gt;defaultaxes&lt;/tt&gt; again just
broke it.&lt;/p&gt;
</content><category term="misc"></category><category term="casa"></category><category term="clean"></category><category term="simulation"></category></entry><entry><title>More CASA simulation &amp; debugging</title><link href="https://keflavich.github.io/blog/more-casa-simulation-debugging.html" rel="alternate"></link><published>2016-04-24T22:57:00-06:00</published><updated>2016-04-24T22:57:00-06:00</updated><author><name>Adam Ginsburg (Adam.G.Ginsburg@gmail.com)</name></author><id>tag:keflavich.github.io,2016-04-24:/blog/more-casa-simulation-debugging.html</id><summary type="html">&lt;p&gt;(this post written from snowy-ish ALMA; &lt;a class="reference external" href="https://goo.gl/photos/z3fUkCT6VVRzt8EW6"&gt;just cloudy at the OSF though&lt;/a&gt;)&lt;/p&gt;
&lt;p&gt;(tl; dr version: &lt;tt class="docutils literal"&gt;sm.setvp&lt;/tt&gt; doesn't work if you have &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;TELESCOP=&amp;quot;ALMA&amp;quot;&lt;/span&gt;&lt;/tt&gt; in
your header)&lt;/p&gt;
&lt;p&gt;I'm trying to repeat an experiment very similar to
&lt;a class="reference external" href="|static|/casa_simulating.rst"&gt;previous&lt;/a&gt;
&lt;a class="reference external" href="|static|/simulated_imaging.rst"&gt;simulation work&lt;/a&gt;
in order to quantify my completeness and largest angular scales
by …&lt;/p&gt;</summary><content type="html">&lt;p&gt;(this post written from snowy-ish ALMA; &lt;a class="reference external" href="https://goo.gl/photos/z3fUkCT6VVRzt8EW6"&gt;just cloudy at the OSF though&lt;/a&gt;)&lt;/p&gt;
&lt;p&gt;(tl; dr version: &lt;tt class="docutils literal"&gt;sm.setvp&lt;/tt&gt; doesn't work if you have &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;TELESCOP=&amp;quot;ALMA&amp;quot;&lt;/span&gt;&lt;/tt&gt; in
your header)&lt;/p&gt;
&lt;p&gt;I'm trying to repeat an experiment very similar to
&lt;a class="reference external" href="|static|/casa_simulating.rst"&gt;previous&lt;/a&gt;
&lt;a class="reference external" href="|static|/simulated_imaging.rst"&gt;simulation work&lt;/a&gt;
in order to quantify my completeness and largest angular scales
by injecting synthetic signal into the real UV data.&lt;/p&gt;
&lt;p&gt;However, as you might expect, it doesn't work as it did last time, even
when I (afaict) copy and paste the code directly.&lt;/p&gt;
&lt;p&gt;Here's the new error:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
2016-04-25 02:57:21 SEVERE  Simulator::createSkyEquation() (file /Users/rpmbuild/gradle/workdir/casasources/release-4_5/code/synthesis/MeasurementEquations/Simulator.cc, line 2200)        Caught exception: Transformations to/from frame &amp;quot;Undefined&amp;quot; are not possible.
2016-04-25 02:57:21 SEVERE  Simulator::predict() (file /Users/rpmbuild/gradle/workdir/casasources/release-4_5/code/synthesis/MeasurementEquations/Simulator.cc, line 2118)  Failed to create SkyEquation
Result of predict: False
&lt;/pre&gt;
&lt;p&gt;It's strange because there is nothing obviously undefined.&lt;/p&gt;
&lt;p&gt;I'm comparing 2 FITS files that should behave identically.
The good header lacks these keywords that the bad header has:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
['PV2_1',
 'PV2_2',
 'OBSERVER',
 'DATE-OBS',
 'OBSRA',
 'OBSDEC',
 'OBSGEO-X',
 'OBSGEO-Y',
 'OBSGEO-Z']
&lt;/pre&gt;
&lt;p&gt;while the good header has these and the bad lacks them:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
['PC03_01',
 'PC04_01',
 'PC03_02',
 'PC04_02',
 'PC01_03',
 'PC02_03',
 'PC03_03',
 'PC04_03',
 'PC01_04',
 'PC02_04',
 'PC03_04',
 'PC04_04',
 'CREATOR',
 'INSTRUME',
 'BAND',
 'PROPOSAL',
 'PRTITLE',
 'OBSID001',
 'OBSID002',
 'HISTORY']
&lt;/pre&gt;
&lt;p&gt;The only significant difference is the &lt;tt class="docutils literal"&gt;PC&lt;/tt&gt; values, unless CASA
is doing something with the observatory location information.&lt;/p&gt;
&lt;p&gt;The only difference in common keywords is numerical, which seems
very unlikely to cause this issue.&lt;/p&gt;
&lt;p&gt;I cannot discern any useful difference between these two CASA .image headers:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
2016-04-25 03:08:55 INFO imhead     ##########################################
2016-04-25 03:08:55 INFO imhead     ##### Begin Task: imhead             #####
2016-04-25 03:08:55 INFO imhead     imhead(imagename=&amp;quot;../perseus_synth/perseus_250_to_w51.image&amp;quot;,mode=&amp;quot;summary&amp;quot;,hdkey=&amp;quot;&amp;quot;,hdvalue=&amp;quot;&amp;quot;,verbose=True)
2016-04-25 03:08:55 INFO ImageAnalysis
2016-04-25 03:08:55 INFO ImageAnalysis      Image name       : perseus_250_to_w51.image
2016-04-25 03:08:55 INFO ImageAnalysis      Object name      : perseus 04
2016-04-25 03:08:55 INFO ImageAnalysis      Image type       : PagedImage
2016-04-25 03:08:55 INFO ImageAnalysis      Image quantity   : Intensity
2016-04-25 03:08:55 INFO ImageAnalysis      Pixel mask(s)    : mask0
2016-04-25 03:08:55 INFO ImageAnalysis      Region(s)        : None
2016-04-25 03:08:55 INFO ImageAnalysis      Image units      : Jy/pixel
2016-04-25 03:08:55 INFO ImageAnalysis      Restoring Beam   : 0.465804 arcsec, 0.465804 arcsec, 0 deg
2016-04-25 03:08:55 INFO ImageAnalysis
2016-04-25 03:08:55 INFO ImageAnalysis      Direction reference : J2000
2016-04-25 03:08:55 INFO ImageAnalysis      Spectral  reference : Undefined
2016-04-25 03:08:55 INFO ImageAnalysis      Velocity  type      : RADIO
2016-04-25 03:08:55 INFO ImageAnalysis      Rest frequency      : 2.33947e+11 Hz
2016-04-25 03:08:55 INFO ImageAnalysis      Telescope           : Herschel
2016-04-25 03:08:55 INFO ImageAnalysis      Observer            : UNKNOWN
2016-04-25 03:08:55 INFO ImageAnalysis      Date observation    : UNKNOWN
2016-04-25 03:08:55 INFO ImageAnalysis
2016-04-25 03:08:55 INFO ImageAnalysis      Axis Coord Type      Name             Proj Shape Tile   Coord value at pixel    Coord incr Units
2016-04-25 03:08:55 INFO ImageAnalysis      ------------------------------------------------------------------------------------------------
2016-04-25 03:08:55 INFO ImageAnalysis      0    0     Direction Right Ascension   TAN  2370  158  19:23:41.765  1099.00 -1.552680e-01 arcsec
2016-04-25 03:08:55 INFO ImageAnalysis      1    0     Direction Declination       TAN  2500  250 +14.30.45.850  1552.00  1.552680e-01 arcsec
2016-04-25 03:08:55 INFO ImageAnalysis      2    2     Spectral  Frequency                 1    1   2.33947e+11     0.00  1.000000e+09 Hz
2016-04-25 03:08:55 INFO ImageAnalysis                           Velocity                                     0     0.00 -1.281456e+03 km/s
2016-04-25 03:08:55 INFO ImageAnalysis      3    1     Stokes    Stokes                    1    1             I
2016-04-25 03:08:55 INFO imhead     ##### End Task: imhead               #####
2016-04-25 03:08:55 INFO imhead     ##########################################
2016-04-25 03:09:07 INFO imhead
2016-04-25 03:09:07 INFO imhead     ##########################################
2016-04-25 03:09:07 INFO imhead     ##### Begin Task: imhead             #####
2016-04-25 03:09:07 INFO imhead     imhead(imagename=&amp;quot;../simulations/simimage_firsttest.image&amp;quot;,mode=&amp;quot;summary&amp;quot;,hdkey=&amp;quot;&amp;quot;,hdvalue=&amp;quot;&amp;quot;,verbose=False)
2016-04-25 03:09:07 INFO ImageAnalysis
2016-04-25 03:09:07 INFO ImageAnalysis      Image name       : simimage_firsttest.image
2016-04-25 03:09:07 INFO ImageAnalysis      Object name      :
2016-04-25 03:09:07 INFO ImageAnalysis      Image type       : PagedImage
2016-04-25 03:09:07 INFO ImageAnalysis      Image quantity   : Intensity
2016-04-25 03:09:07 INFO ImageAnalysis      Pixel mask(s)    : None
2016-04-25 03:09:07 INFO ImageAnalysis      Region(s)        : None
2016-04-25 03:09:07 INFO ImageAnalysis      Image units      : Jy/beam
2016-04-25 03:09:07 INFO ImageAnalysis      Restoring Beam   : 0.21023 arcsec, 0.192666 arcsec, 79.8538 deg
2016-04-25 03:09:07 INFO ImageAnalysis
2016-04-25 03:09:07 INFO ImageAnalysis      Direction reference : J2000
2016-04-25 03:09:07 INFO ImageAnalysis      Spectral  reference : Undefined
2016-04-25 03:09:07 INFO ImageAnalysis      Velocity  type      : RADIO
2016-04-25 03:09:07 INFO ImageAnalysis      Rest frequency      : 2.33947e+11 Hz
2016-04-25 03:09:07 INFO ImageAnalysis      Pointing center     :  19:23:41.629000  +14.30.42.380000
2016-04-25 03:09:07 INFO ImageAnalysis      Telescope           : ALMA
2016-04-25 03:09:07 INFO ImageAnalysis      Observer            : keflavich
2016-04-25 03:09:07 INFO ImageAnalysis      Date observation    : 2015/04/23/09:47:44
2016-04-25 03:09:07 INFO ImageAnalysis      Telescope position: [2.22514e+06m, -5.44031e+06m, -2.48103e+06m] (ITRF)
2016-04-25 03:09:07 INFO ImageAnalysis
2016-04-25 03:09:07 INFO ImageAnalysis      Axis Coord Type      Name             Proj Shape Tile   Coord value at pixel    Coord incr Units
2016-04-25 03:09:07 INFO ImageAnalysis      ------------------------------------------------------------------------------------------------
2016-04-25 03:09:07 INFO ImageAnalysis      0    0     Direction Right Ascension   TAN  3072  192  19:23:41.629  1536.00 -5.000000e-02 arcsec
2016-04-25 03:09:07 INFO ImageAnalysis      1    0     Direction Declination       TAN  3072  192 +14.30.42.380  1536.00  5.000000e-02 arcsec
2016-04-25 03:09:07 INFO ImageAnalysis      2    1     Stokes    Stokes                    1    1             I
2016-04-25 03:09:07 INFO ImageAnalysis      3    2     Spectral  Frequency                 1    1   2.33947e+11     0.00  1.000000e+09 Hz
2016-04-25 03:09:07 INFO ImageAnalysis                           Velocity                                     0     0.00 -1.281456e+03 km/s
2016-04-25 03:09:07 INFO imhead     ##### End Task: imhead               #####
2016-04-25 03:09:07 INFO imhead     ##########################################
&lt;/pre&gt;
&lt;p&gt;if anything, the ALMA file includes &lt;em&gt;extra&lt;/em&gt; data. Removing this data has no
effect.&lt;/p&gt;
&lt;p&gt;The only really substantial difference left is the order of the axes, which
is &lt;em&gt;not what I put in&lt;/em&gt; for the ALMA data: it puts Stokes as 2 instead of 3
despite the fact that &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;CTYPE4='STOKES'&lt;/span&gt;&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;CTYPE3='FREQ'&lt;/span&gt;&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;By doing a round trip FITS-&amp;gt;image-&amp;gt;FITS-&amp;gt;image, I was able to fix the order,
but that is not the underlying problem, apparently.&lt;/p&gt;
&lt;p&gt;Could the missing pixel mask be at fault?  It doesn't jive at all with the
error message, so I doubt it.  &lt;tt class="docutils literal"&gt;OBSDATE&lt;/tt&gt; is not the problem.&lt;/p&gt;
&lt;p&gt;Turns out, the error is that ALMA is the telescope.  I added the header entry:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
ffile[0].header['TELESCOP'] = 'NotReal'
&lt;/pre&gt;
&lt;p&gt;and it Just Worked.  It is approaching the end of my shift, so I think it is
now acceptable to say &amp;quot;what kind of !#$&amp;#64;#$!&amp;#64;% up #&amp;#64;$$&amp;#64;% is that?!&amp;quot;.&lt;/p&gt;
</content><category term="misc"></category><category term="CASA"></category><category term="ALMA"></category><category term="simulation"></category><category term="debuggin"></category></entry><entry><title>Which one is real?</title><link href="https://keflavich.github.io/blog/which-one-is-real.html" rel="alternate"></link><published>2016-03-12T10:25:00-07:00</published><updated>2016-03-12T10:25:00-07:00</updated><author><name>Adam Ginsburg (Adam.G.Ginsburg@gmail.com)</name></author><id>tag:keflavich.github.io,2016-03-12:/blog/which-one-is-real.html</id><summary type="html">&lt;p&gt;I've &amp;quot;successfully&amp;quot; combined 7m and 12m data, and I've also &amp;quot;successfully&amp;quot;
processed 12m data.  In both cases, I've self-calibrated the long-baseline 12m
data.&lt;/p&gt;
&lt;p&gt;The question now is: why are these images so different?  There are features
in the 12m-only data that are a factor of ~2 brighter than in the …&lt;/p&gt;</summary><content type="html">&lt;p&gt;I've &amp;quot;successfully&amp;quot; combined 7m and 12m data, and I've also &amp;quot;successfully&amp;quot;
processed 12m data.  In both cases, I've self-calibrated the long-baseline 12m
data.&lt;/p&gt;
&lt;p&gt;The question now is: why are these images so different?  There are features
in the 12m-only data that are a factor of ~2 brighter than in the 12m+7m data.
That should not happen.&lt;/p&gt;
&lt;p&gt;This image shows the problem.  7m+12m left, 12m-only right:&lt;/p&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/w51/7m12m_vs_12m.png" style="width: 600px;" /&gt;
&lt;p&gt;Note the sharp features on the left and the small tail (filament) toward the
top right that appear in the 12m but not in the 7m+12m data.&lt;/p&gt;
&lt;p&gt;Which features are real?  How do we decide?&lt;/p&gt;
&lt;p&gt;I really want to believe the 12m-only data, but I am very worried that it is
artificially enhanced by sidelobes from the e8 filament:&lt;/p&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/w51/7m12m_vs_12m_zoomout.png" style="width: 600px;" /&gt;
&lt;p&gt;There is a ~20-sigma feature between e8 and e2 along the e8 filament axis,
but it is completely absent in the 7m+12m data.  That leads me to believe
that it is not real, but at such high significance that is very worrisome.
I'm also concerned by the loss of the compact source at the bottom of the e8
filament and to the left: these seem unlikely to be affected by the filament.&lt;/p&gt;
</content><category term="misc"></category><category term="CASA"></category><category term="clean"></category></entry><entry><title>CLEAN has extreme sensitivity to the threshold</title><link href="https://keflavich.github.io/blog/clean-has-extreme-sensitivity-to-the-threshold.html" rel="alternate"></link><published>2016-03-10T10:12:00-07:00</published><updated>2016-03-10T10:12:00-07:00</updated><author><name>Adam Ginsburg (Adam.G.Ginsburg@gmail.com)</name></author><id>tag:keflavich.github.io,2016-03-10:/blog/clean-has-extreme-sensitivity-to-the-threshold.html</id><summary type="html">&lt;p&gt;CLEAN diverges sometimes.  The point at which divergence begins is very
difficult to identify and unfortunately it looks like the images get mostly
better as you slowly approach the toxic threshold:&lt;/p&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/w51/tclean_threshold_sensitivity.png" style="width: 600px;" /&gt;
&lt;p&gt;The precise clean command used, with only threshold changing, is:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
2016-03-10 07:49:28     INFO    tclean::::      tclean(vis=&amp;quot;w51 …&lt;/pre&gt;</summary><content type="html">&lt;p&gt;CLEAN diverges sometimes.  The point at which divergence begins is very
difficult to identify and unfortunately it looks like the images get mostly
better as you slowly approach the toxic threshold:&lt;/p&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/w51/tclean_threshold_sensitivity.png" style="width: 600px;" /&gt;
&lt;p&gt;The precise clean command used, with only threshold changing, is:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
2016-03-10 07:49:28     INFO    tclean::::      tclean(vis=&amp;quot;w51_contvis_selfcal_4.ms&amp;quot;,selectdata=True,field=&amp;quot;&amp;quot;,spw=&amp;quot;&amp;quot;,timerange=&amp;quot;&amp;quot;,
2016-03-10 07:49:28     INFO    tclean::::+             uvrange=&amp;quot;&amp;quot;,antenna=&amp;quot;&amp;quot;,scan=&amp;quot;&amp;quot;,observation=&amp;quot;&amp;quot;,intent=&amp;quot;&amp;quot;,
2016-03-10 07:49:28     INFO    tclean::::+             datacolumn=&amp;quot;corrected&amp;quot;,imagename=&amp;quot;selfcal_allspw_selfcal_4ampphase_mfs_tclean_deeper_4mJy&amp;quot;,imsize=[3072, 3072],cell=&amp;quot;0.05arcsec&amp;quot;,phasecenter=&amp;quot;J2000 19:23:41.629000 +14.30.42.38000&amp;quot;,
2016-03-10 07:49:28     INFO    tclean::::+             stokes=&amp;quot;I&amp;quot;,projection=&amp;quot;SIN&amp;quot;,startmodel=&amp;quot;&amp;quot;,specmode=&amp;quot;mfs&amp;quot;,reffreq=&amp;quot;&amp;quot;,
2016-03-10 07:49:28     INFO    tclean::::+             nchan=-1,start=&amp;quot;&amp;quot;,width=&amp;quot;&amp;quot;,outframe=&amp;quot;LSRK&amp;quot;,veltype=&amp;quot;radio&amp;quot;,
2016-03-10 07:49:28     INFO    tclean::::+             restfreq=[],interpolation=&amp;quot;linear&amp;quot;,gridder=&amp;quot;mosaic&amp;quot;,facets=1,wprojplanes=1,
2016-03-10 07:49:28     INFO    tclean::::+             aterm=True,psterm=False,wbawp=True,conjbeams=True,cfcache=&amp;quot;&amp;quot;,
2016-03-10 07:49:28     INFO    tclean::::+             computepastep=360.0,rotatepastep=360.0,pblimit=0.4,normtype=&amp;quot;flatnoise&amp;quot;,deconvolver=&amp;quot;clark&amp;quot;,
2016-03-10 07:49:28     INFO    tclean::::+             scales=[],nterms=2,restoringbeam=[],outlierfile=&amp;quot;&amp;quot;,weighting=&amp;quot;briggs&amp;quot;,
2016-03-10 07:49:28     INFO    tclean::::+             robust=-2.0,npixels=0,uvtaper=[],niter=100000,gain=0.1,
2016-03-10 07:49:28     INFO    tclean::::+             threshold=&amp;quot;4mJy&amp;quot;,cycleniter=-1,cyclefactor=1.0,minpsffraction=0.05,maxpsffraction=0.8,
2016-03-10 07:49:28     INFO    tclean::::+             interactive=False,mask=&amp;quot;&amp;quot;,overwrite=True,savemodel=&amp;quot;modelcolumn&amp;quot;,calcres=True,
2016-03-10 07:49:28     INFO    tclean::::+             calcpsf=True,parallel=False)
&lt;/pre&gt;
&lt;p&gt;It looks like CLEAN needs a different type of threshold to finish on, perhaps
something requiring each subsequent component to be some value less than the
previous component.  If each component is forced to be less than the previous
one, the clean can never diverge, though clean would stop unexpectedly if
subtracting a component increased the amplitude of some other part of the map
(i.e., if the next brightest source is sitting in a negative bowl).  Still,
this might be a rarer occurrence than the divergence that I see all the time,
which may be related to gridding (given the sharp grid pattern seen in panel 4
of the linked image).&lt;/p&gt;
</content><category term="misc"></category><category term="CASA"></category><category term="clean"></category></entry><entry><title>Simulated Observations of Perseus in W51</title><link href="https://keflavich.github.io/blog/simulated-observations-of-perseus-in-w51.html" rel="alternate"></link><published>2016-02-27T10:40:00-07:00</published><updated>2016-02-27T10:40:00-07:00</updated><author><name>Adam Ginsburg (Adam.G.Ginsburg@gmail.com)</name></author><id>tag:keflavich.github.io,2016-02-27:/blog/simulated-observations-of-perseus-in-w51.html</id><summary type="html">&lt;p&gt;The W51 and Sgr B2 ALMA mosaics contain ~50 and ~150 pointlike sources,
respectively.  However, they have pretty miserable high-noise regions
such that determining completeness is a serious challenge.&lt;/p&gt;
&lt;p&gt;To determine completeness in a means comparable to other observations,
I have therefore been using the Gould's Belt Survey Perseus data …&lt;/p&gt;</summary><content type="html">&lt;p&gt;The W51 and Sgr B2 ALMA mosaics contain ~50 and ~150 pointlike sources,
respectively.  However, they have pretty miserable high-noise regions
such that determining completeness is a serious challenge.&lt;/p&gt;
&lt;p&gt;To determine completeness in a means comparable to other observations,
I have therefore been using the Gould's Belt Survey Perseus data
as an input to do synthetic observations.&lt;/p&gt;
&lt;p&gt;It turns out this is technically challenging because CASA does some
&lt;a class="reference external" href="|static|/casa_simulating.rst"&gt;strange things&lt;/a&gt; when importing files.&lt;/p&gt;
&lt;p&gt;I finally got a &lt;a class="reference external" href="https://github.com/keflavich/W51_ALMA_2013.1.00308.S/commit/b046ff5c82992ef44a1dbaac303fcc6497511142"&gt;version&lt;/a&gt;
working.&lt;/p&gt;
&lt;p&gt;Important details when reading in a FITS file:&lt;/p&gt;
&lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p class="first"&gt;The header &lt;em&gt;must&lt;/em&gt; be fully populated with a 4-dimensional WCS.  If stokes or
frequency are missing, CASA will choke with uninformative errors such as:&lt;/p&gt;
&lt;p&gt;2016-02-26 11:25:24  SEVERE  Simulator::createSkyEquation() (file /Users/rpmbuild/gradle/workdir/casasources/release-4_5/code/synthesis/MeasurementEquations/Simulator.cc, line 2200)        Caught exception: (/Users/rpmbuild/gradle/workdir/casasources/release-4_5/code/synthesis/MeasurementEquations/Simulator.cc : 2266) Failed AlwaysAssert spectralIndex&amp;gt;=0
2016-02-26 11:25:24  SEVERE  Simulator::predict() (file /Users/rpmbuild/gradle/workdir/casasources/release-4_5/code/synthesis/MeasurementEquations/Simulator.cc, line 2118)  Failed to create SkyEquation&lt;/p&gt;
&lt;p&gt;and&lt;/p&gt;
&lt;p&gt;2016-02-26 11:27:36  SEVERE  Simulator::predict() (file /Users/rpmbuild/gradle/workdir/casasources/release-4_5/code/synthesis/MeasurementEquations/Simulator.cc, line 2118)  Caught exception: (/Users/rpmbuild/gradle/workdir/casasources/release-4_5/casacore/coordinates/Coordinates/CoordinateSystem.cc : 793) Failed AlwaysAssert which &amp;lt; nCoordinates() &amp;amp;&amp;amp; coordinates_p[which]-&amp;gt;type() == Coordinate::STOKES&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;Flux units should be in Jy/beam.  Other flux units &lt;em&gt;may&lt;/em&gt; be acceptable (e.g.,
MJy/sr, Jy/pixel), but their behavior is not entirely predictable.  I did not
get out the expected values when I used MJy/sr as input, but I did not pursue
further why this happened.  Using Jy/beam, and ensuring that the units were correctly
set to Jy/beam in the file (by scaling them in the FITS image before importing),
I got the expected results.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;CASA apparently does not read beam information from headers.  You need to include the
beam information when doing importfits, e.g.:&lt;/p&gt;
&lt;blockquote&gt;
&lt;dl class="docutils"&gt;
&lt;dt&gt;beam=[&amp;quot;{0}deg&amp;quot;.format(hdr['BMAJ']),&lt;/dt&gt;
&lt;dd&gt;&lt;p class="first last"&gt;&amp;quot;{0}deg&amp;quot;.format(hdr['BMIN']),
&amp;quot;{0}deg&amp;quot;.format(hdr['BPA'])]&lt;/p&gt;
&lt;/dd&gt;
&lt;/dl&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;CASA will happily read a FITS file into a &lt;tt class="docutils literal"&gt;.image&lt;/tt&gt; that cannot be used by
other casa routines.  You will not get an exception until you try a later
step.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;p&gt;Once the FITS image is read into a CASA &lt;tt class="docutils literal"&gt;.image&lt;/tt&gt;, &lt;em&gt;if&lt;/em&gt; it has the CASA-expected
units and dimensions, you can use &lt;tt class="docutils literal"&gt;sm.predict&lt;/tt&gt; to fourier transform the data
and sample it onto the UV grid in your &lt;tt class="docutils literal"&gt;.ms&lt;/tt&gt; file:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
sm.openfromms(&amp;quot;file.ms&amp;quot;)
sm.setvp() # &amp;quot;set voltage pattern&amp;quot;: not clear if this is needed
success = sm.predict(&amp;quot;myfile.image&amp;quot;)
sm.done()
sm.close()
&lt;/pre&gt;
&lt;p&gt;This (seems to) populate the &lt;em&gt;data&lt;/em&gt; column, not the model column as I had
originally expected.  Therefore, be warned!  DO NOT DO THIS TO YOUR ORIGINAL
DATA!  It will probably overwrite it.&lt;/p&gt;
&lt;p&gt;Once your &lt;tt class="docutils literal"&gt;.ms&lt;/tt&gt; file is populated, you can clean it as normal.  Some
examples:&lt;/p&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/casa/perseus_in_w51_imaging.png" style="width: 600px;" /&gt;
</content><category term="misc"></category><category term="CASA"></category><category term="ALMA"></category></entry><entry><title>CASA Simulation</title><link href="https://keflavich.github.io/blog/casa-simulation.html" rel="alternate"></link><published>2016-02-25T10:27:00-07:00</published><updated>2016-02-25T10:27:00-07:00</updated><author><name>Adam Ginsburg (Adam.G.Ginsburg@gmail.com)</name></author><id>tag:keflavich.github.io,2016-02-25:/blog/casa-simulation.html</id><summary type="html">&lt;p&gt;More frustration with CASA:&lt;/p&gt;
&lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p class="first"&gt;If you try to load a FITS image into a CASA .image, beware that it is likely
to have incorrect units.  Round-tripping between .image and .fits doesn't
work well, because CASA always assumes that CDELT is in radians even when it
is explicitly set to be …&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/blockquote&gt;</summary><content type="html">&lt;p&gt;More frustration with CASA:&lt;/p&gt;
&lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p class="first"&gt;If you try to load a FITS image into a CASA .image, beware that it is likely
to have incorrect units.  Round-tripping between .image and .fits doesn't
work well, because CASA always assumes that CDELT is in radians even when it
is explicitly set to be degrees.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;EDIT: OK, this isn't true in all cases, but if you use &lt;tt class="docutils literal"&gt;imhead&lt;/tt&gt; to &lt;tt class="docutils literal"&gt;put&lt;/tt&gt;
a keyword value, it will assume radians by default.  That can be overcome by explicitly setting the units:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;imhead(perseus_casa_image, mode='put', hdkey='CDELT1', hdvalue={'value':hdr['CDELT1'], 'unit':'deg'})&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;I was able to produce this awkward behavior &lt;em&gt;without&lt;/em&gt; imhead as well, though
I cannot repeat that now.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;p&gt;The simulator gives this error message if I try to load an image:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;sm.setvp()
sm.predict(perseus_casa_image)&lt;/p&gt;
&lt;p&gt;2016-02-25 09:26:34 SEVERE  Simulator::predict() (file /Users/rpmbuild/gradle/workdir/casasources/release-4_5/code/synthesis/MeasurementEquations/Simulator.cc, line 2118)  Caught exception: TiledShape: #elements in shape and tileShape differ&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;My best guess is that CASA doesn't understand how to handle 2D images with 3D
headers.  However, the sensible workaround of expanding the image to 3D does
not work.&lt;/p&gt;
&lt;p&gt;Re-importing after exporting gets yet another different image.  After
re-importing an image that was exported to FITS, I get a new error:&lt;/p&gt;
&lt;blockquote&gt;
Failed AlwaysAssert spectralIndex&amp;gt;=0 2016-02-25 09:37:35&lt;/blockquote&gt;
&lt;p&gt;which is rather strange since the spectral index is a physical quantity.&lt;/p&gt;
&lt;p&gt;There is also the lovely message:&lt;/p&gt;
&lt;blockquote&gt;
2016-02-25 09:55:27 INFO importfits No usable restoring beam information found.&lt;/blockquote&gt;
&lt;p&gt;for a header that contains these lines:&lt;/p&gt;
&lt;blockquote&gt;
BMAJ    =   1.293900184840E-04
BMIN    =   1.293900184840E-04
BPA     =   0.000000000000E+00&lt;/blockquote&gt;
&lt;p&gt;The image might finally be right, but now I can't find any way to convert it to
a model.  If I try to &lt;tt class="docutils literal"&gt;ft&lt;/tt&gt; the model, I get:&lt;/p&gt;
&lt;blockquote&gt;
2016-02-25 10:54:54 SEVERE  ft::imager::ft() (file /Users/rpmbuild/gradle/workdir/casasources/release-4_5/code/synthesis/MeasurementEquations/Imager.cc, line 4488) Exception: (/Users/rpmbuild/gradle/workdir/casasources/release-4_5/casacore/coordinates/Coordinates/CoordinateSystem.cc : 777) Failed AlwaysAssert which &amp;lt; nCoordinates() &amp;amp;&amp;amp; coordinates_p[which]-&amp;gt;type() == Coordinate::SPECTRAL&lt;/blockquote&gt;
&lt;p&gt;which probably means that CASA doesn't know how to turn a single-band continuum
image into a model for a multi-frequency .ms (which is all .ms's, including
continuum, in the ALMA world).&lt;/p&gt;
</content><category term="misc"></category><category term="CASA"></category><category term="ALMA"></category></entry><entry><title>Retrieving and Selecting Data in CASA</title><link href="https://keflavich.github.io/blog/retrieving-and-selecting-data-in-casa.html" rel="alternate"></link><published>2016-02-24T13:44:00-07:00</published><updated>2016-02-24T13:44:00-07:00</updated><author><name>Adam Ginsburg (Adam.G.Ginsburg@gmail.com)</name></author><id>tag:keflavich.github.io,2016-02-24:/blog/retrieving-and-selecting-data-in-casa.html</id><summary type="html">&lt;p&gt;I learned a few important things at the 7m+12m workshop in Garching:&lt;/p&gt;
&lt;ol class="arabic"&gt;
&lt;li&gt;&lt;p class="first"&gt;&lt;tt class="docutils literal"&gt;clean&lt;/tt&gt; treats input models in Jy/beam and Jy/pixel qualitatively (not
just quantitatively) differently.  Jy/pixel images are taken to be model
images exactly, where Jy/beam are... somehow interpreted differently, maybe
as clean component assemblies …&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;</summary><content type="html">&lt;p&gt;I learned a few important things at the 7m+12m workshop in Garching:&lt;/p&gt;
&lt;ol class="arabic"&gt;
&lt;li&gt;&lt;p class="first"&gt;&lt;tt class="docutils literal"&gt;clean&lt;/tt&gt; treats input models in Jy/beam and Jy/pixel qualitatively (not
just quantitatively) differently.  Jy/pixel images are taken to be model
images exactly, where Jy/beam are... somehow interpreted differently, maybe
as clean component assemblies.  I don't know the details, but this is a
major caution.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;The &lt;tt class="docutils literal"&gt;tbtool&lt;/tt&gt; is not very good for extracting data for plotting.  The flags
are not guaranteed to be in a sane shape, which will lead to crashes if you
try &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;tb.getcolumn('FLAG')&lt;/span&gt;&lt;/tt&gt;.  &lt;tt class="docutils literal"&gt;ms.msselect&lt;/tt&gt;, however, allows you access
to most of the normal selection routines used in &lt;tt class="docutils literal"&gt;clean&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;split&lt;/tt&gt;, etc.
It is tricky, though, because &lt;tt class="docutils literal"&gt;ms.select&lt;/tt&gt; does &lt;em&gt;not&lt;/em&gt; allow you access to
the same selection.  Also, while &lt;tt class="docutils literal"&gt;spw&lt;/tt&gt;-based selection normally allows you
to select channels, in &lt;tt class="docutils literal"&gt;ms.msselect&lt;/tt&gt; it does not: instead you must use
&lt;tt class="docutils literal"&gt;ms.selectchannel&lt;/tt&gt;.  See &lt;a class="reference external" href="https://github.com/radio-astro-tools/sandbox/blob/master/casa_7m12m_tools/weight_density_uv_plot.py"&gt;this example&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Details about the selection are at this URL, but the documentation is
incomplete and, in places, incorrect:&lt;/p&gt;
&lt;p&gt;&lt;a class="reference external" href="http://www.aoc.nrao.edu/~sbhatnag/misc/msselection/FrequencySelection.html"&gt;http://www.aoc.nrao.edu/~sbhatnag/misc/msselection/FrequencySelection.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;(for example, &lt;tt class="docutils literal"&gt;chanspec&lt;/tt&gt; is not valid in &lt;tt class="docutils literal"&gt;msselect&lt;/tt&gt;, or at least
it doesn't do anything)&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
</content><category term="misc"></category><category term="CASA"></category><category term="ALMA"></category></entry><entry><title>A tclean vs clean comparison</title><link href="https://keflavich.github.io/blog/a-tclean-vs-clean-comparison.html" rel="alternate"></link><published>2016-02-22T11:23:00-07:00</published><updated>2016-02-22T11:23:00-07:00</updated><author><name>Adam Ginsburg (Adam.G.Ginsburg@gmail.com)</name></author><id>tag:keflavich.github.io,2016-02-22:/blog/a-tclean-vs-clean-comparison.html</id><summary type="html">&lt;p&gt;Comparing tclean to clean with the following parameters:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
clean(vis=vis0, imagename=myimagebase, field=&amp;quot;&amp;quot;, spw='',
      mode='mfs', outframe='LSRK', interpolation='linear',
      imagermode='mosaic', multiscale=multiscale, interactive=False,
      niter=1000, threshold='100mJy', imsize=imsize, minpb=0.5, cell=cell,
      phasecenter=phasecenter, weighting='briggs', usescratch=True,
      pbcor=True, robust=-2.0)

tclean …&lt;/pre&gt;</summary><content type="html">&lt;p&gt;Comparing tclean to clean with the following parameters:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
clean(vis=vis0, imagename=myimagebase, field=&amp;quot;&amp;quot;, spw='',
      mode='mfs', outframe='LSRK', interpolation='linear',
      imagermode='mosaic', multiscale=multiscale, interactive=False,
      niter=1000, threshold='100mJy', imsize=imsize, minpb=0.5, cell=cell,
      phasecenter=phasecenter, weighting='briggs', usescratch=True,
      pbcor=True, robust=-2.0)

tclean(vis=vis0, imagename=myimagebase, field=&amp;quot;&amp;quot;, spw='',
       outframe='LSRK', interpolation='linear', gridder='mosaic',
       scales=multiscale, interactive=False, niter=1000,
       threshold='100mJy', imsize=imsize, mask='auto-pb', specmode='mfs',
       cell=cell, phasecenter=phasecenter, weighting='briggs', robust=-2.0)
&lt;/pre&gt;
&lt;p&gt;Note the very bad cleaning instability creeping in in the clean image:&lt;/p&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/tclean_vs_clean_7m12m.png" style="width: 600px;" /&gt;
</content><category term="misc"></category><category term="CASA"></category><category term="ALMA"></category></entry><entry><title>CASA Selfcal: Good &amp; Awful</title><link href="https://keflavich.github.io/blog/casa-selfcal-good-awful.html" rel="alternate"></link><published>2016-01-28T09:20:00-07:00</published><updated>2016-01-28T09:20:00-07:00</updated><author><name>Adam Ginsburg (Adam.G.Ginsburg@gmail.com)</name></author><id>tag:keflavich.github.io,2016-01-28:/blog/casa-selfcal-good-awful.html</id><summary type="html">&lt;p&gt;Self-calibration is necessary for some images to get a decent dynamic range or
to see anything at all in the images.  So, I did some tests using self-cal on
the central field of Sgr B2 (&lt;a class="reference external" href="https://github.com/keflavich/SgrB2_ALMA_3mm_Mosaic/blob/master/script_12m_te/selfcal_centralfield.py"&gt;source&lt;/a&gt;)
and it worked great:&lt;/p&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/casa/sgrb2_selfcal_good.png" style="width: 600px;" /&gt;
&lt;p&gt;That image is actually from &lt;a class="reference external" href="https://github.com/keflavich/SgrB2_ALMA_3mm_Mosaic/blob/master/script_12m_te/selfcal_continuum.py"&gt;self-calibrating the whole field&lt;/a&gt;,
which …&lt;/p&gt;</summary><content type="html">&lt;p&gt;Self-calibration is necessary for some images to get a decent dynamic range or
to see anything at all in the images.  So, I did some tests using self-cal on
the central field of Sgr B2 (&lt;a class="reference external" href="https://github.com/keflavich/SgrB2_ALMA_3mm_Mosaic/blob/master/script_12m_te/selfcal_centralfield.py"&gt;source&lt;/a&gt;)
and it worked great:&lt;/p&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/casa/sgrb2_selfcal_good.png" style="width: 600px;" /&gt;
&lt;p&gt;That image is actually from &lt;a class="reference external" href="https://github.com/keflavich/SgrB2_ALMA_3mm_Mosaic/blob/master/script_12m_te/selfcal_continuum.py"&gt;self-calibrating the whole field&lt;/a&gt;,
which also worked great.  Except, it deleted all the flux outside of the bright regions:&lt;/p&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/casa/sgrb2_selfcal_bad.png" style="width: 600px;" /&gt;
&lt;p&gt;This is awful.  It is just deleting flux!  I had previously thought that the
&lt;tt class="docutils literal"&gt;applyonly&lt;/tt&gt; option would only apply solutions that it actually found, but
that appears not to bt true.  Instead, it seems that even phase solutions with
&lt;em&gt;no&lt;/em&gt; signal are being applied, which effectively removes everything from the
image.  I could have understood if this was happening to amplitude
self-calibration, but I can't understand how it is happening with phase
self-cal.&lt;/p&gt;
</content><category term="misc"></category><category term="clean"></category><category term="selfcal"></category></entry><entry><title>CASA imaging of huge cube</title><link href="https://keflavich.github.io/blog/casa-imaging-of-huge-cube.html" rel="alternate"></link><published>2016-01-25T10:09:00-07:00</published><updated>2016-01-25T10:09:00-07:00</updated><author><name>Adam Ginsburg (Adam.G.Ginsburg@gmail.com)</name></author><id>tag:keflavich.github.io,2016-01-25:/blog/casa-imaging-of-huge-cube.html</id><summary type="html">&lt;p&gt;Imaging full cubes, i.e. every channel and every pixel, from ALMA data proved
too much for the first few machines I tried it on, so I then tried splitting
the cubes into chunks (&lt;a class="reference external" href="https://github.com/keflavich/W51_ALMA_2013.1.00308.S/blob/master/script_12m/scriptForImaging_fullcube.py"&gt;source&lt;/a&gt;).&lt;/p&gt;
&lt;p&gt;For the most part, this works well, but there are some serious problems:&lt;/p&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/casa/spectrum_with_badchunk.png" style="width: 600px;" /&gt;
&lt;p&gt;Note the …&lt;/p&gt;</summary><content type="html">&lt;p&gt;Imaging full cubes, i.e. every channel and every pixel, from ALMA data proved
too much for the first few machines I tried it on, so I then tried splitting
the cubes into chunks (&lt;a class="reference external" href="https://github.com/keflavich/W51_ALMA_2013.1.00308.S/blob/master/script_12m/scriptForImaging_fullcube.py"&gt;source&lt;/a&gt;).&lt;/p&gt;
&lt;p&gt;For the most part, this works well, but there are some serious problems:&lt;/p&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/casa/spectrum_with_badchunk.png" style="width: 600px;" /&gt;
&lt;p&gt;Note the range from 233.8-234 GHz.  It has a continuum level way above the
rest.  This is utter nonsense, and turns out to be due to some imaging error.
The first image below shows a &amp;quot;good&amp;quot; chunk of the cube, the second image shows
a &amp;quot;bad&amp;quot; chunk.&lt;/p&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/casa/w51_cube_chunk_compare_good.png" style="width: 600px;" /&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/casa/w51_cube_chunk_compare_bad.png" style="width: 600px;" /&gt;
&lt;p&gt;It is clear that the second image was restore using a too-large beam, and this is verified by examining the header:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;In&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;]:&lt;/span&gt; &lt;span class="n"&gt;badcube&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;beam&lt;/span&gt;
&lt;span class="n"&gt;Out&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;]:&lt;/span&gt; &lt;span class="n"&gt;Beam&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;BMAJ&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;1.15963029861&lt;/span&gt; &lt;span class="n"&gt;arcsec&lt;/span&gt; &lt;span class="n"&gt;BMIN&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.96223282814&lt;/span&gt; &lt;span class="n"&gt;arcsec&lt;/span&gt; &lt;span class="n"&gt;BPA&lt;/span&gt;&lt;span class="o"&gt;=-&lt;/span&gt;&lt;span class="mf"&gt;71.0310058594&lt;/span&gt; &lt;span class="n"&gt;deg&lt;/span&gt;

&lt;span class="n"&gt;In&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;9&lt;/span&gt;&lt;span class="p"&gt;]:&lt;/span&gt; &lt;span class="n"&gt;goodcube&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;beam&lt;/span&gt;
&lt;span class="n"&gt;Out&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;9&lt;/span&gt;&lt;span class="p"&gt;]:&lt;/span&gt; &lt;span class="n"&gt;Beam&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;BMAJ&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.408393889665&lt;/span&gt; &lt;span class="n"&gt;arcsec&lt;/span&gt; &lt;span class="n"&gt;BMIN&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.229679107666&lt;/span&gt; &lt;span class="n"&gt;arcsec&lt;/span&gt; &lt;span class="n"&gt;BPA&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;45.966835022&lt;/span&gt; &lt;span class="n"&gt;deg&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;I don't yet know what is causing this error.  When I try re-doing the clean
with &lt;tt class="docutils literal"&gt;tclean&lt;/tt&gt;, I get the following message, which is a hint:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
2016-01-25 09:13:04     WARN    task_tclean::SIImageStore::getPSFGaussian (file
/var/rpmbuild/BUILD/casa-prerelease/casa-prerelease-4.5.0/code/synthesis/ImagerObjects/SIImageStore.cc,
line 1262)      PSF is blank for[C139:P0] [C140:P0] [C141:P0] [C142:P0]
[C143:P0] [C144:P0] [C145:P0] [C146:P0] [C147:P0] [C148:P0] [C149:P0] [C150:P0]
[C151:P0] [C152:P0] [C153:P0] [C154:P0] [C155:P0] [C156:P0] [C157:P0] [C158:P0]
[C159:P0] [C160:P0] [C161:P0] [C162:P0] [C163:P0] [C164:P0] [C165:P0] [C166:P0]
[C167:P0] [C168:P0] [C169:P0] [C170:P0] [C171:P0] [C172:P0] [C173:P0] [C174:P0]
[C175:P0] [C176:P0] [C177:P0] [C178:P0] [C179:P0] [C180:P0] [C181:P0] [C182:P0]
[C183:P0] [C184:P0] [C185:P0] [C186:P0]
&lt;/pre&gt;
&lt;p&gt;Apparently tclean solves this problem!  Instead of using a single beam for all
channels, it creates a CASAMBM table in the FITS output and uses different
beams at each channel.  There must be genuinely bad data (probably an
atmospheric absorption line) at the specified frequencies.  At least now, that
will come up more naturally, rather than spiking the data.&lt;/p&gt;
</content><category term="misc"></category><category term="CASA"></category><category term="imaging"></category><category term="cubes"></category></entry><entry><title>Comparing tclean parameters</title><link href="https://keflavich.github.io/blog/comparing-tclean-parameters.html" rel="alternate"></link><published>2016-01-14T09:57:00-07:00</published><updated>2016-01-14T09:57:00-07:00</updated><author><name>Adam Ginsburg (Adam.G.Ginsburg@gmail.com)</name></author><id>tag:keflavich.github.io,2016-01-14:/blog/comparing-tclean-parameters.html</id><summary type="html">&lt;p&gt;Comparing clean methods with identical data &amp;amp; parameters (as far as possible):
&lt;a class="reference external" href="https://github.com/keflavich/W51_ALMA_2013.1.00308.S/blob/master/script_merge/clean_method_comparison.py"&gt;code&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;An example using natural weighting:&lt;/p&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/casa/tclean_compare.png" style="width: 600px;" /&gt;
&lt;p&gt;None of the methods are acceptable.  Multiscale is the worst, but hogbom is
extremely bad: there are major ringing artifacts (stripes parallel to the main
filament).&lt;/p&gt;
&lt;p&gt;Disturbingly, even though I have given multiple …&lt;/p&gt;</summary><content type="html">&lt;p&gt;Comparing clean methods with identical data &amp;amp; parameters (as far as possible):
&lt;a class="reference external" href="https://github.com/keflavich/W51_ALMA_2013.1.00308.S/blob/master/script_merge/clean_method_comparison.py"&gt;code&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;An example using natural weighting:&lt;/p&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/casa/tclean_compare.png" style="width: 600px;" /&gt;
&lt;p&gt;None of the methods are acceptable.  Multiscale is the worst, but hogbom is
extremely bad: there are major ringing artifacts (stripes parallel to the main
filament).&lt;/p&gt;
&lt;p&gt;Disturbingly, even though I have given multiple scales, there are clearly no
non-pointlike scales in any of the model images, including mem, so I think
there's a major problem with tclean:&lt;/p&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/casa/tclean_compare_models.png" style="width: 600px;" /&gt;
&lt;p&gt;I'm re-doing it with uniform weighting, because that's the case I was actually
interested in.&lt;/p&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/casa/tclean_compare_uniform.png" style="width: 600px;" /&gt;
&lt;p&gt;The uniform tests come up with a clear and obvious answer: use clark clean, DO
NOT use any other methods as they are all unstable.&lt;/p&gt;
</content><category term="misc"></category><category term="casa"></category><category term="clean"></category><category term="tclean"></category></entry><entry><title>Self-cal with EVLA data</title><link href="https://keflavich.github.io/blog/self-cal-with-evla-data.html" rel="alternate"></link><published>2016-01-07T08:14:00-07:00</published><updated>2016-01-07T08:14:00-07:00</updated><author><name>Adam Ginsburg (Adam.G.Ginsburg@gmail.com)</name></author><id>tag:keflavich.github.io,2016-01-07:/blog/self-cal-with-evla-data.html</id><summary type="html">&lt;p&gt;I'm trying to self-calibrate my A+C array C-band data on W51, since we're in a
clearly dynamic-range-limited regime.  I've never had any luck with self-cal,
though.  The images &lt;em&gt;always&lt;/em&gt; get worse, and I still don't really understand
why.&lt;/p&gt;
&lt;p&gt;This is a clue, though:&lt;/p&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/w51/selfcal_phasecal_vs_time.png" style="width: 600px;" /&gt;
&lt;p&gt;For many of the antennae, especially …&lt;/p&gt;</summary><content type="html">&lt;p&gt;I'm trying to self-calibrate my A+C array C-band data on W51, since we're in a
clearly dynamic-range-limited regime.  I've never had any luck with self-cal,
though.  The images &lt;em&gt;always&lt;/em&gt; get worse, and I still don't really understand
why.&lt;/p&gt;
&lt;p&gt;This is a clue, though:&lt;/p&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/w51/selfcal_phasecal_vs_time.png" style="width: 600px;" /&gt;
&lt;p&gt;For many of the antennae, especially those in C array, self-calibration results
in phase plots that look nice, with corrections confined to +/-30 degrees as
you would hope and expect.&lt;/p&gt;
&lt;p&gt;These plots show that some antennae are going through dozens or hundreds of
phase wraps.  That is obviously unacceptable and incorrect: the original images
actually looked pretty good, so it is obvious (to me, at least) that there
should be &lt;em&gt;no&lt;/em&gt; phase wrapping in the self-cal.  I'm surprised at this, since
each of these points should have S/N &amp;gt; 3 and there is a lot of consistency in
these large phase shifts.&lt;/p&gt;
&lt;p&gt;My suspicion is still that the clean process has failed.  I have been trying
multiscale clean, since the emission is completely dominated by extended
components.  However, even if I set smallscalebias to different values, there
are essentially no pointlike components being added to the clean model.  This
is wrong!  There are genuine point sources.  So I still suspect that this is a
modeling problem and the phase wraps are being caused by bad models.&lt;/p&gt;
&lt;p&gt;I'm trying again with smaller pixels in the hope that a better match between
the beam size and the pixel size will produce a better model.  The only other
thing I can think to try is increasing the solint, but given the high S/N
already present, I doubt that's an important factor.&lt;/p&gt;
&lt;p&gt;Smaller pixels didn't help, &lt;em&gt;but&lt;/em&gt; forcing clean to include point-source
components by performing a second round of clean with &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;multiscale=[]&lt;/span&gt;&lt;/tt&gt; worked!
The solutions are MUCH more reasonable (no more phase wrap every integration),
and selfcal no longer diverges.  I also increased the solution interval to 30s
since it seems that the phase change timescale is significantly longer than
an integration.  I increased the S/N cutoff to 5 too.&lt;/p&gt;
&lt;p&gt;There are still some &amp;quot;noisy&amp;quot; phases, even in the 3rd iteration:&lt;/p&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/w51/selfcal_phasecal_vs_time_3rditer.png" style="width: 600px;" /&gt;
&lt;p&gt;I think more iterations may be necessary, but I will also increase the S/N
threshold to 6 and solint to 60s to see if that helps.&lt;/p&gt;
&lt;p&gt;RMS improvements are evident but not spectacular:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
SPW4 Iteration 0: RMS=1.003e-04
SPW4 Iteration 1: RMS=6.009e-05
SPW4 Iteration 2: RMS=6.698e-05
SPW4 Iteration 3: RMS=7.061e-05
&lt;/pre&gt;
&lt;p&gt;The bump in the last one is because I forgot to add a point clean for the last
iteration.&lt;/p&gt;
&lt;p&gt;Perhaps not unfortunately, it looks like the improvements in image quality are
tiny when self-cal is added.  The only real hope now is that self-cal on all
bands will result in an artifact-free final combined image.&lt;/p&gt;
&lt;p&gt;On the &amp;quot;noisy&amp;quot; phases, now that it looks like there are decent solutions, it
may actually be worth keeping the flags generated by applycal.  &amp;lt;10% of the
data is being flagged out, which is negligible, and it probably is genuinely
bad (or signal-free, anyway) in that case.&lt;/p&gt;
&lt;p&gt;EDIT: Looks better... or at least different... now:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
SPW4 Iteration 0: RMS=1.003e-04
SPW4 Iteration 1: RMS=5.962e-05
SPW4 Iteration 2: RMS=6.817e-05
SPW4 Iteration 3: RMS=6.775e-05
&lt;/pre&gt;
</content><category term="misc"></category><category term="w51"></category><category term="evla"></category><category term="casa"></category></entry><entry><title>FFT comparisons in python</title><link href="https://keflavich.github.io/blog/fft-comparisons-in-python.html" rel="alternate"></link><published>2015-12-07T11:24:00-07:00</published><updated>2015-12-07T11:24:00-07:00</updated><author><name>Adam Ginsburg (Adam.G.Ginsburg@gmail.com)</name></author><id>tag:keflavich.github.io,2015-12-07:/blog/fft-comparisons-in-python.html</id><summary type="html">&lt;p&gt;I'm trying to figure out which ffts are fastest, best, etc.&lt;/p&gt;
&lt;p&gt;First, it is difficult to get fftw3 + pyfftw installed into python.&lt;/p&gt;
&lt;p&gt;For pyfftw to install, you need to &lt;a class="reference external" href="http://www.fftw.org/doc/Installation-on-Unix.html"&gt;enable floats and every specific type&lt;/a&gt; when compiling &lt;a class="reference external" href="http://www.fftw.org/"&gt;fftw3&lt;/a&gt; (thanks to &lt;a class="reference external" href="http://linuxtoolkit.blogspot.de/2010/04/cant-find-fftw3f-library-when.html"&gt;linux toolkits blog&lt;/a&gt;).
Apparently you can't have &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;--enable-long-double&lt;/span&gt;&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;--enable-float …&lt;/span&gt;&lt;/tt&gt;&lt;/p&gt;</summary><content type="html">&lt;p&gt;I'm trying to figure out which ffts are fastest, best, etc.&lt;/p&gt;
&lt;p&gt;First, it is difficult to get fftw3 + pyfftw installed into python.&lt;/p&gt;
&lt;p&gt;For pyfftw to install, you need to &lt;a class="reference external" href="http://www.fftw.org/doc/Installation-on-Unix.html"&gt;enable floats and every specific type&lt;/a&gt; when compiling &lt;a class="reference external" href="http://www.fftw.org/"&gt;fftw3&lt;/a&gt; (thanks to &lt;a class="reference external" href="http://linuxtoolkit.blogspot.de/2010/04/cant-find-fftw3f-library-when.html"&gt;linux toolkits blog&lt;/a&gt;).
Apparently you can't have &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;--enable-long-double&lt;/span&gt;&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;--enable-float&lt;/span&gt;&lt;/tt&gt; simultaneously,
but pyfftw requires both, so you have to install twice or thrice?  Nope, four
times!!  Also, &lt;a class="reference external" href="https://github.com/hgomersall/pyFFTW/issues/16#issuecomment-19422752"&gt;my own post&lt;/a&gt;
indicates that I should install to a different path to avoid weird conflicts
with other libraries.&lt;/p&gt;
&lt;pre class="literal-block"&gt;
./configure --enable-threads --enable-openmp --enable-mpi --enable-shared \
            --enable-fortran --enable-avx \
            CFLAGS=&amp;quot;-O3 -fno-common -fomit-frame-pointer -fstrict-aliasing&amp;quot;
make -j 4
sudo make install

./configure --enable-float --enable-threads --enable-openmp --enable-mpi --enable-shared \
            --enable-fortran --enable-avx \
            CFLAGS=&amp;quot;-O3 -fno-common -fomit-frame-pointer -fstrict-aliasing&amp;quot;
make -j 4
sudo make install

# quad precision is not supported in mpi
./configure --enable-quad-precision --enable-threads --enable-openmp --enable-shared \
            --enable-fortran --enable-avx \
             CFLAGS=&amp;quot;-O3 -fno-common -fomit-frame-pointer -fstrict-aliasing&amp;quot;
make -j 4
sudo make install

./configure --enable-long-double --enable-threads --enable-openmp --enable-mpi --enable-shared \
            --enable-fortran --enable-avx \
             CFLAGS=&amp;quot;-O3 -fno-common -fomit-frame-pointer -fstrict-aliasing&amp;quot;
make -j 4
sudo make install
&lt;/pre&gt;
&lt;p&gt;Onto speed test comparisons:&lt;/p&gt;
&lt;blockquote&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;a class="reference external" href="https://gist.github.com/mperrin/5763120"&gt;Marshal Perrin's&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="https://gist.github.com/keflavich/5797994"&gt;my fork&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://code.google.com/p/agpy/source/browse/trunk/tests/test_ffts.py"&gt;speed tests on agpy&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="https://github.com/astropy/astropy/pull/4374"&gt;profiling convolve_fft with different parameters&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;p&gt;If you want to use &lt;tt class="docutils literal"&gt;fftw3&lt;/tt&gt; with astropy's &lt;a class="reference external" href="http://docs.astropy.org/en/stable/api/astropy.convolution.convolve_fft.html#astropy.convolution.convolve_fft"&gt;convolve_fft&lt;/a&gt;,
use &lt;a class="reference external" href="https://code.google.com/p/agpy/source/browse/trunk/AG_fft_tools/convolve_nd.py?r=479#8"&gt;this example&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Onto some comparisons from &lt;a class="reference external" href="https://github.com/astropy/astropy/pull/4374"&gt;astropy issue 4374&lt;/a&gt;:&lt;/p&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/time_vs_mem.png" style="width: 600px;" /&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/psfTfftT.png" style="width: 600px;" /&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/psfTfftF.png" style="width: 600px;" /&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/psfFfftT.png" style="width: 600px;" /&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/psfFfftF.png" style="width: 600px;" /&gt;
&lt;p&gt;&lt;a class="reference external" href="https://gist.github.com/6a2d338830efdc02959a"&gt;Notebook containing comparisons between FFT and FFTW&lt;/a&gt;&lt;/p&gt;
</content><category term="misc"></category><category term="fft"></category><category term="convolution"></category></entry><entry><title>Separating Line from Continuum in CASA data</title><link href="https://keflavich.github.io/blog/separating-line-from-continuum-in-casa-data.html" rel="alternate"></link><published>2015-11-04T15:57:00-07:00</published><updated>2015-11-04T15:57:00-07:00</updated><author><name>Adam Ginsburg (Adam.G.Ginsburg@gmail.com)</name></author><id>tag:keflavich.github.io,2015-11-04:/blog/separating-line-from-continuum-in-casa-data.html</id><summary type="html">&lt;p&gt;I'm continuing to try to separate the line forest from the continuum data in my
W51 cube.  Some approaches 'kinda work', some don't.&lt;/p&gt;
&lt;p&gt;The iterative approach suggested in the &lt;a class="reference external" href="|static|cvel_w51_fail.rst"&gt;previous post&lt;/a&gt; &lt;a class="reference external" href="https://github.com/keflavich/W51_ALMA_2013.1.00308.S/blob/630c60e7e57ea7b57877d66b15860b26419a5552/script_12m/uvcontsub_test.py"&gt;works reasonably well&lt;/a&gt;,
but results in oversubtraction of the continuum, even with
a few iterations.  Note that this approach …&lt;/p&gt;</summary><content type="html">&lt;p&gt;I'm continuing to try to separate the line forest from the continuum data in my
W51 cube.  Some approaches 'kinda work', some don't.&lt;/p&gt;
&lt;p&gt;The iterative approach suggested in the &lt;a class="reference external" href="|static|cvel_w51_fail.rst"&gt;previous post&lt;/a&gt; &lt;a class="reference external" href="https://github.com/keflavich/W51_ALMA_2013.1.00308.S/blob/630c60e7e57ea7b57877d66b15860b26419a5552/script_12m/uvcontsub_test.py"&gt;works reasonably well&lt;/a&gt;,
but results in oversubtraction of the continuum, even with
a few iterations.  Note that this approach requires &lt;a class="reference external" href="https://github.com/keflavich/W51_ALMA_2013.1.00308.S/blob/630c60e7e57ea7b57877d66b15860b26419a5552/script_12m/uvcontsub_test.py#L17"&gt;copying columns between ms
files using the table toolkit&lt;/a&gt;.&lt;/p&gt;
&lt;img alt="Oversubtracted spectrum" src="https://keflavich.github.io/blog/images/w51/oversubtracted_spectrum.png" style="width: 400px;" /&gt;
&lt;p&gt;Another approach I wanted to try was to image the whole cube, take the minimum
value along the spectral axis, and subtract that.  This would avoid the
oversubtraction issue by force.  However, &lt;a class="reference external" href="https://github.com/keflavich/W51_ALMA_2013.1.00308.S/blob/c58e4fdf755f85b163d1684cc7383ef31d6a1669/script_12m/mincontsub.py"&gt;this&lt;/a&gt;
leads to failures in the &lt;cite&gt;ft&lt;/cite&gt; task:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
CASA &amp;lt;85&amp;gt;: ft(vis='w51_test_small_imcont.ms', model='test_continuum_min.image', usescratch=True, nterms=1)
2015-11-04 15:01:29 WARN    ft::FTMachine::initMaps No overlap in frequency between image channels and selected data found for this FTMachine
2015-11-04 15:01:29 WARN    ft::FTMachine::initMaps+         Check your data selection and image parameters if you end up with a blank image
&lt;/pre&gt;
&lt;p&gt;which I don't understand.  I had to &lt;a class="reference external" href="https://github.com/keflavich/W51_ALMA_2013.1.00308.S/blob/c58e4fdf755f85b163d1684cc7383ef31d6a1669/script_12m/mincontsub.py#L22"&gt;hack the header&lt;/a&gt;
just to get ft to load the file at all, and apparently my hack wasn't good enough.
It's really unclear to me now how to load a model from a FITS file.&lt;/p&gt;
&lt;p&gt;The next approach is to load the whole continuum-subtracted cube into a model,
subtract THAT, then make a continuum image, then subtract that, then maybe
we have line and continuum?  Maybe?  I suspect this approach will require
some sort of cube masking.&lt;/p&gt;
&lt;p&gt;Unfortunately, ft is again the problem:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
2015-11-04 15:09:08 SEVERE  ft::imager::ft() (file /Users/rpmbuild/gradle/workdir/casaautobuild/release-4_5/code/synthesis/MeasurementEquations/Imager.cc, line 4488)       Exception: (/Users/rpmbuild/gradle/workdir/casaautobuild/release-4_5/darwin/include/casacore/lattices/Lattices/Lattice.tcc : 299) Failed AlwaysAssert shapeIn.isEqual (shapeOut)
&lt;/pre&gt;
&lt;p&gt;Followup in early 2017: a cube-based approach is generally more successful.
See Sanchez-Monge in prep and the related &lt;a class="reference external" href="https://github.com/radio-astro-tools/statcont"&gt;statcont&lt;/a&gt; software package.&lt;/p&gt;
</content><category term="misc"></category><category term="CASA"></category></entry><entry><title>CVEL errors</title><link href="https://keflavich.github.io/blog/cvel-errors.html" rel="alternate"></link><published>2015-11-02T20:50:00-07:00</published><updated>2015-11-02T20:50:00-07:00</updated><author><name>Adam Ginsburg (Adam.G.Ginsburg@gmail.com)</name></author><id>tag:keflavich.github.io,2015-11-02:/blog/cvel-errors.html</id><summary type="html">&lt;p&gt;I'm trying to get a good image of the W51 main sources that have line forests.
MFS clean does a pretty good job, but is very limited in dynamic range
presumably because the spectral lines manifest as amplitude errors.&lt;/p&gt;
&lt;p&gt;I tried splitting the data to merge my two spectral windows …&lt;/p&gt;</summary><content type="html">&lt;p&gt;I'm trying to get a good image of the W51 main sources that have line forests.
MFS clean does a pretty good job, but is very limited in dynamic range
presumably because the spectral lines manifest as amplitude errors.&lt;/p&gt;
&lt;p&gt;I tried splitting the data to merge my two spectral windows using &lt;cite&gt;cvel&lt;/cite&gt;
(&lt;a class="reference external" href="https://github.com/keflavich/W51_ALMA_2013.1.00308.S/blob/4c29c8dc763e3f994279d50db72b9a0dfc2a35b7/script_12m/split_for_localtests.py#L8"&gt;code&lt;/a&gt;),
but I see thousands of errors like this:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
2015-11-02 19:52:15     WARN    SubMS::combineSpws()    Averaging failed for the following channel/correllation pairs from output row 44432 up to 44459. Corresponding visibilities will be flagged:
2015-11-02 19:52:15     WARN    SubMS::combineSpws()+   (60, 0) (60, 1) (1804, 0) (1804, 1) (1998, 0) (1998, 1)
&lt;/pre&gt;
&lt;p&gt;and when I image the cube, there is a jump at one channel that occurs because
the resolution suddenly changes either because SPW3 (the lo-res SPW) is not
included or because the hi-res one suddenly is.&lt;/p&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/w51/cvel_jump.png" style="width: 400px;" /&gt;
&lt;p&gt;It doesn't look like there's any obvious workaround at the moment, but I'll
probably try sending another helpdesk ticket about this.&lt;/p&gt;
&lt;p&gt;My best idea for getting a decent continuum out now is something like this:&lt;/p&gt;
&lt;blockquote&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;image the whole cube in frequency&lt;/li&gt;
&lt;li&gt;determine channels that can approximate the bright continuum&lt;/li&gt;
&lt;li&gt;use those to uvcontsub the data&lt;/li&gt;
&lt;li&gt;image the uvcontsub'd cube&lt;/li&gt;
&lt;li&gt;uvsub the imaged spectral line cube from the original data&lt;/li&gt;
&lt;li&gt;re-image the now-continuum-only cube using mfs&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;p&gt;EDIT: Dirk replied to the helpdesk ticket, suggesting:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
Concerning cvel: try to process one SPW at a time. Otherwise cvel will
_combine_ the SPWs and if they are not observed at the same time, this will
lead to problems.
&lt;/pre&gt;
&lt;p&gt;So I've now &lt;a class="reference external" href="https://github.com/keflavich/W51_ALMA_2013.1.00308.S/blob/2d15ce46f9ecd75d70ab7ac4ee8f91b272139d9e/script_12m/split_for_localtests.py#L8"&gt;split the cvel into two commands&lt;/a&gt;.
I also added &lt;cite&gt;outframe='bary'&lt;/cite&gt; because otherwise it's not obvious that the
frequency command is doing anything
sensible or useful.  That's actually probably why I was getting non-overlapping
segments before - it tried converting to barycentric, but maybe too late in the
process (i.e., it tried selecting in topo, then converting to bary for output).
I also added a phasecenter, because it was automatically selecting pointing 24
as the phasecenter for cvel before.&lt;/p&gt;
&lt;p&gt;This led to a new error:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
2015-11-03 14:38:27     WARN    cvel::SubMS::convertGridPars     *** Requested new channel width is smaller than smallest original channel width
2015-11-03 14:38:27     WARN    cvel::SubMS::convertGridPars+        which is 488319 Hz
&lt;/pre&gt;
&lt;p&gt;which I've fixed by setting the output width to be 0.5 MHz, just a simple round
number greater than the input even accounting for shift.  Unfortunately, this
seems to have produced a dramatically larger output MS, which cannot be
correct.... ahhh, it turns out that was temporary, once regridding was complete,
it turned small again.&lt;/p&gt;
</content><category term="misc"></category><category term="casa"></category><category term="cvel"></category></entry><entry><title>CASA clean errors related to channels</title><link href="https://keflavich.github.io/blog/casa-clean-errors-related-to-channels.html" rel="alternate"></link><published>2015-10-28T16:51:00-06:00</published><updated>2015-10-28T16:51:00-06:00</updated><author><name>Adam Ginsburg (Adam.G.Ginsburg@gmail.com)</name></author><id>tag:keflavich.github.io,2015-10-28:/blog/casa-clean-errors-related-to-channels.html</id><summary type="html">&lt;p&gt;When cleaning my ALMA data, especially when trying to &lt;a class="reference external" href="https://github.com/keflavich/SgrB2_ALMA_3mm_Mosaic/blob/master/script_12m/scriptForImaging.py#L120"&gt;image the full cube (all
channels)&lt;/a&gt;
when there are multiple SBs
with slightly different frequencies, I see this error frequently:&lt;/p&gt;
&lt;blockquote&gt;
No valid data, skip CLEANing this channel&lt;/blockquote&gt;
&lt;p&gt;It seems that the channel really is being skipped in many cases.  In the …&lt;/p&gt;</summary><content type="html">&lt;p&gt;When cleaning my ALMA data, especially when trying to &lt;a class="reference external" href="https://github.com/keflavich/SgrB2_ALMA_3mm_Mosaic/blob/master/script_12m/scriptForImaging.py#L120"&gt;image the full cube (all
channels)&lt;/a&gt;
when there are multiple SBs
with slightly different frequencies, I see this error frequently:&lt;/p&gt;
&lt;blockquote&gt;
No valid data, skip CLEANing this channel&lt;/blockquote&gt;
&lt;p&gt;It seems that the channel really is being skipped in many cases.  In the Sgr B2
cube, this wasn't a problem because I unintentionally cleaned only one of the
observations.  For the W51 and Orion data, I tried to &lt;a class="reference external" href="https://github.com/keflavich/W51_ALMA_2013.1.00308.S/blob/master/script_12m/scriptForImaging_fullcube.py"&gt;include all of the data&lt;/a&gt;,
but that is causing problems.  Perhaps CASA does not work at all when 'channel'
is specified and the channels aren't aligned?  Or maybe it only accepts channels
when all channels exist?&lt;/p&gt;
&lt;p&gt;I've now redone the 'full cube' imaging to separately image the two SBs in W51.
I'll see if that works...&lt;/p&gt;
&lt;p&gt;Nope, the resulting error is much worse:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
Log:
2015-10-28 15:49:01     INFO    imager::clean() Fitted beam used in restoration: 1.07809 by 0.913862 (arcsec) at pa -63.3899 (deg)
2015-10-28 15:49:01     INFO    imager::iClean()        Restoring Image(s) with the clean-beam
2015-10-28 15:49:02     SEVERE  clean::::       An error occurred running task clean.

Terminal:
*** Error ***  The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()
2015-10-28 15:49:02     SEVERE  clean::::       An error occurred running task clean.
&lt;/pre&gt;
&lt;p&gt;This is an indication of a major underlying python bug.&lt;/p&gt;
</content><category term="misc"></category><category term="clean"></category><category term="casa"></category></entry><entry><title>pyspeckit is py3-compatible</title><link href="https://keflavich.github.io/blog/pyspeckit-is-py3-compatible.html" rel="alternate"></link><published>2015-10-28T10:28:00-06:00</published><updated>2015-10-28T10:28:00-06:00</updated><author><name>Adam Ginsburg (Adam.G.Ginsburg@gmail.com)</name></author><id>tag:keflavich.github.io,2015-10-28:/blog/pyspeckit-is-py3-compatible.html</id><content type="html">&lt;p&gt;With PR &lt;a class="reference external" href="https://github.com/pyspeckit/pyspeckit/pull/110"&gt;#110&lt;/a&gt; and &lt;a class="reference external" href="https://github.com/pyspeckit/pyspeckit/pull/111"&gt;#111&lt;/a&gt;, pyspeckit is now (apparently)
fully python3-compatible.  The test suite passes, but that's not a guarantee
that I've caught all bugs in the translation.&lt;/p&gt;
</content><category term="misc"></category><category term="pyspeckit"></category><category term="python 3"></category></entry><entry><title>Self-calibration of Sgr B2 Mosaic</title><link href="https://keflavich.github.io/blog/self-calibration-of-sgr-b2-mosaic.html" rel="alternate"></link><published>2015-10-14T14:30:00-06:00</published><updated>2015-10-14T14:30:00-06:00</updated><author><name>Adam Ginsburg (Adam.G.Ginsburg@gmail.com)</name></author><id>tag:keflavich.github.io,2015-10-14:/blog/self-calibration-of-sgr-b2-mosaic.html</id><summary type="html">&lt;p&gt;The Sgr B2 ALMA data from project 2013.1.00269.S has imaging problems around
the brightest sources, especially Sgr B2 M.
Crystal Brogan &amp;amp; Todd Hunter gave some useful advice, essentially the following:&lt;/p&gt;
&lt;blockquote&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;the line forest is causing trouble, so line-containing regions of the spectrum
must be excluded when mapping …&lt;/li&gt;&lt;/ul&gt;&lt;/blockquote&gt;</summary><content type="html">&lt;p&gt;The Sgr B2 ALMA data from project 2013.1.00269.S has imaging problems around
the brightest sources, especially Sgr B2 M.
Crystal Brogan &amp;amp; Todd Hunter gave some useful advice, essentially the following:&lt;/p&gt;
&lt;blockquote&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;the line forest is causing trouble, so line-containing regions of the spectrum
must be excluded when mapping&lt;/li&gt;
&lt;li&gt;there is some nasty curvature in the spectral baseline that needs to be removed
probably by flagging out some of the data&lt;/li&gt;
&lt;li&gt;Self-calibration is needed to exceed a dynamic range ~100&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;p&gt;Todd developed a &lt;cite&gt;fitcontinuum.py&lt;/cite&gt; script to address the first point, but I ended up
doing this custom (&lt;a class="reference external" href="https://github.com/keflavich/SgrB2_ALMA_3mm_Mosaic/blob/master/script_12m/test_split_spw1.py"&gt;script&lt;/a&gt;) because of the problem introduced by the second point.&lt;/p&gt;
&lt;p&gt;To exclude the lines, I had to use &lt;em&gt;frequency-based&lt;/em&gt; selection, not channel based, because my
spectral windows from different dates were offset by 10 MHz.  The approach to use in CASA is
ugly: you flag the line-containing data, then split (and in splitting, average) the continuum
into another MS.  From there, a phase-only selfcal is straigtforward (&lt;a class="reference external" href="https://github.com/keflavich/SgrB2_ALMA_3mm_Mosaic/blob/master/script_12m/selfcal_spw1_center.py"&gt;script&lt;/a&gt;).&lt;/p&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/sgrb2/selfcal_compare.png" style="width: 800px;" /&gt;
</content><category term="misc"></category><category term="CASA"></category><category term="ALMA"></category><category term="Sgr B2"></category></entry><entry><title>Sensitivity Plots using astroquery NRAO tool</title><link href="https://keflavich.github.io/blog/sensitivity-plots-using-astroquery-nrao-tool.html" rel="alternate"></link><published>2015-10-09T14:00:00-06:00</published><updated>2015-10-09T14:00:00-06:00</updated><author><name>Adam Ginsburg (Adam.G.Ginsburg@gmail.com)</name></author><id>tag:keflavich.github.io,2015-10-09:/blog/sensitivity-plots-using-astroquery-nrao-tool.html</id><summary type="html">&lt;p&gt;I wanted to see what the approximate depth achieved by (repeated)
VLA observations of a few sources was, at least theoretically.
This is relatively easy to do:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;astropy&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;units&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;u&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;astroquery.nrao&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Nrao&lt;/span&gt;
&lt;span class="n"&gt;result&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Nrao&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;query&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coordinates&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;coordinates&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SkyCoord&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;from_name&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Sgr B2(M)&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
                      &lt;span class="n"&gt;radius …&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;</summary><content type="html">&lt;p&gt;I wanted to see what the approximate depth achieved by (repeated)
VLA observations of a few sources was, at least theoretically.
This is relatively easy to do:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;astropy&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;units&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;u&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;astroquery.nrao&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Nrao&lt;/span&gt;
&lt;span class="n"&gt;result&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Nrao&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;query&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coordinates&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;coordinates&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SkyCoord&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;from_name&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Sgr B2(M)&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
                      &lt;span class="n"&gt;radius&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;arcmin&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;pylab&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;pl&lt;/span&gt;

&lt;span class="n"&gt;pl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;pl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;loglog&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Observing Freq&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mf"&gt;1e3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;TOS&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;.&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;pl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Observed Frequency (GHz)&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;pl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Time-on-Source (s)&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;pl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;pl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;loglog&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Observing Freq&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mf"&gt;1e3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;TOS&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Bandwidth&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;.&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;pl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Observed Frequency (GHz)&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;pl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Relative depth (Hz s)&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/TOS_vs_freq.png" style="width: 800px;" /&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/depth_vs_freq.png" style="width: 800px;" /&gt;
</content><category term="misc"></category><category term="radio"></category><category term="astropy"></category><category term="python"></category><category term="astroquery"></category></entry><entry><title>ALMA QA2 restoration</title><link href="https://keflavich.github.io/blog/alma-qa2-restoration.html" rel="alternate"></link><published>2015-10-02T09:00:00-06:00</published><updated>2015-10-02T09:00:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2015-10-02:/blog/alma-qa2-restoration.html</id><summary type="html">&lt;p&gt;In case you ever encounter this error about a missing &lt;cite&gt;Source.xml&lt;/cite&gt; file:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
IOError: [Errno 2] No such file or directory: '/diskb/aginsbur/orion/2013.1.00546.S/science_goal.uid___A001_X122_X35c/group.uid___A001_X122_X35d/member.uid___A001_X122_X35e/calibrated/working/uid___A002_X960614_X39db …&lt;/pre&gt;</summary><content type="html">&lt;p&gt;In case you ever encounter this error about a missing &lt;cite&gt;Source.xml&lt;/cite&gt; file:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
IOError: [Errno 2] No such file or directory: '/diskb/aginsbur/orion/2013.1.00546.S/science_goal.uid___A001_X122_X35c/group.uid___A001_X122_X35d/member.uid___A001_X122_X35e/calibrated/working/uid___A002_X960614_X39db.ms/Source.xml'
WARNING: Failure executing file: &amp;lt;scriptForPI.py&amp;gt;
&lt;/pre&gt;
&lt;p&gt;the solution is this ticket: &lt;a class="reference external" href="https://help.almascience.org/index.php?/Knowledgebase/Article/View/266/5/what-should-i-do-if-scriptforpi-aborts-at-the-importasdm-step-with-error"&gt;https://help.almascience.org/index.php?/Knowledgebase/Article/View/266/5/what-should-i-do-if-scriptforpi-aborts-at-the-importasdm-step-with-error&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;So my solution:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
orion /diskb/aginsbur/atca master$ mv /diskb/aginsbur/casa/casapy-42.2.30986-pipe-1-64b/lib64/libxml2.so.2 /diskb/aginsbur/casa/casapy-42.2.30986-pipe-1-64b/lib64/origlibxml2.so.2
orion /diskb/aginsbur/atca master$ locate libxml2.so.2
/diskb/aginsbur/casa/casapy-42.2.30986-pipe-1-64b/lib64/libxml2.so.2
/diskb/aginsbur/casa/casapy-42.2.30986-pipe-1-64b/lib64/libxml2.so.2.6.26
/home/aginsbur/anaconda/lib/libxml2.so.2
/home/aginsbur/anaconda/lib/libxml2.so.2.9.2
/home/aginsbur/anaconda/pkgs/libxml2-2.9.2-0/lib/libxml2.so.2
/home/aginsbur/anaconda/pkgs/libxml2-2.9.2-0/lib/libxml2.so.2.9.2
/opt/anaconda/lib/libxml2.so.2
/opt/anaconda/lib/libxml2.so.2.9.2
/opt/anaconda/pkgs/libxml2-2.9.2-0/lib/libxml2.so.2
/opt/anaconda/pkgs/libxml2-2.9.2-0/lib/libxml2.so.2.9.2
/usr/lib64/libxml2.so.2
/usr/lib64/libxml2.so.2.9.1
orion /diskb/aginsbur/atca master$ ln -sf /usr/lib64/libxml2.so.2 /diskb/aginsbur/casa/casapy-42.2.30986-pipe-1-64b/lib64/libxml2.so.2
&lt;/pre&gt;
</content><category term="misc"></category><category term="alma"></category></entry><entry><title>Export to FITS with MIRIAD</title><link href="https://keflavich.github.io/blog/export-to-fits-with-miriad.html" rel="alternate"></link><published>2015-09-15T15:30:00-06:00</published><updated>2015-09-15T15:30:00-06:00</updated><author><name>Adam Ginsburg (adam.g.ginsburg@gmail.com)</name></author><id>tag:keflavich.github.io,2015-09-15:/blog/export-to-fits-with-miriad.html</id><content type="html">&lt;p&gt;To convert from MIRIAD map files to FITS, use:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
miriad% fits in=h2comos1.clr out=h2comos1.fits op=xyout
&lt;/pre&gt;
&lt;p&gt;(see &lt;a class="reference external" href="converting-gildas-class-data-cubes-lmv-files-to-fits.rst"&gt;the CLASS conversion post&lt;/a&gt;)&lt;/p&gt;
</content><category term="misc"></category></entry><entry><title>Installing Miriad</title><link href="https://keflavich.github.io/blog/installing-miriad.html" rel="alternate"></link><published>2015-09-14T00:00:00-06:00</published><updated>2015-09-14T00:00:00-06:00</updated><author><name>Adam &lt;keflavich@gmail.com&gt;</name></author><id>tag:keflavich.github.io,2015-09-14:/blog/installing-miriad.html</id><summary type="html">&lt;p&gt;From Andrew Walsh, a script to install MIRIAD:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;wget&lt;span class="w"&gt; &lt;/span&gt;ftp://ftp.atnf.csiro.au/pub/software/miriad/miriad-common.tar.bz2
wget&lt;span class="w"&gt; &lt;/span&gt;ftp://ftp.atnf.csiro.au/pub/software/miriad/miriad-linux64.tar.bz2
bzcat&lt;span class="w"&gt; &lt;/span&gt;miriad-common.tar.bz2&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;tar&lt;span class="w"&gt; &lt;/span&gt;xvf&lt;span class="w"&gt; &lt;/span&gt;-
bzcat&lt;span class="w"&gt; &lt;/span&gt;miriad-linux64.tar.bz2&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="p"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;tar&lt;span class="w"&gt; &lt;/span&gt;xvf&lt;span class="w"&gt; &lt;/span&gt;-
&lt;span class="nb"&gt;cd&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;miriad
&lt;span class="nb"&gt;export&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;MIR&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;$PWD&lt;/span&gt;
&lt;span class="c1"&gt;# define …&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;</summary><content type="html">&lt;p&gt;From Andrew Walsh, a script to install MIRIAD:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;wget&lt;span class="w"&gt; &lt;/span&gt;ftp://ftp.atnf.csiro.au/pub/software/miriad/miriad-common.tar.bz2
wget&lt;span class="w"&gt; &lt;/span&gt;ftp://ftp.atnf.csiro.au/pub/software/miriad/miriad-linux64.tar.bz2
bzcat&lt;span class="w"&gt; &lt;/span&gt;miriad-common.tar.bz2&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;tar&lt;span class="w"&gt; &lt;/span&gt;xvf&lt;span class="w"&gt; &lt;/span&gt;-
bzcat&lt;span class="w"&gt; &lt;/span&gt;miriad-linux64.tar.bz2&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="p"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;tar&lt;span class="w"&gt; &lt;/span&gt;xvf&lt;span class="w"&gt; &lt;/span&gt;-
&lt;span class="nb"&gt;cd&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;miriad
&lt;span class="nb"&gt;export&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;MIR&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;$PWD&lt;/span&gt;
&lt;span class="c1"&gt;# define the MIR variable in your bashrc&lt;/span&gt;
&lt;span class="nb"&gt;echo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;export MIR=&lt;/span&gt;&lt;span class="nv"&gt;$MIR&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&amp;gt;&amp;gt;&lt;span class="w"&gt; &lt;/span&gt;~/.bashrc
sed&lt;span class="w"&gt; &lt;/span&gt;-e&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;s,@MIRROOT@,&lt;/span&gt;&lt;span class="nv"&gt;$MIR&lt;/span&gt;&lt;span class="s2"&gt;,&amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;scripts/MIRRC.in&lt;span class="w"&gt; &lt;/span&gt;&amp;gt;&lt;span class="w"&gt; &lt;/span&gt;MIRRC
sed&lt;span class="w"&gt; &lt;/span&gt;-e&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;s,@MIRROOT@,&lt;/span&gt;&lt;span class="nv"&gt;$MIR&lt;/span&gt;&lt;span class="s2"&gt;,&amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;scripts/MIRRC.sh.in&lt;span class="w"&gt; &lt;/span&gt;&amp;gt;&lt;span class="w"&gt; &lt;/span&gt;MIRRC.sh
chmod&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;644&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;MIRRC*

&lt;span class="c1"&gt;# Put these into .bashrc, or call them each time you want to run MIRIAD&lt;/span&gt;
.&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;$MIR&lt;/span&gt;/MIRRC.sh
&lt;span class="nb"&gt;export&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;PATH&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;$PATH&lt;/span&gt;:&lt;span class="nv"&gt;$MIRBIN&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
</content><category term="misc"></category><category term="miriad"></category></entry><entry><title>My python + ipython + vim debugging workflow</title><link href="https://keflavich.github.io/blog/my-python-ipython-vim-debugging-workflow.html" rel="alternate"></link><published>2015-05-07T12:00:00-06:00</published><updated>2015-05-07T12:00:00-06:00</updated><author><name>Adam (adam.g.ginsburg@gmail.com)</name></author><id>tag:keflavich.github.io,2015-05-07:/blog/my-python-ipython-vim-debugging-workflow.html</id><summary type="html">&lt;p&gt;My &lt;a class="reference external" href="http://www.eso.org/~eemselle/CV.html"&gt;boss&lt;/a&gt; asked a great question at our first weekly &lt;a class="reference external" href="https://github.com/ESO-python/ESOPythonTutorials"&gt;ESO-python tutorial&lt;/a&gt;
session: What does a good ipython debugging workflow look like?&lt;/p&gt;
&lt;p&gt;The one advantage I had found in IDL was that &lt;em&gt;everything&lt;/em&gt; is a script, which
means that &lt;em&gt;everything&lt;/em&gt; can be debugged in the same way: add a stop …&lt;/p&gt;</summary><content type="html">&lt;p&gt;My &lt;a class="reference external" href="http://www.eso.org/~eemselle/CV.html"&gt;boss&lt;/a&gt; asked a great question at our first weekly &lt;a class="reference external" href="https://github.com/ESO-python/ESOPythonTutorials"&gt;ESO-python tutorial&lt;/a&gt;
session: What does a good ipython debugging workflow look like?&lt;/p&gt;
&lt;p&gt;The one advantage I had found in IDL was that &lt;em&gt;everything&lt;/em&gt; is a script, which
means that &lt;em&gt;everything&lt;/em&gt; can be debugged in the same way: add a stop statement
at the relevant line of code.  Of course, that debugging model breaks apart
badly once you start writing complex programs and using things like common
blocks.&lt;/p&gt;
&lt;p&gt;In ipython, there is a beautiful debugger that is far more feature-rich than
the IDL equivalent.  It can be activated simply:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;pdb&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;will toggle the interactive ipython debugger.  Then, if you run into a code
crash, you will be dumped out at an &lt;cite&gt;ipdb&amp;gt;&lt;/cite&gt; prompt, with access to a
fully-functional python prompt in the local namespace / environment of the
crash point.  You can also move up and down the function hierarchy with the &lt;tt class="docutils literal"&gt;u&lt;/tt&gt;
and &lt;tt class="docutils literal"&gt;d&lt;/tt&gt; commands.&lt;/p&gt;
&lt;p&gt;The existence of the ipdb debugger suggests a natural approach for those
familiar with IDL debugging: simply add a &lt;tt class="docutils literal"&gt;raise&lt;/tt&gt; statement wherever you would
normally have put a &lt;tt class="docutils literal"&gt;stop&lt;/tt&gt; statement.  There are a few key differences,
however: in IDL, you could just &lt;tt class="docutils literal"&gt;.continue&lt;/tt&gt; to run the rest of the code as if
no stop occurred; in python the same is not possible with the default ipdb.&lt;/p&gt;
&lt;p&gt;However, the &lt;a class="reference external" href="https://pypi.python.org/pypi/ipdb"&gt;ipdb&lt;/a&gt; package allows the insertion of breakpoints just like in IDL:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;ipdb&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;ipdb&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_trace&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;From within one of these breakpoints, the &lt;tt class="docutils literal"&gt;.continue&lt;/tt&gt; command will continue on
to the next breakpoint, as you might expect.  The &lt;tt class="docutils literal"&gt;n&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;s&lt;/tt&gt; commands will go
to the next line in the code, while &lt;tt class="docutils literal"&gt;s&lt;/tt&gt; will allow you to drop into called functions (how?)&lt;/p&gt;
&lt;p&gt;&lt;a class="reference external" href="http://scipy-lectures.github.io/advanced/debugging/#using-the-python-debugger"&gt;Postmortem debugging&lt;/a&gt; is also awesome.  If you have run a command and gotten a traceback,
you can retroactively enter the debugger:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;debug&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;but as with the normal traceback debugger, one cannot &lt;tt class="docutils literal"&gt;continue&lt;/tt&gt; afterward.&lt;/p&gt;
&lt;div class="section" id="reloading-code"&gt;
&lt;h2&gt;Reloading Code&lt;/h2&gt;
&lt;p&gt;Python code is typically distributed in packages managed with a &lt;tt class="docutils literal"&gt;setup.py&lt;/tt&gt;
script.  These are the most convenient way to install, use, and distribute
code, but they are not ideal for debugging.&lt;/p&gt;
&lt;p&gt;When debugging a normal script, something you could run by invoking&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;python&lt;span class="w"&gt; &lt;/span&gt;myfile.py
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;or&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;run&lt;/span&gt; &lt;span class="n"&gt;myfile&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;py&lt;/span&gt;
&lt;span class="c1"&gt;# in the local namespace&lt;/span&gt;
&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;run&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="n"&gt;myfile&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;py&lt;/span&gt;
&lt;span class="c1"&gt;# with the python debugger active:&lt;/span&gt;
&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;run&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;d&lt;/span&gt; &lt;span class="n"&gt;myfile&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;py&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;can easily be debugged by running it line-by-line.  The &lt;a class="reference external" href="http://ipython.org/ipython-doc/dev/interactive/tutorial.html#running-and-editing"&gt;documentation&lt;/a&gt;
can be accessed via the &lt;tt class="docutils literal"&gt;%magic&lt;/tt&gt; command.&lt;/p&gt;
&lt;p&gt;For debugging &amp;quot;compiled&amp;quot; packages, though, more thought is needed.&lt;/p&gt;
&lt;p&gt;If you are working on your own package, you can use &lt;a class="reference external" href="https://pythonhosted.org/setuptools/setuptools.html#develop-deploy-the-project-source-in-development-mode"&gt;setuptools&lt;/a&gt; to enable the
&lt;tt class="docutils literal"&gt;python setup.py develop&lt;/tt&gt; command, which installs a symbolic link to the
source code directory - meaning any changes you make are immediately reflected
in the python source path.  This does &lt;em&gt;not&lt;/em&gt; mean that any changes are
recognized in the local python environment, though!&lt;/p&gt;
&lt;p&gt;If you are in an active &lt;tt class="docutils literal"&gt;ipython&lt;/tt&gt; session, you need to &lt;tt class="docutils literal"&gt;reload&lt;/tt&gt; packages to
see their results.  As far as I know, you can &lt;em&gt;never&lt;/em&gt; &amp;quot;reload&amp;quot; the source code
underlying an already-instantiated class, so you have to remake any class
instances you want to examine.&lt;/p&gt;
&lt;p&gt;The &lt;tt class="docutils literal"&gt;reload&lt;/tt&gt; command is tricky to use.  You will only see changes to the source code
if you import the exact package in which the code is stored.  For example, if you have a file structure like this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;mypackage/
&lt;span class="w"&gt;    &lt;/span&gt;__init__.py
&lt;span class="w"&gt;    &lt;/span&gt;core.py
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;and you do &lt;tt class="docutils literal"&gt;reload(mypackage)&lt;/tt&gt;, that will effectively reload only the source
code in &lt;tt class="docutils literal"&gt;__init__.py&lt;/tt&gt;.  If the code you want to use is called &lt;tt class="docutils literal"&gt;myfunction&lt;/tt&gt;
and it lives in &lt;tt class="docutils literal"&gt;core.py&lt;/tt&gt;, you can reload that source code by doing
&lt;tt class="docutils literal"&gt;reload(mypackage.core)&lt;/tt&gt;.  Reloading &lt;tt class="docutils literal"&gt;mypackage&lt;/tt&gt; may have no effect.  So
the key for developing packages is finding the right module to reload!&lt;/p&gt;
&lt;p&gt;IPython has a &lt;a class="reference external" href="http://ipython.org/ipython-doc/dev/interactive/reference.html#dreload"&gt;deepreload package&lt;/a&gt;
intended to recursively reload functions; it may work but I had trouble in the
past.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="tests"&gt;
&lt;h2&gt;Tests&lt;/h2&gt;
&lt;p&gt;It's generally much better to have a test suite enabled with unit tests for
each component of your code.  This is the approach adopted by most open-source
projects and many industrial code developers.&lt;/p&gt;
&lt;p&gt;Tests are invoked with the command &lt;tt class="docutils literal"&gt;py.test&lt;/tt&gt; with a variety of command
options.  Among my favorites are &lt;tt class="docutils literal"&gt;py.test &lt;span class="pre"&gt;--tb=short&lt;/span&gt;&lt;/tt&gt;, which gives a much
less verbose traceback, &lt;tt class="docutils literal"&gt;py.test &lt;span class="pre"&gt;--pastebin=failed&lt;/span&gt;&lt;/tt&gt;, which posts any failure
results to pastebin for easy sharing, &lt;tt class="docutils literal"&gt;py.test &lt;span class="pre"&gt;-p&lt;/span&gt; packagename&lt;/tt&gt; (or &lt;tt class="docutils literal"&gt;python
setup.py test &lt;span class="pre"&gt;-P&lt;/span&gt; packagename&lt;/tt&gt; in astropy) to select tests for a specific
package.  A great deal more options can be found in the &lt;a class="reference external" href="http://pytest.org/latest/"&gt;pytest docs&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;A test suite, if properly constructed, can also be run from with in ipython:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;astroquery&lt;/span&gt;
&lt;span class="n"&gt;astroquery&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;test&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;eso&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="postscript"&gt;
&lt;h2&gt;Postscript&lt;/h2&gt;
&lt;p&gt;Some useful related links:&lt;/p&gt;
&lt;blockquote&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;a class="reference external" href="http://stackoverflow.com/questions/1623039/python-debugging-tips"&gt;http://stackoverflow.com/questions/1623039/python-debugging-tips&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="https://pypi.python.org/pypi/pudb"&gt;https://pypi.python.org/pypi/pudb&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;!-- great picture: http://commons.wikimedia.org/wiki/File:Richard_Hook_and_Eric_Emsellem_at_the_ESO_50th_Anniversary_Gala_Event.jpg --&gt;
&lt;/div&gt;
</content><category term="misc"></category><category term="python"></category><category term="workflow"></category><category term="debugging"></category><category term="ipython"></category><category term="vim"></category></entry><entry><title>Installing astrometry.net in November 2014</title><link href="https://keflavich.github.io/blog/installing-astrometrynet-in-november-2014.html" rel="alternate"></link><published>2014-11-26T09:57:00-07:00</published><updated>2014-11-26T09:57:00-07:00</updated><author><name>Adam</name></author><id>tag:keflavich.github.io,2014-11-26:/blog/installing-astrometrynet-in-november-2014.html</id><summary type="html">&lt;p&gt;Installing astrometry.net is all about navigating dependency hell.&lt;/p&gt;
&lt;p&gt;Requirements:&lt;/p&gt;
&lt;blockquote&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;libpng&lt;/li&gt;
&lt;li&gt;libtiff&lt;/li&gt;
&lt;li&gt;libjpeg&lt;/li&gt;
&lt;li&gt;netpbm (requires above 3)&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;p&gt;To install netpbm, a recent version - NOT the stable version - is required,
which means navigating throught 3-4 layers of links including a sourceforge
build-my-tarball link.&lt;/p&gt;
&lt;p&gt;To compile astrometry.net-0.50:&lt;/p&gt;
&lt;blockquote&gt;
ARCH_FLAGS=&amp;quot;&amp;quot; make …&lt;/blockquote&gt;</summary><content type="html">&lt;p&gt;Installing astrometry.net is all about navigating dependency hell.&lt;/p&gt;
&lt;p&gt;Requirements:&lt;/p&gt;
&lt;blockquote&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;libpng&lt;/li&gt;
&lt;li&gt;libtiff&lt;/li&gt;
&lt;li&gt;libjpeg&lt;/li&gt;
&lt;li&gt;netpbm (requires above 3)&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;p&gt;To install netpbm, a recent version - NOT the stable version - is required,
which means navigating throught 3-4 layers of links including a sourceforge
build-my-tarball link.&lt;/p&gt;
&lt;p&gt;To compile astrometry.net-0.50:&lt;/p&gt;
&lt;blockquote&gt;
ARCH_FLAGS=&amp;quot;&amp;quot; make -j 8&lt;/blockquote&gt;
&lt;p&gt;To compile cairo, I had to install pixman (no problem) the setup a PKG_CONFIG_PATH:&lt;/p&gt;
&lt;blockquote&gt;
PKG_CONFIG_PATH=/usr/local/lib/pkgconfig ./configure&lt;/blockquote&gt;
</content><category term="misc"></category><category term="install"></category></entry><entry><title>Azimuthal Mass Profiles</title><link href="https://keflavich.github.io/blog/azimuthal-mass-profiles.html" rel="alternate"></link><published>2014-06-13T09:00:00-06:00</published><updated>2014-06-13T09:00:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2014-06-13:/blog/azimuthal-mass-profiles.html</id><content type="html">&lt;p&gt;Can we characterize &amp;quot;hub&amp;quot; clumps vs &amp;quot;filament&amp;quot; clumps by examining their
azimuthal column density profile?  Filaments would have two-peaked structures,
hubs many-peaked, and spherically symmetric &amp;quot;isolated&amp;quot; clumps would be
peakless.&lt;/p&gt;
</content><category term="misc"></category><category term="science"></category><category term="molecular clouds"></category></entry><entry><title>Python stack on Mavericks</title><link href="https://keflavich.github.io/blog/python-stack-on-mavericks.html" rel="alternate"></link><published>2014-02-19T12:02:00-07:00</published><updated>2014-02-19T12:02:00-07:00</updated><author><name>napattack (adam.g.ginsburg@gmail.com)</name></author><id>tag:keflavich.github.io,2014-02-19:/blog/python-stack-on-mavericks.html</id><summary type="html">&lt;p&gt;As you might expect from numerous blog posts and the general difficulty people
have always experienced upgrading mac OS versions, Mavericks caused some truly
hideous issues.&lt;/p&gt;
&lt;p&gt;The only really &amp;quot;new&amp;quot; issues specifically for Mavericks relate to app nap.  The
main solution is minrk's &lt;a class="reference external" href="https://github.com/minrk/appnope"&gt;appnope&lt;/a&gt;.  Otherwise, command line options like
&lt;cite&gt;defaults …&lt;/cite&gt;&lt;/p&gt;</summary><content type="html">&lt;p&gt;As you might expect from numerous blog posts and the general difficulty people
have always experienced upgrading mac OS versions, Mavericks caused some truly
hideous issues.&lt;/p&gt;
&lt;p&gt;The only really &amp;quot;new&amp;quot; issues specifically for Mavericks relate to app nap.  The
main solution is minrk's &lt;a class="reference external" href="https://github.com/minrk/appnope"&gt;appnope&lt;/a&gt;.  Otherwise, command line options like
&lt;cite&gt;defaults write &amp;lt;app domain name&amp;gt; NSAppSleepDisabled -bool YES&lt;/cite&gt; are required
&lt;a class="reference external" href="http://apple.stackexchange.com/questions/121386/missing-prevent-app-nap-button-on-app"&gt;if the button is missing&lt;/a&gt; from Mac's Get Info pane.&lt;/p&gt;
&lt;p&gt;I tried installing the &lt;a class="reference external" href="https://store.continuum.io/cshop/anaconda/"&gt;conda&lt;/a&gt; stack to get python running quickly.  This
worked to an extremely limited degree: the TkAgg shipped with anaconda links to
&lt;a class="reference external" href="xquartz.macosforge.org"&gt;XQuartz&lt;/a&gt;, which is highly undesirable for a number of reasons.  This meant
that matplotlib plots showed up as X11 plots.  With the Mac OS X backend, the
windows failed to show up in the Dock and therefore were totally unusable (though
they did look OK).&lt;/p&gt;
&lt;p&gt;I am still using &lt;a class="reference external" href="https://store.continuum.io/cshop/anaconda/"&gt;conda&lt;/a&gt; to maintain multiple parallel versions of python for
testing.  However, I went back to my typical install-from-source approach.&lt;/p&gt;
&lt;p&gt;To get the matplotlib backends to interact nicely with apple, you need to install
them using the &lt;cite&gt;/Library&lt;/cite&gt; version of python&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# this had to happen sometime early:&lt;/span&gt;
$&lt;span class="w"&gt; &lt;/span&gt;xcode-select&lt;span class="w"&gt; &lt;/span&gt;--install

$&lt;span class="w"&gt; &lt;/span&gt;wget&lt;span class="w"&gt; &lt;/span&gt;https://pypi.python.org/pypi/pip#downloads
$&lt;span class="w"&gt; &lt;/span&gt;tar&lt;span class="w"&gt; &lt;/span&gt;-xzvf&lt;span class="w"&gt; &lt;/span&gt;~/Downloads/pip-1.5.2.tar.gz
$&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;cd&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;pip-1.5.2
$&lt;span class="w"&gt; &lt;/span&gt;/Library/Frameworks/Python.framework/Versions/2.7/bin/python&lt;span class="w"&gt; &lt;/span&gt;setup.py&lt;span class="w"&gt; &lt;/span&gt;install
$&lt;span class="w"&gt; &lt;/span&gt;/Library/Frameworks/Python.framework/Versions/2.7/bin/pip&lt;span class="w"&gt; &lt;/span&gt;install&lt;span class="w"&gt; &lt;/span&gt;virtualenv
$&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;cd&lt;/span&gt;
$&lt;span class="w"&gt; &lt;/span&gt;/Library/Frameworks/Python.framework/Versions/2.7/bin/virtualenv&lt;span class="w"&gt; &lt;/span&gt;virtual-python
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;After this, I was surprisingly able to install everything in the python stack
with no hitches.  Obviously, that could not possibly last.&lt;/p&gt;
&lt;p&gt;While matplotlib and numpy worked fine, scipy had problems.&lt;/p&gt;
&lt;pre class="literal-block"&gt;
ImportError: dlopen(/Users/adam/virtual-python/lib/python2.7/site-packages/scipy/integrate/_odepack.so, 2): Symbol not found: __gfortran_internal_free
Referenced from: /Users/adam/virtual-python/lib/python2.7/site-packages/scipy/integrate/_odepack.so
Expected in: flat namespace
   in /Users/adam/virtual-python/lib/python2.7/site-packages/scipy/integrate/_odepack.so
&lt;/pre&gt;
&lt;p&gt;This terrible error led me back to re-compiling scipy.  I tried installing with
&lt;a class="reference external" href="hpc.sourceforge.net"&gt;hpc&lt;/a&gt; gfortran, but that didn't work at all, first apparently because of linking
errors in numpy.  When I investigated numpy, I found that the compilers
apparently don't work at all:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
C compiler: /usr/local/bin/gcc -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -arch i386 -arch x86_64
...
RuntimeError: Broken toolchain: cannot link a simple C program
&lt;/pre&gt;
&lt;p&gt;I had to give up on that, and then googling returned no results at all, which I
thought was a bit weird.  Scipy seems to want gcc and g++ 4.2, even though
they're years old.  I had to find those and gfortran-4.2 somehow, but the &lt;a class="reference external" href="r.research.att.com/tools/"&gt;old
site&lt;/a&gt; that used to serve them seems to have lost the files!  They had an
&lt;a class="reference external" href="http://r.research.att.com/tools/gcc-42-5666.3-darwin11.pkg"&gt;older version&lt;/a&gt;, though, which appears to work.  Scipy is a scary install.&lt;/p&gt;
&lt;div class="section" id="problems-with-xquartz"&gt;
&lt;h2&gt;Problems with XQuartz&lt;/h2&gt;
&lt;p&gt;XQuartz is not well-behaved on Mac OS X 10.9.  First, &lt;a class="reference external" href="https://xquartz.macosforge.org/trac/ticket/661"&gt;on retina machines, it
does not display well&lt;/a&gt;.  Second, and much more important, it &lt;a class="reference external" href="http://xquartz.macosforge.org/trac/ticket/797"&gt;does not work on
external monitors&lt;/a&gt;.  Apparently this can be worked around by turning off
&amp;quot;Displays have different spaces&amp;quot;  in Mission Control, but so far that has had
no effect for me.&lt;/p&gt;
&lt;/div&gt;
</content><category term="misc"></category><category term="mac"></category><category term="install"></category><category term="python"></category><category term="scipy"></category><category term="fortran"></category></entry><entry><title>W51 Mapping: Flagging bad data</title><link href="https://keflavich.github.io/blog/w51-mapping-flagging-bad-data.html" rel="alternate"></link><published>2014-01-16T00:00:00-07:00</published><updated>2014-01-16T00:00:00-07:00</updated><author><name>Adam &lt;keflavich@gmail.com&gt;</name></author><id>tag:keflavich.github.io,2014-01-16:/blog/w51-mapping-flagging-bad-data.html</id><summary type="html">&lt;p&gt;In the process of creating W51 data cubes from the GBT mapping data (project
GBT 10B/019), I've had to deal with a lot of bad data.&lt;/p&gt;
&lt;p&gt;Some of the bad data comes from misbehaving electronics.  All I can say is that
they were misbehaving, not how or why - the …&lt;/p&gt;</summary><content type="html">&lt;p&gt;In the process of creating W51 data cubes from the GBT mapping data (project
GBT 10B/019), I've had to deal with a lot of bad data.&lt;/p&gt;
&lt;p&gt;Some of the bad data comes from misbehaving electronics.  All I can say is that
they were misbehaving, not how or why - the data from one polarizaiton simply
disagrees with the other polarization and feeds spontaneously and for no
apparent reason.&lt;/p&gt;
&lt;p&gt;I've implemented a waterfall diagnostic plot to help examine the data, it is in
my &lt;a class="reference external" href="https://github.com/keflavich/mpl_plot_templates"&gt;mpl_plot_templates&lt;/a&gt; repository: &lt;a class="reference external" href="https://github.com/keflavich/mpl_plot_templates/blob/master/mpl_plot_templates/imdiagnostics.py"&gt;imdiagnostics.py&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;A good waterfall looks something like this:&lt;/p&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/w51/Session17_111to186_D37_F2_data_scrubbed_flagged.png" style="width: 800px;" /&gt;
&lt;p&gt;The line plots show the average and standard deviation along each axis; the
right side effectively shows timestream continuum data while the top plots show
a time-averaged spectrum.  This plot is good in that there are clearly signals
detected as the scan crosses continuum sources and there is a strong Helium
Alpha line detected in the average (though there's no way to read that it's
Helium fromt he data as presented).
Notably, the noise correlates with the continuum brightness - this is expected;
higher TSYS leads to higher noise.&lt;/p&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/w51/Session22_10to41_D37_F2_data_scrubbed_flagged.png" style="width: 800px;" /&gt;
&lt;p&gt;This is an example of a data set with some extremely irritating artifacts.
There are apparent absorption lines throughout the spectrum: they are not real.
This is a particularly irritating problem because I had resolved it once in the
not-too-distant past, but I can't figure out how!!  Most likely, I just removed
the data from the maps, but that SHOULD be in the code history (git) and is not.&lt;/p&gt;
</content><category term="misc"></category><category term="W51"></category><category term="GBT"></category></entry><entry><title>Regrid an image (or cube) using CASA</title><link href="https://keflavich.github.io/blog/regrid-an-image-or-cube-using-casa.html" rel="alternate"></link><published>2013-12-18T17:52:00-07:00</published><updated>2013-12-18T17:52:00-07:00</updated><author><name>Adam Ginsburg &lt;adam.g.ginsburg@gmail.com&gt;</name></author><id>tag:keflavich.github.io,2013-12-18:/blog/regrid-an-image-or-cube-using-casa.html</id><summary type="html">&lt;p&gt;In order to regrid an image, you need some target reprojection.  The simplest way to acquire such a reprojection
is by extracting it from another image, e.g. a &lt;a class="reference external" href="casaguides.nrao.edu/index.php?title=FITStoImage"&gt;FITS image&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;(I use &lt;cite&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/cite&gt; to indicate the &lt;cite&gt;CASA &amp;lt;#&amp;gt;:&lt;/cite&gt; prompt here because it allows you to copy &amp;amp; paste the code into CASA …&lt;/p&gt;</summary><content type="html">&lt;p&gt;In order to regrid an image, you need some target reprojection.  The simplest way to acquire such a reprojection
is by extracting it from another image, e.g. a &lt;a class="reference external" href="casaguides.nrao.edu/index.php?title=FITStoImage"&gt;FITS image&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;(I use &lt;cite&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/cite&gt; to indicate the &lt;cite&gt;CASA &amp;lt;#&amp;gt;:&lt;/cite&gt; prompt here because it allows you to copy &amp;amp; paste the code into CASA)&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;header&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;imregrid&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;imagename&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;file.image&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;template&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;get&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This header will be a python dictionary with two keys, &lt;cite&gt;csys&lt;/cite&gt;, which specifies
the coordinate system, and &lt;cite&gt;shap&lt;/cite&gt;, which gives the shape.&lt;/p&gt;
&lt;p&gt;If you want to write up your own FITS header and you don't have a FITS file
with those exact coordinates, you can use the &lt;a class="reference external" href="https://github.com/keflavich/casa_tools/blob/master/casa_tools/header_to_template.py#L11"&gt;header_to_template&lt;/a&gt; convenience
tool in &lt;a class="reference external" href="https://github.com/keflavich/casa_tools"&gt;casa_tools&lt;/a&gt;.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;casa_tools&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;header_to_template&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;astropy.io&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;fits&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;fits_header&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fits&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Header&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fromtextfile&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;my_header.hdr&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;header&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;header_to_template&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fits_header&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;In order to regrid the file, you then need to pass in the image name and template to imregrid.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;imregrid&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;imagename&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;file.image&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="o"&gt;...&lt;/span&gt;          &lt;span class="n"&gt;template&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;header&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="o"&gt;...&lt;/span&gt;          &lt;span class="n"&gt;output&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;file_regrid.image&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;If your input image's header did not include a 'telescope' keyword, CASA will complain:&lt;/p&gt;
&lt;blockquote&gt;
2013-12-18 16:46:33 SEVERE  imregrid::ImageRegrid::regrid (file /opt/casa/release-4_1_0-release-1/darwin64/include/casacore/images/Images/ImageRegrid.tcc, line 118)        Cannot find the observatory name UNKNOWN in the CASA&lt;/blockquote&gt;
&lt;p&gt;You can add the keyword to the header yourself:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;imhead&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;file.image&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="o"&gt;...&lt;/span&gt;        &lt;span class="n"&gt;mode&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;put&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="o"&gt;...&lt;/span&gt;        &lt;span class="n"&gt;hdkey&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;telescope&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="o"&gt;...&lt;/span&gt;        &lt;span class="n"&gt;hdvalue&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Arecibo&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="section" id="references"&gt;
&lt;h2&gt;References&lt;/h2&gt;
&lt;blockquote&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;a class="reference external" href="http://www.eso.org/projects/alma/arc/tw/pub/External/EUARCCASATutorialJan2012/ImageAnalysis-CASA.pdf"&gt;Sebastian Muller's presentation&lt;/a&gt; (page 16)&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://casa.nrao.edu/docs/casaref/image.regrid.html"&gt;imregrid docs&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;/div&gt;
</content><category term="misc"></category><category term="W51"></category><category term="GBT"></category></entry><entry><title>Converting a FITS cube to a CASA Image</title><link href="https://keflavich.github.io/blog/converting-a-fits-cube-to-a-casa-image.html" rel="alternate"></link><published>2013-12-18T15:15:00-07:00</published><updated>2013-12-18T15:15:00-07:00</updated><author><name>Adam Ginsburg &lt;adam.g.ginsburg@gmail.com&gt;</name></author><id>tag:keflavich.github.io,2013-12-18:/blog/converting-a-fits-cube-to-a-casa-image.html</id><summary type="html">&lt;p&gt;If you want to perform analysis on a FITS file in CASA, you first need to
import it into &lt;cite&gt;.image&lt;/cite&gt; format.&lt;/p&gt;
&lt;blockquote&gt;
importfits('file.fits','file.image')&lt;/blockquote&gt;
&lt;p&gt;If this works, great!  You can move on.  CASA will treat NaN values in an image
as 'masked'.&lt;/p&gt;
&lt;div class="section" id="dealing-with-errors"&gt;
&lt;h2&gt;Dealing with Errors&lt;/h2&gt;
&lt;p&gt;There may be …&lt;/p&gt;&lt;/div&gt;</summary><content type="html">&lt;p&gt;If you want to perform analysis on a FITS file in CASA, you first need to
import it into &lt;cite&gt;.image&lt;/cite&gt; format.&lt;/p&gt;
&lt;blockquote&gt;
importfits('file.fits','file.image')&lt;/blockquote&gt;
&lt;p&gt;If this works, great!  You can move on.  CASA will treat NaN values in an image
as 'masked'.&lt;/p&gt;
&lt;div class="section" id="dealing-with-errors"&gt;
&lt;h2&gt;Dealing with Errors&lt;/h2&gt;
&lt;p&gt;There may be issues with FITS headers.  CASA respects a large number of header
keys (&lt;a class="reference external" href="http://www.eso.org/projects/alma/arc/tw/pub/External/EUARCCASATutorialJan2012/ImageAnalysis-CASA.pdf"&gt;reference&lt;/a&gt;).&lt;/p&gt;
&lt;p&gt;There are many ways to edit a FITS header.  One of the most straightforward to
use is &lt;a class="reference external" href="http://tdc-www.harvard.edu/wcstools/edhead.html"&gt;edhead&lt;/a&gt;.  Otherwise, one can use CASA's &lt;a class="reference external" href="http://casaguides.nrao.edu/index.php?title=Imhead"&gt;imhead&lt;/a&gt;&lt;/p&gt;
&lt;table border="1" class="docutils"&gt;
&lt;colgroup&gt;
&lt;col width="14%" /&gt;
&lt;col width="14%" /&gt;
&lt;col width="71%" /&gt;
&lt;/colgroup&gt;
&lt;tbody valign="top"&gt;
&lt;tr&gt;&lt;td&gt;CASA Keyword&lt;/td&gt;
&lt;td&gt;FITS keyword&lt;/td&gt;
&lt;td&gt;Description&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;beammaj&lt;/td&gt;
&lt;td&gt;BMAJ&lt;/td&gt;
&lt;td&gt;Major&amp;nbsp;axis&amp;nbsp;of&amp;nbsp;the&amp;nbsp;clean&amp;nbsp;beam&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;beammin&lt;/td&gt;
&lt;td&gt;BMIN&lt;/td&gt;
&lt;td&gt;Minor&amp;nbsp;axis&amp;nbsp;of&amp;nbsp;the&amp;nbsp;clean&amp;nbsp;beam&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;beampa&lt;/td&gt;
&lt;td&gt;BPA&lt;/td&gt;
&lt;td&gt;Position&amp;nbsp;angle&amp;nbsp;of&amp;nbsp;the&amp;nbsp;clean&amp;nbsp;beam&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;bunit&lt;/td&gt;
&lt;td&gt;BUNIT&lt;/td&gt;
&lt;td&gt;Brightness&amp;nbsp;unit&amp;nbsp;(K,&amp;nbsp;Jy/beam,&amp;nbsp;etc)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;cdeltn&lt;/td&gt;
&lt;td&gt;CDELTn&lt;/td&gt;
&lt;td&gt;Pixel&amp;nbsp;size,&amp;nbsp;nth&amp;nbsp;axis&amp;nbsp;&amp;nbsp;(max&amp;nbsp;n&amp;nbsp;is&amp;nbsp;4)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;crpixn&lt;/td&gt;
&lt;td&gt;CRPIXn&lt;/td&gt;
&lt;td&gt;Pixel&amp;nbsp;coordinate&amp;nbsp;of&amp;nbsp;reference&amp;nbsp;point,&amp;nbsp;nth&amp;nbsp;axis&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;crvaln&lt;/td&gt;
&lt;td&gt;CRVALn&lt;/td&gt;
&lt;td&gt;Pixel&amp;nbsp;location&amp;nbsp;of&amp;nbsp;reference&amp;nbsp;point,&amp;nbsp;nth&amp;nbsp;axis&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;ctypen&lt;/td&gt;
&lt;td&gt;CTYPEn&lt;/td&gt;
&lt;td&gt;Axis&amp;nbsp;name,&amp;nbsp;nth&amp;nbsp;axis.  For FITS, this includes the projection&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;cunitn&lt;/td&gt;
&lt;td&gt;CUNITn&lt;/td&gt;
&lt;td&gt;Pixel&amp;nbsp;units,&amp;nbsp;nth&amp;nbsp;axis&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;datamax&lt;/td&gt;
&lt;td&gt;DATAMAX&lt;/td&gt;
&lt;td&gt;Maximum&amp;nbsp;pixel&amp;nbsp;value&amp;nbsp;in&amp;nbsp;image&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;datamin&lt;/td&gt;
&lt;td&gt;DATAMIN&lt;/td&gt;
&lt;td&gt;Minimum&amp;nbsp;pixel&amp;nbsp;value&amp;nbsp;in&amp;nbsp;image&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;date-obs&lt;/td&gt;
&lt;td&gt;DATE-OBS&lt;/td&gt;
&lt;td&gt;Date&amp;nbsp;of&amp;nbsp;the&amp;nbsp;observation&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;equinox&lt;/td&gt;
&lt;td&gt;EQUINOX&lt;/td&gt;
&lt;td&gt;Reference&amp;nbsp;frame&amp;nbsp;for&amp;nbsp;directional&amp;nbsp;coordinates&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;imtype&lt;/td&gt;
&lt;td&gt;&lt;ul class="first last simple"&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/td&gt;
&lt;td&gt;Image&amp;nbsp;type:&amp;nbsp;intensity,&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;minpos&lt;/td&gt;
&lt;td&gt;&lt;ul class="first last simple"&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/td&gt;
&lt;td&gt;Position&amp;nbsp;of&amp;nbsp;the&amp;nbsp;minimum&amp;nbsp;value&amp;nbsp;(world&amp;nbsp;unit)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;minpixpos&lt;/td&gt;
&lt;td&gt;&lt;ul class="first last simple"&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/td&gt;
&lt;td&gt;Same&amp;nbsp;in&amp;nbsp;pixel&amp;nbsp;(array)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;maxpos&lt;/td&gt;
&lt;td&gt;&lt;ul class="first last simple"&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/td&gt;
&lt;td&gt;Position&amp;nbsp;of&amp;nbsp;the&amp;nbsp;maximum&amp;nbsp;value&amp;nbsp;(world&amp;nbsp;unit)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;maxpixpos&lt;/td&gt;
&lt;td&gt;&lt;ul class="first last simple"&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/td&gt;
&lt;td&gt;Same&amp;nbsp;in&amp;nbsp;pixel&amp;nbsp;(array)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;object&lt;/td&gt;
&lt;td&gt;OBJECT&lt;/td&gt;
&lt;td&gt;Source&amp;nbsp;name&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;observer&lt;/td&gt;
&lt;td&gt;OBSERVER&lt;/td&gt;
&lt;td&gt;Observer&amp;nbsp;name&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;projection&lt;/td&gt;
&lt;td&gt;CTYPEn&lt;/td&gt;
&lt;td&gt;Image&amp;nbsp;projection&amp;nbsp;('SIN','TAN',&amp;nbsp;or&amp;nbsp;'ZEA')&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;reffreqtype&lt;/td&gt;
&lt;td&gt;&lt;ul class="first last simple"&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/td&gt;
&lt;td&gt;Reference&amp;nbsp;frame&amp;nbsp;for&amp;nbsp;the&amp;nbsp;spectral&amp;nbsp;coordinates&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;restfreq&lt;/td&gt;
&lt;td&gt;RESTFREQ&lt;/td&gt;
&lt;td&gt;Rest&amp;nbsp;Frequency&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;shape&lt;/td&gt;
&lt;td&gt;NAXISn&lt;/td&gt;
&lt;td&gt;Number&amp;nbsp;of&amp;nbsp;pixels&amp;nbsp;along&amp;nbsp;each&amp;nbsp;axis&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;telescope&lt;/td&gt;
&lt;td&gt;TELESCOP&lt;/td&gt;
&lt;td&gt;Telescope&amp;nbsp;name&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;What does it mean if you get this sort of error?&lt;/p&gt;
&lt;blockquote&gt;
CASA &amp;lt;1&amp;gt;: importfits('file.fits','file.image')
2013-12-18 13:06:18     WARN    importfits::FITSCoordinateUtil::fromFITSHeader  The wcs function failures are too severe to continue ...
2013-12-18 13:06:18     WARN    importfits::ImageFITSConverterImpl::FITSToImage (file /var/rpmbuild/BUILD/casapy-stable/casapy-stable-42.0.26945/casacore/images/Images/ImageFITSConverter.tcc, line 71)       No proper coordinate system defined in FITS file. Using dummy linear system instead.&lt;/blockquote&gt;
&lt;p&gt;First, go to the &lt;cite&gt;casapy-yyyymmdd-hhmmss.log&lt;/cite&gt; file and look at the errors.&lt;/p&gt;
&lt;blockquote&gt;
2013-12-18 13:06:18     INFO    importfits::FITSCoordinateUtil::fromFITSHeader  celfix incurred the error Inconsistent or unrecognized coordinate axis types
2013-12-18 13:06:18     INFO    importfits::FITSCoordinateUtil::fromFITSHeader  spcfix incurred the error Inconsistent or unrecognized coordinate axis types
2013-12-18 13:06:18     INFO    importfits::FITSCoordinateUtil::fromFITSHeader  cylfix incurred the error Inconsistent or unrecognized coordinate axis types&lt;/blockquote&gt;
&lt;p&gt;In my case, the error turned out to be that &lt;cite&gt;CTYPE3&lt;/cite&gt; was set to &lt;cite&gt;RADI-LSR&lt;/cite&gt;,
while it should be &lt;cite&gt;VELO-LSR&lt;/cite&gt; to be recognized by the CASA system.  The
velocity convention is, unfortunately, lost.&lt;/p&gt;
&lt;/div&gt;
</content><category term="misc"></category><category term="W51"></category><category term="GBT"></category></entry><entry><title>There is a "gap" in the dust around Sgr B2</title><link href="https://keflavich.github.io/blog/there-is-a-gap-in-the-dust-around-sgr-b2.html" rel="alternate"></link><published>2013-12-13T00:00:00-07:00</published><updated>2013-12-13T00:00:00-07:00</updated><author><name>Adam &lt;keflavich@gmail.com&gt;</name></author><id>tag:keflavich.github.io,2013-12-13:/blog/there-is-a-gap-in-the-dust-around-sgr-b2.html</id><summary type="html">&lt;p&gt;Sgr B2 is the most massive gas clump in our Galaxy.  It's about 100 pc away
from Sgr A*, the black hole at the center of the Galaxy.  It is forming stars
prodigiously, and has extreme properties in many regards.&lt;/p&gt;
&lt;p&gt;In many physical aspects - mass, luminosity, velocity dispersion, temperature -
the …&lt;/p&gt;</summary><content type="html">&lt;p&gt;Sgr B2 is the most massive gas clump in our Galaxy.  It's about 100 pc away
from Sgr A*, the black hole at the center of the Galaxy.  It is forming stars
prodigiously, and has extreme properties in many regards.&lt;/p&gt;
&lt;p&gt;In many physical aspects - mass, luminosity, velocity dispersion, temperature -
the Sgr B2 region is similar to &amp;quot;proto-cluster clumps&amp;quot; seen in other galaxies,
e.g. the Antennae galaxies.&lt;/p&gt;
&lt;p&gt;There are plenty of mysteries about Sgr B2, including its extraordinarily
diverse chemistry and its peculiar kinematics.&lt;/p&gt;
&lt;p&gt;I'm raising a sort of new one.  There appears to be a hole next to Sgr B2,
towards the southeast in Galactic coordinates.  It appears as a relatively
empty spot in the dust continuum bands.  It doesn't seem to be filled in
with anything in particular.&lt;/p&gt;
&lt;html&gt;
&lt;div class="output_html rendered_html"&gt;

    &lt;script type="text/javascript"&gt;

      var image_dir='blog/images/sgrb2/'

      var images=new Array(
                   "TheGap_GLM_00000+0000_mosaic_I2.png",
                   "TheGap_GLM_00000+0000_mosaic_I4.png",
                   "TheGap_gcmosaic_24um.png",
                   "TheGap_igls_l000_blue_cnr_hh.png",
                   "TheGap_igls_l000_red_cnr_hh.png",
                   "TheGap_igls_l000_psw_deglitch_hh.png",
                   "TheGap_igls_l000_pmw_deglitch_hh.png",
                   "TheGap_SgrB2_350um_gal.png",
                   "TheGap_gc450_gal.png",
                   "TheGap_igls_l000_plw_deglitch_hh.png",
                   "TheGap_gc850_gal.png",
                   "TheGap_ATLASGAL.1.5_reprojectoverlap9.png",
                   "TheGap_v2.0_ds2_l001_13pca_map20.png",
                   //"TheGap_sgrb2_nh311_sum.png",
                   "TheGap_sgrb2_20cm_12as_gal.png",
                   "TheGap_20cm_0.png"
                   )
      var titles=new Array(
                   "4.5um",
                   "8um",
                   "24um",
                   "70um",
                   "160um",
                   "250um",
                   "350um Herschel",
                   "350um SHARC",
                   "450um",
                   "500um",
                   "850um SCUBA",
                   "870um ATLASGAL",
                   "1100um",
                   //"1.3cm NH3",
                   "20cm",
                   "20cm (poor resolution)"
                   )

      function interactUpdate(div){
         var outputs = div.getElementsByTagName("img");
         var divoutputs = div.getElementsByTagName("div");
         var controls = div.getElementsByTagName("input");

         var value = "";
         for(i=0; i&lt;controls.length; i++){
           if((controls[i].type == "range") || controls[i].checked){
             //value = value + controls[i].getAttribute("name") + controls[i].value;
             value = controls[i].value;
           }
         }

         for(i=0; i&lt;outputs.length; i++){
           var name = outputs[i].getAttribute("name");
           if(name=="figure"){
                 outputs[i].src = image_dir+images[value]
           }
         }

         for(i=0; i&lt;divoutputs.length; i++){
           var name = divoutputs[i].getAttribute("name");
           if(name=="caption"){
                 divoutputs[i].innerHTML = titles[value];
           }
         }

         //for(i=0; i&lt;images.length; i++){
         //  var name = outputs[i].getAttribute("name");
         //  if(name == value){
         //     outputs[i].style.display = 'block';
         //  } else if(name != "controls"){
         //     outputs[i].style.display = 'none';
         //  }
         //}
      }
    &lt;/script&gt;
    
    &lt;div&gt;
      
    &lt;div name="figure" style="display:block"&gt;
        &lt;div name="caption"&gt;
            20cm
        &lt;/div&gt;
        &lt;img name="figure" src="blog/images/sgrb2/TheGap_20cm_0.png" height=600px&gt;
    &lt;/div&gt;

&lt;input type="range" name="figure" min="0" max="14" step="1" value="0" style="width:350px" onchange="interactUpdate(this.parentNode);"&gt;
&lt;/html&gt;
&lt;p&gt;Note the slider here: you can view Sgr B2 at any wavelength where I have data.
The green circle highlights the major deficiency that is evident in all
dust-containing bands.  There are other &amp;quot;minor&amp;quot; deficiencies elsewhere.&lt;/p&gt;
&lt;p&gt;It is tricky to interpret this: I don't think the absolute flux densities in
any of the millimeter observations are perfectly trustworthy because of their
proximity to the extremely bright Sgr B2 point sources.&lt;/p&gt;
&lt;p&gt;Additionally, this gap is not perfectly evident in NH3 or CO.  In the HOPS NH3
maps, there is a relative lack of emission at ~56 km/s - relative to
neighboring regions; this is actually the peak of the line profile extracted
from the ellipse!&lt;/p&gt;
&lt;p&gt;This is in contrast to the central &amp;quot;Gas Hole&amp;quot; which has been noted by others;
it exists in CO and NH3.  There is almost certainly some NH3 self-absorption
involved.  The &amp;quot;Gas Hole&amp;quot; coincides with the peak in other gas species and the
peak in the dust emission, so it really seems to be a different phenomenon,
having to do with line-of-sight confusion and excitation conditions.&lt;/p&gt;
&lt;p&gt;The one feature of the &amp;quot;dust gap&amp;quot; that distinguishes this part of Sgr B2 from
the other regions surrounding it is that 8 micron emission can readily be
observed here.  A little 24 micron emission is in the gap as well, but not as
much as the 8 micron.  The 70 micron emission is quite weak, but not really
deficient.  Perhaps in this region, very small grains are more common than in
its surroundings?&lt;/p&gt;
&lt;p&gt;There's a lot more hypothesizing to be done here.&lt;/p&gt;
</content><category term="misc"></category><category term="python"></category><category term="blogging"></category><category term="meta"></category></entry><entry><title>Late Night Ideas, Oct 6 2013</title><link href="https://keflavich.github.io/blog/late-night-ideas-oct-6-2013.html" rel="alternate"></link><published>2013-10-07T01:00:00-06:00</published><updated>2013-10-07T01:00:00-06:00</updated><author><name>Adam Ginsburg</name></author><id>tag:keflavich.github.io,2013-10-07:/blog/late-night-ideas-oct-6-2013.html</id><summary type="html">&lt;p&gt;Coffee at 7 pm usually isn't a problem...&lt;/p&gt;
&lt;blockquote&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;Dendrogram analysis of turbulent simulations.  What do the structures look
like?  Mostly for visualization in a talk, but perhaps the start of a paper.
Are the high-density substructures too small to collapse?  Too hot?&lt;/li&gt;
&lt;li&gt;A deep GBT+AO observation of the center …&lt;/li&gt;&lt;/ol&gt;&lt;/blockquote&gt;</summary><content type="html">&lt;p&gt;Coffee at 7 pm usually isn't a problem...&lt;/p&gt;
&lt;blockquote&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;Dendrogram analysis of turbulent simulations.  What do the structures look
like?  Mostly for visualization in a talk, but perhaps the start of a paper.
Are the high-density substructures too small to collapse?  Too hot?&lt;/li&gt;
&lt;li&gt;A deep GBT+AO observation of the center of the G49 40km/s cloud.  Can we
perform the same measurement as I did originally against a uniform
backlight?  Will that provide new information&lt;/li&gt;
&lt;li&gt;Corollary to 2: In simulations, what effect does a varying size and
brightness backlight have on the inferred density?&lt;/li&gt;
&lt;li&gt;Measure the distance to the G49 cloud with NIR extinction.  Keep working
with Jonathan Foster on that...&lt;/li&gt;
&lt;li&gt;Test the Cepheid / RR Lyrae distance method on the G49 cloud.  It's close
enough that the targets should be bright.  Start off with 1-hour pilot
(DD?) on the most distant star with a &amp;quot;guaranteed&amp;quot; CO detection, then
propose a longer project to begin using the bisector approach to determine
its true distance.&lt;/li&gt;
&lt;li&gt;Eta Car ALMA.  Basically, same thing, but now invoke the SN 1987A CO
detection.  Eta is the closer laboratory, and it must have similar shock
physics...&lt;/li&gt;
&lt;li&gt;H3+ in the CMZ with Juergen.  Talk to Tom Geballe about H3+ and CO
absorption.  Is it possible to measure CO absorption to red giants?&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;
</content><category term="misc"></category><category term="ideas"></category></entry><entry><title>Installing MultiNest on Mac OS X 10.7</title><link href="https://keflavich.github.io/blog/installing-multinest-on-mac-os-x-107.html" rel="alternate"></link><published>2013-10-06T15:25:00-06:00</published><updated>2013-10-06T15:25:00-06:00</updated><author><name>Adam Ginsburg</name></author><id>tag:keflavich.github.io,2013-10-06:/blog/installing-multinest-on-mac-os-x-107.html</id><summary type="html">&lt;p&gt;Installing multinest &amp;amp; pymultinest has proved non-trivial.&lt;/p&gt;
&lt;p&gt;First, you probably can't build using the default mac gcc; a gcc version &amp;gt;4.5
is probably needed.  The error I got installing MultiNest only turned up one
useful result on google... it was a &lt;a class="reference external" href="https://github.com/hyperion-rt/hyperion/issues/23"&gt;question I had asked&lt;/a&gt; on the &lt;a class="reference external" href="https://github.com/hyperion-rt"&gt;hyperion github
page …&lt;/a&gt;&lt;/p&gt;</summary><content type="html">&lt;p&gt;Installing multinest &amp;amp; pymultinest has proved non-trivial.&lt;/p&gt;
&lt;p&gt;First, you probably can't build using the default mac gcc; a gcc version &amp;gt;4.5
is probably needed.  The error I got installing MultiNest only turned up one
useful result on google... it was a &lt;a class="reference external" href="https://github.com/hyperion-rt/hyperion/issues/23"&gt;question I had asked&lt;/a&gt; on the &lt;a class="reference external" href="https://github.com/hyperion-rt"&gt;hyperion github
page&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;To get around that, I installed the &lt;a class="reference external" href="http://hpc.sourceforge.net/"&gt;hpc compilers&lt;/a&gt; (4.7 since I'm on OS X 10.7) into
&lt;cite&gt;/usr/local/hpc/&lt;/cite&gt; to keep them distinct from the system gcc, which is needed
for many other things.&lt;/p&gt;
&lt;p&gt;I then installed the &lt;a class="reference external" href="http://www.open-mpi.org/"&gt;openMPI compilers&lt;/a&gt; to &lt;cite&gt;/usr/local/openmpi&lt;/cite&gt;:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
./configure --prefix=/usr/local/openmpi
make
sudo make install
&lt;/pre&gt;
&lt;p&gt;Then I tried installing pymultinest&lt;/p&gt;
&lt;pre class="literal-block"&gt;
dor ~/repos/MultiNest cmake/master$ mkdir build
dor ~/repos/MultiNest cmake/master$ cd build/
dor ~/repos/MultiNest/build cmake/master$ which mpif90
/usr/local/openmpi/bin/mpif90
dor ~/repos/MultiNest/build cmake/master$ which gfortran
/usr/local/hpc/bin//gfortran
dor ~/repos/MultiNest/build cmake/master$ which gcc
/usr/local/hpc/bin//gcc
dor ~/repos/MultiNest/build cmake/master$ cmake -DCMAKE_{C,CXX}_FLAGS=&amp;quot;-arch x86_64&amp;quot; -DCMAKE_Fortran_FLAGS=&amp;quot;-m64&amp;quot; ..
-- The Fortran compiler identification is GNU
-- The C compiler identification is GNU 4.7.1
-- The CXX compiler identification is GNU 4.7.1
-- Check for working Fortran compiler: /usr/local/hpc/bin/gfortran
-- Check for working Fortran compiler: /usr/local/hpc/bin/gfortran  -- works
-- Detecting Fortran compiler ABI info
-- Detecting Fortran compiler ABI info - done
-- Checking whether /usr/local/hpc/bin/gfortran supports Fortran 90
-- Checking whether /usr/local/hpc/bin/gfortran supports Fortran 90 -- yes
-- Checking whether C compiler has -isysroot
-- Checking whether C compiler has -isysroot - yes
-- Checking whether C compiler supports OSX deployment target flag
-- Checking whether C compiler supports OSX deployment target flag - yes
-- Check for working C compiler: /usr/local/hpc/bin/gcc
-- Check for working C compiler: /usr/local/hpc/bin/gcc -- works
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Checking whether CXX compiler has -isysroot
-- Checking whether CXX compiler has -isysroot - yes
-- Checking whether CXX compiler supports OSX deployment target flag
-- Checking whether CXX compiler supports OSX deployment target flag - yes
-- Check for working CXX compiler: /usr/local/hpc/bin/g++
-- Check for working CXX compiler: /usr/local/hpc/bin/g++ -- works
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Looking for Fortran dgemm
-- Looking for Fortran dgemm - found
-- Looking for include file pthread.h
-- Looking for include file pthread.h - found
-- Looking for pthread_create
-- Looking for pthread_create - found
-- Found Threads: TRUE
-- A library with BLAS API found.
-- Looking for Fortran cheev
-- Looking for Fortran cheev - found
-- A library with LAPACK API found.
-- Detected gfortran, adding -ffree-line-length-none compiler option.
-- Found MPI_C: /usr/local/openmpi/lib/libmpi.dylib;/usr/lib/libm.dylib
-- Found MPI_CXX: /usr/local/openmpi/lib/libmpi_cxx.dylib;/usr/local/openmpi/lib/libmpi.dylib;/usr/lib/libm.dylib
-- Found MPI_Fortran: /usr/local/openmpi/lib/libmpi_f90.a;/usr/local/openmpi/lib/libmpi_f77.dylib;/usr/local/openmpi/lib/libmpi.dylib;/usr/lib/libm.dylib
-- Configuring done
-- Generating done
-- Build files have been written to: /Users/adam/repos/MultiNest/build
dor ~/repos/MultiNest/build cmake/master$ make
Scanning dependencies of target multinest_mpi_shared
[  1%] Building Fortran object src/CMakeFiles/multinest_mpi_shared.dir/utils.f90.o
[  3%] Building Fortran object src/CMakeFiles/multinest_mpi_shared.dir/utils1.f90.o
[  5%] Building Fortran object src/CMakeFiles/multinest_mpi_shared.dir/kmeans_clstr.f90.o
[  6%] Building Fortran object src/CMakeFiles/multinest_mpi_shared.dir/xmeans_clstr.f90.o
[  8%] Building Fortran object src/CMakeFiles/multinest_mpi_shared.dir/posterior.F90.o
[ 10%] Building Fortran object src/CMakeFiles/multinest_mpi_shared.dir/priors.f90.o
[ 12%] Building Fortran object src/CMakeFiles/multinest_mpi_shared.dir/nested.F90.o
[ 13%] Building Fortran object src/CMakeFiles/multinest_mpi_shared.dir/cwrapper.f90.o
Linking Fortran shared library ../../lib/libmultinest_mpi.dylib
[ 13%] Built target multinest_mpi_shared
Scanning dependencies of target multinest_mpi_static
[ 15%] Building Fortran object src/CMakeFiles/multinest_mpi_static.dir/utils.f90.o
[ 17%] Building Fortran object src/CMakeFiles/multinest_mpi_static.dir/utils1.f90.o
[ 18%] Building Fortran object src/CMakeFiles/multinest_mpi_static.dir/kmeans_clstr.f90.o
[ 20%] Building Fortran object src/CMakeFiles/multinest_mpi_static.dir/xmeans_clstr.f90.o
[ 22%] Building Fortran object src/CMakeFiles/multinest_mpi_static.dir/posterior.F90.o
[ 24%] Building Fortran object src/CMakeFiles/multinest_mpi_static.dir/priors.f90.o
[ 25%] Building Fortran object src/CMakeFiles/multinest_mpi_static.dir/nested.F90.o
[ 27%] Building Fortran object src/CMakeFiles/multinest_mpi_static.dir/cwrapper.f90.o
Linking Fortran static library ../../lib/libmultinest_mpi.a
[ 27%] Built target multinest_mpi_static
Scanning dependencies of target multinest_shared
[ 29%] Building Fortran object src/CMakeFiles/multinest_shared.dir/utils.f90.o
[ 31%] Building Fortran object src/CMakeFiles/multinest_shared.dir/utils1.f90.o
[ 32%] Building Fortran object src/CMakeFiles/multinest_shared.dir/kmeans_clstr.f90.o
[ 34%] Building Fortran object src/CMakeFiles/multinest_shared.dir/xmeans_clstr.f90.o
[ 36%] Building Fortran object src/CMakeFiles/multinest_shared.dir/posterior.F90.o
[ 37%] Building Fortran object src/CMakeFiles/multinest_shared.dir/priors.f90.o
[ 39%] Building Fortran object src/CMakeFiles/multinest_shared.dir/nested.F90.o
[ 41%] Building Fortran object src/CMakeFiles/multinest_shared.dir/cwrapper.f90.o
Linking Fortran shared library ../../lib/libmultinest.dylib
[ 41%] Built target multinest_shared
Scanning dependencies of target multinest_static
[ 43%] Building Fortran object src/CMakeFiles/multinest_static.dir/utils.f90.o
[ 44%] Building Fortran object src/CMakeFiles/multinest_static.dir/utils1.f90.o
[ 46%] Building Fortran object src/CMakeFiles/multinest_static.dir/kmeans_clstr.f90.o
[ 48%] Building Fortran object src/CMakeFiles/multinest_static.dir/xmeans_clstr.f90.o
[ 50%] Building Fortran object src/CMakeFiles/multinest_static.dir/posterior.F90.o
[ 51%] Building Fortran object src/CMakeFiles/multinest_static.dir/priors.f90.o
[ 53%] Building Fortran object src/CMakeFiles/multinest_static.dir/nested.F90.o
[ 55%] Building Fortran object src/CMakeFiles/multinest_static.dir/cwrapper.f90.o
Linking Fortran static library ../../lib/libmultinest.a
Error copying file &amp;quot;/Users/adam/repos/MultiNest/build/src/kmeans_clstr.mod&amp;quot; to &amp;quot;/Users/adam/repos/MultiNest/modules/&amp;quot;.
make[2]: *** [../lib/libmultinest.a] Error 1
make[1]: *** [src/CMakeFiles/multinest_static.dir/all] Error 2
make: *** [all] Error 2
&lt;/pre&gt;
&lt;p&gt;The approach that worked:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
mkdir -p build lib modules bin/chains
cd build
cmake -DCMAKE_{C,CXX}_FLAGS=&amp;quot;-arch x86_64&amp;quot; -DCMAKE_Fortran_FLAGS=&amp;quot;-m64&amp;quot; ..
make
sudo make install
cd ../lib
ln -s libmultinest.dylib libmultinest.so
export DYLD_LIBRARY_PATH=$DYLD_LIBRARY_PATH:/usr/local/hpc/lib:/usr/local/openmpi/lib/
export LD_LIBRARY_PATH=/Users/adam/repos/MultiNest/lib
&lt;/pre&gt;
&lt;p&gt;At this point, multinest imports but doesn't run the tests...&lt;/p&gt;
</content><category term="misc"></category></entry><entry><title>Position-Velocity Diagrams</title><link href="https://keflavich.github.io/blog/position-velocity-diagrams.html" rel="alternate"></link><published>2013-09-24T00:00:00-06:00</published><updated>2013-09-24T00:00:00-06:00</updated><author><name>Adam Ginsburg (adam.g.ginsburg@gmail.com)</name></author><id>tag:keflavich.github.io,2013-09-24:/blog/position-velocity-diagrams.html</id><summary type="html">&lt;p&gt;tl;dr version: IPython notebook &lt;a class="reference external" href="http://keflavich.github.io/pvextractor/examples/IRAS05358Slicing.html"&gt;here&lt;/a&gt;, code &lt;a class="reference external" href="http://keflavich.github.io/pvextractor/"&gt;available on github&lt;/a&gt;&lt;/p&gt;
&lt;div class="section" id="current-state-of-affairs"&gt;
&lt;h2&gt;Current state of affairs&lt;/h2&gt;
&lt;p&gt;Position-velocity diagrams with arbitrary position axes have been a common tool
for studying spectra for a long time, probably because the &amp;quot;native&amp;quot; format of
long-slit spectra on CCDs is effectively a position-velocity diagram.&lt;/p&gt;
&lt;p&gt;It's becoming more …&lt;/p&gt;&lt;/div&gt;</summary><content type="html">&lt;p&gt;tl;dr version: IPython notebook &lt;a class="reference external" href="http://keflavich.github.io/pvextractor/examples/IRAS05358Slicing.html"&gt;here&lt;/a&gt;, code &lt;a class="reference external" href="http://keflavich.github.io/pvextractor/"&gt;available on github&lt;/a&gt;&lt;/p&gt;
&lt;div class="section" id="current-state-of-affairs"&gt;
&lt;h2&gt;Current state of affairs&lt;/h2&gt;
&lt;p&gt;Position-velocity diagrams with arbitrary position axes have been a common tool
for studying spectra for a long time, probably because the &amp;quot;native&amp;quot; format of
long-slit spectra on CCDs is effectively a position-velocity diagram.&lt;/p&gt;
&lt;p&gt;It's becoming more common now to have data cubes (PPV) than 1D or 2D spectra.
But PV diagrams still have utility.  Unfortunately, there aren't very good
tools to produce them.&lt;/p&gt;
&lt;p&gt;There are plenty of tools that can slice along any of the native axes of a data
cube.  If you take your data cube in RA/Dec space, extracting along lines of
constant RA or Dec is trivial (&lt;a class="reference external" href="http://star-www.dur.ac.uk/~pdraper/gaia/gaia.html"&gt;GAIA&lt;/a&gt; can do it natively, but it's easy to
slice a cube in IDL or python).&lt;/p&gt;
&lt;p&gt;However, if you wanted to slice along lines of constant GLON or GLAT, you'd
have to reproject the cube to use this approach.  There are nice tools that
implement cube rotation: CASA has an &lt;a class="reference external" href="http://star-www.dur.ac.uk/~pdraper/gaia/gaia.html"&gt;imrebin recipe&lt;/a&gt; and STARLINK has a
rotation tool (though I can't find it now...).&lt;/p&gt;
&lt;p&gt;However, this approach is terribly inefficient if you want slices at multiple
different angles, and it's outright awful if you want to track a filament.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="an-alternative-approach"&gt;
&lt;h2&gt;An alternative approach&lt;/h2&gt;
&lt;p&gt;The alternative is to interpolate between pixels along a specified axis.  This
can be done very efficiently in python using scipy's &lt;a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/generated/scipy.ndimage.interpolation.map_coordinates.html"&gt;map_coordinates&lt;/a&gt;, which
by default does a cubic-spline interpolation at the specified points.&lt;/p&gt;
&lt;p&gt;I've started to build a tool to extract position-velocity diagrams on this
basis.  It's fully functional, but doesn't do anything interactive just yet.
&lt;a class="reference external" href="https://github.com/keflavich/pvextractor"&gt;pvextractor&lt;/a&gt; is &lt;a class="reference external" href="http://keflavich.github.io/pvextractor/"&gt;available on github&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;There is a complete example demonstrating its use &lt;a class="reference external" href="http://keflavich.github.io/pvextractor/examples/IRAS05358Slicing.html"&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;In short, though, it allows you to describe paths like this:&lt;/p&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/paths_i05358.png" style="width: 800px;" /&gt;
&lt;p&gt;and extract them into position-velocity diagrams like this:&lt;/p&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/pv_i05358.png" style="width: 800px;" /&gt;
&lt;/div&gt;
&lt;div class="section" id="postscript-figshare"&gt;
&lt;h2&gt;Postscript: Figshare&lt;/h2&gt;
&lt;p&gt;(note: postscript as in &amp;quot;P.S.&amp;quot;, not &amp;quot;.ps&amp;quot;)&lt;/p&gt;
&lt;p&gt;In order to create the example document (&lt;a class="reference external" href="http://keflavich.github.io/pvextractor/examples/IRAS05358Slicing.html"&gt;here&lt;/a&gt;), I needed a small data cube
that could easily be downloaded. &lt;a class="reference external" href="theastrodata.org"&gt;Dataverse&lt;/a&gt; hosts the &lt;a class="reference external" href="http://www.cfa.harvard.edu/COMPLETE/"&gt;COMPLETE&lt;/a&gt; survey, but
they make you jump through a javascript hoop to download their data, which
means that it is not possible to write an easily reproducible script.  Too bad,
since I would have used them except for this minor interface issue.&lt;/p&gt;
&lt;p&gt;Instead, I've found that &lt;a class="reference external" href="http://figshare.com"&gt;figshare&lt;/a&gt; has fixed up their interface since I last
used them.  It was easy enough that I decided to upload my &lt;a class="reference external" href="http://figshare.com/articles/IRAS_05358_3543_Data_Cubes/806315"&gt;IRAS 05358+3543
data cubes&lt;/a&gt; and had no trouble at all.  I also posted an update to the &lt;a class="reference external" href="http://arxiv.org/abs/0910.2990"&gt;arxiv&lt;/a&gt;
page for the article indictating that the data are freely shared.  I'll do my
best to share the data for the rest of my papers too, though it will take some
time and I'll hit data limits for W5 pretty quickly.&lt;/p&gt;
&lt;/div&gt;
</content><category term="misc"></category><category term="python"></category><category term="spectra"></category></entry><entry><title>Blogging from IPython</title><link href="https://keflavich.github.io/blog/blogging-from-ipython.html" rel="alternate"></link><published>2013-09-22T00:00:00-06:00</published><updated>2013-09-22T00:00:00-06:00</updated><author><name>Adam &lt;keflavich@gmail.com&gt;</name></author><id>tag:keflavich.github.io,2013-09-22:/blog/blogging-from-ipython.html</id><summary type="html">&lt;p&gt;[ &lt;a class="reference external" href="http://nbviewer.ipython.org/urls/raw.github.com/keflavich/blog/master/content/BloggingFromIPython.ipynb"&gt;Notebook Form of this
post&lt;/a&gt;
]&lt;/p&gt;
&lt;p&gt;There have been
&lt;a class="reference external" href="http://jmcarp.github.io/blog/2013/07/07/hello-world/"&gt;many&lt;/a&gt;
&lt;a class="reference external" href="http://danielfrg.github.io/blog/2013/02/16/blogging-pelican-ipython-notebook/"&gt;other&lt;/a&gt;
&lt;a class="reference external" href="http://danielfrg.github.io/blog/2013/03/08/pelican-ipython-notebook-plugin/"&gt;posts&lt;/a&gt;
about blogging in ipython, but they all included more overhead than I
really wanted to deal with.&lt;/p&gt;
&lt;p&gt;Instead, I've gone directly to &lt;a class="reference external" href="http://nbviewer.ipython.org/urls/raw.github.com/Carreau/posts/master/06-NBconvert-Doc-Draft.ipynb"&gt;the
source&lt;/a&gt;
and used nbconvert in ipython 2.0 to convert my notebooks to rst, then
put …&lt;/p&gt;</summary><content type="html">&lt;p&gt;[ &lt;a class="reference external" href="http://nbviewer.ipython.org/urls/raw.github.com/keflavich/blog/master/content/BloggingFromIPython.ipynb"&gt;Notebook Form of this
post&lt;/a&gt;
]&lt;/p&gt;
&lt;p&gt;There have been
&lt;a class="reference external" href="http://jmcarp.github.io/blog/2013/07/07/hello-world/"&gt;many&lt;/a&gt;
&lt;a class="reference external" href="http://danielfrg.github.io/blog/2013/02/16/blogging-pelican-ipython-notebook/"&gt;other&lt;/a&gt;
&lt;a class="reference external" href="http://danielfrg.github.io/blog/2013/03/08/pelican-ipython-notebook-plugin/"&gt;posts&lt;/a&gt;
about blogging in ipython, but they all included more overhead than I
really wanted to deal with.&lt;/p&gt;
&lt;p&gt;Instead, I've gone directly to &lt;a class="reference external" href="http://nbviewer.ipython.org/urls/raw.github.com/Carreau/posts/master/06-NBconvert-Doc-Draft.ipynb"&gt;the
source&lt;/a&gt;
and used nbconvert in ipython 2.0 to convert my notebooks to rst, then
put them through pelican.&lt;/p&gt;
&lt;p&gt;This post outlines my workflow.&lt;/p&gt;
&lt;p&gt;First, and most inconvenient, it is necessary to head any blog post with
metadata. I don't have any convenient workflow to deal with that, I just
write it in by hand in a raw text box (ctrl-m, t) as you can see above.
&lt;a class="reference external" href="http://danielfrg.github.io/"&gt;Daniel Rodriguez&lt;/a&gt; took a &lt;a class="reference external" href="http://danielfrg.github.io/blog/2013/03/08/pelican-ipython-notebook-plugin/"&gt;different
approach&lt;/a&gt;
using the ipython metadata directly and an ipython plugin, but I didn't
want to have to worry about installing plugins and I am definitely
worried about breaking notebooks by messing with the
&lt;a class="reference external" href="https://github.com/ipython/ipython/wiki/IPEP-20%3A-Informal-structure-of-cell-metadata"&gt;metadata&lt;/a&gt;
as the ipy devs give some fairly &lt;a class="reference external" href="https://gist.github.com/Carreau/4437348"&gt;strict
warnings&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Next, the ipynb -&amp;gt; rst step is fairly straightforward. I modified the
rst template because I don't want to see the &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;In[#]:&lt;/span&gt;&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;Out[#]:&lt;/span&gt;&lt;/tt&gt;
prefixes around my code. I also use &lt;tt class="docutils literal"&gt;.. &lt;span class="pre"&gt;code-block::&lt;/span&gt;&lt;/tt&gt; rather than
&lt;tt class="docutils literal"&gt;.. code::&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;This very simple function below makes sure that my local &lt;tt class="docutils literal"&gt;rst.tbl&lt;/tt&gt;
file is seen before ipython's. Their templates are in
&lt;tt class="docutils literal"&gt;IPython/nbconvert/templates&lt;/tt&gt;. Note that you could normally use Jinja2
templating and &amp;quot;Extend&amp;quot; their template, but I wanted to remove rather
than extend.&lt;/p&gt;
&lt;p&gt;[
&lt;a class="reference external" href="https://github.com/keflavich/blog/blob/master/nbconverter.py"&gt;Source&lt;/a&gt;
]&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;IPython.nbconvert.exporters&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;RSTExporter&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;export&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;nbname&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;outfilename&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;exportRST&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;RSTExporter&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="c1"&gt;# exclude default paths&lt;/span&gt;
    &lt;span class="n"&gt;exportRST&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;template_path&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;.&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/Users/adam/repos/blog&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;

    &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;body&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;resources&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;exportRST&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;from_filename&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;nbname&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;outfilename&lt;/span&gt; &lt;span class="ow"&gt;is&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;outfilename&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;nbname&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;replace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;ipynb&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;rst&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;outfilename&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;w&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;body&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;body&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;resources&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;I then run the script from the command line:
&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;~/virtual-ipydev/bin/ipython&lt;/span&gt; ./nbconverter.py content/GenerateCVExample.ipynb&lt;/tt&gt;&lt;/p&gt;
&lt;p&gt;I'm using a virtual environment with ipython 2 installed because I'm not
yet ready to make the jump to the dev version of ipython (though these
days, with Travis and Jenkins around, it's probably safe to assume the
dev version won't break anything).&lt;/p&gt;
&lt;p&gt;With this rst file generated, the only remaining step is
&lt;a class="reference external" href="http://blog.getpelican.com/"&gt;pelican&lt;/a&gt;, which only requires a
&lt;tt class="docutils literal"&gt;make github&lt;/tt&gt; command in the blog directory. Installing &amp;amp; setting up
pelican is reasonably easy, but not the topic of this post.&lt;/p&gt;
&lt;p&gt;I've made my own &lt;a class="reference external" href="https://github.com/keflavich/pelican-themes/tree/master/mine"&gt;custom pelican
theme&lt;/a&gt;,
so I generally need to update the theme before building:&lt;/p&gt;
&lt;p&gt;&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;pelican-themes&lt;/span&gt; &lt;span class="pre"&gt;--upgrade&lt;/span&gt; &lt;span class="pre"&gt;/Users/adam/repos/pelican-themes/mine&lt;/span&gt; &amp;amp;&amp;amp; make github&lt;/tt&gt;&lt;/p&gt;
</content><category term="misc"></category><category term="python"></category><category term="blogging"></category><category term="meta"></category></entry><entry><title>Generating a CV using the ADS Labs API</title><link href="https://keflavich.github.io/blog/generating-a-cv-using-the-ads-labs-api.html" rel="alternate"></link><published>2013-09-21T00:00:00-06:00</published><updated>2013-09-21T00:00:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2013-09-21:/blog/generating-a-cv-using-the-ads-labs-api.html</id><summary type="html">&lt;ul class="simple"&gt;
&lt;li&gt;[ &lt;a class="reference external" href="https://github.com/keflavich/generate_cv"&gt;Source code related to this
post&lt;/a&gt; ]&lt;/li&gt;
&lt;li&gt;[ &lt;a class="reference external" href="http://nbviewer.ipython.org/urls/raw.github.com/keflavich/generate_cv/master/examples/GenerateCVExample.ipynb"&gt;Notebook
form&lt;/a&gt;
]&lt;/li&gt;
&lt;li&gt;[ &lt;a class="reference external" href="http://www.adamgginsburg.com/cv.htm"&gt;CV partly generated from this
post&lt;/a&gt; ]&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;At &lt;a class="reference external" href="http://dotastronomy.com/"&gt;.astronomy&lt;/a&gt; this past week, the keynote
speaker was &lt;a class="reference external" href="https://www.cfa.harvard.edu/~alberto/"&gt;Alberto
Accomazzi&lt;/a&gt;, introducing ADS
Labs and &lt;a class="reference external" href="http://labs.adsabs.harvard.edu/adsabs/"&gt;ADS 2.0&lt;/a&gt;, which are
really quite impressive.&lt;/p&gt;
&lt;p&gt;I was inspired to use ADS Labs to help me auto-generate a nicely …&lt;/p&gt;</summary><content type="html">&lt;ul class="simple"&gt;
&lt;li&gt;[ &lt;a class="reference external" href="https://github.com/keflavich/generate_cv"&gt;Source code related to this
post&lt;/a&gt; ]&lt;/li&gt;
&lt;li&gt;[ &lt;a class="reference external" href="http://nbviewer.ipython.org/urls/raw.github.com/keflavich/generate_cv/master/examples/GenerateCVExample.ipynb"&gt;Notebook
form&lt;/a&gt;
]&lt;/li&gt;
&lt;li&gt;[ &lt;a class="reference external" href="http://www.adamgginsburg.com/cv.htm"&gt;CV partly generated from this
post&lt;/a&gt; ]&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;At &lt;a class="reference external" href="http://dotastronomy.com/"&gt;.astronomy&lt;/a&gt; this past week, the keynote
speaker was &lt;a class="reference external" href="https://www.cfa.harvard.edu/~alberto/"&gt;Alberto
Accomazzi&lt;/a&gt;, introducing ADS
Labs and &lt;a class="reference external" href="http://labs.adsabs.harvard.edu/adsabs/"&gt;ADS 2.0&lt;/a&gt;, which are
really quite impressive.&lt;/p&gt;
&lt;p&gt;I was inspired to use ADS Labs to help me auto-generate a nicely
formatted CV for myself. I used &lt;a class="reference external" href="https://twitter.com/astrowizicist"&gt;Andy
Casey's&lt;/a&gt;
&lt;a class="reference external" href="https://github.com/andycasey/ads-python"&gt;ADS-python&lt;/a&gt; as a starting
point: he introduces a useful convention of storing your &lt;a class="reference external" href="https://github.com/adsabs/adsabs-dev-api#signup--access"&gt;ADS API
Key&lt;/a&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;os&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_dev_key&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot; A convenience function for accessing a system-wide ADS Developer&amp;#39;s Key &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;

    &lt;span class="n"&gt;ads_dev_key_filename&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;abspath&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;expanduser&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;~/.ads/dev_key&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;

    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exists&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ads_dev_key_filename&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ads_dev_key_filename&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;r&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;fp&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;dev_key&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fp&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;readline&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rstrip&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;dev_key&lt;/span&gt;

    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;ADS_DEV_KEY&amp;#39;&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;environ&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;environ&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;ADS_DEV_KEY&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;

    &lt;span class="k"&gt;raise&lt;/span&gt; &lt;span class="ne"&gt;IOError&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;no ADS API key found in ~/.ads/dev_key&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;We'll use &lt;tt class="docutils literal"&gt;requests&lt;/tt&gt; to send the request to ADS, then &lt;tt class="docutils literal"&gt;json&lt;/tt&gt; to
parse the data.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;requests&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;json&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;We then query the database using a keyword query (parameter &lt;tt class="docutils literal"&gt;q&lt;/tt&gt;)
specifying the author. Other required parameters are the API key
(&lt;tt class="docutils literal"&gt;dev_key&lt;/tt&gt;) and a filter to select only astronomy articles. The
maximum number of rows returned in the API is 200 right now, which I
have set (the default is 10 or 20).&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;response&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;requests&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;post&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;http://adslabs.org/adsabs/api/search/&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                         &lt;span class="n"&gt;params&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;q&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;author:ginsburg, a&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                                 &lt;span class="s1"&gt;&amp;#39;dev_key&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;get_dev_key&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;
                                 &lt;span class="s1"&gt;&amp;#39;rows&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;200&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                                 &lt;span class="s1"&gt;&amp;#39;filter&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;database:astronomy&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;J&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;json&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;J&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;keys&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;pre class="literal-block"&gt;
[u'meta', u'results']
&lt;/pre&gt;
&lt;p&gt;The JSON 'meta' key is just metadata about the query, include the number
of matches and execution time.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;J&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;meta&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;pre class="literal-block"&gt;
{u'api-version': u'0.1',
 u'count': 54,
 u'hits': 54,
 u'qtime': 7,
 u'query': u'author:ginsburg, a'}
&lt;/pre&gt;
&lt;p&gt;The 'results' key includes what we're actually interested in, under
another key 'docs'.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;J&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;results&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;keys&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;pre class="literal-block"&gt;
[u'docs']
&lt;/pre&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;datalist&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;J&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;results&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;docs&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="nb"&gt;type&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;datalist&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;datalist&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;pre class="literal-block"&gt;
(list, 54)
&lt;/pre&gt;
&lt;p&gt;&lt;tt class="docutils literal"&gt;datalist&lt;/tt&gt; is a list of the retrieved bibliographic entries.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;datalist&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;keys&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;pre class="literal-block"&gt;
[u'bibcode',
 u'keyword',
 u'pubdate',
 u'bibstem',
 u'property',
 u'aff',
 u'author',
 u'citation_count',
 u'pub',
 u'page',
 u'volume',
 u'database',
 u'doi',
 u'year',
 u'abstract',
 u'title',
 u'identifier',
 u'issue',
 u'id']
&lt;/pre&gt;
&lt;p&gt;At this point, most of the remaining work is building up a nicely
formatted output. We'll start with a web-specific example, using HTML
unordered lists.&lt;/p&gt;
&lt;p&gt;In this example, we'll make a list item that creates a hyperlink for the
author names and uses a reasonably standard bibliographic format:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
Authors Month, Year, Journal
Title
&lt;/pre&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;fmt&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;                &amp;#39;&lt;/span&gt;
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&amp;lt;li&amp;gt;&amp;lt;a class=&amp;quot;norm&amp;quot; href=&amp;quot;http://adsabs.harvard.edu/abs/&lt;/span&gt;&lt;span class="si"&gt;{adsbibid}&lt;/span&gt;&lt;span class="s1"&gt;&amp;quot;&amp;gt;&lt;/span&gt;&lt;span class="si"&gt;{creator}&lt;/span&gt;&lt;span class="s1"&gt;&amp;lt;/a&amp;gt;&amp;#39;&lt;/span&gt;
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39; &lt;/span&gt;&lt;span class="si"&gt;{month}&lt;/span&gt;&lt;span class="s1"&gt;, &amp;lt;b&amp;gt;&lt;/span&gt;&lt;span class="si"&gt;{year}&lt;/span&gt;&lt;span class="s1"&gt;&amp;lt;/b&amp;gt; &lt;/span&gt;&lt;span class="si"&gt;{journal}&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;                &amp;lt;br&amp;gt;&amp;amp;nbsp;&amp;amp;nbsp;&amp;amp;nbsp;&lt;/span&gt;&lt;span class="si"&gt;{titlestring}&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;We need to do a little data wrangling to get the individual JSON entries
into the appropriate format:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;wrangle&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;authorname&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Ginsburg&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot; Create new fields from the input data to insert into the format string &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;month&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;pubdate&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="c1"&gt;# Generally, the last identifier is the published version,&lt;/span&gt;
    &lt;span class="c1"&gt;# while the first is an arXiv identifier&lt;/span&gt;
    &lt;span class="c1"&gt;# (data[&amp;#39;identifier&amp;#39;] is a list)&lt;/span&gt;
    &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;adsbibid&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;identifier&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="c1"&gt;# data[&amp;#39;title&amp;#39;] &amp;amp; [&amp;#39;pub&amp;#39;] are also lists&lt;/span&gt;
    &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;titlestring&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;title&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;journal&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;bibstem&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="c1"&gt;# This trick bolds my name in the list of authors&lt;/span&gt;
    &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;authors&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&amp;lt;b&amp;gt;&lt;/span&gt;&lt;span class="si"&gt;{}&lt;/span&gt;&lt;span class="s1"&gt;&amp;lt;/b&amp;gt;&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;authorname&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;author&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;
    &lt;span class="c1"&gt;# Separate names by semicolons&lt;/span&gt;
    &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;creator&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;; &amp;quot;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;authors&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The return from &lt;tt class="docutils literal"&gt;wrangle&lt;/tt&gt; is a dict with new keys that match the
keywords in the format string. The python &lt;tt class="docutils literal"&gt;string.format&lt;/tt&gt; method will
nicely ignore any extra keywords that we're uninterested in.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;fmt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;wrangle&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;datalist&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;pre class="literal-block"&gt;
u'                &amp;lt;li&amp;gt;&amp;lt;a class=&amp;quot;norm&amp;quot; href=&amp;quot;&lt;a class="reference external" href="http://adsabs.harvard.edu/abs/2013ApJ...773..102F"&gt;http://adsabs.harvard.edu/abs/2013ApJ...773..102F&lt;/a&gt;&amp;quot;&amp;gt;Fallscheer, C.; Reid, M. A.; Di Francesco, J.; Martin, P. G.; Hill, T.; Hennemann, M.; Nguyen-Luong, Q.; Motte, F.; Men'shchikov, A.; Andrxe9, Ph.; Ward-Thompson, D.; Griffin, M.; Kirk, J.; Konyves, V.; Rygl, K. L. J.; Sadavoy, S.; Sauvage, M.; Schneider, N.; Anderson, L. D.; Benedettini, M.; Bernard, J. -P.; Bontemps, S.; &amp;lt;b&amp;gt;Ginsburg, A.&amp;lt;/b&amp;gt;; Molinari, S.; Polychroni, D.; Rivera-Ingraham, A.; Roussel, H.; Testi, L.; White, G.; Williams, J. P.; Wilson, C. D.; Wong, M.; Zavagno, A.&amp;lt;/a&amp;gt; 08, &amp;lt;b&amp;gt;2013&amp;lt;/b&amp;gt; ApJn                &amp;lt;br&amp;gt;&amp;amp;nbsp;&amp;amp;nbsp;&amp;amp;nbsp;Herschel Reveals Massive Cold Clumps in NGCxa07538'
&lt;/pre&gt;
&lt;p&gt;Now to show it in the notebook...&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;IPython.display&lt;/span&gt;
&lt;span class="n"&gt;IPython&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;display&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;HTML&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fmt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;wrangle&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;datalist&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;])))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;You can make a complete bibliography by looping over a few entries. The
ordered list (&lt;tt class="docutils literal"&gt;&amp;lt;ol&amp;gt;&lt;/tt&gt;) tag makes a numbered list.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;html&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&amp;lt;ol&amp;gt;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fmt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;wrangle&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;datalist&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ii&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;ii&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;xrange&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&amp;lt;/ol&amp;gt;&amp;quot;&lt;/span&gt;
&lt;span class="n"&gt;IPython&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;display&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;HTML&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;html&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;If you want to make sure you only include refereed articles, use the
'property' tag.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;REFEREED&amp;#39;&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;property&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;d&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;datalist&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;pre class="literal-block"&gt;
[True, False, True, False, False, False, True, True, False, False, False, False, True, True, True, False, False, True, True, False, False, True, True, True, False, False, False, False, True, False, False, True, True, True, True, True, True, False, False, False, False, False, False, True, True, False, False, False, False, False, True, False, False, True]
&lt;/pre&gt;
&lt;p&gt;And don't forget that you can also include the citation count:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="si"&gt;{}&lt;/span&gt;&lt;span class="s2"&gt; &lt;/span&gt;&lt;span class="si"&gt;{}&lt;/span&gt;&lt;span class="s2"&gt;: &lt;/span&gt;&lt;span class="si"&gt;{}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;author&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;year&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;citation_count&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
                &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;d&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;datalist&lt;/span&gt;
                &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;citation_count&amp;#39;&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;d&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;REFEREED&amp;#39;&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;property&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;pre class="literal-block"&gt;
Fallscheer, C. 2013: 0
Ellsworth-Bowers, Timothy P. 2013: 2
Smith, Nathan 2013: 0
Harvey, Paul M. 2013: 2
Bressert, E. 2012: 10
Ginsburg, A. 2012: 11
Bally, John 2012: 0
Ginsburg, Adam 2011: 5
Battersby, C. 2011: 22
Schlingman, Wayne M. 2011: 17
Ginsburg, Adam 2011: 6
van Aarle, E. 2011: 12
Aguirre, James E. 2011: 72
Bally, John 2010: 36
Battersby, Cara 2010: 30
Yan, Chi-Hung 2010: 5
Bally, J. 2010: 20
Dunham, Miranda K. 2010: 27
Rosolowsky, Erik 2010: 80
Ginsburg, Adam G. 2009: 10
Rubin, D. 2009: 23
van de Steene, G. C. 2008: 4
Golitsyn, G. S. 1985: 4
&lt;/pre&gt;
&lt;div class="section" id="wishlist"&gt;
&lt;h2&gt;Wishlist&lt;/h2&gt;
&lt;p&gt;There are a few other features that would be nice to add to the CV, but
some are not yet well-supported.&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;You can get the full name, but right now not the short name
('bibstem'), of the journal&lt;/li&gt;
&lt;li&gt;The bibtex entry is important for generating tex versions of CVs.
Currently, it is not possible to completely reproduce one, largely
because of point #1.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;However, the ADS folks will certainly change this soon. You can find out
if they have by querying their API settings. If the query below returns
&amp;quot;True&amp;quot;, then you can access the bibstem.&lt;/p&gt;
&lt;p&gt;UPDATE 9/23/2013: Jay Luker &amp;#64;ADS &lt;a class="reference external" href="https://twitter.com/lbjay/status/382138570632204291"&gt;added 'bibstem' to the allowed return
entries&lt;/a&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;permissions_response&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;requests&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;post&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;http://adslabs.org/adsabs/api/settings/&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;params&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;dev_key&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;get_dev_key&lt;/span&gt;&lt;span class="p"&gt;()})&lt;/span&gt;
&lt;span class="n"&gt;permissions&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;permissions_response&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;json&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="s1"&gt;&amp;#39;bibstem&amp;#39;&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;permissions&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;allowed_fields&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;pre class="literal-block"&gt;
True
&lt;/pre&gt;
&lt;p&gt;In the meantime, you can get most of the way there. We'll create
&amp;quot;Article&amp;quot; entries for any articles or eprints and ignore abstracts
(e.g., conference abstracts). I don't have any books, but for others
that might be useful.&lt;/p&gt;
&lt;p&gt;The approach we'll use is also a good way to reject unwanted articles in
the HTML bibliography above.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;bibfmt&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&amp;quot;&amp;quot;@article{{&lt;/span&gt;&lt;span class="si"&gt;{tagname}&lt;/span&gt;&lt;span class="s2"&gt;,&lt;/span&gt;
&lt;span class="s2"&gt;abstract={{&lt;/span&gt;&lt;span class="si"&gt;{abstract}&lt;/span&gt;&lt;span class="s2"&gt;}},&lt;/span&gt;
&lt;span class="s2"&gt;author={{&lt;/span&gt;&lt;span class="si"&gt;{bibtexauthors}&lt;/span&gt;&lt;span class="s2"&gt;}},&lt;/span&gt;
&lt;span class="s2"&gt;month={{&lt;/span&gt;&lt;span class="si"&gt;{month}&lt;/span&gt;&lt;span class="s2"&gt;}},&lt;/span&gt;
&lt;span class="s2"&gt;pages={{&lt;/span&gt;&lt;span class="si"&gt;{page}&lt;/span&gt;&lt;span class="s2"&gt;}},&lt;/span&gt;
&lt;span class="s2"&gt;title={{&lt;/span&gt;&lt;span class="si"&gt;{titlestring}&lt;/span&gt;&lt;span class="s2"&gt;}},&lt;/span&gt;
&lt;span class="s2"&gt;year={{&lt;/span&gt;&lt;span class="si"&gt;{year}&lt;/span&gt;&lt;span class="s2"&gt;}},&lt;/span&gt;
&lt;span class="s2"&gt;volume={{&lt;/span&gt;&lt;span class="si"&gt;{volume}&lt;/span&gt;&lt;span class="s2"&gt;}},&lt;/span&gt;
&lt;span class="s2"&gt;journal={{&lt;/span&gt;&lt;span class="se"&gt;\\&lt;/span&gt;&lt;span class="si"&gt;{lowercasejournal}&lt;/span&gt;&lt;span class="s2"&gt;}}&lt;/span&gt;
&lt;span class="s2"&gt;}}&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Of course, it's necessary to wrangle the data again for the appropriate
author list formatting for bibtex:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;wrangleauthors&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;authorlist&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot; Fit the author list into a bibtex-friendly format.&lt;/span&gt;
&lt;span class="sd"&gt;    Not the cleanest hack, since we need to allow for single-name&lt;/span&gt;
&lt;span class="sd"&gt;    authors (e.g., astropy collaboration, Planck collaboration, etc.)&lt;/span&gt;
&lt;span class="sd"&gt;    The triple braces are needed because TeX uses them&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class="n"&gt;splita&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[[&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;strip&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;,&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;authorlist&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="n"&gt;bracketed&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;{{&lt;/span&gt;&lt;span class="si"&gt;{}&lt;/span&gt;&lt;span class="s1"&gt;}}, &lt;/span&gt;&lt;span class="si"&gt;{}&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;replace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot; &amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;~&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
                 &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
                 &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;{{&lt;/span&gt;&lt;span class="si"&gt;{}&lt;/span&gt;&lt;span class="s1"&gt;}}&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
                 &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;splita&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot; and &amp;quot;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;bracketed&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;wrangleauthors&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;datalist&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;author&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;pre class="literal-block"&gt;
u&amp;quot;{Fallscheer}, C. and {Reid}, M.~A. and {Di Francesco}, J. and {Martin}, P.~G. and {Hill}, T. and {Hennemann}, M. and {Nguyen-Luong}, Q. and {Motte}, F. and {Men'shchikov}, A. and {Andrxe9}, Ph. and {Ward-Thompson}, D. and {Griffin}, M. and {Kirk}, J. and {Konyves}, V. and {Rygl}, K.~L.~J. and {Sadavoy}, S. and {Sauvage}, M. and {Schneider}, N. and {Anderson}, L.~D. and {Benedettini}, M. and {Bernard}, J.~-P. and {Bontemps}, S. and {Ginsburg}, A. and {Molinari}, S. and {Polychroni}, D. and {Rivera-Ingraham}, A. and {Roussel}, H. and {Testi}, L. and {White}, G. and {Williams}, J.~P. and {Wilson}, C.~D. and {Wong}, M. and {Zavagno}, A.&amp;quot;
&lt;/pre&gt;
&lt;p&gt;Now we can start looping through, performing checks for article status,
and making bibentries. We'll use python's &lt;tt class="docutils literal"&gt;dateutils.parse&lt;/tt&gt; to turn
month numbers into names&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;dateutil.parser&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;d&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;datalist&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;bibtexauthors&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;wrangleauthors&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;author&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;

    &lt;span class="c1"&gt;# pubdates don&amp;#39;t include days, and sometimes don&amp;#39;t include months,&lt;/span&gt;
    &lt;span class="c1"&gt;# so we have to be careful&lt;/span&gt;
    &lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;month&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dateutil&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;parser&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;parse&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;pubdate&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;][:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;strftime&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;%B&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
                  &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;pubdate&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;00&amp;#39;&lt;/span&gt;
                  &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="c1"&gt;# To make the standard macros, e.g. \apj, \aa&lt;/span&gt;
    &lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;lowercasejournal&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;bibstem&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;lower&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="c1"&gt;# list -&amp;gt; string&lt;/span&gt;
    &lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;titlestring&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;title&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;

    &lt;span class="c1"&gt;# need to make sure there is something to put in the volume field&lt;/span&gt;
    &lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;volume&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;volume&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;volume&amp;#39;&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;d&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;

    &lt;span class="c1"&gt;# tagname is [First author&amp;#39;s last name][year]&lt;/span&gt;
    &lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;tagname&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;author&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;()[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;strip&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;,&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;year&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;bibdata&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;d&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;datalist&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;ARTICLE&amp;#39;&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;property&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="ow"&gt;or&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;EPRINT&amp;#39;&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;property&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]:&lt;/span&gt;
        &lt;span class="n"&gt;bibdata&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;bibfmt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="se"&gt;\n\n&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Now this data can be saved to a bibliography file and parsed by LaTeX.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;codecs&lt;/span&gt; &lt;span class="c1"&gt;# for writing unicode&lt;/span&gt;

&lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="n"&gt;codecs&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;mypapers.bib&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;w&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;encoding&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;utf8&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;bibdata&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Future work:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Verify the bibtex&lt;/li&gt;
&lt;li&gt;Generate the CV LaTeX and compile it&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</content><category term="misc"></category><category term="python"></category></entry><entry><title>My favorite Splatalogue queries</title><link href="https://keflavich.github.io/blog/my-favorite-splatalogue-queries.html" rel="alternate"></link><published>2013-08-05T10:37:59-06:00</published><updated>2013-08-05T10:37:59-06:00</updated><author><name>Adam Ginsburg</name></author><id>tag:keflavich.github.io,2013-08-05:/blog/my-favorite-splatalogue-queries.html</id><summary type="html">&lt;p&gt;I tend to be most interested in low-energy molecular lines: CO, NH&lt;sub&gt;3&lt;/sub&gt;, and
H&lt;sub&gt;2&lt;/sub&gt;CO being the main candidates.&lt;/p&gt;
&lt;p&gt;Note: Splatalogue has made some recent changes to their returned tables, partly
per my recommendations.  The code below has been update to reflect these
changes.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;astropy&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;units …&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;</summary><content type="html">&lt;p&gt;I tend to be most interested in low-energy molecular lines: CO, NH&lt;sub&gt;3&lt;/sub&gt;, and
H&lt;sub&gt;2&lt;/sub&gt;CO being the main candidates.&lt;/p&gt;
&lt;p&gt;Note: Splatalogue has made some recent changes to their returned tables, partly
per my recommendations.  The code below has been update to reflect these
changes.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;astropy&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;units&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;u&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;astroquery.splatalogue&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Splatalogue&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;S&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Splatalogue&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;energy_max&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;500&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="o"&gt;...&lt;/span&gt;    &lt;span class="n"&gt;energy_type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;eu_k&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;energy_levels&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;el4&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;span class="o"&gt;...&lt;/span&gt;    &lt;span class="n"&gt;line_strengths&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;ls4&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;span class="o"&gt;...&lt;/span&gt;    &lt;span class="n"&gt;only_NRAO_recommended&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;noHFS&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;trimmed_query&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="o"&gt;...&lt;/span&gt;     &lt;span class="n"&gt;columns&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Species&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Chemical Name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Resolved QNs&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Freq-GHz&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="o"&gt;...&lt;/span&gt;                &lt;span class="s1"&gt;&amp;#39;Meas Freq-GHz&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Log&amp;lt;sub&amp;gt;10&amp;lt;/sub&amp;gt; (A&amp;lt;sub&amp;gt;ij&amp;lt;/sub&amp;gt;)&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="o"&gt;...&lt;/span&gt;                &lt;span class="s1"&gt;&amp;#39;E_U (K)&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;...&lt;/span&gt;     &lt;span class="n"&gt;table&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;S&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;query_lines&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;)[&lt;/span&gt;&lt;span class="n"&gt;columns&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="o"&gt;...&lt;/span&gt;     &lt;span class="n"&gt;table&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rename_column&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Log&amp;lt;sub&amp;gt;10&amp;lt;/sub&amp;gt; (A&amp;lt;sub&amp;gt;ij&amp;lt;/sub&amp;gt;)&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;log10(Aij)&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;...&lt;/span&gt;     &lt;span class="n"&gt;table&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rename_column&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;E_U (K)&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;EU_K&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;...&lt;/span&gt;     &lt;span class="n"&gt;table&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rename_column&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Resolved QNs&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;QNs&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;...&lt;/span&gt;     &lt;span class="n"&gt;table&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sort&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;EU_K&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;...&lt;/span&gt;     &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;table&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;trimmed_query&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;GHz&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;GHz&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="o"&gt;...&lt;/span&gt;     &lt;span class="n"&gt;chemical_name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;(H2.*Formaldehyde)|( HDCO )&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="o"&gt;...&lt;/span&gt;     &lt;span class="n"&gt;energy_max&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;50&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pprint&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;Species&lt;/span&gt; &lt;span class="n"&gt;Chemical&lt;/span&gt; &lt;span class="n"&gt;Name&lt;/span&gt;      &lt;span class="n"&gt;QNs&lt;/span&gt;      &lt;span class="n"&gt;Freq&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;GHz&lt;/span&gt; &lt;span class="n"&gt;Meas&lt;/span&gt; &lt;span class="n"&gt;Freq&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;GHz&lt;/span&gt; &lt;span class="n"&gt;log10&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Aij&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;   &lt;span class="n"&gt;EU_K&lt;/span&gt;
&lt;span class="o"&gt;-------&lt;/span&gt; &lt;span class="o"&gt;-------------&lt;/span&gt; &lt;span class="o"&gt;-------------&lt;/span&gt; &lt;span class="o"&gt;--------&lt;/span&gt; &lt;span class="o"&gt;-------------&lt;/span&gt; &lt;span class="o"&gt;----------&lt;/span&gt; &lt;span class="o"&gt;--------&lt;/span&gt;
   &lt;span class="n"&gt;HDCO&lt;/span&gt;  &lt;span class="n"&gt;Formaldehyde&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;       &lt;span class="o"&gt;--&lt;/span&gt;       &lt;span class="mf"&gt;5.34614&lt;/span&gt;   &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;8.31616&lt;/span&gt; &lt;span class="mf"&gt;11.18287&lt;/span&gt;
 &lt;span class="n"&gt;H2C18O&lt;/span&gt;  &lt;span class="n"&gt;Formaldehyde&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;   &lt;span class="mf"&gt;4.3888&lt;/span&gt;        &lt;span class="mf"&gt;4.3888&lt;/span&gt;   &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;8.22052&lt;/span&gt; &lt;span class="mf"&gt;15.30187&lt;/span&gt;
 &lt;span class="n"&gt;H213CO&lt;/span&gt;  &lt;span class="n"&gt;Formaldehyde&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;       &lt;span class="o"&gt;--&lt;/span&gt;       &lt;span class="mf"&gt;4.59309&lt;/span&gt;   &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;8.51332&lt;/span&gt; &lt;span class="mf"&gt;15.34693&lt;/span&gt;
   &lt;span class="n"&gt;H2CO&lt;/span&gt;  &lt;span class="n"&gt;Formaldehyde&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;  &lt;span class="mf"&gt;4.82966&lt;/span&gt;            &lt;span class="o"&gt;--&lt;/span&gt;   &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;8.44801&lt;/span&gt; &lt;span class="mf"&gt;15.39497&lt;/span&gt;
   &lt;span class="n"&gt;HDCO&lt;/span&gt;  &lt;span class="n"&gt;Formaldehyde&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;       &lt;span class="o"&gt;--&lt;/span&gt;      &lt;span class="mf"&gt;16.03787&lt;/span&gt;   &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;7.36194&lt;/span&gt; &lt;span class="mf"&gt;17.62746&lt;/span&gt;
 &lt;span class="n"&gt;H2C18O&lt;/span&gt;  &lt;span class="n"&gt;Formaldehyde&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="mf"&gt;13.16596&lt;/span&gt;      &lt;span class="mf"&gt;13.16596&lt;/span&gt;   &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;6.86839&lt;/span&gt; &lt;span class="mf"&gt;22.17455&lt;/span&gt;
 &lt;span class="n"&gt;H213CO&lt;/span&gt;  &lt;span class="n"&gt;Formaldehyde&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;       &lt;span class="o"&gt;--&lt;/span&gt;       &lt;span class="mf"&gt;13.7788&lt;/span&gt;   &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;7.55919&lt;/span&gt; &lt;span class="mf"&gt;22.38424&lt;/span&gt;
   &lt;span class="n"&gt;H2CO&lt;/span&gt;  &lt;span class="n"&gt;Formaldehyde&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="mf"&gt;14.48848&lt;/span&gt;            &lt;span class="o"&gt;--&lt;/span&gt;   &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;7.49383&lt;/span&gt; &lt;span class="mf"&gt;22.61771&lt;/span&gt;
 &lt;span class="n"&gt;H2C18O&lt;/span&gt;  &lt;span class="n"&gt;Formaldehyde&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="mf"&gt;26.33012&lt;/span&gt;      &lt;span class="mf"&gt;26.33014&lt;/span&gt;   &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;6.03008&lt;/span&gt; &lt;span class="mf"&gt;32.48204&lt;/span&gt;
 &lt;span class="n"&gt;H213CO&lt;/span&gt;  &lt;span class="n"&gt;Formaldehyde&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;       &lt;span class="o"&gt;--&lt;/span&gt;      &lt;span class="mf"&gt;27.55567&lt;/span&gt;   &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;6.95712&lt;/span&gt;  &lt;span class="mf"&gt;32.9381&lt;/span&gt;
   &lt;span class="n"&gt;H2CO&lt;/span&gt;  &lt;span class="n"&gt;Formaldehyde&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;       &lt;span class="o"&gt;--&lt;/span&gt;       &lt;span class="mf"&gt;28.9748&lt;/span&gt;   &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;6.89179&lt;/span&gt; &lt;span class="mf"&gt;33.44949&lt;/span&gt;


&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;trimmed_query&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;GHz&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;400&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;GHz&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="o"&gt;...&lt;/span&gt;     &lt;span class="n"&gt;chemical_name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Carbon Monoxide&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="o"&gt;...&lt;/span&gt;     &lt;span class="n"&gt;energy_max&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;50&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pprint&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;Species&lt;/span&gt;  &lt;span class="n"&gt;Chemical&lt;/span&gt; &lt;span class="n"&gt;Name&lt;/span&gt;   &lt;span class="n"&gt;QNs&lt;/span&gt;   &lt;span class="n"&gt;Freq&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;GHz&lt;/span&gt; &lt;span class="n"&gt;Meas&lt;/span&gt; &lt;span class="n"&gt;Freq&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;GHz&lt;/span&gt; &lt;span class="n"&gt;log10&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Aij&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;   &lt;span class="n"&gt;EU_K&lt;/span&gt;
&lt;span class="o"&gt;-------&lt;/span&gt; &lt;span class="o"&gt;---------------&lt;/span&gt; &lt;span class="o"&gt;-----&lt;/span&gt; &lt;span class="o"&gt;---------&lt;/span&gt; &lt;span class="o"&gt;-------------&lt;/span&gt; &lt;span class="o"&gt;----------&lt;/span&gt; &lt;span class="o"&gt;--------&lt;/span&gt;
   &lt;span class="n"&gt;C18O&lt;/span&gt; &lt;span class="n"&gt;Carbon&lt;/span&gt; &lt;span class="n"&gt;Monoxide&lt;/span&gt;   &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="mf"&gt;109.78218&lt;/span&gt;     &lt;span class="mf"&gt;109.78218&lt;/span&gt;   &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;7.20058&lt;/span&gt;  &lt;span class="mf"&gt;5.26868&lt;/span&gt;
&lt;span class="mi"&gt;13&lt;/span&gt;&lt;span class="n"&gt;COv&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="n"&gt;Carbon&lt;/span&gt; &lt;span class="n"&gt;Monoxide&lt;/span&gt;   &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="mf"&gt;110.20135&lt;/span&gt;            &lt;span class="o"&gt;--&lt;/span&gt;   &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;7.49946&lt;/span&gt;   &lt;span class="mf"&gt;5.2888&lt;/span&gt;
   &lt;span class="n"&gt;C17O&lt;/span&gt; &lt;span class="n"&gt;Carbon&lt;/span&gt; &lt;span class="n"&gt;Monoxide&lt;/span&gt; &lt;span class="n"&gt;J&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="mf"&gt;112.35928&lt;/span&gt;     &lt;span class="mf"&gt;112.35928&lt;/span&gt;   &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;7.17404&lt;/span&gt;  &lt;span class="mf"&gt;5.39236&lt;/span&gt;
  &lt;span class="n"&gt;COv&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="n"&gt;Carbon&lt;/span&gt; &lt;span class="n"&gt;Monoxide&lt;/span&gt;   &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;  &lt;span class="mf"&gt;115.2712&lt;/span&gt;      &lt;span class="mf"&gt;115.2712&lt;/span&gt;   &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;7.14236&lt;/span&gt;  &lt;span class="mf"&gt;5.53211&lt;/span&gt;
   &lt;span class="n"&gt;C18O&lt;/span&gt; &lt;span class="n"&gt;Carbon&lt;/span&gt; &lt;span class="n"&gt;Monoxide&lt;/span&gt;   &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;219.56036&lt;/span&gt;     &lt;span class="mf"&gt;219.56036&lt;/span&gt;   &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;6.21833&lt;/span&gt; &lt;span class="mf"&gt;15.80595&lt;/span&gt;
&lt;span class="mi"&gt;13&lt;/span&gt;&lt;span class="n"&gt;COv&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="n"&gt;Carbon&lt;/span&gt; &lt;span class="n"&gt;Monoxide&lt;/span&gt;   &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;220.39868&lt;/span&gt;            &lt;span class="o"&gt;--&lt;/span&gt;   &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;6.51752&lt;/span&gt; &lt;span class="mf"&gt;15.86618&lt;/span&gt;
   &lt;span class="n"&gt;C17O&lt;/span&gt; &lt;span class="n"&gt;Carbon&lt;/span&gt; &lt;span class="n"&gt;Monoxide&lt;/span&gt; &lt;span class="n"&gt;J&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;224.71437&lt;/span&gt;     &lt;span class="mf"&gt;224.71439&lt;/span&gt;   &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;6.19179&lt;/span&gt; &lt;span class="mf"&gt;16.17703&lt;/span&gt;
  &lt;span class="n"&gt;COv&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="n"&gt;Carbon&lt;/span&gt; &lt;span class="n"&gt;Monoxide&lt;/span&gt;   &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;   &lt;span class="mf"&gt;230.538&lt;/span&gt;       &lt;span class="mf"&gt;230.538&lt;/span&gt;   &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;6.16011&lt;/span&gt; &lt;span class="mf"&gt;16.59608&lt;/span&gt;
   &lt;span class="n"&gt;C18O&lt;/span&gt; &lt;span class="n"&gt;Carbon&lt;/span&gt; &lt;span class="n"&gt;Monoxide&lt;/span&gt;   &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="mf"&gt;329.33055&lt;/span&gt;     &lt;span class="mf"&gt;329.33055&lt;/span&gt;   &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;5.66014&lt;/span&gt;  &lt;span class="mf"&gt;31.6116&lt;/span&gt;
&lt;span class="mi"&gt;13&lt;/span&gt;&lt;span class="n"&gt;COv&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="n"&gt;Carbon&lt;/span&gt; &lt;span class="n"&gt;Monoxide&lt;/span&gt;   &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="mf"&gt;330.58797&lt;/span&gt;            &lt;span class="o"&gt;--&lt;/span&gt;   &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;5.95976&lt;/span&gt; &lt;span class="mf"&gt;31.73179&lt;/span&gt;
   &lt;span class="n"&gt;C17O&lt;/span&gt; &lt;span class="n"&gt;Carbon&lt;/span&gt; &lt;span class="n"&gt;Monoxide&lt;/span&gt; &lt;span class="n"&gt;J&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;  &lt;span class="mf"&gt;337.0611&lt;/span&gt;     &lt;span class="mf"&gt;337.06113&lt;/span&gt;    &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;5.6336&lt;/span&gt;  &lt;span class="mf"&gt;32.3538&lt;/span&gt;
  &lt;span class="n"&gt;COv&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="n"&gt;Carbon&lt;/span&gt; &lt;span class="n"&gt;Monoxide&lt;/span&gt;   &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="mf"&gt;345.79599&lt;/span&gt;     &lt;span class="mf"&gt;345.79599&lt;/span&gt;   &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;5.60192&lt;/span&gt; &lt;span class="mf"&gt;33.19169&lt;/span&gt;

&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;trimmed_query&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;MHz&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;GHz&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="o"&gt;...&lt;/span&gt;     &lt;span class="n"&gt;chemical_name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39; H2CO .*Formaldehyde&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;energy_max&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;75&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="o"&gt;...&lt;/span&gt;     &lt;span class="n"&gt;energy_type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;eu_k&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pprint&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;Species&lt;/span&gt; &lt;span class="n"&gt;Chemical&lt;/span&gt; &lt;span class="n"&gt;Name&lt;/span&gt;      &lt;span class="n"&gt;QNs&lt;/span&gt;      &lt;span class="n"&gt;Freq&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;GHz&lt;/span&gt; &lt;span class="n"&gt;Meas&lt;/span&gt; &lt;span class="n"&gt;Freq&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;GHz&lt;/span&gt; &lt;span class="n"&gt;log10&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Aij&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;   &lt;span class="n"&gt;EU_K&lt;/span&gt;
&lt;span class="o"&gt;-------&lt;/span&gt; &lt;span class="o"&gt;-------------&lt;/span&gt; &lt;span class="o"&gt;-------------&lt;/span&gt; &lt;span class="o"&gt;--------&lt;/span&gt; &lt;span class="o"&gt;-------------&lt;/span&gt; &lt;span class="o"&gt;----------&lt;/span&gt; &lt;span class="o"&gt;--------&lt;/span&gt;
   &lt;span class="n"&gt;H2CO&lt;/span&gt;  &lt;span class="n"&gt;Formaldehyde&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;       &lt;span class="o"&gt;--&lt;/span&gt;       &lt;span class="mf"&gt;0.07114&lt;/span&gt;  &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;13.81846&lt;/span&gt;   &lt;span class="mf"&gt;57.612&lt;/span&gt;
   &lt;span class="n"&gt;H2CO&lt;/span&gt;  &lt;span class="n"&gt;Formaldehyde&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;       &lt;span class="o"&gt;--&lt;/span&gt;       &lt;span class="mf"&gt;0.35557&lt;/span&gt;  &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;12.02319&lt;/span&gt; &lt;span class="mf"&gt;68.11082&lt;/span&gt;


&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;trimmed_query&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;MHz&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;GHz&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;chemical_name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39; NH3 &amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pprint&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;Species&lt;/span&gt; &lt;span class="n"&gt;Chemical&lt;/span&gt; &lt;span class="n"&gt;Name&lt;/span&gt;      &lt;span class="n"&gt;QNs&lt;/span&gt;       &lt;span class="n"&gt;Freq&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;GHz&lt;/span&gt; &lt;span class="n"&gt;Meas&lt;/span&gt; &lt;span class="n"&gt;Freq&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;GHz&lt;/span&gt; &lt;span class="n"&gt;log10&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Aij&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;    &lt;span class="n"&gt;EU_K&lt;/span&gt;
&lt;span class="o"&gt;-------&lt;/span&gt; &lt;span class="o"&gt;-------------&lt;/span&gt; &lt;span class="o"&gt;--------------&lt;/span&gt; &lt;span class="o"&gt;--------&lt;/span&gt; &lt;span class="o"&gt;-------------&lt;/span&gt; &lt;span class="o"&gt;----------&lt;/span&gt; &lt;span class="o"&gt;---------&lt;/span&gt;
 &lt;span class="n"&gt;NH3v&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;       &lt;span class="n"&gt;Ammonia&lt;/span&gt;  &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="mf"&gt;23.69447&lt;/span&gt;       &lt;span class="mf"&gt;23.6945&lt;/span&gt;   &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;6.43769&lt;/span&gt;  &lt;span class="mf"&gt;24.40492&lt;/span&gt;
 &lt;span class="n"&gt;NH3v&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;       &lt;span class="n"&gt;Ammonia&lt;/span&gt;  &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;  &lt;span class="mf"&gt;23.7226&lt;/span&gt;      &lt;span class="mf"&gt;23.72263&lt;/span&gt;   &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;6.31125&lt;/span&gt;   &lt;span class="mf"&gt;65.5867&lt;/span&gt;
 &lt;span class="n"&gt;NH3v&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;       &lt;span class="n"&gt;Ammonia&lt;/span&gt;  &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="mf"&gt;23.09885&lt;/span&gt;      &lt;span class="mf"&gt;23.09881&lt;/span&gt;   &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;6.94808&lt;/span&gt;   &lt;span class="mf"&gt;81.5904&lt;/span&gt;
 &lt;span class="n"&gt;NH3v&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;       &lt;span class="n"&gt;Ammonia&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="mf"&gt;23.87008&lt;/span&gt;      &lt;span class="mf"&gt;23.87013&lt;/span&gt;   &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;6.25203&lt;/span&gt; &lt;span class="mf"&gt;124.68113&lt;/span&gt;
 &lt;span class="n"&gt;NH3v&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;       &lt;span class="n"&gt;Ammonia&lt;/span&gt;  &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="mf"&gt;22.83422&lt;/span&gt;      &lt;span class="mf"&gt;22.83418&lt;/span&gt;     &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;6.662&lt;/span&gt; &lt;span class="mf"&gt;151.33353&lt;/span&gt;
 &lt;span class="n"&gt;NH3v&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;       &lt;span class="n"&gt;Ammonia&lt;/span&gt;  &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="mf"&gt;22.23456&lt;/span&gt;       &lt;span class="mf"&gt;22.2345&lt;/span&gt;   &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;7.29889&lt;/span&gt; &lt;span class="mf"&gt;167.29666&lt;/span&gt;
 &lt;span class="n"&gt;NH3v&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;       &lt;span class="n"&gt;Ammonia&lt;/span&gt;  &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="mf"&gt;24.13935&lt;/span&gt;      &lt;span class="mf"&gt;24.13942&lt;/span&gt;   &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;6.20938&lt;/span&gt; &lt;span class="mf"&gt;201.67106&lt;/span&gt;
 &lt;span class="n"&gt;NH3v&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;       &lt;span class="n"&gt;Ammonia&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="mf"&gt;22.68835&lt;/span&gt;      &lt;span class="mf"&gt;22.68831&lt;/span&gt;   &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;6.54002&lt;/span&gt; &lt;span class="mf"&gt;238.96192&lt;/span&gt;
 &lt;span class="n"&gt;NH3v&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;       &lt;span class="n"&gt;Ammonia&lt;/span&gt;  &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="mf"&gt;21.70341&lt;/span&gt;      &lt;span class="mf"&gt;21.70336&lt;/span&gt;   &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;6.95001&lt;/span&gt; &lt;span class="mf"&gt;265.52612&lt;/span&gt;
 &lt;span class="n"&gt;NH3v&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;       &lt;span class="n"&gt;Ammonia&lt;/span&gt;  &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="mf"&gt;21.13434&lt;/span&gt;      &lt;span class="mf"&gt;21.13431&lt;/span&gt;   &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;7.58659&lt;/span&gt; &lt;span class="mf"&gt;281.43749&lt;/span&gt;
 &lt;span class="n"&gt;NH3v&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;       &lt;span class="n"&gt;Ammonia&lt;/span&gt;  &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="mf"&gt;24.53292&lt;/span&gt;      &lt;span class="mf"&gt;24.53299&lt;/span&gt;    &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;6.1706&lt;/span&gt; &lt;span class="mf"&gt;296.53357&lt;/span&gt;
 &lt;span class="n"&gt;NH3v&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;       &lt;span class="n"&gt;Ammonia&lt;/span&gt;  &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="mf"&gt;22.65307&lt;/span&gt;      &lt;span class="mf"&gt;22.65302&lt;/span&gt;   &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;6.46829&lt;/span&gt; &lt;span class="mf"&gt;344.46226&lt;/span&gt;
 &lt;span class="n"&gt;NH3v&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;       &lt;span class="n"&gt;Ammonia&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="mf"&gt;21.28532&lt;/span&gt;      &lt;span class="mf"&gt;21.28528&lt;/span&gt;   &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;6.79928&lt;/span&gt;  &lt;span class="mf"&gt;381.6003&lt;/span&gt;
 &lt;span class="n"&gt;NH3v&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;       &lt;span class="n"&gt;Ammonia&lt;/span&gt;  &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="mf"&gt;20.37145&lt;/span&gt;      &lt;span class="mf"&gt;20.37145&lt;/span&gt;   &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;7.20859&lt;/span&gt; &lt;span class="mf"&gt;408.05568&lt;/span&gt;
 &lt;span class="n"&gt;NH3v&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;       &lt;span class="n"&gt;Ammonia&lt;/span&gt;  &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="mf"&gt;19.83833&lt;/span&gt;      &lt;span class="mf"&gt;19.83835&lt;/span&gt;   &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;7.84539&lt;/span&gt; &lt;span class="mf"&gt;423.90259&lt;/span&gt;
 &lt;span class="n"&gt;NH3v&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;       &lt;span class="n"&gt;Ammonia&lt;/span&gt;  &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="mf"&gt;22.73249&lt;/span&gt;      &lt;span class="mf"&gt;22.73243&lt;/span&gt;   &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;6.41603&lt;/span&gt; &lt;span class="mf"&gt;467.80451&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
</content><category term="misc"></category></entry><entry><title>GPS Data Analysis</title><link href="https://keflavich.github.io/blog/gps-data-analysis.html" rel="alternate"></link><published>2013-06-09T20:30:00-06:00</published><updated>2013-06-09T20:30:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2013-06-09:/blog/gps-data-analysis.html</id><content type="html">&lt;p&gt;I've been running up the same mountain about a dozen times with a GPS on.  With
a little hacking, I was able to take the GPS data and normalize it to the same
start &amp;amp; end points to see how well I did on different runs.&lt;/p&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/sanitas_timevsdist.png" style="width: 800px;" /&gt;
</content><category term="misc"></category><category term="personal"></category></entry><entry><title>Hopkins PDF Generalization</title><link href="https://keflavich.github.io/blog/hopkins-pdf-generalization.html" rel="alternate"></link><published>2013-06-04T15:00:00-06:00</published><updated>2013-06-04T15:00:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2013-06-04:/blog/hopkins-pdf-generalization.html</id><summary type="html">&lt;p&gt;&lt;a class="reference external" href="http://adsabs.harvard.edu/abs/2013MNRAS.430.1880H"&gt;Hopkins 2013&lt;/a&gt; presents a non-lognormal form of the probability distribution
function of density in turbulence, depending primarily on a parameter
&lt;span class="math"&gt;\(T\)&lt;/span&gt;.  I examine some of its properties here.  All of the equations shown
on this page are implemented in &lt;a class="reference external" href="https://github.com/keflavich/turbulence_pdfs"&gt;https://github.com/keflavich/turbulence_pdfs&lt;/a&gt;,
in particular the functions &lt;tt class="docutils literal"&gt;moments …&lt;/tt&gt;&lt;/p&gt;&lt;script type='text/javascript'&gt;if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width &lt; 768) ? "left" : align;
        indent = (screen.width &lt; 768) ? "0em" : indent;
        linebreak = (screen.width &lt; 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/latest.js?config=TeX-AMS-MML_HTMLorMML';

    var configscript = document.createElement('script');
    configscript.type = 'text/x-mathjax-config';
    configscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'none' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        availableFonts: ['STIX', 'TeX']," +
        "        preferredFont: 'STIX'," +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";

    (document.body || document.getElementsByTagName('head')[0]).appendChild(configscript);
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
&lt;/script&gt;</summary><content type="html">&lt;p&gt;&lt;a class="reference external" href="http://adsabs.harvard.edu/abs/2013MNRAS.430.1880H"&gt;Hopkins 2013&lt;/a&gt; presents a non-lognormal form of the probability distribution
function of density in turbulence, depending primarily on a parameter
&lt;span class="math"&gt;\(T\)&lt;/span&gt;.  I examine some of its properties here.  All of the equations shown
on this page are implemented in &lt;a class="reference external" href="https://github.com/keflavich/turbulence_pdfs"&gt;https://github.com/keflavich/turbulence_pdfs&lt;/a&gt;,
in particular the functions &lt;tt class="docutils literal"&gt;moments_theoretical_hopkins&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;moments&lt;/tt&gt; in
&lt;a class="reference external" href="https://github.com/keflavich/turbulence_pdfs/blob/master/hopkins_pdf.py"&gt;hopkins_pdf.py&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;The conservation equations, conservation of probability and mass&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\int_{-\infty}^\infty P_V(\ln \rho) d \ln \rho \equiv 1
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
\int_{-\infty}^\infty\rho P_V(\ln \rho) d \ln \rho \equiv \rho_0 = 1
\end{equation*}
&lt;/div&gt;
&lt;p&gt;&lt;span class="math"&gt;\(\rho_0=1\)&lt;/span&gt; is the definition used by &lt;a class="reference external" href="http://adsabs.harvard.edu/abs/2013MNRAS.430.1880H"&gt;Hopkins 2013&lt;/a&gt;.  Part of the goal
of this document is to generalize to &lt;span class="math"&gt;\(\rho_0 &amp;lt;&amp;gt; 1\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;The most important thing to do is determine the values of the moments of the
distribution, including the integral corrections for the Dirac Delta function
component of the PDF.&lt;/p&gt;
&lt;div class="section" id="the-pdf"&gt;
&lt;h2&gt;The PDF&lt;/h2&gt;
&lt;p&gt;The full form of the Hopkins PDF is&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
P_V(\ln \rho/\rho_0) d \ln \rho =  \left[I_1(2\sqrt{\lambda u}) e^{-\lambda-u} \sqrt{\frac{\lambda}{u}} + e^{-\lambda} \delta(u)\right]du
\end{equation*}
&lt;/div&gt;
&lt;p&gt;The mass-weighted PDF is&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
P_M(\ln \rho/\rho_0) d \ln \rho =  \frac{\rho}{\rho_0} \left[I_1(2\sqrt{\lambda u}) e^{-\lambda-u} \sqrt{\frac{\lambda}{u}} + e^{-\lambda} \delta(u)\right]du
\end{equation*}
&lt;/div&gt;
&lt;p&gt;With definitions:&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
u\equiv \frac{\lambda}{1+T} - \frac{\ln \rho/\rho_0}{T}  ;  (u \geq 0)
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
\lambda \equiv \frac{S_{\ln \rho,V}}{2 T^2}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;The ratio &lt;span class="math"&gt;\(\rho/\rho_0\)&lt;/span&gt; is needed to ensure self-consistency: the mass
PDF must also conserve probability, which means it must be scaled by
&lt;span class="math"&gt;\(1/\rho_0\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;These distributions are slightly different than those shown in &lt;a class="reference external" href="http://adsabs.harvard.edu/abs/2013MNRAS.430.1880H"&gt;Hopkins 2013&lt;/a&gt;.
The &lt;span class="math"&gt;\(m=0\)&lt;/span&gt; term in the summation version of the PDF yields a Dirac
&lt;span class="math"&gt;\(\delta\)&lt;/span&gt; function in the integral form of the PDF.  To quote Phil:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
If you check, the summation expression is exact, and does exactly integrate
to unity (and properly conserve mass) for any value of T or lambda (with
u&amp;gt;0). But this is with the implicit understanding that the gamma-function
distribution with exponent &amp;quot;m&amp;quot; should be taken to go to a delta-function
about u=0 when m=0 (since otherwise it is ill defined; and physically this
is the &amp;quot;no event/multiplication&amp;quot; case, so that's the only allowed case for
the term in u).
&lt;/pre&gt;
&lt;!-- But note that both of these distributions can depend on :math:`\rho_0`, changing :math:`u` to be --&gt;
&lt;!--  --&gt;
&lt;!-- .. math:: u\equiv \frac{\lambda}{1+T} - \frac{\ln (\rho/\rho_0)}{T}  ;  (u \geq 0) --&gt;
&lt;div class="section" id="moment-equations"&gt;
&lt;h3&gt;Moment equations&lt;/h3&gt;
&lt;p&gt;The important moments are the mean and variance of the volume and mass density
probability distribution and the volume and mass &lt;em&gt;log&lt;/em&gt;-density probability
distribution.&lt;/p&gt;
&lt;p&gt;The definitions used here are &lt;span class="math"&gt;\(E[\rho] \equiv &amp;lt;\rho&amp;gt;_V\)&lt;/span&gt;, etc.  The
variance is computed as &lt;span class="math"&gt;\(V[x]=E[x^2]-E[x]^2\)&lt;/span&gt;, which means we'll need to
compute the moments of various combinations of variables.&lt;/p&gt;
&lt;p&gt;Also, &lt;span class="math"&gt;\(S_{\ln \rho,V} \equiv V[\ln \rho_V]\)&lt;/span&gt;&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
&amp;lt;\rho&amp;gt;_V \equiv \rho_0 \equiv \int_{-\infty}^{\infty} \rho P_V(\ln \rho/\rho_0) d \ln \rho
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
&amp;lt;\ln \rho&amp;gt;_V \equiv \int_{-\infty}^{\infty} \ln \rho P_V(\ln \rho/\rho_0) d \ln \rho
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
&amp;lt;\rho&amp;gt;_M \equiv \int_{-\infty}^{\infty} \rho (\rho P_V(\ln \rho/\rho_0)) d \ln \rho
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
&amp;lt;\ln \rho&amp;gt;_M \equiv \int_{-\infty}^{\infty} \ln \rho (\rho P_V(\ln \rho/\rho_0)) d \ln \rho
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
&amp;lt;\rho^3&amp;gt;_V \equiv \int_{-\infty}^{\infty} \rho^3 P_V(\ln \rho/\rho_0) d \ln \rho
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
&amp;lt;\ln^2 \rho&amp;gt;_V \equiv \int_{-\infty}^{\infty} (\ln \rho)^2 P_V(\ln \rho/\rho_0)d \ln \rho
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
&amp;lt;\ln^2 \rho&amp;gt;_M \equiv \int_{-\infty}^{\infty} (\ln \rho)^2 \rho P_V(\ln \rho/\rho_0)d \ln \rho
\end{equation*}
&lt;/div&gt;
&lt;p&gt;In the moment equations, only the input to the PDF is scaled by a mean density
&lt;span class="math"&gt;\(\rho_0\)&lt;/span&gt;; the &amp;quot;weighting factors&amp;quot; for the expectation value are not
(i.e., we are measuring &lt;span class="math"&gt;\(E[\rho]\)&lt;/span&gt;, not &lt;span class="math"&gt;\(E[\rho/rho_0]\)&lt;/span&gt;).&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="delta-terms"&gt;
&lt;h3&gt;Delta terms&lt;/h3&gt;
&lt;p&gt;These can be integrated analytically.  In this section, I am just computing the
means; the variances are more complicated.&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
&amp;lt;\rho&amp;gt;_V \equiv \rho_0 \equiv \int_{-\infty}^{\infty} \rho e^{-\lambda} \delta(\frac{\lambda}{1+T} - \frac{\ln\rho/\rho_0}{T}) \frac{d \ln \rho}{T}
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
&amp;lt;\ln \rho&amp;gt;_V \equiv \int_{-\infty}^{\infty} \ln \rho e^{-\lambda} \delta(\frac{\lambda}{1+T} - \frac{\ln\rho/\rho_0}{T}) \frac{d \ln \rho}{T}
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
&amp;lt;\rho&amp;gt;_M \equiv \int_{-\infty}^{\infty} \rho (\frac{\rho}{\rho_0} e^{-\lambda} \delta(\frac{\lambda}{1+T} - \frac{\ln\rho/\rho_0}{T})) \frac{d \ln \rho}{T}
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
&amp;lt;\ln \rho&amp;gt;_M \equiv \int_{-\infty}^{\infty} \ln \rho (\frac{\rho}{\rho_0} e^{-\lambda} \delta(\frac{\lambda}{1+T} - \frac{\ln\rho/\rho_0}{T})) \frac{d \ln \rho}{T}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;Substitution: &lt;span class="math"&gt;\(v=\frac{\ln \rho/\rho_0}{T}\)&lt;/span&gt;,
&lt;span class="math"&gt;\(dv = \frac{1}{T} d \ln \rho\)&lt;/span&gt;, &lt;span class="math"&gt;\(\rho=\rho_0 e^{v*T}\)&lt;/span&gt;, &lt;span class="math"&gt;\(\ln \rho = v T + \ln \rho_0\)&lt;/span&gt;&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
&amp;lt;\rho&amp;gt;_{V\delta} \equiv \rho_0 \equiv \int_{-\infty}^{\infty} \rho_0 e^{vT} e^{-\lambda} \delta(\frac{\lambda}{1+T} - v) d v
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
&amp;lt;\ln \rho&amp;gt;_{V\delta} \equiv \int_{-\infty}^{\infty} (vT + \ln \rho_0) e^{-\lambda} \delta(\frac{\lambda}{1+T} - v) d v
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
&amp;lt;\rho&amp;gt;_{M\delta} \equiv \int_{-\infty}^{\infty} \rho_0 e^{2vT} ( e^{-\lambda} \delta(\frac{\lambda}{1+T} - v)) d v
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
&amp;lt;\ln \rho&amp;gt;_{M\delta} \equiv \int_{-\infty}^{\infty} (vT + \ln \rho_0) e^{vT} ( e^{-\lambda} \delta(\frac{\lambda}{1+T} - v)) d v
\end{equation*}
&lt;/div&gt;
&lt;p&gt;Solutions:&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
&amp;lt;\rho&amp;gt;_{V\delta} =  \rho_0 \exp\left[\frac{T \lambda }{1+T} - \lambda\right] =  \rho_0 \exp\left[-\lambda \frac{1}{1+T}\right]
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
&amp;lt;\ln \rho&amp;gt;_{V\delta} =  e^{-\lambda} \frac{\lambda T}{1+T} + e^{-\lambda} \ln \rho_0
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
&amp;lt;\rho&amp;gt;_{M\delta} =  \rho_0 \exp\left[\frac{2 T \lambda }{1+T} - \lambda\right] = \rho_0 \exp\left[\lambda\frac{T-1}{T+1}\right]
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
&amp;lt;\ln \rho&amp;gt;_{M\delta} = \left( \frac{\lambda T}{1+T} + \ln \rho_0 \right) \exp\left[\frac{T \lambda }{1+T} - \lambda\right]
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
= \left( \frac{\lambda T}{1+T} + \ln \rho_0 \right) \exp\left[\frac{ -\lambda }{T+1}\right]
\end{equation*}
&lt;/div&gt;
&lt;p&gt;(for these next 3, I skipped intermediate steps)&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
&amp;lt;\rho^3&amp;gt;_{V\delta} =  \rho_0^2 \exp\left[\frac{3 T \lambda }{1+T} - \lambda\right] = \rho_0^2 \exp\left[\lambda\frac{2T-1}{T+1}\right]
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
&amp;lt;\ln^2 \rho&amp;gt;_{M\delta} = \left( \frac{\lambda T}{1+T} + \ln \rho_0 \right)^2 \exp\left[\frac{ -\lambda }{T+1}\right]
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
&amp;lt;\ln^2 \rho&amp;gt;_{V\delta} = \left( \frac{\lambda T}{1+T} + \ln \rho_0 \right)^2 e^{-\lambda}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;Using &lt;span class="math"&gt;\(\rho_0=1\)&lt;/span&gt; as defined in &lt;a class="reference external" href="http://adsabs.harvard.edu/abs/2013MNRAS.430.1880H"&gt;Hopkins 2013&lt;/a&gt; simplifies all of these a great deal.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="pdf-integrals"&gt;
&lt;h3&gt;PDF Integrals&lt;/h3&gt;
&lt;p&gt;These cannot be integrated analytically.&lt;/p&gt;
&lt;p&gt;However, we can work from a few simple mathematica/sympy results:&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\int_0^\infty I_1(x) e^{-x^2/(4L)} dx = e^L - 1
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
\int_0^\infty x^2 I_1(x) e^{-x^2/(4L)} dx = 4 L^2 * e^L
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
\int_0^\infty x^4 I_1(x) e^{-x^2/(4L)} dx = 16 L^3 (L+2) * e^L
\end{equation*}
&lt;/div&gt;
&lt;p&gt;We use &lt;span class="math"&gt;\(L\)&lt;/span&gt; instead of &lt;span class="math"&gt;\(\lambda\)&lt;/span&gt; in these equations because it is often substituted in later equations.&lt;/p&gt;
&lt;div class="section" id="expectation-value-of-the-volume-weighted-density-e-rho"&gt;
&lt;h4&gt;Expectation Value of the Volume-Weighted Density &lt;span class="math"&gt;\(E[\rho]\)&lt;/span&gt;&lt;/h4&gt;
&lt;div class="math"&gt;
\begin{equation*}
E[\rho] \equiv \int \rho P_v(\ln \rho/\rho_0) d \ln \rho = \int \rho \left[I_1(2\sqrt{\lambda u}) e^{-\lambda-u} \sqrt{\frac{\lambda}{u}} + e^{-\lambda} \delta(u)\right]du
\end{equation*}
&lt;/div&gt;
&lt;p&gt;To get to the form of the above equations, we use the substitution&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
x = 2\sqrt{\lambda u}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;which gives us &lt;span class="math"&gt;\(\rho\)&lt;/span&gt; in terms of &lt;span class="math"&gt;\(x\)&lt;/span&gt;:&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\rho = \rho_0 \exp\left[T\left(-\frac{x^2}{4\lambda} + \frac{\lambda}{1+T}\right)\right]
\end{equation*}
&lt;/div&gt;
&lt;p&gt;and leads to the rearrangement:&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
E[\rho] = \int \rho_0 \exp\left[T\left(-\frac{x^2}{4\lambda} + \frac{\lambda}{1+T}\right)\right] \left[I_1(x) e^{-x^2/(4\lambda)-\lambda} \right]dx + \rho_0 \exp\left(- \frac{\lambda}{1+T}\right)
\end{equation*}
&lt;/div&gt;
&lt;p&gt;where the rightmost term is kept from the first moment above.  The integral
term can straightforwardly be broken apart into equations of the form shown
above.&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
L \rightarrow \frac{\lambda}{1+T}
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
E[\rho] = \rho_0 \left[ \exp \left(-\lambda+\frac{T\lambda}{1+T}\right) \int  \left[I_1(x) e^{-x^2/(4L)} \right]dx +\exp\left(- \frac{\lambda}{1+T}\right) \right]
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
= \rho_0 \left[ \exp \left(-\lambda+\frac{T\lambda}{1+T}\right)(e^L-1)  +\exp\left(- \frac{\lambda}{1+T}\right) \right]
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
= \rho_0 \left[ \exp \left(-\lambda+\frac{T\lambda}{1+T}\right)(e^{\lambda/1+T}-1)  +\exp\left(- \frac{\lambda}{1+T}\right) \right]
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
= \rho_0 \left[ e^{-\lambda/(1+T)}(e^{\lambda/1+T}-1)  +\exp\left(- \frac{\lambda}{1+T}\right) \right]
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
= \rho_0
\end{equation*}
&lt;/div&gt;
&lt;p&gt;The same general approach can be followed for all expectation values, but we'll skip the detailed algebra.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="variance-of-the-volume-weighted-density-v-rho-s-ln-rho-v"&gt;
&lt;h4&gt;Variance of the Volume-Weighted Density &lt;span class="math"&gt;\(V[\rho]=S_{\ln \rho,V}\)&lt;/span&gt;&lt;/h4&gt;
&lt;div class="math"&gt;
\begin{equation*}
V[\rho] = E[\rho^2] - E[\rho]^2 = \rho_0^2 \left[  \exp\left(\lambda\frac{2 T^2}{1+3T+2T^2}\right) - 1 \right]
\end{equation*}
&lt;/div&gt;
&lt;p&gt;However, the &amp;quot;correction factor&amp;quot; is still important:&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
V_\delta[\rho] = \rho_0^2 \left[ \exp\left(\lambda\frac{T-1}{T+1}\right) - \exp\left(-2\frac{\lambda}{1+T}\right) \right]
\end{equation*}
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="expectation-value-of-the-mass-weighted-density-e-m-rho"&gt;
&lt;h4&gt;Expectation Value of the Mass-Weighted Density &lt;span class="math"&gt;\(E_M[\rho]\)&lt;/span&gt;&lt;/h4&gt;
&lt;p&gt;Start from halfway through &lt;span class="math"&gt;\(E[\rho]\)&lt;/span&gt;, simply adding a factor of 2 in the exponent:&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
E_M[\rho] = \int \rho_0 \exp\left[2T\left(-\frac{x^2}{4\lambda} + \frac{\lambda}{1+T}\right)\right] \left[I_1(x) e^{-x^2/(4\lambda)-\lambda} \right]dx + \rho_0 \exp\left(- \frac{\lambda(T-1)}{1+T}\right)
\end{equation*}
&lt;/div&gt;
&lt;p&gt;Follow the same math, with &lt;span class="math"&gt;\(L=\frac{\lambda}{1+2T}\)&lt;/span&gt;&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
= \rho_0 \left[ \exp \left(-\lambda+\frac{2T\lambda}{1+T}\right)(e^L-1)  +\exp\left(- \frac{\lambda(T-1)}{1+T}\right) \right]
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
= \rho_0 \left[ \exp \left(\frac{(T-1)\lambda}{1+T}\right)(e^{\lambda/(1+2T)}-1)  +\exp\left(- \frac{\lambda}{1+T}\right) \right]
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
E_M[\rho] = \rho_0 \left[ \exp\left(\lambda\frac{2 T^2}{1+3T+2T^2}\right) - \exp\left(\lambda\frac{T-1}{T+1}\right) + \exp\left(\lambda\frac{T-1}{T+1}\right) \right]
\end{equation*}
&lt;/div&gt;
&lt;p&gt;The right 2 terms cancel, yielding the value shown in Equation 7 of &lt;a class="reference external" href="http://adsabs.harvard.edu/abs/2013MNRAS.430.1880H"&gt;Hopkins 2013&lt;/a&gt;
scaled by &lt;span class="math"&gt;\(\rho_0^2\)&lt;/span&gt;.  However, the right-most term is the
correction factor from the Dirac Delta term needed to correct any
numerical computation of the mass-weighted density.&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
E_{\delta,M}[\rho] = \exp\left(\lambda\frac{T-1}{T+1}\right)
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
E_M[\rho] = \rho_0  \exp\left(\lambda\frac{2 T^2}{1+3T+2T^2}\right)
\end{equation*}
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="expectation-value-of-the-mass-weighted-density-squared-e-m-rho-2"&gt;
&lt;h4&gt;Expectation Value of the Mass-Weighted Density Squared &lt;span class="math"&gt;\(E_M[\rho^2]\)&lt;/span&gt;&lt;/h4&gt;
&lt;div class="math"&gt;
\begin{equation*}
E_M[\rho^2] = \int \rho^2 \frac{\rho}{\rho_0} e^{-\lambda} \left[I_1(x) e^{-x^2/(4\lambda)} \right]dx + \int \rho^2 \frac{\rho}{\rho_0} e^{-\lambda} \delta(u) du
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
E_{\delta,M}[\rho^2] = \rho_0^2 \exp\left[\lambda\frac{2T-1}{T+1}\right]
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
E_{left}[\rho^2] = e^{-\lambda} \int
\rho_0^2 \exp\left[3T\left(-\frac{x^2}{4\lambda} + \frac{\lambda}{1+T}\right)\right]
\left[I_1(x) e^{-x^2/(4\lambda)} \right]
dx
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
 = \rho_0^2 \exp\left[\frac{(2T-1)\lambda}{1+T}\right]
\int I_1(x) e^{-(3T+1)x^2/(4\lambda)}  dx
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
 = \rho_0^2 \exp\left[\frac{(2T-1)\lambda}{1+T}\right]
\left( \exp\left[\frac{\lambda}{3T+1}\right] - 1\right)
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
= \rho_0^2 \left(\exp\left[\frac{6\lambda T^2}{3T^2+4T+1}\right] - \exp\left[\frac{(2T-1)\lambda}{1+T}\right] \right)
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
E_{M}[\rho^2] = \rho_0^2 \exp\left[\frac{6\lambda T^2}{3T^2+4T+1}\right]
\end{equation*}
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="variance-of-the-mass-weighted-density-v-m-rho-e-m-rho-2-e-m-rho-2"&gt;
&lt;h4&gt;Variance of the Mass-Weighted Density &lt;span class="math"&gt;\(V_M[\rho] = E_M[\rho^2] - E_M[\rho]^2\)&lt;/span&gt;&lt;/h4&gt;
&lt;p&gt;Since correction factors are given for &lt;span class="math"&gt;\(E_M[\rho^2]\)&lt;/span&gt; and
&lt;span class="math"&gt;\(E_M[\rho]\)&lt;/span&gt;, they are not included separately here:&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
V_M[\rho] = E_M[\rho^2] - E_M[\rho]^2
= \rho_0^2 \left( \exp\left[\frac{6\lambda T^2}{3T^2+4T+1}\right]
-\exp\left[\lambda\frac{4 T^2}{1+3T+2T^2}\right]
\right)
\end{equation*}
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="expectation-value-of-the-volume-weighted-log-density-e-ln-rho"&gt;
&lt;h4&gt;Expectation Value of the Volume-Weighted Log Density &lt;span class="math"&gt;\(E[\ln \rho]\)&lt;/span&gt;&lt;/h4&gt;
&lt;div class="math"&gt;
\begin{equation*}
E[\ln \rho] = \int \ln \rho e^{-\lambda} \left[I_1(x) e^{-x^2/(4\lambda)} \right]dx + \int \ln \rho e^{-\lambda} \delta(u) du
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
E_\delta[\ln \rho] = e^{-\lambda} \left[ \frac{\lambda T}{1+T} + \ln \rho_0 \right]
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
E_{left}[\ln \rho] = \int \left[\ln \rho_0 + T\left(-\frac{x^2}{4\lambda} + \frac{\lambda}{1+T}\right) \right] e^{-\lambda} \left[I_1(x) e^{-x^2/(4\lambda)} \right]dx
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
= e^{-\lambda} \left( \int \left[\ln \rho_0 + \frac{T\lambda}{1+T}\right] \left[I_1(x) e^{-x^2/(4\lambda)} \right]dx
- \int \frac{T x^2}{4\lambda} \left[I_1(x) e^{-x^2/(4\lambda)} \right]dx \right)
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
= e^{-\lambda} \left( \int \left[\ln \rho_0 + \frac{T\lambda}{1+T}\right](e^{\lambda}-1)
- \frac{4 T \lambda^2 e^{\lambda}}{4\lambda} \right)
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
= \left( \left[\ln \rho_0 + \frac{T\lambda}{1+T}\right](1-e^{-\lambda})
- T \lambda  \right)
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
E[\ln \rho] = \ln \rho_0 + \frac{T\lambda}{1+T} - T \lambda
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
= \ln \rho_0 - \frac{T^2\lambda}{1+T}
\end{equation*}
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="expectation-value-of-the-mass-weighted-log-density-e-m-ln-rho"&gt;
&lt;h4&gt;Expectation Value of the Mass-Weighted Log Density &lt;span class="math"&gt;\(E_M[\ln \rho]\)&lt;/span&gt;&lt;/h4&gt;
&lt;div class="math"&gt;
\begin{equation*}
E_M[\ln \rho] = \int \ln \rho \frac{\rho}{\rho_0} e^{-\lambda} \left[I_1(x) e^{-x^2/(4\lambda)} \right]dx + \int \ln \rho \frac{\rho}{\rho_0} e^{-\lambda} \delta(u) du
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
E_\delta[\ln \rho] = \left( \frac{\lambda T}{1+T} + \ln \rho_0 \right) \exp\left[\frac{ -\lambda }{T+1}\right]
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
E_{left}[\ln \rho] = e^{-\lambda} \int \left[
\left(\ln \rho_0 + T\left(-\frac{x^2}{4\lambda} + \frac{\lambda}{1+T}\right) \right)
\exp\left(T\left(-\frac{x^2}{4\lambda} + \frac{\lambda}{1+T}\right)\right) \right]
\left[I_1(x) e^{-x^2/(4\lambda)} \right]dx
\end{equation*}
&lt;/div&gt;
&lt;p&gt;Again, separate into integrable terms:&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
= \exp\left(\frac{T\lambda}{1+T} -\lambda\right) \left[
\left(\ln \rho_0 + \frac{T\lambda}{1+T} \right)  \left[I_1(x) e^{-(1+T)x^2/(4\lambda)} \right] +
\left(-\frac{Tx^2}{4\lambda} \right)  \left[I_1(x) e^{-(1+T)x^2/(4\lambda)} \right]
\right]
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
L = \frac{\lambda}{1+T}
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
E_{left}[\ln \rho] = \exp\left(\frac{T\lambda}{1+T} -\lambda\right) \left[
\left(\ln \rho_0 + \frac{T\lambda}{1+T} \right)  \left(\exp\left[\frac{\lambda}{1+T}\right]-1\right) +
\left(-\frac{T}{4\lambda} \right)  \left(\frac{4  \lambda^2}{(1+T)^2}  \exp\left[\frac{\lambda}{1+T}\right]\right)
\right]
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
E_{left}[\ln \rho] = \exp\left(\frac{-\lambda}{1+T}\right) \left[
\left(\ln \rho_0 + \frac{T\lambda}{1+T} \right)  \left(\exp\left[\frac{\lambda}{1+T}\right]-1\right) +
\left(-\frac{T}{4\lambda} \right)  \left(\frac{4  \lambda^2}{(1+T)^2}  \exp\left[\frac{\lambda}{1+T}\right]\right)
\right]
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
E_{left}[\ln \rho] =
\left(\ln \rho_0 + \frac{T\lambda}{1+T} \right)  \left(1-\exp\left[\frac{-\lambda}{1+T}\right]\right) -
\left(\frac{ T \lambda}{(1+T)^2}  \right)
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
E_M[\ln \rho] = \left(\ln \rho_0 + \frac{T\lambda}{1+T} \right) -
\left(\frac{ T \lambda}{(1+T)^2}  \right)
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
= \ln \rho_0 + \frac{T^2\lambda}{(1+T)^2}
\end{equation*}
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="expectation-value-of-the-mass-weighted-log-density-squared-e-m-ln-2-rho"&gt;
&lt;h4&gt;Expectation Value of the Mass-Weighted Log Density Squared &lt;span class="math"&gt;\(E_M[\ln^2 \rho]\)&lt;/span&gt;&lt;/h4&gt;
&lt;div class="math"&gt;
\begin{equation*}
E_M[\ln^2 \rho] = \int (\ln \rho)^2 \frac{\rho}{\rho_0} e^{-\lambda} \left[I_1(x) e^{-x^2/(4\lambda)} \right]dx + \int (\ln \rho)^2 \frac{\rho}{\rho_0} e^{-\lambda} \delta(u) du
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
E_\delta[\ln^2 \rho] = \left( \frac{\lambda T}{1+T} + \ln \rho_0 \right)^2 \exp\left[\frac{ -\lambda }{T+1}\right]
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
E_{left}[\ln^2 \rho] = e^{-\lambda} \int \left[
\left(\ln \rho_0 + T\left(-\frac{x^2}{4\lambda} + \frac{\lambda}{1+T}\right) \right)^2
\exp\left(T\left(-\frac{x^2}{4\lambda} + \frac{\lambda}{1+T}\right)\right) \right]
\left[I_1(x) e^{-x^2/(4\lambda)} \right]dx
\end{equation*}
&lt;/div&gt;
&lt;p&gt;This time it's just too ugly.  Define a new variable:&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
Q = \ln \rho_0 + \frac{T\lambda}{1+T}
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
E_{left}[\ln^2 \rho] = e^{-\lambda/(1+T)} \int \left[
\left(Q  -\frac{T x^2}{4\lambda} \right)^2
\exp\left(-\frac{Tx^2}{4\lambda} \right) \right]
\left[I_1(x) e^{-x^2/(4\lambda)} \right]dx
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
E_{left}[\ln^2 \rho] = e^{-\lambda/(1+T)} \int \left[
\left(Q^2  - 2 Q \frac{T x^2}{4\lambda} + \frac{T^2 x^4}{16\lambda^2} \right)
\left[I_1(x) e^{-(1+T)x^2/(4\lambda)} \right]
\right]dx
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
E_{left}[\ln^2 \rho] = e^{-\lambda/(1+T)}  \left[
Q^2 (e^{\lambda/(1+T)}-1)
- 2 Q \frac{T}{4\lambda} \left(\frac{4\lambda^2}{(1+T)^2} e^{\lambda/(1+T)}\right)
+ \frac{T^2}{16\lambda^2} \left(16 \frac{\lambda^3}{(1+T)^3} (\frac{\lambda}{1+T}+2) e^{\lambda/(1+T)} \right)
\right]
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
E_{left}[\ln^2 \rho] =
Q^2 (1-e^{-\lambda/(1+T)})
- 2 Q \frac{T\lambda}{(1+T)^2}
+ \frac{\lambda T^2}{(1+T)^3} \left(\frac{\lambda}{1+T}+2\right)
\end{equation*}
&lt;/div&gt;
&lt;p&gt;Add back the &lt;span class="math"&gt;\(\delta\)&lt;/span&gt; termG&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
E_M[\ln^2 \rho] =
Q^2
- 2 Q \frac{T\lambda}{(1+T)^2}
+ \frac{\lambda T^2}{(1+T)^3} \left(\frac{\lambda}{1+T}+2\right)
\end{equation*}
&lt;/div&gt;
&lt;p&gt;Re-expand to see if it's simplifiable....&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
E_M[\ln^2 \rho] =
\left(\ln \rho_0 + \frac{T\lambda}{1+T}\right)^2
- 2 \left(\ln \rho_0 + \frac{T\lambda}{1+T}\right) \frac{T\lambda}{(1+T)^2}
+ \frac{\lambda T^2}{(1+T)^3} \left(\frac{\lambda}{1+T}+2\right)
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
E_M[\ln^2 \rho] =
\ln^2 \rho_0 + 2 \ln \rho_0 \frac{T\lambda}{1+T} + \frac{T^2\lambda^2}{(1+T)^2}
- 2 \ln \rho_0 \frac{T\lambda}{(1+T)^2} - 2 \frac{T\lambda}{1+T} \frac{T\lambda}{(1+T)^2}
+ 2 \frac{\lambda T^2}{(1+T)^3}
+ \frac{\lambda T^2}{(1+T)^3} \frac{\lambda}{1+T}
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
E_M[\ln^2 \rho] =
\ln^2 \rho_0 + 2 \ln \rho_0 \left(\frac{T\lambda}{1+T} - \frac{T\lambda}{(1+T)^2}\right)
+ \frac{T^2\lambda^2(1+T)}{(1+T)^3}
- 2 \frac{T^2\lambda^2}{(1+T)^3}
+ 2 \frac{\lambda T^2}{(1+T)^3}
+ \frac{\lambda^2 T^2}{(1+T)^4}
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
E_M[\ln^2 \rho] =
\ln^2 \rho_0 + 2 \ln \rho_0 \left(\frac{T^2\lambda}{1+T}\right)
+ \frac{T^2\lambda^2(1+T)}{(1+T)^3}
- 2 \frac{T^2\lambda^2}{(1+T)^3}
+ 2 \frac{\lambda T^2}{(1+T)^3}
+ \frac{\lambda^2 T^2}{(1+T)^4}
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
= \ln^2 \rho_0 + 2 \ln \rho_0 \frac{T^2 \lambda}{(1+T)^2}
+ \left(\frac{\lambda T^2}{(1+T)^2}\right)^2
+ \frac{2\lambda T^2}{(1+T)^3}
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
= \left(\ln \rho_0 + \frac{T^2\lambda}{(1+T)^2}\right)^2 +
\frac{2\lambda T^2}{(1+T)^3}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;As expected, we recover the correct relation from &lt;a class="reference external" href="http://adsabs.harvard.edu/abs/2013MNRAS.430.1880H"&gt;Hopkins 2013&lt;/a&gt;:&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
S_{\ln \rho,M} = E_M[\ln \rho^2] - E_M[\ln \rho]^2 =
\ln^2 \rho_0 + 2 \ln \rho_0 \frac{T^2 \lambda}{(1+T)^2}
+ \left(\frac{\lambda T^2}{(1+T)^2}\right)^2 + \frac{2\lambda T^2}{(1+T)^3}
- \left(\ln \rho_0 + \frac{T^2\lambda}{(1+T)^2}\right)^2
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
= \frac{2\lambda T^2}{(1+T)^3}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;&lt;em&gt;independent&lt;/em&gt; of &lt;span class="math"&gt;\(\rho_0\)&lt;/span&gt;.&lt;/p&gt;
&lt;div class="section" id="properties-of-the-hopkins-pdf"&gt;
&lt;h5&gt;Properties of the Hopkins PDF&lt;/h5&gt;
&lt;p&gt;I began this investigation in order to find out whether a different parameter,
i.e. something related to the compressiveness of the turbulent driving, could
be responsible for the &amp;quot;discrepancy&amp;quot; between the Formaldehyde-derived density
and the volume-averaged density of some clouds.&lt;/p&gt;
&lt;p&gt;I naively expected that, in compressive turbulence, more of the mass will be
concentrated at higher density, which should drive up the mass-weighted mean
density.&lt;/p&gt;
&lt;p&gt;&lt;a class="reference external" href="http://adsabs.harvard.edu/abs/2013MNRAS.430.1880H"&gt;Hopkins 2013&lt;/a&gt; showed that &lt;span class="math"&gt;\(T\sim\mathcal{M}_C\)&lt;/span&gt;.  If this is taken on
face value, without recognizing the relation between &lt;span class="math"&gt;\(T\)&lt;/span&gt; and
&lt;span class="math"&gt;\(\sigma\)&lt;/span&gt;, it means that for &lt;em&gt;fixed&lt;/em&gt; &lt;span class="math"&gt;\(\sigma\)&lt;/span&gt;,
&lt;span class="math"&gt;\(&amp;lt;\rho&amp;gt;_M\propto e^{-T^2}\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;This figure shows the relation of the various moments and &lt;span class="math"&gt;\(T\)&lt;/span&gt;.  The plots
show both the &amp;quot;theoretical&amp;quot; result (i.e., doing the integral by hand) and the
numerical result with 50,000 data points plus a correction for the
&lt;span class="math"&gt;\(\delta\)&lt;/span&gt; terms; the agreement is essentially perfect excepting some
numerical noise (the only visible discrepancy is for a perfect lognormal at
high &lt;span class="math"&gt;\(\sigma_V\)&lt;/span&gt;):&lt;/p&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/rho1_varyT_colorSigma.png" style="width: 800px;" /&gt;
&lt;p&gt;However, &lt;a class="reference external" href="http://adsabs.harvard.edu/abs/2013MNRAS.430.1880H"&gt;Hopkins 2013&lt;/a&gt; also found that simulations generally produced
&lt;span class="math"&gt;\(T\sim0.1\sigma_{s,M}^2\)&lt;/span&gt; (though a relation of the form &lt;span class="math"&gt;\(T\sim 0.25
\ln(1+0.25\sigma_{s,M}^4)\)&lt;/span&gt; is also a good fit).&lt;/p&gt;
&lt;p&gt;If you use the simpler of these relations, the expected relationship (mean mass
increasing with increasing &amp;quot;compressiveness&amp;quot;) is recovered.  However, it comes
with an increasing &lt;span class="math"&gt;\(\sigma_s\)&lt;/span&gt;.  In these plots, half are labeled with
&lt;span class="math"&gt;\(\sigma\)&lt;/span&gt; and the others are labeled with &lt;span class="math"&gt;\(T\)&lt;/span&gt;, though the two are
equivalent.  The highest &lt;span class="math"&gt;\(\sigma_s\)&lt;/span&gt; observed in any of the simulations
shown in &lt;a class="reference external" href="http://adsabs.harvard.edu/abs/2013MNRAS.430.1880H"&gt;Hopkins 2013&lt;/a&gt; was about &lt;span class="math"&gt;\(\sigma_s=4\)&lt;/span&gt; (marked with a black
square below), so the maximum &lt;span class="math"&gt;\(\rho_M/\rho_V \sim 10^2\)&lt;/span&gt;.&lt;/p&gt;
&lt;img alt="" src="https://keflavich.github.io/blog/images/TSigma.png" style="width: 800px;" /&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;script type='text/javascript'&gt;if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width &lt; 768) ? "left" : align;
        indent = (screen.width &lt; 768) ? "0em" : indent;
        linebreak = (screen.width &lt; 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/latest.js?config=TeX-AMS-MML_HTMLorMML';

    var configscript = document.createElement('script');
    configscript.type = 'text/x-mathjax-config';
    configscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'none' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        availableFonts: ['STIX', 'TeX']," +
        "        preferredFont: 'STIX'," +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";

    (document.body || document.getElementsByTagName('head')[0]).appendChild(configscript);
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
&lt;/script&gt;</content><category term="misc"></category><category term="turbulence"></category></entry><entry><title>Recovering from "Startup drive out of memory"</title><link href="https://keflavich.github.io/blog/recovering-from-startup-drive-out-of-memory.html" rel="alternate"></link><published>2013-05-13T09:26:00-06:00</published><updated>2013-05-13T09:26:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2013-05-13:/blog/recovering-from-startup-drive-out-of-memory.html</id><summary type="html">&lt;p&gt;To continue frozen processes, you need to find all sleeping procs and restart them with &lt;tt class="docutils literal"&gt;kill &lt;span class="pre"&gt;-CONT&lt;/span&gt;&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;In principle, this command should do that:&lt;/p&gt;
&lt;p&gt;&lt;tt class="docutils literal"&gt;ps &lt;span class="pre"&gt;-A&lt;/span&gt; &lt;span class="pre"&gt;-o&lt;/span&gt; tpgid,uid,pid,state,flags | awk &lt;span class="pre"&gt;'$1!=&amp;quot;0&amp;quot;&lt;/span&gt; &amp;amp;&amp;amp; &lt;span class="pre"&gt;$2==501&lt;/span&gt; &amp;amp;&amp;amp; &lt;span class="pre"&gt;$4==&amp;quot;S&amp;quot;&lt;/span&gt; &amp;amp;&amp;amp; &lt;span class="pre"&gt;$5!=&amp;quot;4000410c&amp;quot;&lt;/span&gt; {print &amp;quot;kill &lt;span class="pre"&gt;-CONT&lt;/span&gt; &amp;quot; $3}' | bash&lt;/tt&gt;&lt;/p&gt;
&lt;p&gt;Without the flags exclusion …&lt;/p&gt;</summary><content type="html">&lt;p&gt;To continue frozen processes, you need to find all sleeping procs and restart them with &lt;tt class="docutils literal"&gt;kill &lt;span class="pre"&gt;-CONT&lt;/span&gt;&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;In principle, this command should do that:&lt;/p&gt;
&lt;p&gt;&lt;tt class="docutils literal"&gt;ps &lt;span class="pre"&gt;-A&lt;/span&gt; &lt;span class="pre"&gt;-o&lt;/span&gt; tpgid,uid,pid,state,flags | awk &lt;span class="pre"&gt;'$1!=&amp;quot;0&amp;quot;&lt;/span&gt; &amp;amp;&amp;amp; &lt;span class="pre"&gt;$2==501&lt;/span&gt; &amp;amp;&amp;amp; &lt;span class="pre"&gt;$4==&amp;quot;S&amp;quot;&lt;/span&gt; &amp;amp;&amp;amp; &lt;span class="pre"&gt;$5!=&amp;quot;4000410c&amp;quot;&lt;/span&gt; {print &amp;quot;kill &lt;span class="pre"&gt;-CONT&lt;/span&gt; &amp;quot; $3}' | bash&lt;/tt&gt;&lt;/p&gt;
&lt;p&gt;Without the flags exclusion, this failed for me on apple's VNC server:
&lt;tt class="docutils literal"&gt;ps &lt;span class="pre"&gt;-A&lt;/span&gt; &lt;span class="pre"&gt;-o&lt;/span&gt; tpgid,uid,pid,state,flags | awk &lt;span class="pre"&gt;'$2==501&lt;/span&gt; &amp;amp;&amp;amp; &lt;span class="pre"&gt;$4==&amp;quot;S&amp;quot;&lt;/span&gt; &amp;amp;&amp;amp; &lt;span class="pre"&gt;$5!=&amp;quot;4000410c&amp;quot;&lt;/span&gt; {print &amp;quot;kill &lt;span class="pre"&gt;-CONT&lt;/span&gt; &amp;quot; $3}' | bash&lt;/tt&gt;&lt;/p&gt;
&lt;p&gt;This is necessary for recovering mac processes:
&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-A&lt;/span&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Display information about other users' processes, including those without controlling terminals.&lt;/tt&gt;&lt;/p&gt;
&lt;p&gt;The outputs from the &lt;tt class="docutils literal"&gt;ps&lt;/tt&gt; process are:&lt;/p&gt;
&lt;blockquote&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;tpgid      control terminal process group ID&lt;/li&gt;
&lt;li&gt;pid        process ID&lt;/li&gt;
&lt;li&gt;uid        effective user ID&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
</content><category term="misc"></category><category term="mac"></category><category term="memory"></category><category term="crash"></category></entry><entry><title>Bolocam Mass Calculations</title><link href="https://keflavich.github.io/blog/bolocam-mass-calculations.html" rel="alternate"></link><published>2013-03-25T11:14:00-06:00</published><updated>2013-03-25T11:14:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2013-03-25:/blog/bolocam-mass-calculations.html</id><summary type="html">&lt;p&gt;Adopt an effective Bolocam center frequency,  f = 271.1 GHz&lt;/p&gt;
&lt;p&gt;Use Ossenkopf, V. &amp;amp; Henning, Th. 1994, A&amp;amp;A, 291, 943 Table 1. [&lt;a class="reference external" href="http://adsabs.harvard.edu/abs/1994A%26A...291..943O"&gt;http://adsabs.harvard.edu/abs/1994A%26A...291..943O&lt;/a&gt;]
Interpolate last two entries (lambda = 1.0 mm and 1.3 mm to f)&lt;/p&gt;
&lt;p&gt;This gives &lt;span class="math"&gt;\(\kappa = 0.01166 …&lt;/span&gt;&lt;/p&gt;&lt;script type='text/javascript'&gt;if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width &lt; 768) ? "left" : align;
        indent = (screen.width &lt; 768) ? "0em" : indent;
        linebreak = (screen.width &lt; 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/latest.js?config=TeX-AMS-MML_HTMLorMML';

    var configscript = document.createElement('script');
    configscript.type = 'text/x-mathjax-config';
    configscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'none' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        availableFonts: ['STIX', 'TeX']," +
        "        preferredFont: 'STIX'," +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";

    (document.body || document.getElementsByTagName('head')[0]).appendChild(configscript);
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
&lt;/script&gt;</summary><content type="html">&lt;p&gt;Adopt an effective Bolocam center frequency,  f = 271.1 GHz&lt;/p&gt;
&lt;p&gt;Use Ossenkopf, V. &amp;amp; Henning, Th. 1994, A&amp;amp;A, 291, 943 Table 1. [&lt;a class="reference external" href="http://adsabs.harvard.edu/abs/1994A%26A...291..943O"&gt;http://adsabs.harvard.edu/abs/1994A%26A...291..943O&lt;/a&gt;]
Interpolate last two entries (lambda = 1.0 mm and 1.3 mm to f)&lt;/p&gt;
&lt;p&gt;This gives &lt;span class="math"&gt;\(\kappa = 0.01166 cm^2 g^{-1}\)&lt;/span&gt; (or round to 0.0117)
for gas-to-dust = 100.
But the slope between these 2 points is only 1.61!&lt;/p&gt;
&lt;p&gt;The points in OH94 table 1 jump around and locally give a variety of
slopes around 1.8.  A fit to kappa longward of 100 microns
gives a slope of 1.8.&lt;/p&gt;
&lt;p&gt;Interpolating kappa from 1.00 mm where OH5 gives &lt;span class="math"&gt;\(\kappa(1.00) = 0.0137\)&lt;/span&gt;
(for a gas-to-dust ratio = 100) to 271.1 GHz (= 1.1058 mm)
using a slope of 1.8 gives:&lt;/p&gt;
&lt;p&gt;&lt;span class="math"&gt;\(\kappa = 0.01143 cm^{2} g^{-1}\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;This is the same as the value used by Enoch, so let's adopt it
(round to 0.0114), but note that this was calculated for 271.1 GHz.&lt;/p&gt;
&lt;p&gt;For the v1.0 data, the BGPS has the following properties:&lt;/p&gt;
&lt;p&gt;effective beam FWHM = 33&amp;quot;&lt;/p&gt;
&lt;p&gt;gaussian beam &lt;span class="math"&gt;\(\sigma = 14.01\)&lt;/span&gt;&amp;quot;    (= FWHM / &lt;span class="math"&gt;\(\sqrt{(8*\ln(2))}\)&lt;/span&gt;)&lt;/p&gt;
&lt;p&gt;effective beam radius = 19.82&amp;quot;    (= FWHM / &lt;span class="math"&gt;\(\sqrt{(4*\ln(2))}\)&lt;/span&gt;)&lt;/p&gt;
&lt;p&gt;This is the radius of a circular top-hat function that has the
same solid angle as a gaussian.  At a distance of
D = 1 kpc, this radius corresponds to a length  = &lt;span class="math"&gt;\(2.97 x 10^{17}\)&lt;/span&gt; cm.
The effective beam solid angle is &lt;span class="math"&gt;\(\Omega = 2.902 x 10^{-8}\)&lt;/span&gt; sr.&lt;/p&gt;
&lt;p&gt;Adopt a fiducial dust temperature for mass calculations, &lt;span class="math"&gt;\(T_d = 20K\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;The total mass per Jy at &lt;span class="math"&gt;\(D_{kpc}\)&lt;/span&gt; = 1 kpc is given by&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
M = 1.0 x 10^{-23} * S(Jy) * D^2 / \kappa * B_{\nu}(T)
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
=  14.30 * [e^{13.01/T(K) - 1}] * S(Jy) * D^2_{kpc}   M_{\odot}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;For &lt;span class="math"&gt;\(T = 20 K\)&lt;/span&gt;:&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
M = 13.07 * S(Jy) * D^2_{kpc} M_{\odot}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;This corresponds to a beam-filling column density of &lt;span class="math"&gt;\(H_2\)&lt;/span&gt;,&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
N(H2) = 2.19e+22 * [e^{13.01/T(K) - 1}] * S(Jy)             (cm^{-2})
\end{equation*}
&lt;/div&gt;
&lt;p&gt;For &lt;span class="math"&gt;\(T = 20 K\)&lt;/span&gt;:&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
N(H2) = 2.01 x 10^{22} * S(Jy)    (cm^{-2})
A_V = 21.1 \mathrm{magnitudes} Jy^{-1}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;where we use the Bohlin &amp;amp; Savage calibration&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
A_V = 1 mag. &amp;lt;=&amp;gt; N(H) = 1.9 x 10^{20} cm^{-2} \mathrm{and}
N(H_2) = N(H) / 2
\end{equation*}
&lt;/div&gt;
&lt;script type='text/javascript'&gt;if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width &lt; 768) ? "left" : align;
        indent = (screen.width &lt; 768) ? "0em" : indent;
        linebreak = (screen.width &lt; 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/latest.js?config=TeX-AMS-MML_HTMLorMML';

    var configscript = document.createElement('script');
    configscript.type = 'text/x-mathjax-config';
    configscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'none' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        availableFonts: ['STIX', 'TeX']," +
        "        preferredFont: 'STIX'," +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";

    (document.body || document.getElementsByTagName('head')[0]).appendChild(configscript);
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
&lt;/script&gt;</content><category term="misc"></category><category term="physics"></category><category term="bgps"></category><category term="dust"></category></entry><entry><title>Arecibo Mapping: Total Power Measurements</title><link href="https://keflavich.github.io/blog/arecibo-mapping-total-power-measurements.html" rel="alternate"></link><published>2013-03-22T22:50:00-06:00</published><updated>2013-03-22T22:50:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2013-03-22:/blog/arecibo-mapping-total-power-measurements.html</id><summary type="html">&lt;p&gt;Worked on reducing the Arecibo continuum data.  There were some serious
problems with the off positions previously, in particular generating weird
slopes.&lt;/p&gt;
&lt;p&gt;I suspect the problem was with these lines&lt;/p&gt;
&lt;!-- this is really IDL but there's no pygment for IDL --&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;sorted1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sort&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;totals&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;span class="n"&gt;sorted2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sort&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;totals&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;since the indexing is wrong, but I'm not …&lt;/p&gt;</summary><content type="html">&lt;p&gt;Worked on reducing the Arecibo continuum data.  There were some serious
problems with the off positions previously, in particular generating weird
slopes.&lt;/p&gt;
&lt;p&gt;I suspect the problem was with these lines&lt;/p&gt;
&lt;!-- this is really IDL but there's no pygment for IDL --&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;sorted1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sort&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;totals&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;span class="n"&gt;sorted2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sort&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;totals&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;since the indexing is wrong, but I'm not sure yet.  I re-wrote the whole
off-position measurement to average over all scans.  Still in progress, but the
fitting works now. Here's an example:&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;img alt="" src="static/images/total_vs_integnum.png" style="width: 800px;" /&gt;
&lt;/div&gt;
</content><category term="misc"></category><category term="arecibo"></category><category term="idl"></category></entry><entry><title>Jeans Mass</title><link href="https://keflavich.github.io/blog/jeans-mass.html" rel="alternate"></link><published>2013-03-12T20:16:00-06:00</published><updated>2013-03-12T20:16:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2013-03-12:/blog/jeans-mass.html</id><summary type="html">&lt;p&gt;Some notes about the Jeans mass scale using astropy's units.&lt;/p&gt;
&lt;p&gt;Simple approaches to determining mass scales:&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
v_{esc} = \sqrt{\frac{G M}{R}}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;Isothermal equation of state:&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
P = \rho k T
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
c_s = \sqrt{2 k T / m}
\end{equation …&lt;/div&gt;&lt;script type='text/javascript'&gt;if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width &lt; 768) ? "left" : align;
        indent = (screen.width &lt; 768) ? "0em" : indent;
        linebreak = (screen.width &lt; 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/latest.js?config=TeX-AMS-MML_HTMLorMML';

    var configscript = document.createElement('script');
    configscript.type = 'text/x-mathjax-config';
    configscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'none' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        availableFonts: ['STIX', 'TeX']," +
        "        preferredFont: 'STIX'," +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";

    (document.body || document.getElementsByTagName('head')[0]).appendChild(configscript);
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
&lt;/script&gt;</summary><content type="html">&lt;p&gt;Some notes about the Jeans mass scale using astropy's units.&lt;/p&gt;
&lt;p&gt;Simple approaches to determining mass scales:&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
v_{esc} = \sqrt{\frac{G M}{R}}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;Isothermal equation of state:&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
P = \rho k T
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
c_s = \sqrt{2 k T / m}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;Setting &lt;span class="math"&gt;\(v_{esc} = c_s\)&lt;/span&gt; yields the mass scale:&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
M = \frac{R}{G}  \frac{2 k T}{m} = \frac{R c_s^2}{G}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;Using &lt;span class="math"&gt;\(\rho = \frac{M}{ 4/3 \pi R^{3} }\)&lt;/span&gt;,&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
R = \left(\frac{M}{4/3 \pi \rho}\right)^{1/3}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;so&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
M = M^{1/3} \frac{c_s^2}{G \rho^{1/3}}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;which rearranges to&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
M = \frac{c_s^{3}}{G^{3/2} \rho^{1/2}}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;where &lt;span class="math"&gt;\(M\)&lt;/span&gt; is now &lt;span class="math"&gt;\(M_J\)&lt;/span&gt;, the Jeans mass. In terms of
temperature, this is:&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
M_J = \frac{(2 k T)^{3/2}}{(m G)^{3/2} \rho^{1/2}}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;where &lt;span class="math"&gt;\(m\)&lt;/span&gt; is the particle mass, usually assumed to be 2.8 amu. (actually,
2.8 is for mass per H$_2$ particle, it should really be 2.3 amu)&lt;/p&gt;
&lt;p&gt;In[1]:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# astropy imports&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;astropy.units&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;u&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;astropy.constants&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;c&lt;/span&gt;
&lt;span class="c1"&gt;# turn off verbose but unnecessary information&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;warnings&lt;/span&gt;
&lt;span class="n"&gt;warnings&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;filterwarnings&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;ignore&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;warnings&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;filterwarnings&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;ignore&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;category&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;UnitsWarning&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;pre class="literal-block"&gt;
WARNING: ConfigurationDefaultMissingWarning: Requested default
configuration file /Users/adam/repos/astropy/astropy/astropy.cfg is not a
file. Cannot install default profile. If you are importing from source,
this is expected. [astropy]
&lt;/pre&gt;
&lt;p&gt;In[7]:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;amu&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;m_p&lt;/span&gt;
&lt;span class="n"&gt;temperature&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;K&lt;/span&gt;
&lt;span class="n"&gt;m&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(((&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;k_B&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;temperature&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mf"&gt;1.5&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mf"&gt;2.8&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;m_p&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;G&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mf"&gt;1.5&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;2.8&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="mf"&gt;1e4&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;amu&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cm&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mf"&gt;2.&lt;/span&gt;&lt;span class="p"&gt;))))&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cgs&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;In[5]:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;to&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;solMass&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Out[5]:&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
1.92903 \mathrm{M_{\odot}}
\end{equation*}
&lt;/div&gt;
&lt;pre class="literal-block"&gt;
&amp;lt;Quantity 1.92902547696 solMass&amp;gt;
&lt;/pre&gt;
&lt;script type='text/javascript'&gt;if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width &lt; 768) ? "left" : align;
        indent = (screen.width &lt; 768) ? "0em" : indent;
        linebreak = (screen.width &lt; 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/latest.js?config=TeX-AMS-MML_HTMLorMML';

    var configscript = document.createElement('script');
    configscript.type = 'text/x-mathjax-config';
    configscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'none' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        availableFonts: ['STIX', 'TeX']," +
        "        preferredFont: 'STIX'," +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";

    (document.body || document.getElementsByTagName('head')[0]).appendChild(configscript);
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
&lt;/script&gt;</content><category term="misc"></category><category term="ipynb"></category><category term="physics"></category></entry><entry><title>Installing sextractor on a mac?</title><link href="https://keflavich.github.io/blog/installing-sextractor-on-a-mac.html" rel="alternate"></link><published>2013-02-27T18:02:00-07:00</published><updated>2013-02-27T18:02:00-07:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2013-02-27:/blog/installing-sextractor-on-a-mac.html</id><summary type="html">&lt;p&gt;Attempting to install sextractor.&lt;/p&gt;
&lt;p&gt;First, tried following these instructions:&lt;/p&gt;
&lt;p&gt;&lt;a class="reference external" href="http://henrysmac.org/blog/2012/8/17/install-sextractor-on-os-x-lion.html"&gt;http://henrysmac.org/blog/2012/8/17/install-sextractor-on-os-x-lion.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Then found out that mac's tar doesn't work properly (see this note: &lt;a class="reference external" href="http://math-atlas.sourceforge.net/atlas_install/node60.html"&gt;http://math-atlas.sourceforge.net/atlas_install/node60.html&lt;/a&gt;)&lt;/p&gt;
&lt;p&gt;Fixed that with:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;wget&lt;span class="w"&gt; &lt;/span&gt;ftp://gnu.mirror.iweb.com/gnu/tar/tar-latest …&lt;/pre&gt;&lt;/div&gt;</summary><content type="html">&lt;p&gt;Attempting to install sextractor.&lt;/p&gt;
&lt;p&gt;First, tried following these instructions:&lt;/p&gt;
&lt;p&gt;&lt;a class="reference external" href="http://henrysmac.org/blog/2012/8/17/install-sextractor-on-os-x-lion.html"&gt;http://henrysmac.org/blog/2012/8/17/install-sextractor-on-os-x-lion.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Then found out that mac's tar doesn't work properly (see this note: &lt;a class="reference external" href="http://math-atlas.sourceforge.net/atlas_install/node60.html"&gt;http://math-atlas.sourceforge.net/atlas_install/node60.html&lt;/a&gt;)&lt;/p&gt;
&lt;p&gt;Fixed that with:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;wget&lt;span class="w"&gt; &lt;/span&gt;ftp://gnu.mirror.iweb.com/gnu/tar/tar-latest.tar.gz
&lt;span class="nb"&gt;cd&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;~/repos/
tar&lt;span class="w"&gt; &lt;/span&gt;-xzvf&lt;span class="w"&gt; &lt;/span&gt;~/Downloads/tar-latest.tar.gz&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;# ironically&lt;/span&gt;
&lt;span class="nb"&gt;cd&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;tar-1.26/
./configure
make
make&lt;span class="w"&gt; &lt;/span&gt;install&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;# fails&lt;/span&gt;
sudo&lt;span class="w"&gt; &lt;/span&gt;make&lt;span class="w"&gt; &lt;/span&gt;install
&lt;span class="nb"&gt;hash&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-r
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;OK, try the instructions again:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# first command may not work... visit that link if so&lt;/span&gt;
wget&lt;span class="w"&gt; &lt;/span&gt;https://sourceforge.net/projects/math-atlas/files/latest/download?source&lt;span class="o"&gt;=&lt;/span&gt;files
mkdir&lt;span class="w"&gt; &lt;/span&gt;~/repos/ATLAS3.10
&lt;span class="nb"&gt;cd&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;~/repos/ATLAS3.10
tar&lt;span class="w"&gt; &lt;/span&gt;-xf&lt;span class="w"&gt; &lt;/span&gt;~/Downloads/atlas3.10.1.tar&lt;span class="w"&gt; &lt;/span&gt;-C&lt;span class="w"&gt; &lt;/span&gt;./&lt;span class="w"&gt; &lt;/span&gt;--strip-components&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;
mkdir&lt;span class="w"&gt; &lt;/span&gt;build/
&lt;span class="nb"&gt;cd&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;build/
../configure&lt;span class="w"&gt; &lt;/span&gt;-b&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;64&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;--shared&lt;span class="w"&gt; &lt;/span&gt;--prefix&lt;span class="o"&gt;=&lt;/span&gt;/usr/local/lib/atlas&lt;span class="w"&gt; &lt;/span&gt;--with-netlib-lapack-tarfile&lt;span class="o"&gt;=&lt;/span&gt;/Users/adam/Downloads/lapack-3.4.2.tar
make&lt;span class="w"&gt; &lt;/span&gt;build
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Died with errors:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
ar r /Users/adam/repos/ATLAS3.10/build/lib/libatlas.a ATL_dMBJBmm.o
    ATL_dIBNBmm.o ATL_dIBJBmm.o ATL_dgemm.o ATL_dGetNB.o ATL_dGetNCNB.o
    ATL_dgemmNN.o ATL_dgemmNT.o ATL_dgemmTN.o ATL_dgemmTT.o ATL_dNCmmIJK.o
    ATL_dNCmmJIK.o ATL_dNCmmIJK_c.o ATL_dNCmmJIK_c.o ATL_daliased_gemm.o
    ATL_dAgemmNN.o ATL_dAgemmNT.o ATL_dAgemmTN.o ATL_dAgemmTT.o ATL_dmmJIK.o
    ATL_dmmIJK.o ATL_dmmJKI.o ATL_dmmK.o ATL_dmmBPP.o ATL_dmmJITcp.o
    ATL_dcol2blk_aX.o ATL_drow2blkT_aX.o ATL_dcol2blk_a1.o ATL_drow2blkT_a1.o
    ATL_dputblk_bX.o ATL_dputblk_b1.o ATL_dputblk_bn1.o ATL_dputblk_b0.o
ar: fatal error in /usr/bin/ranlib
make[4]: *** [dlib.grd] Error 1
make[3]: *** [dlib] Error 2
make[2]: *** [IBuildPtlibs] Error 2
   DONE  STAGE 4-2-1 at 23:09


   BEGIN STAGE 4-3-0: LAPACK TUNING at 23:09


      BEGIN STAGE 4-3-1: dLAPACK TUNING at 23:09
make -f Makefile IBuildPtlibs 2&amp;gt;&amp;amp;1 | ./xatlas_tee INSTALL_LOG/LIBPTBUILD.LOG
if [ -s &amp;quot;/Users/adam/repos/ATLAS3.10/build/include/atlas_dGetNB_geqrf.h&amp;quot; ]; then \
           echo &amp;quot;Arch Defaults allow us to skip tuning&amp;quot; ; \
        else \
        cd /Users/adam/repos/ATLAS3.10/build/tune/lapack ; make res/ATL_dGetNB_geqrf.h ; \
        cp /Users/adam/repos/ATLAS3.10/build/tune/lapack/res/ATL_dGetNB_geqrf.h \
               /Users/adam/repos/ATLAS3.10/build/include/atlas_dGetNB_geqrf.h ; \
        fi
Arch Defaults allow us to skip tuning
if [ -s &amp;quot;/Users/adam/repos/ATLAS3.10/build/include/atlas_dtGetNB_geqrf.h&amp;quot; ]; then \
           echo &amp;quot;Arch Defaults allow us to skip threaded tuning&amp;quot; ; \
        elif [ -s &amp;quot;/Users/adam/repos/ATLAS3.10/build/include/atlas_pthreads.h&amp;quot; ]; then \
        cd /Users/adam/repos/ATLAS3.10/build/tune/lapack ; make res/ATL_dtGetNB_geqrf.h ; \
        cp /Users/adam/repos/ATLAS3.10/build/tune/lapack/res/ATL_dtGetNB_geqrf.h \
               /Users/adam/repos/ATLAS3.10/build/include/atlas_dtGetNB_geqrf.h ; \
        fi
Arch Defaults allow us to skip threaded tuning
      DONE  STAGE 4-3-1 at 23:09


      BEGIN STAGE 4-3-2: sLAPACK TUNING at 23:09
make -f Makefile ILATune pre=d 2&amp;gt;&amp;amp;1 | ./xatlas_tee INSTALL_LOG/dLATUNE.LOG
if [ -s &amp;quot;/Users/adam/repos/ATLAS3.10/build/include/atlas_sGetNB_geqrf.h&amp;quot; ]; then \
           echo &amp;quot;Arch Defaults allow us to skip tuning&amp;quot; ; \
        else \
        cd /Users/adam/repos/ATLAS3.10/build/tune/lapack ; make res/ATL_sGetNB_geqrf.h ; \
        cp /Users/adam/repos/ATLAS3.10/build/tune/lapack/res/ATL_sGetNB_geqrf.h \
               /Users/adam/repos/ATLAS3.10/build/include/atlas_sGetNB_geqrf.h ; \
        fi
Arch Defaults allow us to skip tuning
if [ -s &amp;quot;/Users/adam/repos/ATLAS3.10/build/include/atlas_stGetNB_geqrf.h&amp;quot; ]; then \
           echo &amp;quot;Arch Defaults allow us to skip threaded tuning&amp;quot; ; \
        elif [ -s &amp;quot;/Users/adam/repos/ATLAS3.10/build/include/atlas_pthreads.h&amp;quot; ]; then \
        cd /Users/adam/repos/ATLAS3.10/build/tune/lapack ; make res/ATL_stGetNB_geqrf.h ; \
        cp /Users/adam/repos/ATLAS3.10/build/tune/lapack/res/ATL_stGetNB_geqrf.h \
               /Users/adam/repos/ATLAS3.10/build/include/atlas_stGetNB_geqrf.h ; \
        fi
Arch Defaults allow us to skip threaded tuning
      DONE  STAGE 4-3-2 at 23:09


      BEGIN STAGE 4-3-3: zLAPACK TUNING at 23:09
make -f Makefile ILATune pre=s 2&amp;gt;&amp;amp;1 | ./xatlas_tee INSTALL_LOG/sLATUNE.LOG
if [ -s &amp;quot;/Users/adam/repos/ATLAS3.10/build/include/atlas_zGetNB_geqrf.h&amp;quot; ]; then \
           echo &amp;quot;Arch Defaults allow us to skip tuning&amp;quot; ; \
        else \
        cd /Users/adam/repos/ATLAS3.10/build/tune/lapack ; make res/ATL_zGetNB_geqrf.h ; \
        cp /Users/adam/repos/ATLAS3.10/build/tune/lapack/res/ATL_zGetNB_geqrf.h \
               /Users/adam/repos/ATLAS3.10/build/include/atlas_zGetNB_geqrf.h ; \
        fi
Arch Defaults allow us to skip tuning
if [ -s &amp;quot;/Users/adam/repos/ATLAS3.10/build/include/atlas_ztGetNB_geqrf.h&amp;quot; ]; then \
           echo &amp;quot;Arch Defaults allow us to skip threaded tuning&amp;quot; ; \
        elif [ -s &amp;quot;/Users/adam/repos/ATLAS3.10/build/include/atlas_pthreads.h&amp;quot; ]; then \
        cd /Users/adam/repos/ATLAS3.10/build/tune/lapack ; make res/ATL_ztGetNB_geqrf.h ; \
        cp /Users/adam/repos/ATLAS3.10/build/tune/lapack/res/ATL_ztGetNB_geqrf.h \
               /Users/adam/repos/ATLAS3.10/build/include/atlas_ztGetNB_geqrf.h ; \
        fi
Arch Defaults allow us to skip threaded tuning
      DONE  STAGE 4-3-3 at 23:09


      BEGIN STAGE 4-3-4: cLAPACK TUNING at 23:09
make -f Makefile ILATune pre=z 2&amp;gt;&amp;amp;1 | ./xatlas_tee INSTALL_LOG/zLATUNE.LOG
if [ -s &amp;quot;/Users/adam/repos/ATLAS3.10/build/include/atlas_cGetNB_geqrf.h&amp;quot; ]; then \
           echo &amp;quot;Arch Defaults allow us to skip tuning&amp;quot; ; \
        else \
        cd /Users/adam/repos/ATLAS3.10/build/tune/lapack ; make res/ATL_cGetNB_geqrf.h ; \
        cp /Users/adam/repos/ATLAS3.10/build/tune/lapack/res/ATL_cGetNB_geqrf.h \
               /Users/adam/repos/ATLAS3.10/build/include/atlas_cGetNB_geqrf.h ; \
        fi
Arch Defaults allow us to skip tuning
if [ -s &amp;quot;/Users/adam/repos/ATLAS3.10/build/include/atlas_ctGetNB_geqrf.h&amp;quot; ]; then \
           echo &amp;quot;Arch Defaults allow us to skip threaded tuning&amp;quot; ; \
        elif [ -s &amp;quot;/Users/adam/repos/ATLAS3.10/build/include/atlas_pthreads.h&amp;quot; ]; then \
        cd /Users/adam/repos/ATLAS3.10/build/tune/lapack ; make res/ATL_ctGetNB_geqrf.h ; \
        cp /Users/adam/repos/ATLAS3.10/build/tune/lapack/res/ATL_ctGetNB_geqrf.h \
               /Users/adam/repos/ATLAS3.10/build/include/atlas_ctGetNB_geqrf.h ; \
        fi
Arch Defaults allow us to skip threaded tuning
      DONE  STAGE 4-3-4 at 23:09
   DONE  STAGE 4-3-0 at 23:09
DONE  STAGE 4-0-0 at 23:09


BEGIN STAGE 5-0-0: FINAL LIBRARY UPDATE at 23:09


   BEGIN STAGE 5-1-0: FINAL STATIC LIBRARY UPDATE at 23:09
make -f Makefile IBuildLibs IBuildPtlibs0 2&amp;gt;&amp;amp;1 | ./xatlas_tee INSTALL_LOG/LIBUPDATE.LOG
cd /Users/adam/repos/ATLAS3.10/build/src/auxil ; make lib
make[3]: Nothing to be done for `lib'.
cd /Users/adam/repos/ATLAS3.10/build/src/blas/gemm ; make lib
make auxillib dcleanuplib dusergemm
cd /Users/adam/repos/ATLAS3.10/build/src/auxil ; make lib
make[5]: Nothing to be done for `lib'.
cd KERNEL ; make -f dMakefile dlib
make[5]: Nothing to be done for `dlib'.
make[4]: Nothing to be done for `dusergemm'.
make -j 4 dlib.grd
ar r /Users/adam/repos/ATLAS3.10/build/lib/libatlas.a ATL_dMBJBmm.o
    ATL_dIBNBmm.o ATL_dIBJBmm.o ATL_dgemm.o ATL_dGetNB.o ATL_dGetNCNB.o
    ATL_dgemmNN.o ATL_dgemmNT.o ATL_dgemmTN.o ATL_dgemmTT.o ATL_dNCmmIJK.o
    ATL_dNCmmJIK.o ATL_dNCmmIJK_c.o ATL_dNCmmJIK_c.o ATL_daliased_gemm.o
    ATL_dAgemmNN.o ATL_dAgemmNT.o ATL_dAgemmTN.o ATL_dAgemmTT.o ATL_dmmJIK.o
    ATL_dmmIJK.o ATL_dmmJKI.o ATL_dmmK.o ATL_dmmBPP.o ATL_dmmJITcp.o
    ATL_dcol2blk_aX.o ATL_drow2blkT_aX.o ATL_dcol2blk_a1.o ATL_drow2blkT_a1.o
    ATL_dputblk_bX.o ATL_dputblk_b1.o ATL_dputblk_bn1.o ATL_dputblk_b0.o
ar: fatal error in /usr/bin/ranlib
make[4]: *** [dlib.grd] Error 1
make[3]: *** [dlib] Error 2
make[2]: *** [IBuildLibs] Error 2
   DONE  STAGE 5-1-0 at 23:09


   BEGIN STAGE 5-2-0: DYNAMIC/SHARED LIBRARY UPDATE at 23:09
make -f Makefile IBuildDyLibs 2&amp;gt;&amp;amp;1 | ./xatlas_tee INSTALL_LOG/LIBDYBUILD.LOG
cd /Users/adam/repos/ATLAS3.10/build ; make dylibs
cd lib ; make shared_all
make dylib
rm -rf RCW_tMp ; mkdir RCW_tMp
cd RCW_tMp ; ar x ../liblapack.a
ar: ../liblapack.a: No such file or directory
make[5]: *** [dylib] Error 1
make[4]: *** [shared_all] Error 2
make[3]: *** [dylibs] Error 2
make[2]: *** [IBuildDyLibs] Error 2
   DONE  STAGE 5-2-0 at 23:09




ATLAS install complete.  Examine
ATLAS/bin/&amp;lt;arch&amp;gt;/INSTALL_LOG/SUMMARY.LOG for details.
make clean
rm -rf *.dSYM
rm -f *.o x* config?.out *core*



make check

Died with errors:

ar r /Users/adam/repos/ATLAS3.10/build/lib/libatlas.a ATL_sMBJBmm.o
    ATL_sIBNBmm.o ATL_sIBJBmm.o ATL_sgemm.o ATL_sGetNB.o ATL_sGetNCNB.o
    ATL_sgemmNN.o ATL_sgemmNT.o ATL_sgemmTN.o ATL_sgemmTT.o ATL_sNCmmIJK.o
    ATL_sNCmmJIK.o ATL_sNCmmIJK_c.o ATL_sNCmmJIK_c.o ATL_saliased_gemm.o
    ATL_sAgemmNN.o ATL_sAgemmNT.o ATL_sAgemmTN.o ATL_sAgemmTT.o ATL_smmJIK.o
    ATL_smmIJK.o ATL_smmJKI.o ATL_smmK.o ATL_smmBPP.o ATL_smmJITcp.o
    ATL_scol2blk_aX.o ATL_srow2blkT_aX.o ATL_scol2blk_a1.o ATL_srow2blkT_a1.o
    ATL_sputblk_bX.o ATL_sputblk_b1.o ATL_sputblk_bn1.o ATL_sputblk_b0.o
ranlib /Users/adam/repos/ATLAS3.10/build/lib/libatlas.a
touch slib.grd
cd /Users/adam/repos/ATLAS3.10/build/src/blas/level3 ; make slib
( cd kernel; make slib )
make -j 4 slib.grd
make[6]: `slib.grd' is up to date.
make sl3ref
cd /Users/adam/repos/ATLAS3.10/build/src/blas/reference/level3 ; make slib
make[7]: Nothing to be done for `slib'.
( cd rblas;  make slib )
make[5]: Nothing to be done for `slib'.
cd ../pklevel3 ; make slib
cd gpmm ; make slib
make -j 4 slib.grd
make[7]: `slib.grd' is up to date.
cd sprk ; make slib
make -j 4 slib.grd
make[7]: `slib.grd' is up to date.
make -j 4 sblas3.grd
ar r /Users/adam/repos/ATLAS3.10/build/lib/libatlas.a ATL_ssymm.o ATL_ssyr2k.o ATL_ssyrk.o ATL_strmm.o ATL_strsm.o
ar: fatal error in /usr/bin/ranlib
make[5]: *** [sblas3.grd] Error 1
make[4]: *** [sblas3] Error 2
make[3]: *** [sl3lib] Error 2
make[2]: *** [sanity_test] Error 2
make[1]: *** [sanity_test] Error 2
make: *** [test] Error 2
&lt;/pre&gt;
&lt;p&gt;Gave up after discovering this is an unsolved (and probably intrinsically unsolveable) problem:
&lt;a class="reference external" href="http://fink.9193.n7.nabble.com/Atlas-STAGE-2-3-2-CacheEdge-DETECTION-error-td26004.html"&gt;http://fink.9193.n7.nabble.com/Atlas-STAGE-2-3-2-CacheEdge-DETECTION-error-td26004.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;maybe try this:
&lt;a class="reference external" href="http://okomestudio.net/biboroku/?p=824"&gt;http://okomestudio.net/biboroku/?p=824&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;nope, same thing&lt;/p&gt;
&lt;p&gt;Tried switching from gcc-4.6 to gcc-4.2 (the latter should have been the default anyway).
Even when I renamed gcc-4.6 to dontuse_gcc-4.6, specified CC=/usr/bin/gcc, still found gcc-4.6!&lt;/p&gt;
&lt;p&gt;So I moved /usr/local/bin/gcc-4.6 to /usr/local/bin/dontuse/.gcc-4.6
Ridiculous.&lt;/p&gt;
&lt;p&gt;Then tried what the site actually said, and used the hpc binaries:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
wget http://prdownloads.sourceforge.net/hpc/gfortran-lion.tar.gz?download
wget http://prdownloads.sourceforge.net/hpc/gcc-lion.tar.gz?download
mkdir ~/repos/hpc
tar -xzf ~/Downloads/gcc-lion.tar.gz -C ~/repos/hpc/ --strip-components 2
tar -xzf ~/Downloads/gfortran-lion.tar.gz -C ~/repos/hpc/ --strip-components 2

CC=/Users/adam/repos/hpc/bin/gcc PATH=/Users/adam/repos/hpc/bin:$PATH
    ../configure -b 64 --shared --prefix=/usr/local/lib/atlas
    --with-netlib-lapack-tarfile=/Users/adam/Downloads/lapack-3.4.2.tar


ar r /Users/adam/repos/ATLAS3.10/build/lib/libatlas.a ATL_dMBJBmm.o
    ATL_dIBNBmm.o ATL_dIBJBmm.o ATL_dgemm.o ATL_dGetNB.o ATL_dGetNCNB.o
    ATL_dgemmNN.o ATL_dgemmNT.o ATL_dgemmTN.o ATL_dgemmTT.o ATL_dNCmmIJK.o
    ATL_dNCmmJIK.o ATL_dNCmmIJK_c.o ATL_dNCmmJIK_c.o ATL_daliased_gemm.o
    ATL_dAgemmNN.o ATL_dAgemmNT.o ATL_dAgemmTN.o ATL_dAgemmTT.o ATL_dmmJIK.o
    ATL_dmmIJK.o ATL_dmmJKI.o ATL_dmmK.o ATL_dmmBPP.o ATL_dmmJITcp.o
    ATL_dcol2blk_aX.o ATL_drow2blkT_aX.o ATL_dcol2blk_a1.o ATL_drow2blkT_a1.o
    ATL_dputblk_bX.o ATL_dputblk_b1.o ATL_dputblk_bn1.o ATL_dputblk_b0.o
ar: fatal error in /usr/bin/ranlib
make[4]: *** [dlib.grd] Error 1
make[3]: *** [dlib] Error 2
make[2]: *** [IBuildPtlibs] Error 2
   DONE  STAGE 4-2-1 at 18:09


   BEGIN STAGE 4-3-0: LAPACK TUNING at 18:09


      BEGIN STAGE 4-3-1: dLAPACK TUNING at 18:09
make -f Makefile IBuildPtlibs 2&amp;gt;&amp;amp;1 | ./xatlas_tee INSTALL_LOG/LIBPTBUILD.LOG
if [ -s &amp;quot;/Users/adam/repos/ATLAS3.10/build/include/atlas_dGetNB_geqrf.h&amp;quot; ]; then \
           echo &amp;quot;Arch Defaults allow us to skip tuning&amp;quot; ; \
        else \
        cd /Users/adam/repos/ATLAS3.10/build/tune/lapack ; make res/ATL_dGetNB_geqrf.h ; \
        cp /Users/adam/repos/ATLAS3.10/build/tune/lapack/res/ATL_dGetNB_geqrf.h \
               /Users/adam/repos/ATLAS3.10/build/include/atlas_dGetNB_geqrf.h ; \
        fi
Arch Defaults allow us to skip tuning
if [ -s &amp;quot;/Users/adam/repos/ATLAS3.10/build/include/atlas_dtGetNB_geqrf.h&amp;quot; ]; then \
           echo &amp;quot;Arch Defaults allow us to skip threaded tuning&amp;quot; ; \
        elif [ -s &amp;quot;/Users/adam/repos/ATLAS3.10/build/include/atlas_pthreads.h&amp;quot; ]; then \
        cd /Users/adam/repos/ATLAS3.10/build/tune/lapack ; make res/ATL_dtGetNB_geqrf.h ; \
        cp /Users/adam/repos/ATLAS3.10/build/tune/lapack/res/ATL_dtGetNB_geqrf.h \
               /Users/adam/repos/ATLAS3.10/build/include/atlas_dtGetNB_geqrf.h ; \
        fi
Arch Defaults allow us to skip threaded tuning
      DONE  STAGE 4-3-1 at 18:09


      BEGIN STAGE 4-3-2: sLAPACK TUNING at 18:09
make -f Makefile ILATune pre=d 2&amp;gt;&amp;amp;1 | ./xatlas_tee INSTALL_LOG/dLATUNE.LOG
if [ -s &amp;quot;/Users/adam/repos/ATLAS3.10/build/include/atlas_sGetNB_geqrf.h&amp;quot; ]; then \
           echo &amp;quot;Arch Defaults allow us to skip tuning&amp;quot; ; \
        else \
        cd /Users/adam/repos/ATLAS3.10/build/tune/lapack ; make res/ATL_sGetNB_geqrf.h ; \
        cp /Users/adam/repos/ATLAS3.10/build/tune/lapack/res/ATL_sGetNB_geqrf.h \
               /Users/adam/repos/ATLAS3.10/build/include/atlas_sGetNB_geqrf.h ; \
        fi
Arch Defaults allow us to skip tuning
if [ -s &amp;quot;/Users/adam/repos/ATLAS3.10/build/include/atlas_stGetNB_geqrf.h&amp;quot; ]; then \
           echo &amp;quot;Arch Defaults allow us to skip threaded tuning&amp;quot; ; \
        elif [ -s &amp;quot;/Users/adam/repos/ATLAS3.10/build/include/atlas_pthreads.h&amp;quot; ]; then \
        cd /Users/adam/repos/ATLAS3.10/build/tune/lapack ; make res/ATL_stGetNB_geqrf.h ; \
        cp /Users/adam/repos/ATLAS3.10/build/tune/lapack/res/ATL_stGetNB_geqrf.h \
               /Users/adam/repos/ATLAS3.10/build/include/atlas_stGetNB_geqrf.h ; \
        fi
Arch Defaults allow us to skip threaded tuning
      DONE  STAGE 4-3-2 at 18:09


      BEGIN STAGE 4-3-3: zLAPACK TUNING at 18:09
make -f Makefile ILATune pre=s 2&amp;gt;&amp;amp;1 | ./xatlas_tee INSTALL_LOG/sLATUNE.LOG
if [ -s &amp;quot;/Users/adam/repos/ATLAS3.10/build/include/atlas_zGetNB_geqrf.h&amp;quot; ]; then \
           echo &amp;quot;Arch Defaults allow us to skip tuning&amp;quot; ; \
        else \
        cd /Users/adam/repos/ATLAS3.10/build/tune/lapack ; make res/ATL_zGetNB_geqrf.h ; \
        cp /Users/adam/repos/ATLAS3.10/build/tune/lapack/res/ATL_zGetNB_geqrf.h \
               /Users/adam/repos/ATLAS3.10/build/include/atlas_zGetNB_geqrf.h ; \
        fi
Arch Defaults allow us to skip tuning
if [ -s &amp;quot;/Users/adam/repos/ATLAS3.10/build/include/atlas_ztGetNB_geqrf.h&amp;quot; ]; then \
           echo &amp;quot;Arch Defaults allow us to skip threaded tuning&amp;quot; ; \
        elif [ -s &amp;quot;/Users/adam/repos/ATLAS3.10/build/include/atlas_pthreads.h&amp;quot; ]; then \
        cd /Users/adam/repos/ATLAS3.10/build/tune/lapack ; make res/ATL_ztGetNB_geqrf.h ; \
        cp /Users/adam/repos/ATLAS3.10/build/tune/lapack/res/ATL_ztGetNB_geqrf.h \
               /Users/adam/repos/ATLAS3.10/build/include/atlas_ztGetNB_geqrf.h ; \
        fi
Arch Defaults allow us to skip threaded tuning
      DONE  STAGE 4-3-3 at 18:09


      BEGIN STAGE 4-3-4: cLAPACK TUNING at 18:09
make -f Makefile ILATune pre=z 2&amp;gt;&amp;amp;1 | ./xatlas_tee INSTALL_LOG/zLATUNE.LOG
if [ -s &amp;quot;/Users/adam/repos/ATLAS3.10/build/include/atlas_cGetNB_geqrf.h&amp;quot; ]; then \
           echo &amp;quot;Arch Defaults allow us to skip tuning&amp;quot; ; \
        else \
        cd /Users/adam/repos/ATLAS3.10/build/tune/lapack ; make res/ATL_cGetNB_geqrf.h ; \
        cp /Users/adam/repos/ATLAS3.10/build/tune/lapack/res/ATL_cGetNB_geqrf.h \
               /Users/adam/repos/ATLAS3.10/build/include/atlas_cGetNB_geqrf.h ; \
        fi
Arch Defaults allow us to skip tuning
if [ -s &amp;quot;/Users/adam/repos/ATLAS3.10/build/include/atlas_ctGetNB_geqrf.h&amp;quot; ]; then \
           echo &amp;quot;Arch Defaults allow us to skip threaded tuning&amp;quot; ; \
        elif [ -s &amp;quot;/Users/adam/repos/ATLAS3.10/build/include/atlas_pthreads.h&amp;quot; ]; then \
        cd /Users/adam/repos/ATLAS3.10/build/tune/lapack ; make res/ATL_ctGetNB_geqrf.h ; \
        cp /Users/adam/repos/ATLAS3.10/build/tune/lapack/res/ATL_ctGetNB_geqrf.h \
               /Users/adam/repos/ATLAS3.10/build/include/atlas_ctGetNB_geqrf.h ; \
        fi
Arch Defaults allow us to skip threaded tuning
      DONE  STAGE 4-3-4 at 18:09
   DONE  STAGE 4-3-0 at 18:09
DONE  STAGE 4-0-0 at 18:09


BEGIN STAGE 5-0-0: FINAL LIBRARY UPDATE at 18:09


   BEGIN STAGE 5-1-0: FINAL STATIC LIBRARY UPDATE at 18:09
make -f Makefile IBuildLibs IBuildPtlibs0 2&amp;gt;&amp;amp;1 | ./xatlas_tee INSTALL_LOG/LIBUPDATE.LOG
cd /Users/adam/repos/ATLAS3.10/build/src/auxil ; make lib
make[3]: Nothing to be done for `lib'.
cd /Users/adam/repos/ATLAS3.10/build/src/blas/gemm ; make lib
make auxillib dcleanuplib dusergemm
cd /Users/adam/repos/ATLAS3.10/build/src/auxil ; make lib
make[5]: Nothing to be done for `lib'.
cd KERNEL ; make -f dMakefile dlib
make[5]: Nothing to be done for `dlib'.
make[4]: Nothing to be done for `dusergemm'.
make -j 4 dlib.grd
ar r /Users/adam/repos/ATLAS3.10/build/lib/libatlas.a ATL_dMBJBmm.o
    ATL_dIBNBmm.o ATL_dIBJBmm.o ATL_dgemm.o ATL_dGetNB.o ATL_dGetNCNB.o
    ATL_dgemmNN.o ATL_dgemmNT.o ATL_dgemmTN.o ATL_dgemmTT.o ATL_dNCmmIJK.o
    ATL_dNCmmJIK.o ATL_dNCmmIJK_c.o ATL_dNCmmJIK_c.o ATL_daliased_gemm.o
    ATL_dAgemmNN.o ATL_dAgemmNT.o ATL_dAgemmTN.o ATL_dAgemmTT.o ATL_dmmJIK.o
    ATL_dmmIJK.o ATL_dmmJKI.o ATL_dmmK.o ATL_dmmBPP.o ATL_dmmJITcp.o
    ATL_dcol2blk_aX.o ATL_drow2blkT_aX.o ATL_dcol2blk_a1.o ATL_drow2blkT_a1.o
    ATL_dputblk_bX.o ATL_dputblk_b1.o ATL_dputblk_bn1.o ATL_dputblk_b0.o
ar: fatal error in /usr/bin/ranlib
make[4]: *** [dlib.grd] Error 1
make[3]: *** [dlib] Error 2
make[2]: *** [IBuildLibs] Error 2
   DONE  STAGE 5-1-0 at 18:09


   BEGIN STAGE 5-2-0: DYNAMIC/SHARED LIBRARY UPDATE at 18:09
make -f Makefile IBuildDyLibs 2&amp;gt;&amp;amp;1 | ./xatlas_tee INSTALL_LOG/LIBDYBUILD.LOG
cd /Users/adam/repos/ATLAS3.10/build ; make dylibs
cd lib ; make shared_all
make dylib
rm -rf RCW_tMp ; mkdir RCW_tMp
cd RCW_tMp ; ar x ../liblapack.a
ar: ../liblapack.a: No such file or directory
make[5]: *** [dylib] Error 1
make[4]: *** [shared_all] Error 2
make[3]: *** [dylibs] Error 2
make[2]: *** [IBuildDyLibs] Error 2
   DONE  STAGE 5-2-0 at 18:09




ATLAS install complete.  Examine
ATLAS/bin/&amp;lt;arch&amp;gt;/INSTALL_LOG/SUMMARY.LOG for details.
make clean
rm -rf *.dSYM
rm -f *.o x* config?.out *core*
&lt;/pre&gt;
&lt;p&gt;This is the next step, if I ever get there:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
wget http://www.astromatic.net/download/sextractor/sextractor-2.8.6.tar.gz
tar -xzvf ~/Downloads/sextractor-2.8.6.tar.gz
&lt;/pre&gt;
</content><category term="misc"></category></entry><entry><title>Short timescale variability in Orion? Nope.</title><link href="https://keflavich.github.io/blog/short-timescale-variability-in-orion-nope.html" rel="alternate"></link><published>2012-11-19T17:07:00-07:00</published><updated>2012-11-19T17:07:00-07:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-11-19:/blog/short-timescale-variability-in-orion-nope.html</id><summary type="html">&lt;div dir="ltr" style="text-align: left;"&gt;&lt;p&gt;I attempted to use TripleSpec finder / guider images to search for
variability &amp;nbsp;on short (~5s) timescales in the Orion Nebula region. &amp;nbsp;This
project was an offshoot of the related
&lt;a class="reference external" href="http://adamginsburg.blogspot.com/2012/10/using-guider-images-to-achieve.html"&gt;http://adamginsburg.blogspot.com/2012/10/using-guider-images-to-achieve.html&lt;/a&gt;.
&amp;nbsp;I successfully matched the images using a particular catalog &amp;amp; the
ever-cool&amp;nbsp;&lt;a class="reference external" href="http://astrometry.net/"&gt;astrometry.net …&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;</summary><content type="html">&lt;div dir="ltr" style="text-align: left;"&gt;&lt;p&gt;I attempted to use TripleSpec finder / guider images to search for
variability &amp;nbsp;on short (~5s) timescales in the Orion Nebula region. &amp;nbsp;This
project was an offshoot of the related
&lt;a class="reference external" href="http://adamginsburg.blogspot.com/2012/10/using-guider-images-to-achieve.html"&gt;http://adamginsburg.blogspot.com/2012/10/using-guider-images-to-achieve.html&lt;/a&gt;.
&amp;nbsp;I successfully matched the images using a particular catalog &amp;amp; the
ever-cool&amp;nbsp;&lt;a class="reference external" href="http://astrometry.net/"&gt;astrometry.net&lt;/a&gt;with a great deal of assistance from
&lt;a class="reference external" href="http://www.astro.princeton.edu/~dstn/"&gt;Dustin Lang&lt;/a&gt;&amp;nbsp;and some from &lt;a class="reference external" href="http://hoggresearch.blogspot.com/2012/10/time-for-astrometrynet-to-rise-again.html"&gt;David Hogg&lt;/a&gt;. &amp;nbsp;I'll post details of that
process later; it proved challenging but will DEFINITELY be useful again
in the future. &amp;nbsp;Short story: I had to build my own indices, then fit
twice - once for the first match, once after distortion was applied to
re-extract the sources in the right location.
Conveniently, one of the products output by the astrometry.net code is
ra,dec locations and fluxes (background subtracted) for all of the
identified sources. &amp;nbsp;So, I used a simple script to match all sources
within 2&amp;quot; of a known source from my input catalog and generate
timestream data. &amp;nbsp;It took about an hour of processing (nested for loops
- awful, but the only obvious choice at first. &amp;nbsp;Half of the time was
probably file IO anyway).
I now had a few hundred timestreams of Orion stars. &amp;nbsp;At this point, I
hadn't done any kind of quality control, which was obviously a problem
because the Trapezium and neighbors were clearly saturated. &amp;nbsp;Also, there
are known hot pixels that will drive some stars into weird behavior.
&amp;nbsp;But I ignored all of that. &amp;nbsp;All I did for quality control was reject
stars with more than about 5% missing data.
I elected to go straight for PCA analysis. &amp;nbsp;I assumed the primary
component (the most correlated component) would be from the atmosphere,
which is almost certainly true. &amp;nbsp;Subtracting that off (shown in the
notebook linked below) left some clearly correlated components left over
- some of these are instrumental, others are correlated backgrounds,
others are correlated saturation levels. &amp;nbsp;I don't honestly know what all
of the components are, but I DO know that correlated components are very
unlikely to be intrinsic phenomena - stellar brightness isn't
correlated.
So I tried to cut out ALL correlated components. &amp;nbsp;However, I think in
the process I probably removed any useful information - even
un-correlated signal should probably have a high amplitude (if it's
interesting...) that will get removed through the process I used.
&amp;nbsp;Nonetheless, I probably have some upper limits on the 5s scale
variability of these stars in K-band. &amp;nbsp;Not enough to do anything like
asteroseismology, but it was worth a day's effort.
Here's the ipython notebook (gist &amp;amp; nbviewer) for those interested:
&lt;a class="reference external" href="https://gist.github.com/4109329"&gt;https://gist.github.com/4109329&lt;/a&gt;
&lt;a class="reference external" href="http://nbviewer.ipython.org/4109329/"&gt;http://nbviewer.ipython.org/4109329/&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;&lt;/p&gt;</content><category term="misc"></category><category term="googlepost"></category></entry><entry><title>Attempts to install astrometry.net (comment on problems-with-index-files-generation)</title><link href="https://keflavich.github.io/blog/attempts-to-install-astrometrynet-comment-on-problems-with-index-files-generation.html" rel="alternate"></link><published>2012-11-04T17:26:00-07:00</published><updated>2012-11-04T17:26:00-07:00</updated><author><name>Adam</name></author><id>tag:keflavich.github.io,2012-11-04:/blog/attempts-to-install-astrometrynet-comment-on-problems-with-index-files-generation.html</id><summary type="html">&lt;p&gt;Some progress in this vein:
1. installed astrometry.net (but without some graphical extras)
2. figured out how to create indexes! Finders are ~5x5', so based on
&lt;a class="reference external" href="http://forum.astrometry.net/index.php?p=/discussion/2/problems-with-index-files-generation/p1"&gt;this post&lt;/a&gt; I want to use ~2-3' healpixes.
3. I also should be using denser catalogs than the all-sky USNO B1,
especially for …&lt;/p&gt;</summary><content type="html">&lt;p&gt;Some progress in this vein:
1. installed astrometry.net (but without some graphical extras)
2. figured out how to create indexes! Finders are ~5x5', so based on
&lt;a class="reference external" href="http://forum.astrometry.net/index.php?p=/discussion/2/problems-with-index-files-generation/p1"&gt;this post&lt;/a&gt; I want to use ~2-3' healpixes.
3. I also should be using denser catalogs than the all-sky USNO B1,
especially for infrared targets.
So, here's a sample build command (using a CDS-based FITS table, but
modified by me using atpy):
build-index -v -i OMC1_optical_phot_DaRio.fits -o
OMC1_optical_phot_DaRio_astrometryindex -N 1758&lt;/p&gt;
</content><category term="misc"></category><category term="comment"></category></entry><entry><title>Planned Serendipity: H-alpha maps around O-stars</title><link href="https://keflavich.github.io/blog/planned-serendipity-h-alpha-maps-around-o-stars.html" rel="alternate"></link><published>2012-10-11T14:13:00-06:00</published><updated>2012-10-11T14:13:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-10-11:/blog/planned-serendipity-h-alpha-maps-around-o-stars.html</id><summary type="html">&lt;div dir="ltr" style="text-align: left;"&gt;&lt;p&gt;Plenty of O-stars have been observed in H-alpha because they're in star
forming regions. &amp;nbsp;But there are plenty of others - runaways and the like
- that haven't. &amp;nbsp;A survey of these stars may turn up nearby ionized
features. &amp;nbsp;We may find externally illuminated AGB stars, allowing for
determination of their ejecta …&lt;/p&gt;&lt;/div&gt;</summary><content type="html">&lt;div dir="ltr" style="text-align: left;"&gt;&lt;p&gt;Plenty of O-stars have been observed in H-alpha because they're in star
forming regions. &amp;nbsp;But there are plenty of others - runaways and the like
- that haven't. &amp;nbsp;A survey of these stars may turn up nearby ionized
features. &amp;nbsp;We may find externally illuminated AGB stars, allowing for
determination of their ejecta composition with diagnostic lines that are
usually unexcited and unavailable. &amp;nbsp;We may find bipolar ejection nebulae
or planetary nebulae with peculiar illumination patterns because they
are not centrally lit.&lt;/p&gt;
&lt;div&gt;&lt;/div&gt;&lt;div&gt;&lt;p&gt;A good starting point &amp;amp; justification for this survey would be to
estimate the chance of a coincidence (within 5 pc? &amp;nbsp;10 pc?) of an O star
and an AGB star given purely random sampling. &amp;nbsp;Based on the detection of
SBW 2 in Carina, I think the odds must be pretty good.&lt;/p&gt;
&lt;/div&gt;&lt;/div&gt;&lt;/p&gt;</content><category term="misc"></category><category term="googlepost"></category><category term="research ideas"></category></entry><entry><title>Using Guider images to achieve ~arcsecond pointing accuracy</title><link href="https://keflavich.github.io/blog/using-guider-images-to-achieve-arcsecond-pointing-accuracy.html" rel="alternate"></link><published>2012-10-05T14:46:00-06:00</published><updated>2012-10-05T14:46:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-10-05:/blog/using-guider-images-to-achieve-arcsecond-pointing-accuracy.html</id><summary type="html">&lt;div dir="ltr" style="text-align: left;"&gt;&lt;p&gt;One of the challenges of observing in the near-IR / optical is field
identification. In the case of the Apache Point Observatory 3.5m, the
&amp;quot;raw&amp;quot; pointing - i.e., if you enter a coordinate and press &amp;quot;slew&amp;quot; - is
usually good to within ~1 arcminute. However, once you're on the target
field …&lt;/p&gt;&lt;/div&gt;</summary><content type="html">&lt;div dir="ltr" style="text-align: left;"&gt;&lt;p&gt;One of the challenges of observing in the near-IR / optical is field
identification. In the case of the Apache Point Observatory 3.5m, the
&amp;quot;raw&amp;quot; pointing - i.e., if you enter a coordinate and press &amp;quot;slew&amp;quot; - is
usually good to within ~1 arcminute. However, once you're on the target
field, it's up to you as the observer to identify the exact location
within the 5x5' field to observe.
This proves quite challenging in crowded fields, especially with
rotation. It is far more difficult, though, in sparse fields when your
target is a faint emission line feature - there will be no corresponding
light in your guider image. But you still want ~arcsecond pointing
accuracy.
I think this can be achieved by using the astrometry.net source
recognition and field identification tools, but highly constrained to be
within ~10' of the target field. The WCS coordinates would then be
applied to the guider image, and the target location identified and
translated into a telescope pointing offset.
This technique is probably not needed for most spectroscopic
observations (e.g., of bright point sources). However, for
slit-scan-mapping or observations of faint point sources, this approach
provides the opportunity to do fast-switching with a bright calibration
star so that telluric correction can be provided on a short (~5-10
minute) timescale, as is needed for truly accurate calibration.&lt;/p&gt;
&lt;/div&gt;&lt;/p&gt;</content><category term="misc"></category><category term="googlepost"></category><category term="research ideas"></category><category term="astronomy"></category><category term="observing"></category></entry><entry><title>Lognormal Density / IPython Notebook</title><link href="https://keflavich.github.io/blog/lognormal-density-ipython-notebook.html" rel="alternate"></link><published>2012-09-20T20:07:00-06:00</published><updated>2012-09-20T20:07:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/lognormal-density-ipython-notebook.html</id><summary type="html">&lt;p&gt;An experiment with log normal density distributions (simple, pretty
obvious) and a test of including ipython notebooks in blog posts. To do
this, I created a gist (&lt;a class="reference external" href="https://gist.github.com/3750781"&gt;https://gist.github.com/3750781&lt;/a&gt;) and used the
ipython notebook viewer (&lt;a class="reference external" href="http://nbviewer.ipython.org/3750781/"&gt;http://nbviewer.ipython.org/3750781/&lt;/a&gt;) to render
the notebook in HTML. It …&lt;/p&gt;</summary><content type="html">&lt;p&gt;An experiment with log normal density distributions (simple, pretty
obvious) and a test of including ipython notebooks in blog posts. To do
this, I created a gist (&lt;a class="reference external" href="https://gist.github.com/3750781"&gt;https://gist.github.com/3750781&lt;/a&gt;) and used the
ipython notebook viewer (&lt;a class="reference external" href="http://nbviewer.ipython.org/3750781/"&gt;http://nbviewer.ipython.org/3750781/&lt;/a&gt;) to render
the notebook in HTML. It worked pretty well; all I had to do was c&amp;amp;p the
source and then change 2 lines of the style (background color -&amp;gt; black,
foreground color -&amp;gt; white for the markup... maybe I should do it for the
rest too).&lt;/p&gt;
&lt;p&gt;Comparison of the derived power spectra and density PDFs for lognormal
power distributions. Obviously (if you think about it), the power
spectra are always flat for randomly distributed signal. The PDFs change
significantly.&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="research notes"></category><category term="ipython notebook"></category></entry><entry><title>Research idea: NIR variation</title><link href="https://keflavich.github.io/blog/research-idea-nir-variation.html" rel="alternate"></link><published>2012-09-20T20:07:00-06:00</published><updated>2012-09-20T20:07:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/research-idea-nir-variation.html</id><summary type="html">&lt;p&gt;&lt;a class="reference external" href="http://www.adamgginsburg.com/index.htm"&gt;I&lt;/a&gt;&amp;nbsp;really want to know how near-infrared absorption lines correlate
with emission lines; understanding this is essential for near infrared
calibration.&lt;/p&gt;
&lt;img alt="" src="http://3.bp.blogspot.com/-g_ixmCtNH6c/UEbiTCymILI/AAAAAAAAHNc/WabU1JlWoVo/s320/nightskycorrelation_test.png" /&gt;
&lt;p&gt;The emission lines correlate reasonably well, but not perfectly. &amp;nbsp;There
are models out there of how these should behave, but they seem to be
proprietary and non-free so I …&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;a class="reference external" href="http://www.adamgginsburg.com/index.htm"&gt;I&lt;/a&gt;&amp;nbsp;really want to know how near-infrared absorption lines correlate
with emission lines; understanding this is essential for near infrared
calibration.&lt;/p&gt;
&lt;img alt="" src="http://3.bp.blogspot.com/-g_ixmCtNH6c/UEbiTCymILI/AAAAAAAAHNc/WabU1JlWoVo/s320/nightskycorrelation_test.png" /&gt;
&lt;p&gt;The emission lines correlate reasonably well, but not perfectly. &amp;nbsp;There
are models out there of how these should behave, but they seem to be
proprietary and non-free so I have no interest in them - I won't pay
before I know they work, and I can't test them.
But perhaps more careful measurements of the night sky lines could
provide some information about the absorption, particularly in the
Brackett-delta and Brackett-epsilon region we've been interested in
lately.
I'm pretty sure the change in slope observed above is from observing at
different airmasses (2.3 vs 1.05)&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="research ideas"></category></entry><entry><title>Research Idea: Stacking Finders</title><link href="https://keflavich.github.io/blog/research-idea-stacking-finders.html" rel="alternate"></link><published>2012-09-20T20:07:00-06:00</published><updated>2012-09-20T20:07:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/research-idea-stacking-finders.html</id><summary type="html">&lt;div dir="ltr" style="text-align: left;"&gt;&lt;p&gt;Idea: Stack all of the finders from spectroscopic observations. &amp;nbsp;Finder
images tend to be on lower-quality CCDs with no filter, but they
frequently produce very deep observations. &amp;nbsp;For example, the open K-band
finder on TripleSpec (though it's technically not a CCD).&lt;/p&gt;
&lt;div&gt;&lt;/div&gt;&lt;div&gt;&lt;p&gt;In order to stack them, you would need to …&lt;/p&gt;&lt;/div&gt;&lt;/div&gt;</summary><content type="html">&lt;div dir="ltr" style="text-align: left;"&gt;&lt;p&gt;Idea: Stack all of the finders from spectroscopic observations. &amp;nbsp;Finder
images tend to be on lower-quality CCDs with no filter, but they
frequently produce very deep observations. &amp;nbsp;For example, the open K-band
finder on TripleSpec (though it's technically not a CCD).&lt;/p&gt;
&lt;div&gt;&lt;/div&gt;&lt;div&gt;&lt;p&gt;In order to stack them, you would need to mask out the bad pixels
(already done) and compute astrometic solutions for the CCD. &amp;nbsp;Un-warping
the images will take some work, but there should be plenty of
information available from thousands of observations of different fields
to make this computation nearly ideal. &amp;nbsp;Similarly, it should be possible
to calibrate different pixels on the imager based on response to 2MASS
standards.&lt;/p&gt;
&lt;/div&gt;&lt;div&gt;&lt;/div&gt;&lt;div&gt;&lt;p&gt;Applications? &amp;nbsp;Very deep imaging of spectroscopic targets. &amp;nbsp;Short- and
long-term variability (typical finder cadence is ~a few seconds). &amp;nbsp;Deep
imaging around stars and galaxies of interest - probably far deeper than
you could get with classical observing requests.&lt;/p&gt;
&lt;/div&gt;&lt;div&gt;&lt;/div&gt;&lt;div&gt;&lt;p&gt;This project should be achievable by a motivated undergraduate, but I
think the tools for astrometric solutions need to be in place first.
&amp;nbsp;Astrometry.net is a great tool for this, but I think operates on
spatial scales that are too large. &amp;nbsp;Once basic astrometric solutions are
available (e.g., pointing center for the image), I think IRAF tools
could be automated to compute the complete solution, which would then be
applied to all images.&lt;/p&gt;
&lt;/div&gt;&lt;div&gt;&lt;/div&gt;&lt;div&gt;&lt;p&gt;Calibration might end up being the most challenging component, since
there is variable atmospheric emission (absorption) that is not filtered
by the finder. &amp;nbsp;Depending on the application, though, large calibration
errors may be acceptable. &amp;nbsp;i.e., for deep nebular observations,
morphology will be more important than absolute brightness, since the
line responsible for the brightness cannot be directly determined.
&amp;nbsp;Whereas, for variability, calibration is important, but it can be
computed directly from other stars in the field.&lt;/p&gt;
&lt;/div&gt;&lt;/div&gt;&lt;/p&gt;</content><category term="misc"></category><category term="googlepost"></category><category term="research ideas"></category><category term="observing"></category></entry><entry><title>#6 on Astro-ph today</title><link href="https://keflavich.github.io/blog/6-on-astro-ph-today.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/6-on-astro-ph-today.html</id><content type="html">&lt;p&gt;&lt;a class="reference external" href="http://arxiv.org/abs/0910.2990"&gt;IRAS 05358 on astro-ph&lt;/a&gt;. Check out &lt;a class="reference external" href="http://casa.colorado.edu/~ginsbura/iras05358.htm"&gt;my page on the region&lt;/a&gt; too.&lt;/p&gt;
</content><category term="misc"></category><category term="googleblog"></category><category term="astronomy"></category></entry><entry><title>Acquiring DSS images</title><link href="https://keflavich.github.io/blog/acquiring-dss-images.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/acquiring-dss-images.html</id><content type="html">&lt;p&gt;This is the way to get DSS images:
&lt;a class="reference external" href="http://archive.eso.org/cms/tools-documentation/the-eso-st-ecf-digitized-sky-survey-application"&gt;ESO's batch downloader&lt;/a&gt;&lt;/p&gt;
</content><category term="misc"></category><category term="googleblog"></category><category term="astronomy"></category></entry><entry><title>Another attempt to get 64 bit python on Snow Leopard</title><link href="https://keflavich.github.io/blog/another-attempt-to-get-64-bit-python-on-snow-leopard.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/another-attempt-to-get-64-bit-python-on-snow-leopard.html</id><content type="html">&lt;p&gt;Sam Skillman posted &lt;a class="reference external" href="http://casa.colorado.edu/~skillman/research_and_codes/files/5426de84108df075adee2e9a5c23d90e-4.html"&gt;his attempt to get 64 bit python on snow leopard&lt;/a&gt;.
It worked, but you need to install python with --enable-framework and
NOT --prefix and NOT --enable-universalSDK. It is 64-bit only, not
universal: universal causes trouble.&lt;/p&gt;
</content><category term="misc"></category><category term="googleblog"></category><category term="python"></category><category term="mac"></category></entry><entry><title>apache/php/mysql on snow leopard</title><link href="https://keflavich.github.io/blog/apachephpmysql-on-snow-leopard.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/apachephpmysql-on-snow-leopard.html</id><content type="html">&lt;p&gt;&lt;a class="reference external" href="http://maestric.com/doc/mac/apache_php_mysql_snow_leopard"&gt;This post&lt;/a&gt; helped me out&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="mac"></category><category term="computer"></category></entry><entry><title>API documentation on agpy</title><link href="https://keflavich.github.io/blog/api-documentation-on-agpy.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/api-documentation-on-agpy.html</id><content type="html">&lt;p&gt;I finally processed agpy through sphinx and made some nice html
documentation.
&lt;a class="reference external" href="http://agpy.googlecode.com/svn/trunk/doc/html/agpy.html"&gt;http://agpy.googlecode.com/svn/trunk/doc/html/agpy.html&lt;/a&gt;&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="code"></category></entry><entry><title>Applescripting out that VIM error</title><link href="https://keflavich.github.io/blog/applescripting-out-that-vim-error.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/applescripting-out-that-vim-error.html</id><summary type="html">&lt;p&gt;&lt;p&gt;I have a frequent problem where my VIM window is too large for my
macbook screen but it fits on my external monitor, so when I unplug the
external the VIM file bar gets stuck behind the Mac OS menu bar. It's a
huge pain to fix this normally, but …&lt;/p&gt;&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;p&gt;I have a frequent problem where my VIM window is too large for my
macbook screen but it fits on my external monitor, so when I unplug the
external the VIM file bar gets stuck behind the Mac OS menu bar. It's a
huge pain to fix this normally, but I wrote/stole an applescript to fix
the problem:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
try    tell application &amp;quot;Vim&amp;quot;        activate    end tell    tell application &amp;quot;System Events&amp;quot;        tell process &amp;quot;Vim&amp;quot;            set size of the first window to {1000, 200}            set position of the first window to {50, 50}        end tell    end tellend try
&lt;/pre&gt;
&lt;/p&gt;</content><category term="misc"></category><category term="googlepost"></category><category term="computer"></category></entry><entry><title>Art mimicing reality</title><link href="https://keflavich.github.io/blog/art-mimicing-reality.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/art-mimicing-reality.html</id><content type="html">&lt;p&gt;An artist who likes painting astronomical objects:
&lt;a class="reference external" href="http://web.me.com/mariannebeacham/Manifestations/Gallery_I.html"&gt;Marianne Beacham Gallery&lt;/a&gt;&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="art"></category></entry><entry><title>astro-better post</title><link href="https://keflavich.github.io/blog/astro-better-post.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/astro-better-post.html</id><content type="html">&lt;p&gt;I &lt;a class="reference external" href="http://www.astrobetter.com/analysis/better-ways-to-make-large-image-mosiacs/"&gt;contributed to a post&lt;/a&gt; on &lt;a class="reference external" href="http://www.astrobetter.com/"&gt;Astro Better&lt;/a&gt; asking about mosaicing
software.&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="astronomy"></category><category term="meta"></category></entry><entry><title>Astronomy gets some recognition</title><link href="https://keflavich.github.io/blog/astronomy-gets-some-recognition.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/astronomy-gets-some-recognition.html</id><content type="html">&lt;p&gt;First off, &lt;a class="reference external" href="http://www.cfa.harvard.edu/%7Ereid/"&gt;this guy&lt;/a&gt; does some amazing work, like &lt;a class="reference external" href="http://arxiv.org/abs/0902.3913"&gt;measuring the
galactic rotation curve&lt;/a&gt;. He got recognized by the &lt;a class="reference external" href="http://www.colbertnation.com/the-colbert-report-videos/215963/january-14-2009/little-victories---america-s-galaxy-is-big"&gt;Colbert Report&lt;/a&gt;.
Sweet.&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category></entry><entry><title>Awk sexagesimal to decimal conversion</title><link href="https://keflavich.github.io/blog/awk-sexagesimal-to-decimal-conversion.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/awk-sexagesimal-to-decimal-conversion.html</id><summary type="html">&lt;p&gt;In VIM I often need to convert columns of RA/Dec from Sexagesimal into
Decimal format.
&lt;tt class="docutils literal"&gt;%!awk '{ra = &lt;span class="pre"&gt;($2+$3/60+$4/3600)*15;&lt;/span&gt; dec = &lt;span class="pre"&gt;$6+$7/60+$8/3600;&lt;/span&gt; print &lt;span class="pre"&gt;$1,&amp;quot;ra=&amp;quot;,ra,&amp;quot;,&lt;/span&gt;&amp;nbsp; dec=&amp;nbsp; &lt;span class="pre"&gt;&amp;quot;,$5,dec}'&lt;/span&gt;&lt;/tt&gt;
The far more irritating inverse operation:
`` %!awk '{h=($2/15); h=h-(h …&lt;/p&gt;</summary><content type="html">&lt;p&gt;In VIM I often need to convert columns of RA/Dec from Sexagesimal into
Decimal format.
&lt;tt class="docutils literal"&gt;%!awk '{ra = &lt;span class="pre"&gt;($2+$3/60+$4/3600)*15;&lt;/span&gt; dec = &lt;span class="pre"&gt;$6+$7/60+$8/3600;&lt;/span&gt; print &lt;span class="pre"&gt;$1,&amp;quot;ra=&amp;quot;,ra,&amp;quot;,&lt;/span&gt;&amp;nbsp; dec=&amp;nbsp; &lt;span class="pre"&gt;&amp;quot;,$5,dec}'&lt;/span&gt;&lt;/tt&gt;
The far more irritating inverse operation:
`` %!awk '{h=($2/15); h=h-(h%1);  m=($2-h*15)/15*60; m=m-(m%1); s=($2-h*15-m*15/60)/15*3600; d=-($3-$3%1); am=(-$3-d)*60; am=am-(am%1); as=(-$3-d-am/60)*3600; printf &amp;quot;%s  %02i:%02i:%02.2f,  -%02i:%02i:%02.2f   %s  %s  %sn&amp;quot; , $1,h,m,s,d,am,as,$4,$5,$6}'   ``&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="astronomy"></category><category term="computer"></category></entry><entry><title>Back to site editing</title><link href="https://keflavich.github.io/blog/back-to-site-editing.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/back-to-site-editing.html</id><summary type="html">&lt;p&gt;I'm editing class web pages, php, cgi, etc. again. I don't think I ever
really understood how to do this, but I'd like to know how to use PHP to
fold text. That would be sweet.
I found it by googling this time.
This is really the right way to …&lt;/p&gt;</summary><content type="html">&lt;p&gt;I'm editing class web pages, php, cgi, etc. again. I don't think I ever
really understood how to do this, but I'd like to know how to use PHP to
fold text. That would be sweet.
I found it by googling this time.
This is really the right way to do things:
&lt;a class="reference external" href="http://help.blogger.com/bin/answer.py?hl=en&amp;amp;answer=42214"&gt;http://help.blogger.com/bin/answer.py?hl=en&amp;amp;answer=42214&lt;/a&gt;
Of course, it's pretty disappointing that it doesn't work with the
non-classic template for blogger.&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="computer"></category></entry><entry><title>BASH discoveries, readline questions</title><link href="https://keflavich.github.io/blog/bash-discoveries-readline-questions.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/bash-discoveries-readline-questions.html</id><summary type="html">&lt;p&gt;1. `` shopt -p ``
Maybe my hostname completion worked and then stopped working because the
bash option hostcomplete was not set. Duh! Why? I don't know. Anyway,
`` shopt -s hostcomplete`` solves the problem.
`` nocaseglob `` is also pretty cool (case insensitive tab completion)
2. it's really hard to search for readline stuff …&lt;/p&gt;</summary><content type="html">&lt;p&gt;1. `` shopt -p ``
Maybe my hostname completion worked and then stopped working because the
bash option hostcomplete was not set. Duh! Why? I don't know. Anyway,
`` shopt -s hostcomplete`` solves the problem.
`` nocaseglob `` is also pretty cool (case insensitive tab completion)
2. it's really hard to search for readline stuff on google. Can anyone
explain to me how BASH readline works? I would REALLY like to make bash
readline work like ipython, in which you can start typing a command and
hit the 'up' key to search through the history for anything beginning
with the stuff you've typed up to that point. But I can't even find
documentation for the ipython readline! Any hints, anyone?
3. my desktop at work blocks ssh connections. I can ssh into some
computers and then into it, but not directly into it.
...as usual, I made a list where not-a-list would have sufficed, and I
had to add the last thing because a 2-item list is dumb.&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="bash"></category><category term="python"></category><category term="unix"></category><category term="computer"></category></entry><entry><title>BGPS public release</title><link href="https://keflavich.github.io/blog/bgps-public-release.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/bgps-public-release.html</id><content type="html">&lt;p&gt;&lt;a class="reference external" href="http://irsa.ipac.caltech.edu/"&gt;http://irsa.ipac.caltech.edu/&lt;/a&gt;&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="bgps"></category></entry><entry><title>CGI errors on Origins</title><link href="https://keflavich.github.io/blog/cgi-errors-on-origins.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/cgi-errors-on-origins.html</id><content type="html">&lt;p&gt;&lt;p&gt;First step:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
tail -f /usr/local/apache/logs/casa/casa_error_log
&lt;/pre&gt;
&lt;p&gt;Then, make sure .htaccess has the right lines.&lt;/p&gt;
&lt;pre class="literal-block"&gt;
AddType text/html  .htmAddHandler application/x-httpd-php .php .htmAddHandler server-parsed .htm .htmlAddHandler cgi-script .cgi .pl
&lt;/pre&gt;
&lt;/p&gt;</content><category term="misc"></category><category term="googlepost"></category><category term="computer"></category></entry><entry><title>command line &amp; escape key</title><link href="https://keflavich.github.io/blog/command-line-escape-key.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/command-line-escape-key.html</id><content type="html">&lt;p&gt;Problem: in both the bash command line and ipython, if I hit escape
twice, I can never again do history-search-backwards (i.e. when you type
part of a command and type &amp;quot;up&amp;quot; and reverse-search through your command
history). Any idea how to fix this?&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="python"></category><category term="computer"></category></entry><entry><title>Command of the Day</title><link href="https://keflavich.github.io/blog/command-of-the-day.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/command-of-the-day.html</id><content type="html">&lt;p&gt;`` ls | wc ``
and for when `` ls * `` fails
`` find . -name &amp;quot;*&amp;quot; | xargs -I {} mv {} away/ ``&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="computer"></category></entry><entry><title>Compiling vim...</title><link href="https://keflavich.github.io/blog/compiling-vim.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/compiling-vim.html</id><summary type="html">&lt;p&gt;Figured I had to post this...
I've been trying to compile command-line vim 7.3 on Mac OS X 10.7. I
have the latest `hg clone`d version of vim. I'm stuck on ncurses.
If I `./configure` with no options, I get the following error:
checking --with-tlib argument... empty …&lt;/p&gt;</summary><content type="html">&lt;p&gt;Figured I had to post this...
I've been trying to compile command-line vim 7.3 on Mac OS X 10.7. I
have the latest `hg clone`d version of vim. I'm stuck on ncurses.
If I `./configure` with no options, I get the following error:
checking --with-tlib argument... empty: automatic terminal library
selection
checking for tgetent in -ltinfo... no
checking for tgetent in -lncurses... no
checking for tgetent in -ltermlib... no
checking for tgetent in -ltermcap... no
checking for tgetent in -lcurses... no
no terminal library found
checking for tgetent()... configure: error: NOT FOUND!
You need to install a terminal library; for example ncurses.
Or specify the name of the library with --with-tlib.
If instead I try `./configure --with-tlib=ncurses`
checking --with-tlib argument... ncurses
checking for linking with ncurses library... configure: error: FAILED
I have Xcode 4.1. As far as I can tell, ncurses is available:
$ file /usr/lib/libncurses.*
/usr/lib/libncurses.5.4.dylib: Mach-O universal binary with 2
architectures
/usr/lib/libncurses.5.4.dylib (for architecture x86_64): Mach-O 64-bit
dynamically linked shared library x86_64
/usr/lib/libncurses.5.4.dylib (for architecture i386): Mach-O
dynamically linked shared library i386
/usr/lib/libncurses.5.dylib: Mach-O dynamically linked shared library
i386
/usr/lib/libncurses.dylib: Mach-O universal binary with 2 architectures
/usr/lib/libncurses.dylib (for architecture x86_64): Mach-O 64-bit
dynamically linked shared library x86_64
/usr/lib/libncurses.dylib (for architecture i386): Mach-O dynamically
linked shared library i386
Then I changed my PATH from /usr/local/bin... to /usr/bin.....
The problem was trying to use my /usr/local/bin/gcc instead of the mac
default /usr/bin/gcc. Something about my locally installed gcc (4.6.1)
caused major problems.
I also eventually had to do this command:
LDFLAGS=-L/usr/lib CFLAGS='-arch i386 -arch x86_64' CCFLAGS='-arch i386
-arch x86_64' CXXFLAGS='-arch i386 -arch x86_64' ./configure
--enable-perlinterp --enable-pythoninterp --enable-cscope
--with-features=huge
and then had to make sure my default python was NOT pointing to
enthought!&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="install"></category><category term="vim"></category></entry><entry><title>Comps 2 reflections</title><link href="https://keflavich.github.io/blog/comps-2-reflections.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/comps-2-reflections.html</id><summary type="html">&lt;p&gt;Comps 2 included some successes and some failures.
The most successful part of my Comps preparation was the Monday talk.
The previous talk on Tuesday was somewhat helpful in terms of realizing
that I needed larger figure axes, but otherwise provided no useful
feedback. The Monday talk allowed me to …&lt;/p&gt;</summary><content type="html">&lt;p&gt;Comps 2 included some successes and some failures.
The most successful part of my Comps preparation was the Monday talk.
The previous talk on Tuesday was somewhat helpful in terms of realizing
that I needed larger figure axes, but otherwise provided no useful
feedback. The Monday talk allowed me to realize what needed to be done
to make my talk accessible to a larger audience.
At the defense, I ended up going only ~40 minutes despite having gone
far over time in the Monday version and spending ~5 minutes answering
questions from Don and Mike. I think that was a good thing; I didn't
need to say anything more even though there was an enormous amount of
additional material I could have covered.
The main change I made from Monday to Friday was reorganizing such that
I discussed the largest scales first and zoomed in, and I spent much
more time discussing the larger context of my work. Unfortunately, I
also spent most of the week before the presentation determining the
larger context and reading papers. Ideally, I would have done that
before handing in the paper.
The closed door Q&amp;amp;A section went OK but not great. There were a few
important bits of information related to the IMF that I didn't know off
the top of my head - e.g. the ratio of total # of stars to the # of B
stars. I got the lowest mass star (.07) confused with the most common
star mass (.3). I wasn't particularly able to integrated the IMF on the
board either. I didn't remember the Jeans mass-temperature and
mass-density relationships but was able to derive them quickly enough.
Probably the biggest problem was dealing with a question about the
partition function - specifically how did the partition function come
into play in the column density equation. I didn't come up with the
right answer at all, and in particular quoted the wrong distribution.
However, I think a big part of what they expected to hear was a
dependence on temperature AND degeneracy, and I never explicitly
mentioned degeneracy. It turned out that the equation I had quoted in
both the paper and the talk was correct, but I couldn't come anywhere
close to proving that on the spot.
My expected result is therefore a low pass, though it was not made
explicit. That's rather unfortunate as it's possible that another month
of preparation could have gotten me the high pass, but at the same time,
it's well worth having the project done.&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="grad school"></category></entry><entry><title>Connecting to ipython notebook with SSH tunneling</title><link href="https://keflavich.github.io/blog/connecting-to-ipython-notebook-with-ssh-tunneling.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/connecting-to-ipython-notebook-with-ssh-tunneling.html</id><summary type="html">&lt;div dir="ltr" style="text-align: left;"&gt;&lt;div dir="ltr" style="text-align: left;"&gt;&lt;p&gt;My typical ssh tunnel looks something like:
&lt;tt class="docutils literal"&gt;ssh &lt;span class="pre"&gt;-N&lt;/span&gt; &lt;span class="pre"&gt;-f&lt;/span&gt; &lt;span class="pre"&gt;-L&lt;/span&gt; 8889:SERVER.colorado.edu:8889 ginsbura&amp;#64;SERVER.colorado.edu&lt;/tt&gt;&lt;/p&gt;
&lt;/div&gt;&lt;p&gt;For ipython notebooks, this approach was giving me the error:
`` channel 2: open failed: connect failed: Connection refused``.
The ipython notebook is at &lt;a class="reference external" href="http://127.0.0.1:8888/"&gt;http://127.0.0.1:8888/&lt;/a&gt; locally …&lt;/p&gt;&lt;/div&gt;</summary><content type="html">&lt;div dir="ltr" style="text-align: left;"&gt;&lt;div dir="ltr" style="text-align: left;"&gt;&lt;p&gt;My typical ssh tunnel looks something like:
&lt;tt class="docutils literal"&gt;ssh &lt;span class="pre"&gt;-N&lt;/span&gt; &lt;span class="pre"&gt;-f&lt;/span&gt; &lt;span class="pre"&gt;-L&lt;/span&gt; 8889:SERVER.colorado.edu:8889 ginsbura&amp;#64;SERVER.colorado.edu&lt;/tt&gt;&lt;/p&gt;
&lt;/div&gt;&lt;p&gt;For ipython notebooks, this approach was giving me the error:
`` channel 2: open failed: connect failed: Connection refused``.
The ipython notebook is at &lt;a class="reference external" href="http://127.0.0.1:8888/"&gt;http://127.0.0.1:8888/&lt;/a&gt; locally. Therefore,
the correct ssh tunnel command is:
&lt;tt class="docutils literal"&gt;ssh &lt;span class="pre"&gt;-N&lt;/span&gt; &lt;span class="pre"&gt;-f&lt;/span&gt; &lt;span class="pre"&gt;-L&lt;/span&gt; localhost:8888:localhost:8888 adam&amp;#64;SERVER.colorado.edu&lt;/tt&gt;&lt;/p&gt;
&lt;/div&gt;&lt;/p&gt;</content><category term="misc"></category><category term="googlepost"></category></entry><entry><title>Converting a CLASS-created .fits file to a real (FITS-compliant) FITS file</title><link href="https://keflavich.github.io/blog/converting-a-class-created-fits-file-to-a-real-fits-compliant-fits-file.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/converting-a-class-created-fits-file-to-a-real-fits-compliant-fits-file.html</id><summary type="html">&lt;p&gt;This post is to remind me, the next time I go looking, how the hell to
convert from a GILDAS CLASS fits spectrum (created by
&lt;tt class="docutils literal"&gt;fits write blah.fits /mode spectrum&lt;/tt&gt;) to a FITS-compliant spectrum.
First, remember the FITS-WCS spectral definitions:
&lt;a class="reference external" href="http://www.aanda.org/index.php?option=com_article&amp;amp;access=bibcode&amp;amp;Itemid=129&amp;amp;bibcode=2006A%2526A...446..747GFUL"&gt;http://www.aanda.org/index.php?option=com_article …&lt;/a&gt;&lt;/p&gt;</summary><content type="html">&lt;p&gt;This post is to remind me, the next time I go looking, how the hell to
convert from a GILDAS CLASS fits spectrum (created by
&lt;tt class="docutils literal"&gt;fits write blah.fits /mode spectrum&lt;/tt&gt;) to a FITS-compliant spectrum.
First, remember the FITS-WCS spectral definitions:
&lt;a class="reference external" href="http://www.aanda.org/index.php?option=com_article&amp;amp;access=bibcode&amp;amp;Itemid=129&amp;amp;bibcode=2006A%2526A...446..747GFUL"&gt;http://www.aanda.org/index.php?option=com_article&amp;amp;access=bibcode&amp;amp;Itemid=129&amp;amp;bibcode=2006A%2526A...446..747GFUL&lt;/a&gt;
And the peculiar CLASS definitions:
&lt;a class="reference external" href="http://iram.fr/IRAMFR/GILDAS/doc/html/class-html/node84.html"&gt;http://iram.fr/IRAMFR/GILDAS/doc/html/class-html/node84.html&lt;/a&gt;
Key points:
CLASS stores the CDELT parameter as DELTAV in m/s instead of km/s and
the velocity offset of the spectral frame in VELO-LSR also in m/s.
Things to set:
CTYPE = VRAD
SPECSYS = SOURCE
SSYSSRC = LSRK
VELOSYS = frame velocity (VELO-LSR or CRVAL1)
This information is subject to change...&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category></entry><entry><title>Converting GILDAS-CLASS data cubes (lmv files) to fits</title><link href="https://keflavich.github.io/blog/converting-gildas-class-data-cubes-lmv-files-to-fits.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/converting-gildas-class-data-cubes-lmv-files-to-fits.html</id><content type="html">&lt;p&gt;As usual, CLASS documentation is nearly impossible to navigate. At the
end of the CLASS &amp;quot;introduction&amp;quot; (&lt;a class="reference external" href="iram.fr/IRAMFR/GILDAS/doc/pdf/gildas-intro.pdf"&gt;gildas-intro.pdf&lt;/a&gt;) there is a subtle
and obscure reference to the vector\fits command. The conversion is
actually relatively straightforward:
&lt;tt class="docutils literal"&gt;vector\fits outfile.fits from infile.lmv&lt;/tt&gt;
&lt;a class="reference external" href="http://casa.colorado.edu/~ginsbura/index.htm"&gt;AG&lt;/a&gt;&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="fits"></category><category term="class"></category></entry><entry><title>cython vs f2py</title><link href="https://keflavich.github.io/blog/cython-vs-f2py.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/cython-vs-f2py.html</id><summary type="html">&lt;p&gt;I had a go at optimizing some code this past week, and ended up learning
to use both cython and f2py.
f2py is much easier to use. If you want to write a function in fortran
and use it in python, all you do is write the code and add …&lt;/p&gt;</summary><content type="html">&lt;p&gt;I had a go at optimizing some code this past week, and ended up learning
to use both cython and f2py.
f2py is much easier to use. If you want to write a function in fortran
and use it in python, all you do is write the code and add
specifications using comments in the fortran code.
cython is more natural to code. The code style is C/fortran-like: think
in terms of loops instead of arrays. The syntax is python-like, which
makes coding somewhat clearer and simpler.
For my code, I found that cython was ~10% slower than fortran.
Check out the plfits in:
&lt;a class="reference external" href="http://code.google.com/p/agpy/source/browse/#svn/trunk/"&gt;http://code.google.com/p/agpy/source/browse/#svn/trunk/&lt;/a&gt;&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="python"></category><category term="computer"></category></entry><entry><title>Danger Zone</title><link href="https://keflavich.github.io/blog/danger-zone.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/danger-zone.html</id><content type="html">&lt;p&gt;The Danger Zone: Where the Buffalo Roam.&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category></entry><entry><title>Defining a Molecular Cloud</title><link href="https://keflavich.github.io/blog/defining-a-molecular-cloud.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/defining-a-molecular-cloud.html</id><summary type="html">&lt;p&gt;I'm going to try to answer a few questions [this post is in-progress and
will be updated]:&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;&lt;a class="reference external" href="http://molecularclouds.blogspot.com/2008/08/defining-molecular-cloud.html#one"&gt;Why are molecular clouds called molecular clouds?&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://molecularclouds.blogspot.com/2008/08/defining-molecular-cloud.html#two.htm"&gt;What distinguishes a molecular cloud from similar objects (e.g.
cores, clumps, HII regions)?&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://molecularclouds.blogspot.com/2008/08/defining-molecular-cloud.html#three.htm"&gt;What do molecular clouds look like?&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://molecularclouds.blogspot.com/2008/08/defining-molecular-cloud.html#four.htm"&gt;How do astronomers look at molecular …&lt;/a&gt;&lt;/li&gt;&lt;/ol&gt;</summary><content type="html">&lt;p&gt;I'm going to try to answer a few questions [this post is in-progress and
will be updated]:&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;&lt;a class="reference external" href="http://molecularclouds.blogspot.com/2008/08/defining-molecular-cloud.html#one"&gt;Why are molecular clouds called molecular clouds?&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://molecularclouds.blogspot.com/2008/08/defining-molecular-cloud.html#two.htm"&gt;What distinguishes a molecular cloud from similar objects (e.g.
cores, clumps, HII regions)?&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://molecularclouds.blogspot.com/2008/08/defining-molecular-cloud.html#three.htm"&gt;What do molecular clouds look like?&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://molecularclouds.blogspot.com/2008/08/defining-molecular-cloud.html#four.htm"&gt;How do astronomers look at molecular clouds?&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Why are astronomers look at molecular clouds (why are they
interesting)?&lt;/li&gt;
&lt;li&gt;What do molecular clouds have to do with star formation and planet
formation?&lt;/li&gt;
&lt;li&gt;How are molecular clouds involved in galactic evolution?&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;1. Molecular clouds are regions in space with densities high enough and
temperatures low enough that molecules can form. The most common
molecule is Hydrogen (H:sub:&lt;cite&gt;2&lt;/cite&gt;), simply because hydrogen is the most
common atom. The next most common is Carbon Monoxide, CO, that is
~10&lt;sup&gt;4&lt;/sup&gt; times less common. It is the easiest to observe, though,
because H&lt;sub&gt;2&lt;/sub&gt; can only emit light and energy in 'forbidden'
transitions that don't happen very often.
2. Size, temperature, and composition all distinguish molecular clouds
from other nebulae.&lt;/p&gt;
&lt;dl&gt;&lt;dt&gt;&lt;p&gt;An H II region is very hot - in it, hydrogen atoms are ionized by
radiation from a nearby O-type star. In regions hot enough to ionize
hydrogen, all molecules are destroyed unless they have already collected
into larger dust particles.&lt;/p&gt;
&lt;dt&gt;&lt;p&gt;A core is a much denser bunch of gas than a molecular cloud. Cores are
dense enough that their outsides shield their insides from the radiation
of the rest of the universe and their insides cool to very low
temperatures. At low temperatures, the pressure supporting the cloud
against collapse is lower, and stars can form via gravitational
collapse.&lt;/p&gt;
&lt;dt&gt;&lt;p&gt;I don't really know what clumps are... they're supposed to be something
intermediate between cores and clouds, but I don't know what their
distinguishing features are.&lt;/p&gt;
&lt;/dl&gt;&lt;p&gt;3. It depends on what wavelength you're looking in. In the optical,
where our eyes can see, they look dark - they're seen because they
absorb light from behind them. In the infrared, the hot ones glow, but
the cold ones are still invisible. If you go all the way to the
millimeter, all molecular clouds glow, no matter how cold, but in order
to see them there has to be a lot of material. I'll add some pictures
here later.
4. Lots of ways. Optical telescopes aren't the best choice, though. With
near-infrared images, we can detect molecular clouds by counting stars
and noticing when there aren't as many in some regions. This technique
is called &amp;quot;NICE&amp;quot; and works because there are so many stars in the sky
and dust in molecular clouds includes some, but not all, of their light.
In the far infrared, we can see hot dust glowing, but this is very
difficult because our atmosphere is opaque in the infrared - it's like
trying to look through a brick wall. We need telescopes in space to be
able to see anything at these wavelengths. In the millimeter, there are
some 'holes' in the atmospheric absorption, sort of like color filters,
that we can see through to detect the coldest emission.&lt;/p&gt;
&lt;/p&gt;</content><category term="misc"></category><category term="googlepost"></category><category term="intro"></category></entry><entry><title>Delirium Nocturne</title><link href="https://keflavich.github.io/blog/delirium-nocturne.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/delirium-nocturne.html</id><summary type="html">&lt;p&gt;Delirium Tremens is a tasty beer itself, I think. I'm drinking Delirium
Nocturne right now. It has a cool (opaque!) bottle, plus a pink elephant
on the label. At 8.5% it's pretty strong, but very drinkable with no
taste of alcohol. It's definitely my favorite Belgian brown now. It …&lt;/p&gt;</summary><content type="html">&lt;p&gt;Delirium Tremens is a tasty beer itself, I think. I'm drinking Delirium
Nocturne right now. It has a cool (opaque!) bottle, plus a pink elephant
on the label. At 8.5% it's pretty strong, but very drinkable with no
taste of alcohol. It's definitely my favorite Belgian brown now. It
still has that wheat-soy-sauce taste to it, but very weakly. It poured
with ridiculous head - I could not control it. Overall, great beer,
worth the ridiculous price I paid for it, whatever that was.&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="beer tasting"></category></entry><entry><title>Detexify!</title><link href="https://keflavich.github.io/blog/detexify.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/detexify.html</id><content type="html">&lt;p&gt;for when you can't remember how to draw an angstrom:
&lt;a class="reference external" href="http://detexify.kirelabs.org/classify.html"&gt;detexify&lt;/a&gt;
.. image:: &lt;a class="reference external" href="http://2.bp.blogspot.com/_lsgW26mWZnU/SydQdSeP5EI/AAAAAAAAFds/f8-29Qvef3E/s400/detexify.png"&gt;http://2.bp.blogspot.com/_lsgW26mWZnU/SydQdSeP5EI/AAAAAAAAFds/f8-29Qvef3E/s400/detexify.png&lt;/a&gt;&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="latex"></category></entry><entry><title>Do not install 10.5.5</title><link href="https://keflavich.github.io/blog/do-not-install-1055.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/do-not-install-1055.html</id><summary type="html">&lt;p&gt;Well, I didn't obey that excellent advice from Charles. I installed the
10.5.5 update. Now DS9 - in my opinion, one of the heartiest and most
reliable programs I've dealt with in the astronomy world - won't work
because TCL is broken. I doubt TUI or most of the other …&lt;/p&gt;</summary><content type="html">&lt;p&gt;Well, I didn't obey that excellent advice from Charles. I installed the
10.5.5 update. Now DS9 - in my opinion, one of the heartiest and most
reliable programs I've dealt with in the astronomy world - won't work
because TCL is broken. I doubt TUI or most of the other things I use
will work either. That's a tragedy of significant proportions - I NEED
ds9 to make my observing files! I can only pray that an update of TCL
using port will work... if not I'm basically screwed.&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="computer"></category></entry><entry><title>ds9 commands to test distortion mapping</title><link href="https://keflavich.github.io/blog/ds9-commands-to-test-distortion-mapping.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/ds9-commands-to-test-distortion-mapping.html</id><summary type="html">&lt;p&gt;&lt;p&gt;trying to figure out whether I'm screwing something up in the distortion
map phase... the -scale limits command here is new and useful&lt;/p&gt;
&lt;pre class="literal-block"&gt;
ds9 testfields_*pix5*_map0.fits -cmap sls -scale limits 0 .005 -zoom 4 -match frames wcs -match scales -match colorbars &amp;amp;ds9 testfields_*pix15*_map0.fits -cmap sls …&lt;/pre&gt;&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;p&gt;trying to figure out whether I'm screwing something up in the distortion
map phase... the -scale limits command here is new and useful&lt;/p&gt;
&lt;pre class="literal-block"&gt;
ds9 testfields_*pix5*_map0.fits -cmap sls -scale limits 0 .005 -zoom 4 -match frames wcs -match scales -match colorbars &amp;amp;ds9 testfields_*pix15*_map0.fits -cmap sls -scale limits 0 .003 -zoom 4 -match frames wcs -match scales -match colorbars &amp;amp;ds9 testfields_*pix10*_map0.fits -cmap sls -scale limits 0 .004 -zoom 4 -match frames wcs -match scales -match colorbars &amp;amp;
&lt;/pre&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="ds9"></category><category term="bgps"></category></entry><entry><title>DS9 - crosshairs on command line</title><link href="https://keflavich.github.io/blog/ds9-crosshairs-on-command-line.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/ds9-crosshairs-on-command-line.html</id><summary type="html">&lt;p&gt;&lt;tt class="docutils literal"&gt;ds9 pmm*_map0.fits &lt;span class="pre"&gt;-zscale&lt;/span&gt; &lt;span class="pre"&gt;-match&lt;/span&gt; scales &lt;span class="pre"&gt;-zoom&lt;/span&gt; 4 &lt;span class="pre"&gt;-match&lt;/span&gt; frames wcs &lt;span class="pre"&gt;-crosshair&lt;/span&gt; 17:33:02.7 &lt;span class="pre"&gt;-13:04:49.5&lt;/span&gt; wcs fk5 &lt;span class="pre"&gt;-lock&lt;/span&gt; crosshairs wcs &amp;amp;&lt;/tt&gt;
&lt;tt class="docutils literal"&gt;ds9 pmp*_map0.fits &lt;span class="pre"&gt;-zscale&lt;/span&gt; &lt;span class="pre"&gt;-match&lt;/span&gt; scales &lt;span class="pre"&gt;-zoom&lt;/span&gt; 4 &lt;span class="pre"&gt;-match&lt;/span&gt; frames wcs &lt;span class="pre"&gt;-crosshair&lt;/span&gt; 17:33:02.7 &lt;span class="pre"&gt;-13:04:49.5&lt;/span&gt; wcs fk5 &lt;span class="pre"&gt;-lock …&lt;/span&gt;&lt;/tt&gt;&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;tt class="docutils literal"&gt;ds9 pmm*_map0.fits &lt;span class="pre"&gt;-zscale&lt;/span&gt; &lt;span class="pre"&gt;-match&lt;/span&gt; scales &lt;span class="pre"&gt;-zoom&lt;/span&gt; 4 &lt;span class="pre"&gt;-match&lt;/span&gt; frames wcs &lt;span class="pre"&gt;-crosshair&lt;/span&gt; 17:33:02.7 &lt;span class="pre"&gt;-13:04:49.5&lt;/span&gt; wcs fk5 &lt;span class="pre"&gt;-lock&lt;/span&gt; crosshairs wcs &amp;amp;&lt;/tt&gt;
&lt;tt class="docutils literal"&gt;ds9 pmp*_map0.fits &lt;span class="pre"&gt;-zscale&lt;/span&gt; &lt;span class="pre"&gt;-match&lt;/span&gt; scales &lt;span class="pre"&gt;-zoom&lt;/span&gt; 4 &lt;span class="pre"&gt;-match&lt;/span&gt; frames wcs &lt;span class="pre"&gt;-crosshair&lt;/span&gt; 17:33:02.7 &lt;span class="pre"&gt;-13:04:49.5&lt;/span&gt; wcs fk5 &lt;span class="pre"&gt;-lock&lt;/span&gt; crosshairs wcs &amp;amp;&lt;/tt&gt;
&lt;tt class="docutils literal"&gt;ds9 mpp*_map0.fits &lt;span class="pre"&gt;-zscale&lt;/span&gt; &lt;span class="pre"&gt;-match&lt;/span&gt; scales &lt;span class="pre"&gt;-zoom&lt;/span&gt; 4 &lt;span class="pre"&gt;-match&lt;/span&gt; frames wcs &lt;span class="pre"&gt;-crosshair&lt;/span&gt; 17:33:02.7 &lt;span class="pre"&gt;-13:04:49.5&lt;/span&gt; wcs fk5 &lt;span class="pre"&gt;-lock&lt;/span&gt; crosshairs wcs &amp;amp;&lt;/tt&gt;
&lt;tt class="docutils literal"&gt;ds9 mpm*_map0.fits &lt;span class="pre"&gt;-zscale&lt;/span&gt; &lt;span class="pre"&gt;-match&lt;/span&gt; scales &lt;span class="pre"&gt;-zoom&lt;/span&gt; 4 &lt;span class="pre"&gt;-match&lt;/span&gt; frames wcs &lt;span class="pre"&gt;-crosshair&lt;/span&gt; 17:33:02.7 &lt;span class="pre"&gt;-13:04:49.5&lt;/span&gt; wcs fk5 &lt;span class="pre"&gt;-lock&lt;/span&gt; crosshairs wcs &amp;amp;&lt;/tt&gt;
DS9's crosshairs are extremely useful for checking on WCS coordinate
matching, especially when they can be set precisely using the command
line. I don't know how to set the coordinates exactly interactively...
that may come later.&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="ds9"></category><category term="computer"></category></entry><entry><title>DS9 gaussian fitting</title><link href="https://keflavich.github.io/blog/ds9-gaussian-fitting.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/ds9-gaussian-fitting.html</id><summary type="html">&lt;p&gt;One thing DS9 desperately needs is an interactive gaussian fitter. I
have NOT implemented one yet, but it is high on my to do list. Has
anyone else (googlers?) tried or succeeded in implementing such a thing?
Ideally, something with NO dependencies: if I write one, it will require
python …&lt;/p&gt;</summary><content type="html">&lt;p&gt;One thing DS9 desperately needs is an interactive gaussian fitter. I
have NOT implemented one yet, but it is high on my to do list. Has
anyone else (googlers?) tried or succeeded in implementing such a thing?
Ideally, something with NO dependencies: if I write one, it will require
python, numpy, and probably pyds9 - ick. Straight-up TCL would be very
much preferable.&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="ds9"></category><category term="python"></category></entry><entry><title>Dying Dock</title><link href="https://keflavich.github.io/blog/dying-dock.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/dying-dock.html</id><summary type="html">&lt;p&gt;My dock keeps dying. Repeatedly. Over and over.
Only solution so far:
&lt;tt class="docutils literal"&gt;ps &lt;span class="pre"&gt;-vax&lt;/span&gt; | grep &lt;span class="pre"&gt;-E&lt;/span&gt; &amp;quot;Dock|PID&amp;quot;kill &lt;span class="pre"&gt;-HUP&lt;/span&gt; PIDkill &lt;span class="pre"&gt;-s&lt;/span&gt; SIGCHLD PID&lt;/tt&gt;
And similarly for problems with Chrome + /usr/sbin/mDNSResponder. They
tend to go bad together.... no clues yet from the system logs.
Ironically, the crash reporter …&lt;/p&gt;</summary><content type="html">&lt;p&gt;My dock keeps dying. Repeatedly. Over and over.
Only solution so far:
&lt;tt class="docutils literal"&gt;ps &lt;span class="pre"&gt;-vax&lt;/span&gt; | grep &lt;span class="pre"&gt;-E&lt;/span&gt; &amp;quot;Dock|PID&amp;quot;kill &lt;span class="pre"&gt;-HUP&lt;/span&gt; PIDkill &lt;span class="pre"&gt;-s&lt;/span&gt; SIGCHLD PID&lt;/tt&gt;
And similarly for problems with Chrome + /usr/sbin/mDNSResponder. They
tend to go bad together.... no clues yet from the system logs.
Ironically, the crash reporter seems to fail the most often...&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="computer"></category></entry><entry><title>Electron-Cyclotron Masers from planets around White Dwarves</title><link href="https://keflavich.github.io/blog/electron-cyclotron-masers-from-planets-around-white-dwarves.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/electron-cyclotron-masers-from-planets-around-white-dwarves.html</id><summary type="html">&lt;p&gt;I believe two departures from the stated topic become a rule rather than
an exception. OK, so this is now a blog about generally interesting
astronomical topics.
Today's topic is planets around white dwarves. First, why do we care?
Well, everyone wants to find more planets, and in this case …&lt;/p&gt;</summary><content type="html">&lt;p&gt;I believe two departures from the stated topic become a rule rather than
an exception. OK, so this is now a blog about generally interesting
astronomical topics.
Today's topic is planets around white dwarves. First, why do we care?
Well, everyone wants to find more planets, and in this case we'd be
seeing planets that survived the deaths of their host stars.
When a main sequence star like the sun reaches a certain age (around 10
billion years old for the sun), it expands and cools, becoming a red
giant. At this point, depending on a number of factors including the
mass of the star, it can engulf the planets around it. If this happens,
the planets experience a drag force (think &amp;quot;wind resistance&amp;quot;) as they
move through the star's atmosphere and they spiral in to the center,
where they burn up and are destroyed.&lt;/p&gt;
&lt;img alt="" src="http://1.bp.blogspot.com/_lsgW26mWZnU/SdexrdYSm7I/AAAAAAAAE0A/NtEciMZODrQ/s400/Picture+3.png" /&gt;
&lt;p&gt;However, if the star is just the right size and the planet is in just
the right place, something more interesting may happen. The Red Giant
phase lasts for a few hundred million years, after which it undergoes an
Asymptotic Giant Branch (AGB) phase where it alternately grows and
shrinks. During this phase, it will temporarily engulf a planet, but not
for long enough to destroy it - just long enough to move it inwards a
little bit. Of course, conditions on the planet won't be very pleasant
during this period.&lt;/p&gt;
&lt;img alt="" src="http://upload.wikimedia.org/wikipedia/commons/d/dc/Planetary_nebula_%26_white_dwarf_formation.gif" /&gt;
&lt;p&gt;As shown in the animation, the AGB phase leads into the formation of a
planetary nebula with a white dwarf at the center. If things went right,
a planet could end up close to the white dwarf after the tumultuous
period just described.
This is an exciting proposition because it opens the possibility that we
could detect the planet interacting with the White Dwarf's magnetic
field. You may recall hearing that the Earth has an iron core, which is
why it has a magnetic field surrounding it. A similar planet orbiting a
white dwarf would generate currents, and the electrons would then flow
onto the poles of the white dwarf and show up as hot spots, like on
Jupiter.&lt;/p&gt;
&lt;img alt="" src="http://www.nasa.gov/images/content/170561main_jupiter_aurora_450.jpg" /&gt;
&lt;p&gt;The hot spots would be impossible to spot by normal methods, but on
either side of the hot spots there are big lobes where the electrons
will emit radio light, which is detectable by the best radio arrays on
the ground (e.g. the &lt;a class="reference external" href="http://en.wikipedia.org/wiki/Very_Large_Array"&gt;Very Large Array&lt;/a&gt; and &lt;a class="reference external" href="http://en.wikipedia.org/wiki/LOFAR"&gt;LOFAR&lt;/a&gt;).&lt;/p&gt;
&lt;img alt="" src="http://1.bp.blogspot.com/_lsgW26mWZnU/SdetWZrqe-I/AAAAAAAAEz4/UTUaXEeeWWY/s400/WillesWuFig1.png" /&gt;
&lt;p&gt;Why should we care? Well, besides just detecting the presence of a
planet, we would be able to tell something about the conductivity of its
core, which is very difficult in any other situation. We might also be
able to say whether the planet has a magnetosphere and therefore was
Earth-like. Finally, we could say something definitive about the
eventual fate of the Earth... in about 4.5 billion years.
This post was based on papers by Andrew Willes and Kinwah Wu in &lt;a class="reference external" href="http://cdsads.u-strasbg.fr/abs/2004MNRAS.348..285W"&gt;2004&lt;/a&gt;
and &lt;a class="reference external" href="http://cdsads.u-strasbg.fr/abs/2005A%26A...432.1091W"&gt;2005&lt;/a&gt;.&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="exoplanets"></category></entry><entry><title>Eta Carinae</title><link href="https://keflavich.github.io/blog/eta-carinae.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/eta-carinae.html</id><summary type="html">&lt;p&gt;Post #4 and I'm diverging from the purported theme. But it's Eta
Carinae, it must be discussed!
Eta Carinae is the most amazing object in the sky, in my opinion. It has
been the most active nearby (around 2 kiloparsecs, or 6000 light-years,
distant - close only relative to, say, the …&lt;/p&gt;</summary><content type="html">&lt;p&gt;Post #4 and I'm diverging from the purported theme. But it's Eta
Carinae, it must be discussed!
Eta Carinae is the most amazing object in the sky, in my opinion. It has
been the most active nearby (around 2 kiloparsecs, or 6000 light-years,
distant - close only relative to, say, the Galactic Center or other
galaxies) object in the past few centuries. In 1840 it brightened by a
few magnitudes, and it has been discovered since then that this event
was a huge explosion.
But it wasn't a 'normal' explosion. Most exploding stars blow up and die
in supernovae. Those are awesome events that sometimes completely
annihilate a star and sometimes leave a black hole or neutron star
behind.
This explosion was nearly as powerful as a supernova, but the star is
still there. And it turns out that there are TWO stars there. There are
a number of different theories going around, but this system is
incredibly difficult to observe because there's just &lt;em&gt;so much&lt;/em&gt; stuff
there.
The prevailing theory is that there are two stars, one around 80 solar
masses, the other around 20. Either one of these on its own would be
pretty big, hot, and impressive. Two together is something pretty
impressive - but actually not that uncommon.
Other pairs of hot, massive stars are observed frequently. One example
is WR 40, in which two 80 solar mass stars are orbiting one another. The
curious thing is that most of these massive stars have very circular
orbits, but in Eta Carinae the small star has a very eccentric orbit
around the large star.
One explanation for this - which is not widely accepted yet because it's
very hard to confirm, but it's plausible - is that Eta Carinae used to
be a nearly equal-mass binary system like WR40, but one of the stars
blew off its outer envelope (the outer part of the star) in a huge
explosion, and when it lost this mass its orbit changed. One bit of
evidence in favor of this hypothesis is that the small star has a very
fast wind - 3000 km/s, which is faster than any normal star's wind. Wolf
Rayet stars have winds that fast, though, and they are stars with
blown-off envelopes. It's going to take a lot of skilled observations to
confirm this, though.
Another neat thing is that the smaller star disappears on its closest
approach to the large star. Why? The large star is losing mass at a very
fast rate - about a Jupiter mass every year! That's more than a million
times as fast as the sun is losing its mass in the Solar Wind. All of
this mass loss has an interesting result - you can't see the star, you
only see the outside of its wind. But the small star passes inside the
'sphere' that is producing the wind, and so it's as though the small
star was going inside the large one! You don't see it at all during
closest approach.
I get excited about this star... I'd like to add a lot more on it, and
so you might see Luminous Blue Variables as a recurring theme on this
blog. I hope to post a lot of pictures and add some links to references
too.&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="stars"></category></entry><entry><title>EVLA information</title><link href="https://keflavich.github.io/blog/evla-information.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/evla-information.html</id><content type="html">&lt;p&gt;It has been really hard to find EVLA information like beam size, largest
angular scale, sensitivity, etc. on the VLA pages because all of the
google searches point to old VLA information. The most useful and recent
&lt;a class="reference external" href="http://evlaguides.nrao.edu/index.php?title=Category:Status"&gt;EVLA information on beam size and largest angular scale is here&lt;/a&gt;&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="astronomy"></category></entry><entry><title>Explosion</title><link href="https://keflavich.github.io/blog/explosion.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/explosion.html</id><summary type="html">&lt;p&gt;Our &amp;quot;Workie Ticket&amp;quot;, which was doing its primary in the carboy, popped
its top. It made a mess but should still be healthy... the yeast was
going extremely strong at the way-too-hot 78 degrees it's sitting at
this morning. It already has a fruity aroma, though, so it's likely that …&lt;/p&gt;</summary><content type="html">&lt;p&gt;Our &amp;quot;Workie Ticket&amp;quot;, which was doing its primary in the carboy, popped
its top. It made a mess but should still be healthy... the yeast was
going extremely strong at the way-too-hot 78 degrees it's sitting at
this morning. It already has a fruity aroma, though, so it's likely that
all of our brews are going to be extremely fruity. Bleh.
Our &lt;a class="reference external" href="http://casa.colorado.edu/~ginsbura/sketch_beers.htm"&gt;Honey Brown&lt;/a&gt;, which was excellent at the start, has gotten a bit
too dry and alcoholic. The first few sips have a strong flavor of
alcohol to them. However, once you get into the beer, it gains a little
bit of depth and isn't too bad... probably the alcohol talking. I think
most of the bottles are probably overcarbonated at this point, but we
only have a few left. Overall point: Honey beers need to be drunk within
about a week of bottling for peak deliciousness; apparently honey dries
out very strongly.&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="brewing"></category><category term="beer tasting"></category></entry><entry><title>Extracting figures from papers</title><link href="https://keflavich.github.io/blog/extracting-figures-from-papers.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/extracting-figures-from-papers.html</id><summary type="html">&lt;p&gt;I want to automatically extract figures from papers, but of course most
papers come in .pdf, not .ps form...
This site has a great tool for extracting figures from .ps papers:
&lt;a class="reference external" href="http://www-hermes.desy.de/notes/extras/postscript.html"&gt;http://www-hermes.desy.de/notes/extras/postscript.html&lt;/a&gt;
If anyone can tell me how to do the same thing …&lt;/p&gt;</summary><content type="html">&lt;p&gt;I want to automatically extract figures from papers, but of course most
papers come in .pdf, not .ps form...
This site has a great tool for extracting figures from .ps papers:
&lt;a class="reference external" href="http://www-hermes.desy.de/notes/extras/postscript.html"&gt;http://www-hermes.desy.de/notes/extras/postscript.html&lt;/a&gt;
If anyone can tell me how to do the same thing for .pdfs (automatically
extract figures from pdfs) I'd appreciate it.
Update 12/13/08: One solution is listed at
&lt;a class="reference external" href="http://ubuntuforums.org/showthread.php?t=884002"&gt;http://ubuntuforums.org/showthread.php?t=884002&lt;/a&gt;: use pdfimages, part
of the xpdf package.&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="computer"></category><category term="postscript"></category></entry><entry><title>Failure to compile 64 bit gtk on mac os</title><link href="https://keflavich.github.io/blog/failure-to-compile-64-bit-gtk-on-mac-os.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/failure-to-compile-64-bit-gtk-on-mac-os.html</id><summary type="html">&lt;p&gt;Attempted to install gtk+-2.17.2 on my mac. Had to install:
&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;glib-2.21.2&lt;/span&gt;&lt;/tt&gt;
which would not let me compile with multiple architectures, and
&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;pkgconfig-0.9.0,&lt;/span&gt;&lt;/tt&gt;
which won't configure because:
&lt;tt class="docutils literal"&gt;configure: configuring in &lt;span class="pre"&gt;glib-1.2.8configure:&lt;/span&gt; running /bin/sh &lt;span class="pre"&gt;'./configure'&lt;/span&gt; &lt;span class="pre"&gt;--prefix=/usr/local&lt;/span&gt;&amp;nbsp; CC= CFLAGS= LDFLAGS= &lt;span class="pre"&gt;--cache-file …&lt;/span&gt;&lt;/tt&gt;&lt;/p&gt;</summary><content type="html">&lt;p&gt;Attempted to install gtk+-2.17.2 on my mac. Had to install:
&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;glib-2.21.2&lt;/span&gt;&lt;/tt&gt;
which would not let me compile with multiple architectures, and
&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;pkgconfig-0.9.0,&lt;/span&gt;&lt;/tt&gt;
which won't configure because:
&lt;tt class="docutils literal"&gt;configure: configuring in &lt;span class="pre"&gt;glib-1.2.8configure:&lt;/span&gt; running /bin/sh &lt;span class="pre"&gt;'./configure'&lt;/span&gt; &lt;span class="pre"&gt;--prefix=/usr/local&lt;/span&gt;&amp;nbsp; CC= CFLAGS= LDFLAGS= &lt;span class="pre"&gt;--cache-file=/dev/null&lt;/span&gt; &lt;span class="pre"&gt;--srcdir=.configure:&lt;/span&gt; warning: CC=: invalid host typeconfigure: warning: CFLAGS=: invalid host typeconfigure: error: can only configure for one host and one target at a timeconfigure: error: /bin/sh &lt;span class="pre"&gt;'./configure'&lt;/span&gt; failed for &lt;span class="pre"&gt;glib-1.2.8&lt;/span&gt;&lt;/tt&gt;
which is bs because I don't have any compiler flags set.&lt;/p&gt;
&lt;p&gt;So, gtk+ seems hopeless.
UPDATE: 0.9.0 is not the latest version, 0.23.0 is. Dumb version
numbering.&lt;/p&gt;
&lt;p&gt;GTK is absurd to install. You need:&lt;/p&gt;
&lt;blockquote&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;pkg-config&lt;/li&gt;
&lt;li&gt;glib&lt;/li&gt;
&lt;li&gt;cairo&lt;/li&gt;
&lt;li&gt;pixman&lt;/li&gt;
&lt;li&gt;pango (MUST be installed AFTER cairo)&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://ftp.gnome.org/pub/gnome/sources/atk/"&gt;atk&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="ftp://ftp.remotesensing.org/pub/libtiff/"&gt;libtiff&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://www.ijg.org/"&gt;libjpg&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://www.openjpeg.org/index.php"&gt;jpeg2000&lt;/a&gt; - but I just passed a flag to not do this because it didn't install right. &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;--without-libjasper&lt;/span&gt;&lt;/tt&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://fontconfig.org/wiki/"&gt;fontconfig&lt;/a&gt; I mean, really? at this point it's just ridiculous....&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;p&gt;and finally, it died with this:
checking Pango flags... configure: error:&lt;/p&gt;
&lt;dl class="docutils"&gt;
&lt;dt&gt;::&lt;/dt&gt;
&lt;dd&gt;*** Pango not found. Pango built with Cairo support is required
*** to build GTK+. See &lt;a class="reference external" href="http://www.pango.org"&gt;http://www.pango.org&lt;/a&gt; for Pango information.&lt;/dd&gt;
&lt;/dl&gt;
&lt;p&gt;which meant that I had to reinstall Pango because I had installed it
before Cairo.&lt;/p&gt;
&lt;p&gt;I believe this is where the term &lt;a class="reference external" href="http://en.wikipedia.org/wiki/Dependency_hell"&gt;dependency hell&lt;/a&gt; comes from.&lt;/p&gt;
&lt;p&gt;Also, I don't think any of these are x86-64 compatible.&lt;/p&gt;
&lt;p&gt;Then I'm STILL not done.
PyGTK dies with an import error on dsextras, which a painful google
search traces to pygobject. pygobject makes and installs fine.... but
then I find out it installed to
/usr/local/lib/python2.6/site-packages/gtk-2.0/, which is obviously not
on my python path since I installed a framework.&lt;/p&gt;
&lt;p&gt;So:
&lt;tt class="docutils literal"&gt;./configure &lt;span class="pre"&gt;--prefix=/Library/Frameworks/Python.framework/Versions/2.6/&lt;/span&gt;&lt;/tt&gt;
in both pygobject and pygtk.&lt;/p&gt;
&lt;p&gt;Oh, guess what? Need pycairo too. What happens there? What you'd guess:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
ld warning: in /Developer/SDKs/MacOSX10.5.sdk/usr/local/lib/libcairo.dylib, file is not of required architecture
&lt;/pre&gt;
&lt;p&gt;so when I configure pygtk:&lt;/p&gt;
&lt;dl class="docutils"&gt;
&lt;dt&gt;The following modules will be built:&lt;/dt&gt;
&lt;dd&gt;&lt;ul class="first last simple"&gt;
&lt;li&gt;atk&lt;/li&gt;
&lt;li&gt;pango&lt;/li&gt;
&lt;/ul&gt;
&lt;/dd&gt;
&lt;dt&gt;The following modules will NOT be built:&lt;/dt&gt;
&lt;dd&gt;&lt;ul class="first last simple"&gt;
&lt;li&gt;pangocairo&lt;/li&gt;
&lt;li&gt;gtk&lt;/li&gt;
&lt;li&gt;gtk.glade&lt;/li&gt;
&lt;li&gt;gtk.unixprint&lt;/li&gt;
&lt;/ul&gt;
&lt;/dd&gt;
&lt;/dl&gt;
&lt;p&gt;Damn. That blows.&lt;/p&gt;
&lt;pre class="literal-block"&gt;
python-64 -c &amp;quot;import gtk&amp;quot;
ImportError:
dlopen(/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/gtk-2.0/glib/\_glib.so,
2): no suitable image found. Did find:

/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/gtk-2.0/glib/\_glib.so:
mach-o, but wrong architecture
&lt;/pre&gt;
&lt;p&gt;FAIL.&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="computer"></category></entry><entry><title>fermentation</title><link href="https://keflavich.github.io/blog/fermentation.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/fermentation.html</id><content type="html">&lt;p&gt;ideas + beer. Same process. They catalyze each other.&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="beer"></category></entry><entry><title>figure*</title><link href="https://keflavich.github.io/blog/figure.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/figure.html</id><content type="html">&lt;p&gt;to make figures/deluxetables span the page in LaTeX:
\begin{figure*}
...
\end{figure*}&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="latex"></category></entry><entry><title>Filled step plots in matplotlib</title><link href="https://keflavich.github.io/blog/filled-step-plots-in-matplotlib.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/filled-step-plots-in-matplotlib.html</id><summary type="html">&lt;p&gt;&lt;p&gt;It's not possible to do a simple filled step plot in matplotlib using
default
commands. Workaround:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
def steppify(arr,isX=False,interval=0):    &amp;quot;&amp;quot;&amp;quot;    Converts an array to double-length for step plotting    &amp;quot;&amp;quot;&amp;quot;    if isX and interval==0:        interval = abs(arr[1]-arr[0]) / 2.0        newarr = array(zip(arr-interval,arr+interval …&lt;/pre&gt;&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;p&gt;It's not possible to do a simple filled step plot in matplotlib using
default
commands. Workaround:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
def steppify(arr,isX=False,interval=0):    &amp;quot;&amp;quot;&amp;quot;    Converts an array to double-length for step plotting    &amp;quot;&amp;quot;&amp;quot;    if isX and interval==0:        interval = abs(arr[1]-arr[0]) / 2.0        newarr = array(zip(arr-interval,arr+interval)).ravel()        return newarrplot(xx,yy,linestyle='steps-mid',color='b',linewidth=1.5)fill_between(steppify(xx[x1:x2],isX=True),    steppify(yy[x1:x2])*0,    steppify(yy[x1:x2]),    facecolor='b',alpha=0.2)
&lt;/pre&gt;
&lt;/p&gt;</content><category term="misc"></category><category term="googlepost"></category><category term="matplotlib"></category><category term="python"></category></entry><entry><title>finally got matplotlib to install...</title><link href="https://keflavich.github.io/blog/finally-got-matplotlib-to-install.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/finally-got-matplotlib-to-install.html</id><summary type="html">&lt;p&gt;the key is reading the readme, not just the make.osx file.&lt;/p&gt;
&lt;p&gt;These commands Just Work:
&lt;tt class="docutils literal"&gt;make &lt;span class="pre"&gt;-f&lt;/span&gt; make.osx PYVERSION=2.6 &lt;span class="pre"&gt;PREFIX=/Users/adam/repos/mpl_dependencies/&lt;/span&gt; fetch deps mpl_install_stdmake &lt;span class="pre"&gt;-f&lt;/span&gt; make.osx PYVERSION=2.7 &lt;span class="pre"&gt;PREFIX=/Users/adam/repos/mpl_dependencies/&lt;/span&gt; fetch deps mpl_install …&lt;/tt&gt;&lt;/p&gt;</summary><content type="html">&lt;p&gt;the key is reading the readme, not just the make.osx file.&lt;/p&gt;
&lt;p&gt;These commands Just Work:
&lt;tt class="docutils literal"&gt;make &lt;span class="pre"&gt;-f&lt;/span&gt; make.osx PYVERSION=2.6 &lt;span class="pre"&gt;PREFIX=/Users/adam/repos/mpl_dependencies/&lt;/span&gt; fetch deps mpl_install_stdmake &lt;span class="pre"&gt;-f&lt;/span&gt; make.osx PYVERSION=2.7 &lt;span class="pre"&gt;PREFIX=/Users/adam/repos/mpl_dependencies/&lt;/span&gt; fetch deps mpl_install_std&lt;/tt&gt;&lt;/p&gt;
&lt;p&gt;while, e.g., this one:
&lt;tt class="docutils literal"&gt;make &lt;span class="pre"&gt;-f&lt;/span&gt; make.osx PYVERSION=2.6 &lt;span class="pre"&gt;PREFIX=/Users/adam/repos/mpl_dependencies/&lt;/span&gt; fetch deps mpl_install&lt;/tt&gt;
didn't. I guess because that one doesn't actually install anything.&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="matplotlib"></category><category term="computer"></category></entry><entry><title>find and xargs</title><link href="https://keflavich.github.io/blog/find-and-xargs.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/find-and-xargs.html</id><content type="html">&lt;p&gt;&lt;a class="reference external" href="http://www.kalamazoolinux.org/tech/find.html"&gt;pretty useful info on find and xargs&lt;/a&gt;, e.g.
&lt;tt class="docutils literal"&gt;find /scratch/adam_work/ &lt;span class="pre"&gt;-name&lt;/span&gt; 'mmm*sav' | xargs rm&lt;/tt&gt;&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="computer"></category></entry><entry><title>First!</title><link href="https://keflavich.github.io/blog/first.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/first.html</id><content type="html">&lt;p&gt;First post by &lt;a class="reference external" href="http://casa.colorado.edu/~ginsbura/index.htm"&gt;me&lt;/a&gt; on my own BLDG! I should transition to this address
eventually...&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="blog"></category></entry><entry><title>First paper accepted</title><link href="https://keflavich.github.io/blog/first-paper-accepted.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/first-paper-accepted.html</id><summary type="html">&lt;p&gt;&lt;a class="reference external" href="http://casa.colorado.edu/~ginsbura/iras05358.htm"&gt;My Comps II paper on IRAS 05358+3543&lt;/a&gt; was accepted by ApJ on
Wednesday. It will show up on arxiv in a few days and I'll post the link
then. Unfortunately, there were significant problems rendering the
paper, so I recommend downloading my version.
Also, working on the HISA KDA …&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;a class="reference external" href="http://casa.colorado.edu/~ginsbura/iras05358.htm"&gt;My Comps II paper on IRAS 05358+3543&lt;/a&gt; was accepted by ApJ on
Wednesday. It will show up on arxiv in a few days and I'll post the link
then. Unfortunately, there were significant problems rendering the
paper, so I recommend downloading my version.
Also, working on the HISA KDA... &lt;a class="reference external" href="http://eta.colorado.edu/cutouts/"&gt;I have a nice section of cutouts&lt;/a&gt;&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="astronomy"></category></entry><entry><title>FITS manipuation with imagemagick, gimp, etc.</title><link href="https://keflavich.github.io/blog/fits-manipuation-with-imagemagick-gimp-etc.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/fits-manipuation-with-imagemagick-gimp-etc.html</id><summary type="html">&lt;p&gt;It is possible to convert .fits files to .png, .jpg, etc:
`` convert -normalize a.fits a.png ``
To get things to come out nicely, you have to do the scaling essentially
by hand in python/idl/iraf. DS9 is only useful for finding out what
scaling you want to use …&lt;/p&gt;</summary><content type="html">&lt;p&gt;It is possible to convert .fits files to .png, .jpg, etc:
`` convert -normalize a.fits a.png ``
To get things to come out nicely, you have to do the scaling essentially
by hand in python/idl/iraf. DS9 is only useful for finding out what
scaling you want to use; past that it's pretty much not useable.
To make colors look nice in the GIMP, use solid background layers with
your image as the alpha mask. Then put your image in with itself as an
alpha mask so you can easily control the whiteness (saturation) of the
color you've selected.
I'll be blogging about this more as I prep my next entry for the NRAO
photo contest.&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="photo"></category><category term="unix"></category></entry><entry><title>Galactic Formaldehyde Densitometry Project</title><link href="https://keflavich.github.io/blog/galactic-formaldehyde-densitometry-project.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/galactic-formaldehyde-densitometry-project.html</id><summary type="html">&lt;p&gt;The Galactic Formaldehyde Densitometry Project is finally official and
on its way. I am PI of a joint Arecibo / Green Bank Telescope project to
survey formaldehyde, H2CO, in a sample of ~400 &amp;quot;dust clumps&amp;quot; in the
Galactic Plane. The clumps represent condensations within larger
molecular clouds that are likely to …&lt;/p&gt;</summary><content type="html">&lt;p&gt;The Galactic Formaldehyde Densitometry Project is finally official and
on its way. I am PI of a joint Arecibo / Green Bank Telescope project to
survey formaldehyde, H2CO, in a sample of ~400 &amp;quot;dust clumps&amp;quot; in the
Galactic Plane. The clumps represent condensations within larger
molecular clouds that are likely to be forming stars, particularly
massive stars and star clusters.
Formaldehyde is uniquely useful for measuring densities of these gas
clumps. Because of a collisional selection effect, the low-lying
K-doublet transitions of H2CO undergo &amp;quot;anti-inversion&amp;quot;, which means
their lower-energy states are overpopulated relative to the higher
states, and it can therefore be seen in absorption against the cosmic
microwave background. This unique property removes a key bias present in
emission line studies in which variable excitation conditions can
dominate the observability of a line.
For the next few posts, I will include calibration and data reduction
information from the observations in this survey. The Green Bank
observations are well underway, with nearly half of the sources observed
(though many at poor sensitivity) and the Arecibo observations have been
approved.&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="formaldehyde"></category></entry><entry><title>Galaxy Map</title><link href="https://keflavich.github.io/blog/galaxy-map.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/galaxy-map.html</id><content type="html">&lt;p&gt;If you're ever interested in seeing a face-on view of the Milky Way,
check out the &lt;a class="reference external" href="http://www.spitzer.caltech.edu/Media/releases/ssc2008-10/index.shtml"&gt;Spitzer press release&lt;/a&gt;. This link is very surprisingly
hard to find on google.&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="astronomy"></category></entry><entry><title>Ghostscript error?</title><link href="https://keflavich.github.io/blog/ghostscript-error.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/ghostscript-error.html</id><summary type="html">&lt;p&gt;&lt;p&gt;I've been receiving the following error when attempting to compile
(ps2pdf) my w5 outflows paper:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
Error: /rangecheck in --get--Operand stack:   pdfmark   --dict:20/25(ro)(L)--   --nostringval--   50Execution stack:   %interp_exit   .runexec2   --nostringval--   --nostringval--   --nostringval--   2   %stopped_push   --nostringval--   --nostringval--   --nostringval--   false   1   %stopped_push   1878   1   3   %oparray_pop …&lt;/pre&gt;&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;p&gt;I've been receiving the following error when attempting to compile
(ps2pdf) my w5 outflows paper:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
Error: /rangecheck in --get--Operand stack:   pdfmark   --dict:20/25(ro)(L)--   --nostringval--   50Execution stack:   %interp_exit   .runexec2   --nostringval--   --nostringval--   --nostringval--   2   %stopped_push   --nostringval--   --nostringval--   --nostringval--   false   1   %stopped_push   1878   1   3   %oparray_pop   1877   1   3   %oparray_pop   1861   1   3   %oparray_pop   1755   1   3   %oparray_pop   --nostringval--   %errorexec_pop   .runexec2   --nostringval--   --nostringval--   --nostringval--   2   %stopped_push   --nostringval--   %finish_show   --nostringval--   --nostringval--   8   6   1   --nostringval--   (pdf_text_enum_t)   %op_show_continue   --nostringval--Dictionary stack:   --dict:1153/1684(ro)(G)--   --dict:0/20(G)--   --dict:71/200(L)--   --dict:125/300(L)--   --dict:44/200(L)--   --dict:138/224(L)--Current allocation mode is localLast OS error: 2Current file position is 267478928GPL Ghostscript 8.71: Unrecoverable error, exit code 1
&lt;/pre&gt;
&lt;p&gt;I get the same error with Ghostscript 8.64, but on my laptop, using the
fink version, it works. Similarly, there are errors with the postscript,
so I'm led to believe it's an error in latex:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
$ latex --versionpdfTeX 3.1415926-1.40.10-2.2 (TeX Live 2009)kpathsea version 5.0.0Copyright 2009 Peter Breitenlohner (eTeX)/Han The Thanh (pdfTeX).There is NO warranty.  Redistribution of this software iscovered by the terms of both the pdfTeX copyright andthe Lesser GNU General Public License.For more information about these matters, see the filenamed COPYING and the pdfTeX source.Primary author of pdfTeX: Peter Breitenlohner (eTeX)/Han The Thanh (pdfTeX).Compiled with libpng 1.2.39; using libpng 1.2.39Compiled with zlib 1.2.3; using zlib 1.2.3Compiled with xpdf version 3.02pl3
&lt;/pre&gt;
&lt;p&gt;No idea what the cause is but it's time to start documenting steps and
looking for a workaround. Compiling on the lappy isn't a good option.&lt;/p&gt;
&lt;/p&gt;</content><category term="misc"></category><category term="googlepost"></category><category term="latex"></category><category term="postscript"></category></entry><entry><title>Gildas CLASS</title><link href="https://keflavich.github.io/blog/gildas-class.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/gildas-class.html</id><summary type="html">&lt;p&gt;It's absurdly difficult to find help on GILDAS Class, probably because
you can't google &amp;quot;class&amp;quot; and most people probably don't label every
piece of code with &amp;quot;GILDAS class&amp;quot;.
Anyway, here are some scripts that I refer back to often:
&lt;tt class="docutils literal"&gt;file in August2009BGPS.datfile out August2009fits.dat multipleon error &amp;quot;file out …&lt;/tt&gt;&lt;/p&gt;</summary><content type="html">&lt;p&gt;It's absurdly difficult to find help on GILDAS Class, probably because
you can't google &amp;quot;class&amp;quot; and most people probably don't label every
piece of code with &amp;quot;GILDAS class&amp;quot;.
Anyway, here are some scripts that I refer back to often:
&lt;tt class="docutils literal"&gt;file in August2009BGPS.datfile out August2009fits.dat multipleon error &amp;quot;file out August2009fits.dat&amp;quot;say &amp;quot;READ IN FILES&amp;quot;define character sourcelist*10[300]accept sourcelist /column observed_sources.txton error &amp;quot;continue&amp;quot;get 1001set window &lt;span class="pre"&gt;-100&lt;/span&gt; 160set mask &lt;span class="pre"&gt;-400&lt;/span&gt; &lt;span class="pre"&gt;-100&lt;/span&gt; 160 400set mode x &lt;span class="pre"&gt;-400&lt;/span&gt; 400set align velocityfor i 1 to 161&amp;nbsp;&amp;nbsp;&amp;nbsp; say &amp;quot;Working on SOURCE &amp;quot;'i'&amp;nbsp;&amp;nbsp;&amp;nbsp; find /source 'sourcelist[i]' /telescope &amp;quot;CSO 4GHZ IF1&amp;quot; /offset 0 0 /quality 5&amp;nbsp;&amp;nbsp;&amp;nbsp; average&amp;nbsp;&amp;nbsp;&amp;nbsp; on error &amp;quot;&amp;#64;avplot2 'sourcelist[i]' 'i'; next&amp;quot;&amp;nbsp;&amp;nbsp;&amp;nbsp; base 3&amp;nbsp;&amp;nbsp;&amp;nbsp; line 0&amp;nbsp;&amp;nbsp;&amp;nbsp; min&amp;nbsp;&amp;nbsp;&amp;nbsp; plot&amp;nbsp;&amp;nbsp;&amp;nbsp; vis&amp;nbsp;&amp;nbsp;&amp;nbsp; write i!&amp;nbsp;&amp;nbsp;&amp;nbsp; on error &amp;quot;continue&amp;quot;next&lt;/tt&gt;
and
&lt;tt class="docutils literal"&gt;file in &lt;span class="pre"&gt;araya-2004.clsfinddefine&lt;/span&gt; character filename*20for i 1 to 20&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; say &amp;quot;Working on source &amp;quot;'i'&amp;nbsp;&amp;nbsp;&amp;nbsp; get next&amp;nbsp;&amp;nbsp;&amp;nbsp; let filename &lt;span class="pre"&gt;&amp;quot;araya-2004_&amp;quot;'i'&amp;quot;.fits&amp;quot;&lt;/span&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; say &amp;quot;fits write &amp;quot;'filename'&amp;quot; /mode spectrum&amp;quot;&amp;nbsp;&amp;nbsp;&amp;nbsp; fits write 'filename' /mode spectrumnext!file in &lt;span class="pre"&gt;araya-2002.cls!find!define&lt;/span&gt; character filename*20!for i 1 to 42 !&amp;nbsp;&amp;nbsp;&amp;nbsp; say &amp;quot;Working on source &amp;quot;'i'!&amp;nbsp;&amp;nbsp;&amp;nbsp; get i!&amp;nbsp;&amp;nbsp;&amp;nbsp; let filename &lt;span class="pre"&gt;&amp;quot;araya-2002_&amp;quot;'i'&amp;quot;.fits&amp;quot;&lt;/span&gt; !&amp;nbsp;&amp;nbsp;&amp;nbsp; say &amp;quot;fits write &amp;quot;'filename'&amp;quot; /mode spectrum&amp;quot;!&amp;nbsp;&amp;nbsp;&amp;nbsp; fits write 'filename' /mode spectrum!next&lt;/tt&gt;&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="class"></category></entry><entry><title>Histogram in Google Spreadsheet</title><link href="https://keflavich.github.io/blog/histogram-in-google-spreadsheet.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/histogram-in-google-spreadsheet.html</id><summary type="html">&lt;p&gt;It's not easy to make a histogram in google spreadsheets without
replicating data. The &amp;quot;countif&amp;quot; function would be great, except it only
allows very simple criteria. However, there's a workaround:
=count(Filter('Grades'!V2:V30,'Grades'!V2:V30&amp;gt;0.9))
=count(Filter('Grades'!V2:V30,'Grades'!V2:V30&amp;lt;0.9 …&lt;/p&gt;</summary><content type="html">&lt;p&gt;It's not easy to make a histogram in google spreadsheets without
replicating data. The &amp;quot;countif&amp;quot; function would be great, except it only
allows very simple criteria. However, there's a workaround:
=count(Filter('Grades'!V2:V30,'Grades'!V2:V30&amp;gt;0.9))
=count(Filter('Grades'!V2:V30,'Grades'!V2:V30&amp;lt;0.9,'Grades'!V2:V30&amp;gt;0.8))
The Filter() function returns an array, which can be operated on like
any other set of cells.
It's still not easy to make a nice-looking histogram, but the output of
this process is at least usable.&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="spreadsheet"></category></entry><entry><title>Hosting on my mac</title><link href="https://keflavich.github.io/blog/hosting-on-my-mac.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/hosting-on-my-mac.html</id><summary type="html">&lt;p&gt;I'm hosting my website off my mac; it should be accessible to the
outside world now: &lt;a class="reference external" href="http://eta.colorado.edu/"&gt;eta.colorado.edu&lt;/a&gt;.
A few things went into this....&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;Don't install the fink version. The two versions clash and depending
on how you access your computer you could end up looking at entirely
different …&lt;/li&gt;&lt;/ol&gt;</summary><content type="html">&lt;p&gt;I'm hosting my website off my mac; it should be accessible to the
outside world now: &lt;a class="reference external" href="http://eta.colorado.edu/"&gt;eta.colorado.edu&lt;/a&gt;.
A few things went into this....&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;Don't install the fink version. The two versions clash and depending
on how you access your computer you could end up looking at entirely
different directories (e.g. localhost and eta.colorado.edu referred
to different sites for a while)&lt;/li&gt;
&lt;li&gt;The configuration file is /private/etc/apache2/httpd.conf&lt;/li&gt;
&lt;li&gt;I needed to change DirectoryIndex to index.htm (from index.html)&lt;/li&gt;
&lt;li&gt;uncommmented &amp;quot;LoadModule php5_module libexec/apache2/libphp5.so&amp;quot;&lt;/li&gt;
&lt;li&gt;had to allow override so that .htaccess files would work.&lt;/li&gt;
&lt;/ol&gt;
&lt;/p&gt;</content><category term="misc"></category><category term="googlepost"></category><category term="computer"></category></entry><entry><title>How do I print a multi-page postscript?</title><link href="https://keflavich.github.io/blog/how-do-i-print-a-multi-page-postscript.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/how-do-i-print-a-multi-page-postscript.html</id><summary type="html">&lt;p&gt;I want to print a multi-page postscript duplexed and, if possible, two
per page. pstopng, pstopdf, and the variants failed me horribly by
making postscripts that don't fit the bounding box at all. Any ideas?
So far the best I've come up with is switching gnuplot's output to pdf,
which …&lt;/p&gt;</summary><content type="html">&lt;p&gt;I want to print a multi-page postscript duplexed and, if possible, two
per page. pstopng, pstopdf, and the variants failed me horribly by
making postscripts that don't fit the bounding box at all. Any ideas?
So far the best I've come up with is switching gnuplot's output to pdf,
which is a workaround rather than a solution, but is useful nonetheless:
&lt;tt class="docutils literal"&gt;set terminal pdf enhanced dashed&lt;/tt&gt;&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="gnuplot"></category><category term="computer"></category><category term="postscript"></category></entry><entry><title>How to make a pretty image</title><link href="https://keflavich.github.io/blog/how-to-make-a-pretty-image.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/how-to-make-a-pretty-image.html</id><summary type="html">&lt;p&gt;The most difficult requirement to satisfy is WCS matching. Each image
has to be in exactly the same pixel space in order to overlay them
successfully in an image program. The process is generally to use
Montage's mProject to project the images into the same plane, then mAdd
with a …&lt;/p&gt;</summary><content type="html">&lt;p&gt;The most difficult requirement to satisfy is WCS matching. Each image
has to be in exactly the same pixel space in order to overlay them
successfully in an image program. The process is generally to use
Montage's mProject to project the images into the same plane, then mAdd
with a blank map of a given size so that the dimensions in pixels are
identical.
Once that's done, I load the images into GIMP. However, GIMP reads .fits
files as 256 bit data - which is essentially useless because most
(interesting) images have a dynamical range &amp;gt;~1000. So I usually make
images emphasizing the faint emission in log scale with the high and low
ends cut off (I use DS9 to determine high/low). I make a second copy
showing the details of the very bright regions, again in logscale but it
ends up being a different log scale - essentially, my transfer function
becomes a broken power law.
The tricks in GIMP are numerous, but primarily two:
1. Rotate the color table ~60 degrees
2. Use images as &amp;quot;Layer Masks&amp;quot; (aka alpha layers) on a solid color
background
There's also the nice trick when using radio data of using optical or
some other wavelength to provide the high-resolution details, while the
radio emission provides the intensity.&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="photo"></category></entry><entry><title>IDL array indexing</title><link href="https://keflavich.github.io/blog/idl-array-indexing.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/idl-array-indexing.html</id><content type="html">&lt;p&gt;&lt;tt class="docutils literal"&gt;array_indices(array, location)&lt;/tt&gt;
instead of that x mod n_e(), y / n_e() crap&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="computer"></category></entry><entry><title>IDL colors</title><link href="https://keflavich.github.io/blog/idl-colors.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/idl-colors.html</id><summary type="html">&lt;p&gt;&lt;p&gt;To get IDL colors to 'work right' (i.e. a colortable has 255 colors
etc), put this in a startup file:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
device, true_color = 24, retain = 2, decompose = 0red = [0,1,1,0,0,1]green = [0,1,0,1,0,1]blue = [0,1,0,0,1,0]if …&lt;/pre&gt;&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;p&gt;To get IDL colors to 'work right' (i.e. a colortable has 255 colors
etc), put this in a startup file:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
device, true_color = 24, retain = 2, decompose = 0red = [0,1,1,0,0,1]green = [0,1,0,1,0,1]blue = [0,1,0,0,1,0]if not strcmp(getenv('DISPLAY'),'') then $   tvlct, 255*red, 255*green, 255*blue
&lt;/pre&gt;
&lt;/p&gt;</content><category term="misc"></category><category term="googlepost"></category><category term="computer"></category></entry><entry><title>IDL string conversion</title><link href="https://keflavich.github.io/blog/idl-string-conversion.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/idl-string-conversion.html</id><content type="html">&lt;p&gt;Just a reminder to me:
to convert an IDL number to a string, use string!
`` s = string(x,format='(F10.5)')``
Also, &lt;a class="reference external" href="http://aa.usno.navy.mil/data/docs/JulianDate.php"&gt;Julian Date conversion&lt;/a&gt;&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="computer"></category></entry><entry><title>IDL syntax highlighting in VIM</title><link href="https://keflavich.github.io/blog/idl-syntax-highlighting-in-vim.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/idl-syntax-highlighting-in-vim.html</id><content type="html">&lt;p&gt;I've edited my idlang.vim to auto-identify files that start with a
semicolon.
Add Line 19:
`` syn match idlangStatement &amp;quot;^s*;s&amp;quot;``
Line 61/2 (allow spaces before ;):
&lt;tt class="docutils literal"&gt;syn match&amp;nbsp; idlangComment &lt;span class="pre"&gt;&amp;quot;\s*[\;].*$&amp;quot;&lt;/span&gt; contains=idlangTodo&lt;/tt&gt;
&lt;a class="reference external" href="http://casa.colorado.edu/~ginsbura/index.htm"&gt;AG&lt;/a&gt;&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="idl"></category></entry><entry><title>IDL-to-Python</title><link href="https://keflavich.github.io/blog/idl-to-python.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/idl-to-python.html</id><content type="html">&lt;p&gt;astrobetter started up an &lt;a class="reference external" href="http://www.astrobetter.com/wiki/tiki-index.php?page=Python+Switchers+Guide"&gt;idl-to-python guide&lt;/a&gt; on their wiki.&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="python"></category><category term="astronomy"></category></entry><entry><title>.inputrc</title><link href="https://keflavich.github.io/blog/inputrc.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/inputrc.html</id><summary type="html">&lt;p&gt;New unix stuff!
This is, again, stuff I'd searched for forever but never found the right
collection of terms. This is what bash readline is REALLY all about.
if you make an inputrc file, you can get awesome readline capabilities
(similar to ipython). &lt;a class="reference external" href="http://lifehacker.com/software/command-line/ctrl%252Br-to-search-and-other-terminal-history-tricks-278888.php#c1887277"&gt;This post at lifehacker&lt;/a&gt; showed me how …&lt;/p&gt;</summary><content type="html">&lt;p&gt;New unix stuff!
This is, again, stuff I'd searched for forever but never found the right
collection of terms. This is what bash readline is REALLY all about.
if you make an inputrc file, you can get awesome readline capabilities
(similar to ipython). &lt;a class="reference external" href="http://lifehacker.com/software/command-line/ctrl%252Br-to-search-and-other-terminal-history-tricks-278888.php#c1887277"&gt;This post at lifehacker&lt;/a&gt; showed me how to do it.
&lt;a class="reference external" href="http://www.comptechdoc.org/os/linux/howlinuxworks/linux_hlkeyprogs.html"&gt;This site&lt;/a&gt; has a more complete description of how to use
readline/inputrc.
Even better: &lt;a class="reference external" href="http://www.catonmat.net/blog/bash-vi-editing-mode-cheat-sheet/"&gt;VI command line editing&lt;/a&gt;.
There's also something called &lt;a class="reference external" href="http://stackoverflow.org/wiki/Inputrc_for_bash_history_completion_using_up/down_arrows"&gt;magic space&lt;/a&gt; but I don't know what
purpose it serves all the time... it will replace 'magic' characters
like !* and !&amp;amp; and !! with whatever command they represent if you hit
space immediately after typing them (explained better &lt;a class="reference external" href="http://mike.hostetlerhome.com/2006/05/18/neat-bash-tricks/"&gt;here&lt;/a&gt;).
Wow. Awesome.&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="unix"></category><category term="computer"></category></entry><entry><title>Installing 64 bit tcl/tk on Mac OS X</title><link href="https://keflavich.github.io/blog/installing-64-bit-tcltk-on-mac-os-x.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/installing-64-bit-tcltk-on-mac-os-x.html</id><summary type="html">&lt;p&gt;Everything is described in this post:
&lt;a class="reference external" href="http://www.nabble.com/Error-compiling-tk-8.5.7-on-Mac-OS-X-10.5-td23790967.html"&gt;http://www.nabble.com/Error-compiling-tk-8.5.7-on-Mac-OS-X-10.5-td23790967.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;But here's a script too:
&lt;tt class="docutils literal"&gt;curl &lt;span class="pre"&gt;-O&lt;/span&gt; &lt;span class="pre"&gt;'http://osdn.dl.sourceforge.net/sourceforge/tcl/t{cl,k}8.5.7-src.tar.gz'for&lt;/span&gt; f in &lt;span class="pre"&gt;t*8.5.7*.gz;&lt;/span&gt; do tar zxf $f; done cd …&lt;/tt&gt;&lt;/p&gt;</summary><content type="html">&lt;p&gt;Everything is described in this post:
&lt;a class="reference external" href="http://www.nabble.com/Error-compiling-tk-8.5.7-on-Mac-OS-X-10.5-td23790967.html"&gt;http://www.nabble.com/Error-compiling-tk-8.5.7-on-Mac-OS-X-10.5-td23790967.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;But here's a script too:
&lt;tt class="docutils literal"&gt;curl &lt;span class="pre"&gt;-O&lt;/span&gt; &lt;span class="pre"&gt;'http://osdn.dl.sourceforge.net/sourceforge/tcl/t{cl,k}8.5.7-src.tar.gz'for&lt;/span&gt; f in &lt;span class="pre"&gt;t*8.5.7*.gz;&lt;/span&gt; do tar zxf $f; done cd &lt;span class="pre"&gt;tcl8.5.7/unix/./configure&lt;/span&gt; &lt;span class="pre"&gt;--enable-framework&lt;/span&gt; &lt;span class="pre"&gt;--enable-64-bitcd&lt;/span&gt; &lt;span class="pre"&gt;tk8.5.7/unix/./configure&lt;/span&gt; &lt;span class="pre"&gt;--enable-framework&lt;/span&gt; &lt;span class="pre"&gt;--enable-64-bitmake&lt;/span&gt; &lt;span class="pre"&gt;-j&lt;/span&gt; 4 &lt;span class="pre"&gt;-C&lt;/span&gt; tcl8.5.7/unix make &lt;span class="pre"&gt;-j&lt;/span&gt; 4 &lt;span class="pre"&gt;-C&lt;/span&gt; tk8.5.7/unixsudo make install &lt;span class="pre"&gt;-C&lt;/span&gt; tcl8.5.7/unix sudo make install &lt;span class="pre"&gt;-C&lt;/span&gt; tk8.5.7/unix&lt;/tt&gt;&lt;/p&gt;
&lt;p&gt;Concerns:&lt;/p&gt;
&lt;blockquote&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;might be necessary to do this in the macosx directory for some reason,
though Aqua doesn't support 64 bits&lt;/li&gt;
&lt;li&gt;have to recompile python to get _tkinter to work (see &lt;a class="reference external" href="http://buffalothedestroyer.blogspot.com/2009/07/success-64-bit-python-with-64-bit-tcltk.html"&gt;a later post&lt;/a&gt;)&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="python"></category><category term="computer"></category></entry><entry><title>Installing Snow Leopard</title><link href="https://keflavich.github.io/blog/installing-snow-leopard.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/installing-snow-leopard.html</id><summary type="html">&lt;p&gt;I'm going to attempt to install snow leopard today. This post will serve
as a record of the difficulties I run into.
Things to install (and ensure they are 64-bit):&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;ipython&lt;/li&gt;
&lt;li&gt;numpy&lt;/li&gt;
&lt;li&gt;scipy&lt;/li&gt;
&lt;li&gt;matplotlib&lt;/li&gt;
&lt;li&gt;stsci-python&lt;/li&gt;
&lt;li&gt;starlink&lt;/li&gt;
&lt;li&gt;gfortran&lt;/li&gt;
&lt;li&gt;latex&lt;/li&gt;
&lt;li&gt;idl (check)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Things that have happened:&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;Had to restart again (twice) to …&lt;/li&gt;&lt;/ol&gt;</summary><content type="html">&lt;p&gt;I'm going to attempt to install snow leopard today. This post will serve
as a record of the difficulties I run into.
Things to install (and ensure they are 64-bit):&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;ipython&lt;/li&gt;
&lt;li&gt;numpy&lt;/li&gt;
&lt;li&gt;scipy&lt;/li&gt;
&lt;li&gt;matplotlib&lt;/li&gt;
&lt;li&gt;stsci-python&lt;/li&gt;
&lt;li&gt;starlink&lt;/li&gt;
&lt;li&gt;gfortran&lt;/li&gt;
&lt;li&gt;latex&lt;/li&gt;
&lt;li&gt;idl (check)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Things that have happened:&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;Had to restart again (twice) to install additional updates&lt;/li&gt;
&lt;li&gt;My bash command line looked funny - something about bash changed, but
I don't know what. The fix was easy: commented out some code from
&lt;a class="reference external" href="http://pseudogreen.org/blog/set_tab_names_in_leopard_terminal.html"&gt;http://pseudogreen.org/blog/set_tab_names_in_leopard_terminal.html&lt;/a&gt;
that I had been using to set the tab title&lt;/li&gt;
&lt;li&gt;My locate db broke. Needed repair: &lt;tt class="docutils literal"&gt;sudo /usr/libexec/locate.updatedb&lt;/tt&gt;&lt;/li&gt;
&lt;li&gt;numpy svn failed to build:
`` python setup.py buildRunning from numpy source directory.non-existing path in 'numpy/distutils': 'site.cfg'F2PY Version 2_8111numpy/core/setup_common.py:86: MismatchCAPIWarning: API mismatch detected, the C API version numbers have to be updated. Current C api version is 4, with checksum 59750b518272c8987f02d66445afd3f1, but recorded checksum for C API version 4 in codegen_dir/cversions.txt is 3d8940bf7b0d2a4e25be4338c14c3c85. If functions were added in the C API, you have to update C_API_VERSION  in numpy/core/setup_common.pyc.  MismatchCAPIWarning)blas_opt_info:  FOUND:    extra_link_args = ['-Wl,-framework', '-Wl,Accelerate']    define_macros = [('NO_ATLAS_INFO', 3)]    extra_compile_args = ['-faltivec', '-I/System/Library/Frameworks/vecLib.framework/Headers']lapack_opt_info:  FOUND:    extra_link_args = ['-Wl,-framework', '-Wl,Accelerate']    define_macros = [('NO_ATLAS_INFO', 3)]    extra_compile_args = ['-faltivec']running buildrunning config_ccunifing config_cc, config, build_clib, build_ext, build commands --compiler optionsrunning config_fcunifing config_fc, config, build_clib, build_ext, build commands --fcompiler optionsrunning build_srcbuild_srcbuilding py_modules sourcesbuilding library &amp;quot;npymath&amp;quot; sourcescustomize NAGFCompilerFound executable /usr/local/bin/f95customize AbsoftFCompilerCould not locate executable f90Found executable /usr/bin/f77absoft: no Fortran 90 compiler foundabsoft: no Fortran 90 compiler foundcustomize IBMFCompilerCould not locate executable xlf90Could not locate executable xlfcustomize IntelFCompilerCould not locate executable ifortCould not locate executable ifccustomize GnuFCompilerFound executable /usr/local/bin/g77gnu: no Fortran 90 compiler foundgnu: no Fortran 90 compiler foundcustomize Gnu95FCompilerFound executable /usr/local/bin/gfortrancustomize Gnu95FCompilercustomize Gnu95FCompiler using configC compiler: gcc -arch i386 -arch ppc -arch ppc64 -arch x86_64 -isysroot /Developer/SDKs/MacOSX10.5.sdk -fno-strict-aliasing -fno-common -dynamic -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypescompile options: '-Inumpy/core/src/private -Inumpy/core/src -Inumpy/core -Inumpy/core/src/npymath -Inumpy/core/src/multiarray -Inumpy/core/src/umath -Inumpy/core/include -I/Library/Frameworks/Python.framework/Versions/2.6/include/python2.6 -c'gcc: _configtest.cgcc _configtest.o -o _configtestld: library not found for -lcrt1.10.5.ocollect2: ld returned 1 exit statusld: library not found for -lcrt1.10.5.ocollect2: ld returned 1 exit statusfailure.removing: _configtest.c _configtest.oTraceback (most recent call last):  File &amp;quot;setup.py&amp;quot;, line 210, in     setup_package()  File &amp;quot;setup.py&amp;quot;, line 203, in setup_package    configuration=configuration )  File &amp;quot;/Users/adam/repos/numpy-svn/numpy/distutils/core.py&amp;quot;, line 186, in setup    return old_setup(&lt;strong&gt;new_attr)  File &amp;quot;/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/distutils/core.py&amp;quot;, line 152, in setup    dist.run_commands()  File &amp;quot;/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/distutils/dist.py&amp;quot;, line 975, in run_commands    self.run_command(cmd)  File &amp;quot;/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/distutils/dist.py&amp;quot;, line 995, in run_command    cmd_obj.run()  File &amp;quot;/Users/adam/repos/numpy-svn/numpy/distutils/command/build.py&amp;quot;, line 37, in run    old_build.run(self)  File &amp;quot;/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/distutils/command/build.py&amp;quot;, line 134, in run    self.run_command(cmd_name)  File &amp;quot;/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/distutils/cmd.py&amp;quot;, line 333, in run_command    self.distribution.run_command(command)  File &amp;quot;/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/distutils/dist.py&amp;quot;, line 995, in run_command    cmd_obj.run()  File &amp;quot;/Users/adam/repos/numpy-svn/numpy/distutils/command/build_src.py&amp;quot;, line 152, in run    self.build_sources()  File &amp;quot;/Users/adam/repos/numpy-svn/numpy/distutils/command/build_src.py&amp;quot;, line 163, in build_sources    self.build_library_sources(*libname_info)  File &amp;quot;/Users/adam/repos/numpy-svn/numpy/distutils/command/build_src.py&amp;quot;, line 298, in build_library_sources    sources = self.generate_sources(sources, (lib_name, build_info))  File &amp;quot;/Users/adam/repos/numpy-svn/numpy/distutils/command/build_src.py&amp;quot;, line 385, in generate_sources    source = func(extension, build_dir)  File &amp;quot;numpy/core/setup.py&amp;quot;, line 670, in get_mathlib_info    raise RuntimeError(&amp;quot;Broken toolchain: cannot link a simple C program&amp;quot;)RuntimeError: Broken toolchain: cannot link a simple C program``
**SOLUTION:&lt;/strong&gt; Use the Mac OS X 10.6 python (/usr/bin/python). I will do this
until I run into another problem. Numpy build successfully&lt;/li&gt;
&lt;li&gt;Build/install matplotlib - failed! Completely!&lt;/li&gt;
&lt;li&gt;Acquired gcc/gfortran from &lt;a class="reference external" href="http://hpc.sourceforge.net/"&gt;hpc&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Followed instructions from &lt;a class="reference external" href="http://blog.hyperjeff.net/?p=160"&gt;hyperjeff&lt;/a&gt; on fortran install...&lt;/li&gt;
&lt;li&gt;Get rid of numpy 1.2.1:
`` mv /System/Library/Frameworks/Python.framework/Versions/2.6/Extras/lib/python/numpy /System/Library/Frameworks/Python.framework/Versions/2.6/Extras/lib/python/.not_numpy.bak``&lt;/li&gt;
&lt;li&gt;Try to install scipy. Fail on missing umfpack, follow &lt;a class="reference external" href="http://blog.hyperjeff.net/?p=160"&gt;hyperjeff&lt;/a&gt;'s
instructions (but make sure to edit the site.cfg in scipy, not just the one in
numpy).
Had to add the following code:
&lt;tt class="docutils literal"&gt;sudo cp AMD/Lib/libamd.a /System/Library/Frameworks/Python.framework/Versions/2.6/libsudo cp UMFPACK/Lib/libumfpack.a /System/Library/Frameworks/Python.framework/Versions/2.6/libsudo cp AMD/Include/amd.h /System/Library/Frameworks/Python.framework/Versions/2.6/includesudo cp UFconfig/UFconfig.h /System/Library/Frameworks/Python.framework/Versions/2.6/includesudo cp &lt;span class="pre"&gt;UMFPACK/Include/*.h&lt;/span&gt; /System/Library/Frameworks/Python.framework/Versions/2.6/include&lt;/tt&gt;&lt;/li&gt;
&lt;li&gt;Installed fftw from &lt;a class="reference external" href="http://www.fftw.org/"&gt;fftw.org&lt;/a&gt; with simple ./configure, make, sudo
make install - no compiler opts as they killed the install&lt;/li&gt;
&lt;li&gt;Get SoundSource from &lt;a class="reference external" href="http://www.rogueamoeba.com/freebies/"&gt;rogueamoeba&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Updated &lt;a class="reference external" href="http://www.islayer.com/apps/istatmenus/"&gt;istatmenus&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="mac"></category><category term="computer"></category></entry><entry><title>IRAF append/prepend/replace</title><link href="https://keflavich.github.io/blog/iraf-appendprependreplace.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/iraf-appendprependreplace.html</id><content type="html">&lt;p&gt;IRAF has special syntax to append/replace, so you can do something like:
&lt;tt class="docutils literal"&gt;imarith *.fits - dark.fits &lt;span class="pre"&gt;ds_//*.fits&lt;/span&gt;&lt;/tt&gt;
...though I can't remember right now how to do replacement etc.&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="iraf"></category></entry><entry><title>keynote text boxes</title><link href="https://keflavich.github.io/blog/keynote-text-boxes.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/keynote-text-boxes.html</id><content type="html"></content><category term="misc"></category><category term="googlepost"></category></entry><entry><title>Last month's observations in L111</title><link href="https://keflavich.github.io/blog/last-months-observations-in-l111.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/last-months-observations-in-l111.html</id><summary type="html">&lt;p&gt;Mapped sources:
SH 2-156 [no high resolution observations; covered by 1.2m CO 1-0
survey]
SH 2-157 &lt;a class="reference external" href="http://simbad.u-strasbg.fr/cgi-bin/cdsbib4?2003ApJS..149..375S"&gt;Yancy CS 5-4&lt;/a&gt;, &lt;a class="reference external" href="http://simbad.u-strasbg.fr/cgi-bin/cdsbib4?2004AJ....128.1716A"&gt;CO, 13CO 1-0, CS 2-1&lt;/a&gt;, HCN &amp;amp; SCUBA too....
IRAS 23151 (two pointings)
Unmapped:
BFS 18 = IRAS 23042+6000 = IRCO 859
&lt;a class="reference external" href="http://cdsads.u-strasbg.fr/cgi-bin/nph-bib_query?2005AJ....129..330W&amp;amp;db_key=AST&amp;amp;nosetcookie=1"&gt;Wu et al&lt;/a&gt; mapped this in CO 2-1 and detected …&lt;/p&gt;</summary><content type="html">&lt;p&gt;Mapped sources:
SH 2-156 [no high resolution observations; covered by 1.2m CO 1-0
survey]
SH 2-157 &lt;a class="reference external" href="http://simbad.u-strasbg.fr/cgi-bin/cdsbib4?2003ApJS..149..375S"&gt;Yancy CS 5-4&lt;/a&gt;, &lt;a class="reference external" href="http://simbad.u-strasbg.fr/cgi-bin/cdsbib4?2004AJ....128.1716A"&gt;CO, 13CO 1-0, CS 2-1&lt;/a&gt;, HCN &amp;amp; SCUBA too....
IRAS 23151 (two pointings)
Unmapped:
BFS 18 = IRAS 23042+6000 = IRCO 859
&lt;a class="reference external" href="http://cdsads.u-strasbg.fr/cgi-bin/nph-bib_query?2005AJ....129..330W&amp;amp;db_key=AST&amp;amp;nosetcookie=1"&gt;Wu et al&lt;/a&gt; mapped this in CO 2-1 and detected no outflows. They used
the NRAO 12m with a heterodyne array with very high T&lt;sub&gt;sys&lt;/sub&gt;
~700-1100K.&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="l111"></category><category term="observing"></category></entry><entry><title>latex: producing a bibliography and paper independently</title><link href="https://keflavich.github.io/blog/latex-producing-a-bibliography-and-paper-independently.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/latex-producing-a-bibliography-and-paper-independently.html</id><summary type="html">&lt;p&gt;&lt;a class="reference external" href="http://casa.colorado.edu/~ginsbura/index.htm"&gt;AG&lt;/a&gt;
If you want citations to work, but you don't want your bibliography to
show up, try the following:
&lt;tt class="docutils literal"&gt;latex file.texbibtex file&lt;/tt&gt;
comment out \biblography{} line
&lt;tt class="docutils literal"&gt;latex file.tex&lt;/tt&gt;
If you latex again, it will screw up.
To make an independent bibliography, remove all text and replace all
citep …&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;a class="reference external" href="http://casa.colorado.edu/~ginsbura/index.htm"&gt;AG&lt;/a&gt;
If you want citations to work, but you don't want your bibliography to
show up, try the following:
&lt;tt class="docutils literal"&gt;latex file.texbibtex file&lt;/tt&gt;
comment out \biblography{} line
&lt;tt class="docutils literal"&gt;latex file.tex&lt;/tt&gt;
If you latex again, it will screw up.
To make an independent bibliography, remove all text and replace all
citep/citet/cite commands with \nocite{} in a different document.
Remember to usepackage{natbib} etc. You may have to copy over the .bbl
file.&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="latex"></category></entry><entry><title>LaTeX: replace double quotes with tex quotes</title><link href="https://keflavich.github.io/blog/latex-replace-double-quotes-with-tex-quotes.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/latex-replace-double-quotes-with-tex-quotes.html</id><summary type="html">&lt;p&gt;People often make the mistake of putting &amp;quot; in place of `` in LaTeX
documents. To repair this, the only easy solution is something like:
s/\(\s\)&amp;quot;/\1``/g
in VIM or sed.
I've seen alternate solutions posted but they're all too complicated.
One recommendation was to switch to XeTeX, which sounds …&lt;/p&gt;</summary><content type="html">&lt;p&gt;People often make the mistake of putting &amp;quot; in place of `` in LaTeX
documents. To repair this, the only easy solution is something like:
s/\(\s\)&amp;quot;/\1``/g
in VIM or sed.
I've seen alternate solutions posted but they're all too complicated.
One recommendation was to switch to XeTeX, which sounds like overkill,
and others all stated that a complicated perl script is required. The
latter is technically true, but why isn't such a thing readily
available?
Any other ideas?&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="latex"></category></entry><entry><title>LaTeX: VIM + Skim</title><link href="https://keflavich.github.io/blog/latex-vim-skim.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/latex-vim-skim.html</id><summary type="html">&lt;p&gt;&lt;a class="reference external" href="http://agpy.googlecode.com/svn/trunk/macvim-skim/macvim-skim-install.sh"&gt;macvim-skim-install.sh&lt;/a&gt; is my install script for using MacVim.app with
Skim.app.
The &lt;a class="reference external" href="http://code.google.com/p/agpy/wiki/macvimskim"&gt;agpy wiki page&lt;/a&gt; has instructions that are probably more clear; I
don't really like the colorscheme / layout of this blog.
You can use &lt;a class="reference external" href="http://mactex-wiki.tug.org/wiki/index.php/SyncTeX"&gt;synctex&lt;/a&gt; to make an editor and viewer work together, but
it is far …&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;a class="reference external" href="http://agpy.googlecode.com/svn/trunk/macvim-skim/macvim-skim-install.sh"&gt;macvim-skim-install.sh&lt;/a&gt; is my install script for using MacVim.app with
Skim.app.
The &lt;a class="reference external" href="http://code.google.com/p/agpy/wiki/macvimskim"&gt;agpy wiki page&lt;/a&gt; has instructions that are probably more clear; I
don't really like the colorscheme / layout of this blog.
You can use &lt;a class="reference external" href="http://mactex-wiki.tug.org/wiki/index.php/SyncTeX"&gt;synctex&lt;/a&gt; to make an editor and viewer work together, but
it is far from easy and far harder than it should be. Forward-search is
pretty easy, but the latex-suite &lt;tt class="docutils literal"&gt;\ls&lt;/tt&gt; only works intermittently and
is not easily customizable.
I had to do the following:
For VIM-&amp;gt;Skim.app (Skim.app is necessary for any of this to work), add
these commands to .vimrc:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
&amp;quot; Activate skimmap ,v :w&amp;lt;CR&amp;gt;:silent !/Applications/Skim.app/Contents/SharedSupport/displayline -r &amp;lt;C-r&amp;gt;=line('.')&amp;lt;CR&amp;gt; %&amp;lt;.pdf %&amp;lt;CR&amp;gt;&amp;lt;CR&amp;gt;map ,p :w&amp;lt;CR&amp;gt;:silent !pdflatex -synctex=1 --interaction=nonstopmode %:p &amp;lt;CR&amp;gt;:silent !/Applications/Skim.app/Contents/SharedSupport/displayline -r &amp;lt;C-r&amp;gt;=line('.')&amp;lt;CR&amp;gt; %&amp;lt;.pdf %&amp;lt;CR&amp;gt;&amp;lt;CR&amp;gt;map ,m :w&amp;lt;CR&amp;gt;:silent !make &amp;lt;CR&amp;gt;:silent !/Applications/Skim.app/Contents/SharedSupport/displayline -r &amp;lt;C-r&amp;gt;=line('.')&amp;lt;CR&amp;gt; %&amp;lt;.pdf %&amp;lt;CR&amp;gt;&amp;lt;CR&amp;gt;&amp;quot; Reactivate VIMmap ,r :w&amp;lt;CR&amp;gt;:silent !/Applications/Skim.app/Contents/SharedSupport/displayline -r &amp;lt;C-r&amp;gt;=line('.')&amp;lt;CR&amp;gt; %&amp;lt;.pdf %&amp;lt;CR&amp;gt;:silent !osascript -e &amp;quot;tell application \&amp;quot;MacVim\&amp;quot; to activate&amp;quot; &amp;lt;CR&amp;gt;&amp;lt;CR&amp;gt;map ,t :w&amp;lt;CR&amp;gt;:silent !pdflatex -synctex=1 --interaction=nonstopmode %:p &amp;lt;CR&amp;gt;:silent !/Applications/Skim.app/Contents/SharedSupport/displayline -r &amp;lt;C-r&amp;gt;=line('.')&amp;lt;CR&amp;gt; %&amp;lt;.pdf %&amp;lt;CR&amp;gt;:silent !osascript -e &amp;quot;tell application \&amp;quot;MacVim\&amp;quot; to activate&amp;quot; &amp;lt;CR&amp;gt;&amp;lt;CR&amp;gt;
&lt;/pre&gt;
&lt;p&gt;The &lt;tt class="docutils literal"&gt;,m&lt;/tt&gt; command will reload the file and put your cursor where the
text is. &lt;tt class="docutils literal"&gt;,t&lt;/tt&gt; will return VIM to the front afterwards.
Going the other way (reverse-search / inverse-search) was MUCH more
challenging. The code that does this is &lt;a class="reference external" href="http://code.google.com/p/agpy/source/browse/trunk/macvim-skim/macvim-load-line"&gt;on agpy&lt;/a&gt;. Reproduced here for
posterity (I hope to update the agpy version to &lt;a class="reference external" href="http://stackoverflow.com/questions/8839846/vim-check-if-a-file-is-open-in-current-tab-window"&gt;deal with tabs&lt;/a&gt;). [A
few hours later, I HAVE replaced the code. Below are the old applescript
version, then the new, vim-based version
&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;#!/bin/bashfile=&amp;quot;$1&amp;quot;line=&amp;quot;$2&amp;quot;[&lt;/span&gt; &lt;span class="pre"&gt;&amp;quot;${file:0:1}&amp;quot;&lt;/span&gt; == &amp;quot;/&amp;quot; ] || &lt;span class="pre"&gt;file=&amp;quot;${PWD}/$file&amp;quot;#&lt;/span&gt; Use Applescript to activate VIM, find file, and load it# the 'delay' command is needed to prevent command/control/shift from sticking when this# is activated (e.g., from Skim, where the command is &lt;span class="pre"&gt;command-shift-click)##&lt;/span&gt; key code 53 is &amp;quot;escape&amp;quot; to escape to command mode in VIMexec osascript &lt;span class="pre"&gt;\-e&lt;/span&gt; &amp;quot;delay 0.2&amp;quot; &lt;span class="pre"&gt;\-e&lt;/span&gt; &amp;quot;tell application \&amp;quot;MacVim\&amp;quot; to activate&amp;quot; &lt;span class="pre"&gt;\-e&lt;/span&gt; &amp;quot;tell application \&amp;quot;System &lt;span class="pre"&gt;Events\&amp;quot;&amp;quot;&lt;/span&gt; &lt;span class="pre"&gt;\-e&lt;/span&gt; &amp;quot;&amp;nbsp; tell process &lt;span class="pre"&gt;\&amp;quot;MacVim\&amp;quot;&amp;quot;&lt;/span&gt; &lt;span class="pre"&gt;\-e&lt;/span&gt; &amp;quot;&amp;nbsp;&amp;nbsp;&amp;nbsp; key code 53 &lt;span class="pre"&gt;&amp;quot;\-e&lt;/span&gt; &amp;quot;&amp;nbsp;&amp;nbsp;&amp;nbsp; keystroke &lt;span class="pre"&gt;\&amp;quot;:set&lt;/span&gt; hidden\&amp;quot; &amp;amp; return &amp;quot; &lt;span class="pre"&gt;\-e&lt;/span&gt; &amp;quot;&amp;nbsp;&amp;nbsp;&amp;nbsp; keystroke &lt;span class="pre"&gt;\&amp;quot;:if&lt;/span&gt; &lt;span class="pre"&gt;bufexists(bufname('$file'))\&amp;quot;&lt;/span&gt; &amp;amp; return &amp;quot; &lt;span class="pre"&gt;\-e&lt;/span&gt; &amp;quot;&amp;nbsp;&amp;nbsp;&amp;nbsp; keystroke &lt;span class="pre"&gt;\&amp;quot;:exe&lt;/span&gt; &lt;span class="pre"&gt;\\\&amp;quot;:buffer&lt;/span&gt; &lt;span class="pre"&gt;\\\&amp;quot;&lt;/span&gt; . &lt;span class="pre"&gt;bufnr(bufname('$file'))\&amp;quot;&lt;/span&gt;&amp;nbsp; &amp;amp; return &amp;quot; &lt;span class="pre"&gt;\-e&lt;/span&gt; &amp;quot;&amp;nbsp;&amp;nbsp;&amp;nbsp; keystroke &lt;span class="pre"&gt;\&amp;quot;:else&lt;/span&gt; \&amp;quot; &amp;amp; return &amp;quot; &lt;span class="pre"&gt;\-e&lt;/span&gt; &amp;quot;&amp;nbsp;&amp;nbsp;&amp;nbsp; keystroke &lt;span class="pre"&gt;\&amp;quot;:echo&lt;/span&gt; &lt;span class="pre"&gt;\\\&amp;quot;Could&lt;/span&gt; not load &lt;span class="pre"&gt;file\\\&amp;quot;&lt;/span&gt; \&amp;quot; &amp;amp; return &amp;quot; &lt;span class="pre"&gt;\-e&lt;/span&gt; &amp;quot;&amp;nbsp;&amp;nbsp;&amp;nbsp; keystroke &lt;span class="pre"&gt;\&amp;quot;:endif\&amp;quot;&lt;/span&gt; &amp;amp; return &amp;quot; &lt;span class="pre"&gt;\-e&lt;/span&gt; &amp;quot;&amp;nbsp;&amp;nbsp;&amp;nbsp; keystroke &lt;span class="pre"&gt;\&amp;quot;:$line\&amp;quot;&lt;/span&gt; &amp;amp; return &amp;quot; &lt;span class="pre"&gt;\-e&lt;/span&gt; &amp;quot;&amp;nbsp; end tell&amp;quot; &lt;span class="pre"&gt;\-e&lt;/span&gt; &amp;quot;end tell&amp;quot;&lt;/tt&gt;
New code: &lt;a class="reference external" href="http://agpy.googlecode.com/svn/trunk/macvim-skim/macvim-load-line"&gt;download link A&lt;/a&gt;&lt;/p&gt;
&lt;pre class="literal-block"&gt;
#!/bin/bash# Install directions:# Put this file somewhere in your path and make it executable# To set up in Skim, go to Preferences:Sync# Change Preset: to Custom# Change Command: to macvim-load-line# Change Arguments: to &amp;quot;%file&amp;quot; %linefile=&amp;quot;$1&amp;quot;line=&amp;quot;$2&amp;quot;debug=&amp;quot;$3&amp;quot;echo file: $fileecho line: $lineecho debug: $debugfor server in `mvim --serverlist` do    foundfile=`mvim --servername $server --remote-expr &amp;quot;WhichTab('$file')&amp;quot;`    if [[ $foundfile &amp;gt; 0 ]]    then        mvim --servername $server --remote-expr &amp;quot;foreground()&amp;quot;         if [[ $debug ]] ; then echo mvim --servername $server --remote-send &amp;quot;:exec \&amp;quot;tabnext $foundfile\&amp;quot; &amp;quot;; fi        mvim --servername $server --remote-send &amp;quot;:exec \&amp;quot;tabnext $foundfile\&amp;quot; &amp;quot;        if [[ $debug ]] ; then echo mvim --servername $server --remote-send &amp;quot;:$line &amp;quot;; fi        mvim --servername $server --remote-send &amp;quot;:$line &amp;quot;    fidone
&lt;/pre&gt;
&lt;p&gt;Save that as an executable in your default path (e.g.,
&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;/usr/local/bin/macvim-load-line&lt;/span&gt;&lt;/tt&gt;) and open Skim.app, go to
Preferences:Sync and make the command look like this:&lt;/p&gt;
&lt;img alt="" src="http://3.bp.blogspot.com/-SbMLRTNSxug/Tw8_0saPQUI/AAAAAAAAGrc/9Ab8bgH8Ej0/s320/Screen%2Bshot%2B2012-01-12%2Bat%2B1.17.09%2BPM.png" /&gt;
&lt;p&gt;You need to have mvim on your path. mvim comes with MacVim.app, but is
NOT installed by default. Install it by doing something like:
`` cp /Users/adam/Downloads/MacVim-7_3-53/mvim /usr/local/bin/mvim ``
You'll also need to install WhichTab.vim in your &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;~/.vim/plugins/&lt;/span&gt;&lt;/tt&gt;
directory. It's available &lt;a class="reference external" href="http://code.google.com/p/agpy/source/browse/trunk/macvim-skim/WhichTab.vim"&gt;here&lt;/a&gt; (&lt;a class="reference external" href="http://agpy.googlecode.com/svn/trunk/macvim-skim/WhichTab.vim"&gt;download link B&lt;/a&gt;). Here's the source:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
function! WhichTab(filename)    &amp;quot; Try to determine whether file is open in any tab.      &amp;quot; Return number of tab it's open in    let buffername = bufname(a:filename)    if buffername == &amp;quot;&amp;quot;        return 0    endif    let buffernumber = bufnr(buffername)    &amp;quot; tabdo will loop through pages and leave you on the last one;    &amp;quot; this is to make sure we don't leave the current page    let currenttab = tabpagenr()    let tab_arr = []    tabdo let tab_arr += tabpagebuflist()    &amp;quot; return to current page    exec &amp;quot;tabnext &amp;quot;.currenttab    &amp;quot; Start checking tab numbers for matches    let i = 0    for tnum in tab_arr        let i += 1        echo &amp;quot;tnum: &amp;quot;.tnum.&amp;quot; buff: &amp;quot;.buffernumber.&amp;quot; i: &amp;quot;.i        if tnum == buffernumber            return i        endif    endforendfunctionfunction! WhichWindow(filename)    &amp;quot; Try to determine whether the file is open in any GVIM *window*    let serverlist = split(serverlist(),&amp;quot;\n&amp;quot;)    &amp;quot;let currentserver = ????    for server in serverlist        let remotetabnum = remote_expr(server,             \&amp;quot;WhichTab('&amp;quot;.a:filename.&amp;quot;')&amp;quot;)        if remotetabnum != 0            return server        endif    endforendfunction
&lt;/pre&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="latex"></category><category term="vim"></category><category term="code"></category></entry><entry><title>Listing variables (e.g IDL help) in Python</title><link href="https://keflavich.github.io/blog/listing-variables-eg-idl-help-in-python.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/listing-variables-eg-idl-help-in-python.html</id><summary type="html">&lt;p&gt;Again, IDL has the simple 'help' command to tell you all variables in
your namespace. Python has the same thing, but the namespace tends to be
cluttered with imported functions. The commands who, who_ls, and whos
are meant for interactive use. They are a hell of a lot more …&lt;/p&gt;</summary><content type="html">&lt;p&gt;Again, IDL has the simple 'help' command to tell you all variables in
your namespace. Python has the same thing, but the namespace tends to be
cluttered with imported functions. The commands who, who_ls, and whos
are meant for interactive use. They are a hell of a lot more useful than
var, locals, globals, and dir.
examples:
&lt;tt class="docutils literal"&gt;whos floatwhos ndarraywho modulefloat_vars = %who_ls &lt;span class="pre"&gt;floatgrep('x',float_vars)&lt;/span&gt;&lt;/tt&gt;
I'm afraid I don't know how to make the last two lines into a one-liner,
as would be desirable.&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="python"></category><category term="computer"></category></entry><entry><title>Logarithmic Colormap / Other Colormap in Matplotlib</title><link href="https://keflavich.github.io/blog/logarithmic-colormap-other-colormap-in-matplotlib.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/logarithmic-colormap-other-colormap-in-matplotlib.html</id><summary type="html">&lt;p&gt;This is kind of a pain to find out:
&lt;tt class="docutils literal"&gt;from matplotlib.colors import LogNormim = &lt;span class="pre"&gt;imshow(....&lt;/span&gt; &lt;span class="pre"&gt;cmap=...&lt;/span&gt; , norm=LogNorm(vmin=clevs[0], &lt;span class="pre"&gt;vmax=clevs[-1]))&lt;/span&gt; ``
It also works for contours, and can be particularly useful if you only
want to display contours at a few levels, but you want the colormap …&lt;/tt&gt;&lt;/p&gt;</summary><content type="html">&lt;p&gt;This is kind of a pain to find out:
&lt;tt class="docutils literal"&gt;from matplotlib.colors import LogNormim = &lt;span class="pre"&gt;imshow(....&lt;/span&gt; &lt;span class="pre"&gt;cmap=...&lt;/span&gt; , norm=LogNorm(vmin=clevs[0], &lt;span class="pre"&gt;vmax=clevs[-1]))&lt;/span&gt; ``
It also works for contours, and can be particularly useful if you only
want to display contours at a few levels, but you want the colormap to
start at a different point. e.g.:
&lt;span class="pre"&gt;``contour(xx,levels=[2,3,4,5,6,7,8,9,10],norm=matplotlib.colors.Normalize(vmin=0,vmax=10))&lt;/span&gt;&lt;/tt&gt;
will start at light blue instead of dark blue in the default colormap&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="matplotlib"></category><category term="python"></category></entry><entry><title>login shell</title><link href="https://keflavich.github.io/blog/login-shell.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/login-shell.html</id><content type="html">&lt;p&gt;to change your default login shell, use &lt;tt class="docutils literal"&gt;chsh&lt;/tt&gt;&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="unix"></category></entry><entry><title>Lunar Occultation Hi-Res measurements</title><link href="https://keflavich.github.io/blog/lunar-occultation-hi-res-measurements.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/lunar-occultation-hi-res-measurements.html</id><summary type="html">&lt;p&gt;The folks at the VLT have come up with a means of achieving extremely
high resolution from the ground: Observe when the moon occults a source
and how long the occultation takes. Sweet.
This was applied in the galactic center first, of course:
&lt;a class="reference external" href="http://arxiv.org/abs/0807.2646"&gt;Observations of binaries in GC&lt;/a&gt;
&lt;a class="reference external" href="http://arxiv.org/abs/0807.2650"&gt;Additional observations …&lt;/a&gt;&lt;/p&gt;</summary><content type="html">&lt;p&gt;The folks at the VLT have come up with a means of achieving extremely
high resolution from the ground: Observe when the moon occults a source
and how long the occultation takes. Sweet.
This was applied in the galactic center first, of course:
&lt;a class="reference external" href="http://arxiv.org/abs/0807.2646"&gt;Observations of binaries in GC&lt;/a&gt;
&lt;a class="reference external" href="http://arxiv.org/abs/0807.2650"&gt;Additional observations in GC&lt;/a&gt;&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="astronomy"></category></entry><entry><title>Mac stuff cont'd</title><link href="https://keflavich.github.io/blog/mac-stuff-contd.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/mac-stuff-contd.html</id><content type="html">&lt;p&gt;Trying to get Apache server to run, and it's just a pain.
I frequently forget how to update the locate database because it's
different on macs. Marcos' Mac Singularity &lt;a class="reference external" href="http://macsingularity.org/2004/12/17/the-locate-database/"&gt;has the instructions&lt;/a&gt;.
In short:
&lt;tt class="docutils literal"&gt;sudo /usr/libexec/locate.updatedb&lt;/tt&gt;&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="computer"></category></entry><entry><title>Mac terminal stuff</title><link href="https://keflavich.github.io/blog/mac-terminal-stuff.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/mac-terminal-stuff.html</id><content type="html">&lt;p&gt;xterm-color has some annoying features when SSHing to other compys,
including 'top' not functioning properly. The error I receive:
&lt;tt class="docutils literal"&gt;top: no termcap entry for a &lt;span class="pre"&gt;`xterm-color'&lt;/span&gt; terminal&lt;/tt&gt;
The solution:
&lt;a class="reference external" href="http://www.macosxhints.com/article.php?story=20031031185759986"&gt;From MacOSXhints&lt;/a&gt;, in bash just add &lt;tt class="docutils literal"&gt;export &lt;span class="pre"&gt;TERM=&amp;quot;vt100&amp;quot;&lt;/span&gt;&lt;/tt&gt; to your
&lt;tt class="docutils literal"&gt;.profile&lt;/tt&gt; file.&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="computer"></category></entry><entry><title>macvim crash</title><link href="https://keflavich.github.io/blog/macvim-crash.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/macvim-crash.html</id><summary type="html">&lt;p&gt;&lt;p&gt;well, it finally happened.... my reliable, trusty editor crashed. That
should be impossible. I am ready to call it quits for the week....&lt;/p&gt;
&lt;pre class="literal-block"&gt;
Process:         MacVim [650]Path:            /Applications/Vim.app/Contents/MacOS/MacVimIdentifier:      org.vim.MacVimVersion:         7.2 (49)Code Type:       X86 (Native)Parent Process:  Vim [649]Date/Time:       2010-02-25 …&lt;/pre&gt;&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;p&gt;well, it finally happened.... my reliable, trusty editor crashed. That
should be impossible. I am ready to call it quits for the week....&lt;/p&gt;
&lt;pre class="literal-block"&gt;
Process:         MacVim [650]Path:            /Applications/Vim.app/Contents/MacOS/MacVimIdentifier:      org.vim.MacVimVersion:         7.2 (49)Code Type:       X86 (Native)Parent Process:  Vim [649]Date/Time:       2010-02-25 13:12:43.001 -0700OS Version:      Mac OS X 10.6.2 (10C540)Report Version:  6Interval Since Last Report:          871676 secCrashes Since Last Report:           26Per-App Interval Since Last Report:  938504 secPer-App Crashes Since Last Report:   1Anonymous UUID:                      03159B9E-2257-4E38-8C4A-4D4DAF5641A7Exception Type:  EXC_BAD_ACCESS (SIGSEGV)Exception Codes: 0x000000000000000d, 0x0000000000000000Crashed Thread:  0  Dispatch queue: com.apple.main-threadThread 0 Crashed:  Dispatch queue: com.apple.main-thread0   com.apple.CoreFoundation       0x99119480 __CFSetCallback + 01   com.apple.CoreFoundation       0x990c78bc ___CFBasicHashFindBucket1 + 4442   com.apple.CoreFoundation       0x990cfaac CFBasicHashFindBucket + 2523   com.apple.CoreFoundation       0x990e8293 CFSetGetValue + 1314   com.apple.AppKit               0x961bae7e -[NSWindow _discardTrackingRect:] + 595   com.apple.AppKit               0x961badca -[NSView(NSInternal) _uninstallTrackingArea:] + 1236   com.apple.AppKit               0x960d2c32 -[NSView(NSInternal) _uninstallRemovedTrackingAreas] + 2937   com.apple.AppKit               0x960dac40 -[NSView(NSInternal) _updateTrackingAreas] + 6468   com.apple.CoreFoundation       0x990ea4e0 CFArrayApplyFunction + 2249   com.apple.AppKit               0x960daefb -[NSView(NSInternal) _updateTrackingAreas] + 134510  com.apple.CoreFoundation       0x990ea4e0 CFArrayApplyFunction + 22411  com.apple.AppKit               0x960daefb -[NSView(NSInternal) _updateTrackingAreas] + 134512  com.apple.CoreFoundation       0x990ea4e0 CFArrayApplyFunction + 22413  com.apple.AppKit               0x960daefb -[NSView(NSInternal) _updateTrackingAreas] + 134514  com.apple.AppKit               0x960da8db _handleInvalidCursorRectsNote + 39215  com.apple.CoreFoundation       0x99135892 __CFRunLoopDoObservers + 118616  com.apple.CoreFoundation       0x990f218d __CFRunLoopRun + 55717  com.apple.CoreFoundation       0x990f1864 CFRunLoopRunSpecific + 45218  com.apple.CoreFoundation       0x990f1691 CFRunLoopRunInMode + 9719  com.apple.HIToolbox            0x936f6f0c RunCurrentEventLoopInMode + 39220  com.apple.HIToolbox            0x936f6bff ReceiveNextEventCommon + 15821  com.apple.HIToolbox            0x936f6b48 BlockUntilNextEventMatchingListInMode + 8122  com.apple.AppKit               0x960b0ac5 _DPSNextEvent + 84723  com.apple.AppKit               0x960b0306 -[NSApplication nextEventMatchingMask:untilDate:inMode:dequeue:] + 15624  com.apple.AppKit               0x9607249f -[NSApplication run] + 82125  com.apple.AppKit               0x9606a535 NSApplicationMain + 57426  org.vim.MacVim                 0x0000238b _start + 20927  org.vim.MacVim                 0x000022b9 start + 41Thread 1:  Dispatch queue: com.apple.libdispatch-manager0   libSystem.B.dylib              0x98d0c0ea kevent + 101   libSystem.B.dylib              0x98d0c804 _dispatch_mgr_invoke + 2152   libSystem.B.dylib              0x98d0bcc3 _dispatch_queue_invoke + 1633   libSystem.B.dylib              0x98d0ba68 _dispatch_worker_thread2 + 2344   libSystem.B.dylib              0x98d0b4f1 _pthread_wqthread + 3905   libSystem.B.dylib              0x98d0b336 start_wqthread + 30Thread 2:0   libSystem.B.dylib              0x98ce58da mach_msg_trap + 101   libSystem.B.dylib              0x98ce6047 mach_msg + 682   com.apple.CoreFoundation       0x990f277f __CFRunLoopRun + 20793   com.apple.CoreFoundation       0x990f1864 CFRunLoopRunSpecific + 4524   com.apple.CoreFoundation       0x990f1691 CFRunLoopRunInMode + 975   com.apple.Foundation           0x91b24430 +[NSURLConnection(NSURLConnectionReallyInternal) _resourceLoadLoop:] + 3296   com.apple.Foundation           0x91aeb8d8 -[NSThread main] + 457   com.apple.Foundation           0x91aeb888 __NSThread__main__ + 14998   libSystem.B.dylib              0x98d12fbd _pthread_start + 3459   libSystem.B.dylib              0x98d12e42 thread_start + 34Thread 3:0   libSystem.B.dylib              0x98d04856 select$DARWIN_EXTSN + 101   com.apple.CoreFoundation       0x99131ddd __CFSocketManager + 10852   libSystem.B.dylib              0x98d12fbd _pthread_start + 3453   libSystem.B.dylib              0x98d12e42 thread_start + 34Thread 4:0   libSystem.B.dylib              0x98d0b182 __workq_kernreturn + 101   libSystem.B.dylib              0x98d0b718 _pthread_wqthread + 9412   libSystem.B.dylib              0x98d0b336 start_wqthread + 30Thread 0 crashed with X86 Thread State (32-bit):  eax: 0x00515db0  ebx: 0x990c7711  ecx: 0x00516460  edx: 0xbfffcabc  edi: 0x00001041  esi: 0x00504270  ebp: 0xbfffca38  esp: 0xbfffc99c   ss: 0x0000001f  efl: 0x00010246  eip: 0x99119480   cs: 0x00000017   ds: 0x0000001f   es: 0x0000001f   fs: 0x00000000   gs: 0x00000037  cr2: 0x97a20000
&lt;/pre&gt;
&lt;/p&gt;</content><category term="misc"></category><category term="googlepost"></category><category term="mac"></category><category term="computer"></category></entry><entry><title>Major mac problems</title><link href="https://keflavich.github.io/blog/major-mac-problems.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/major-mac-problems.html</id><summary type="html">&lt;p&gt;The errors are, in short:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Browser stops responding / starts returning &amp;quot;page not found&amp;quot;
(indicating a failure of mDNSResponder)&lt;/li&gt;
&lt;li&gt;killing mDNSResponder sometimes brings browser back, but more often
leads to a partial system freeze (some windows don't respond, can't
switch between windows except by clicking)&lt;/li&gt;
&lt;li&gt;/var/log/system.log gets flooded …&lt;/li&gt;&lt;/ul&gt;</summary><content type="html">&lt;p&gt;The errors are, in short:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Browser stops responding / starts returning &amp;quot;page not found&amp;quot;
(indicating a failure of mDNSResponder)&lt;/li&gt;
&lt;li&gt;killing mDNSResponder sometimes brings browser back, but more often
leads to a partial system freeze (some windows don't respond, can't
switch between windows except by clicking)&lt;/li&gt;
&lt;li&gt;/var/log/system.log gets flooded with &amp;quot;too many files open&amp;quot; errors.&lt;/li&gt;
&lt;li&gt;somewhere in here the Dock fails&lt;/li&gt;
&lt;li&gt;killing Google Chrome and/or the Dock fails; the process never halts
(even kill -9 + kill -s SIGCHLD)&lt;/li&gt;
&lt;li&gt;usually one or two crash reports pop up, at least one of which is for
crash_reporter&lt;/li&gt;
&lt;li&gt;system.log stops getting flooded, but the browser and Dock never
recover&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The only message in system.log that gives me any hint about what might
be happening is occasionally a freeze was resolved at the same time as
this message: Jun 22 19:02:09 eta Quicksilver[93771]: Multiple Scans
Attempted but it doesn't seem to change the situation if quicksilver is
open or not. Google has nothing on this issue, either, except for the
quicksilver source code, so evidently it has not caused problems for
other people system.log was also being flooded with this message:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
Jun 23 08:57:19 eta postfix/master[99954]: fatal: open /dev/null: Bad file descriptorJun 23 08:57:20 eta com.apple.launchd[1] (org.postfix.master[99954]): Exited with exit code: 1Jun 23 08:57:20 eta com.apple.launchd[1] (org.postfix.master): Throttling respawn: Will start in 9 seconds
&lt;/pre&gt;
&lt;p&gt;so I disabled my postman:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
Jun 23 08:57:27 eta sudo[99955]: adam : TTY=ttys006 ; PWD=/Users/adam/proposals/alma ; USER=root ; COMMAND=/bin/launchctl unload -w /System/Library/LaunchDaemons/org.postfix.master.plist
&lt;/pre&gt;
&lt;p&gt;These errors:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
Jun 23 09:06:40 eta Dock[99877]: kCGErrorIllegalArgument: CGSSetWindowTransformAtPlacement: Singular matrix [nan 0.000 0.000 nan]Jun 23 09:06:40 eta com.apple.Dock.agent[99877]: Thu Jun 23 09:06:40 eta.colorado.edu Dock[99877] : kCGErrorIllegalArgument: CGSSetWindowTransformAtPlacement: Singular matrix [nan 0.000 0.000 nan]
&lt;/pre&gt;
&lt;p&gt;are correlated with opening Chrome windows and/or Chrome's
crash_inspector&lt;/p&gt;
&lt;pre class="literal-block"&gt;
Jun 23 09:06:09 eta [0x0-0x69e69e].com.google.Chrome[99995]: [99995:24579:485131152128125:ERROR:shared_memory_posix.cc(164)] Creating shared memory in /var/folders/ni/ni+DtdqFGMeSMH13AvkNkU+++TI/-Tmp-/.com.google.chrome.sHcu6r failed: Too many open files in system
&lt;/pre&gt;
&lt;p&gt;This is the problem that really gets me... I think it's
crash_inspector's fault.
But there's definitely more going on here than just Chrome. Trying to
change default browsers (by opening Safari and opening Preferences) led
to a partial Dock crash (?!) in which I can alt-tab but can't see the
Dock. Not clear at all what's going on.... argh.&lt;/p&gt;
&lt;/p&gt;</content><category term="misc"></category><category term="googlepost"></category><category term="crash"></category><category term="computer"></category></entry><entry><title>Make PDFs open with the thumbnails window open</title><link href="https://keflavich.github.io/blog/make-pdfs-open-with-the-thumbnails-window-open.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/make-pdfs-open-with-the-thumbnails-window-open.html</id><summary type="html">&lt;p&gt;Neat trick I picked up from here:
&lt;a class="reference external" href="http://www.ghostscript.com/~ghostgum/pdftips.htm"&gt;http://www.ghostscript.com/~ghostgum/pdftips.htm&lt;/a&gt;
Add this code:
``  special{! /pdfmark               [/View [/XYZ null null 1]  % unspecified x and y offset, 100% zoom               /Page 1               /PageMode /UseThumbs % /UseNone /UserOutlines /UseThumbs /FullScreen              /DOCVIEW pdfmark               }``
to a LaTeX document (probably near the top) and …&lt;/p&gt;</summary><content type="html">&lt;p&gt;Neat trick I picked up from here:
&lt;a class="reference external" href="http://www.ghostscript.com/~ghostgum/pdftips.htm"&gt;http://www.ghostscript.com/~ghostgum/pdftips.htm&lt;/a&gt;
Add this code:
``  special{! /pdfmark               [/View [/XYZ null null 1]  % unspecified x and y offset, 100% zoom               /Page 1               /PageMode /UseThumbs % /UseNone /UserOutlines /UseThumbs /FullScreen              /DOCVIEW pdfmark               }``
to a LaTeX document (probably near the top) and when you ps2pdf it, it
will open the PDF with the thumbnail bar open. This is very useful for
proofreading after you latex a file. Of course, xdvi also works well for
this, but xdvi is VERY unstable on the Mac. At least adobe, being a
native Mac program, doesn't crash as often.&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="pdf"></category></entry><entry><title>Making a postscript plot of a gigantic fits image</title><link href="https://keflavich.github.io/blog/making-a-postscript-plot-of-a-gigantic-fits-image.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/making-a-postscript-plot-of-a-gigantic-fits-image.html</id><summary type="html">&lt;p&gt;``    map = readfits('MOSAIC.fits',hdr)    crpix1 = sxpar(hdr,'CRPIX1')    crpix2 = sxpar(hdr,'CRPIX2')    crval1 = sxpar(hdr,'CRVAL1')    crval2 = sxpar(hdr,'CRVAL2')    cd1_1 = sxpar(hdr,'CD1_1')    cd2_2 = sxpar(hdr,'CD2_2')       x = lindgen(n_e(map[&lt;em&gt;,0]))    y = lindgen(n_e(map[0,&lt;/em&gt;]))    l = (x-crpix1)*cd1_1+crval1-360 …&lt;/p&gt;</summary><content type="html">&lt;p&gt;``    map = readfits('MOSAIC.fits',hdr)    crpix1 = sxpar(hdr,'CRPIX1')    crpix2 = sxpar(hdr,'CRPIX2')    crval1 = sxpar(hdr,'CRVAL1')    crval2 = sxpar(hdr,'CRVAL2')    cd1_1 = sxpar(hdr,'CD1_1')    cd2_2 = sxpar(hdr,'CD2_2')       x = lindgen(n_e(map[&lt;em&gt;,0]))    y = lindgen(n_e(map[0,&lt;/em&gt;]))    l = (x-crpix1)*cd1_1+crval1-360    b = (y-crpix2)*cd2_2+crval2    imdisp,map,/axis,xrange=[max(l),min(l)],yrange=[min(b),max(b)],range=[-1,8]``
This code makes use of &lt;a class="reference external" href="http://cimss.ssec.wisc.edu/~gumley/idl/imdisp.pro"&gt;imdisp.pro&lt;/a&gt;.&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="idl"></category></entry><entry><title>Marc Pound's toolbox</title><link href="https://keflavich.github.io/blog/marc-pounds-toolbox.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/marc-pounds-toolbox.html</id><content type="html">&lt;p&gt;This is neat:
&lt;a class="reference external" href="http://dustem.astro.umd.edu/pdrt/quickmodels.html"&gt;Line Ratio as a function of density, incident flux from Marc Pound&lt;/a&gt;.
Sadly, straight CO 3-2 intensity isn't included, but perhaps I can
create that myself.&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="astronomy"></category></entry><entry><title>mathematica</title><link href="https://keflavich.github.io/blog/mathematica.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/mathematica.html</id><content type="html">&lt;p&gt;//. and /. use 'rules' of the form {x-&amp;gt;y} for substitutions
how do you make the layout of a page look nice? How do you change line
spacing?&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="computer"></category></entry><entry><title>Mathematica &amp; Series expansions</title><link href="https://keflavich.github.io/blog/mathematica-series-expansions.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/mathematica-series-expansions.html</id><summary type="html">&lt;p&gt;Mathematica does something stupid and incomprehensible (to me) with
their series expansions. For no clear reason, it makes the
O[x]&lt;sup&gt;n&lt;/sup&gt; uneditable, and adds a bunch of formatting things that
prevent you from copying &amp;amp; pasting the expression and then solving for a
variable. Argh. While this is repairable using …&lt;/p&gt;</summary><content type="html">&lt;p&gt;Mathematica does something stupid and incomprehensible (to me) with
their series expansions. For no clear reason, it makes the
O[x]&lt;sup&gt;n&lt;/sup&gt; uneditable, and adds a bunch of formatting things that
prevent you from copying &amp;amp; pasting the expression and then solving for a
variable. Argh. While this is repairable using the &amp;quot;show expression&amp;quot;
tool (Shift-Apple-E), it's a pain and &amp;quot;show expression&amp;quot; is not meant to
be human readable.&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="mathematica"></category></entry><entry><title>matplotlib 64 bit installs never work</title><link href="https://keflavich.github.io/blog/matplotlib-64-bit-installs-never-work.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/matplotlib-64-bit-installs-never-work.html</id><summary type="html">&lt;p&gt;a clue as to why:
functional ft2font.so:
&lt;tt class="docutils literal"&gt;$ otool &lt;span class="pre"&gt;-L&lt;/span&gt; &lt;span class="pre"&gt;/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/matplotlib/ft2font.so&lt;/span&gt; &lt;span class="pre"&gt;/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/matplotlib/ft2font.so:&lt;/span&gt; /usr/local/lib/libfreetype.6.dylib (compatibility version 10.0.0, current …&lt;/tt&gt;&lt;/p&gt;</summary><content type="html">&lt;p&gt;a clue as to why:
functional ft2font.so:
&lt;tt class="docutils literal"&gt;$ otool &lt;span class="pre"&gt;-L&lt;/span&gt; &lt;span class="pre"&gt;/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/matplotlib/ft2font.so&lt;/span&gt; &lt;span class="pre"&gt;/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/matplotlib/ft2font.so:&lt;/span&gt; /usr/local/lib/libfreetype.6.dylib (compatibility version 10.0.0, current version 10.22.0) /usr/lib/libz.1.dylib (compatibility version 1.0.0, current version 1.2.3) &lt;span class="pre"&gt;/usr/local/lib/libstdc++.6.dylib&lt;/span&gt; (compatibility version 7.0.0, current version 7.14.0) /usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 125.2.11)&lt;/tt&gt;
nonfunctional ft2font.so:
&lt;tt class="docutils literal"&gt;$ otool &lt;span class="pre"&gt;-L&lt;/span&gt; &lt;span class="pre"&gt;/Users/adam/repos/yt/yt-i386/lib/python2.7/site-packages/matplotlib/ft2font.so/Users/adam/repos/yt/yt-i386/lib/python2.7/site-packages/matplotlib/ft2font.so:&lt;/span&gt; &lt;span class="pre"&gt;/Users/adam/repos/yt/yt-i386/lib/libfreetype.6.dylib&lt;/span&gt; (compatibility version 13.0.0, current version 13.2.0) &lt;span class="pre"&gt;/Users/adam/repos/yt/yt-i386//lib/libz.1.dylib&lt;/span&gt; (compatibility version 1.0.0, current version 1.2.3) &lt;span class="pre"&gt;/usr/local/lib/libstdc++.6.dylib&lt;/span&gt; (compatibility version 7.0.0, current version 7.14.0) /usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 125.2.11) /usr/local/lib/libgcc_s.1.dylib (compatibility version 1.0.0, current version 1.0.0)&lt;/tt&gt;
The culprit is the difference between those two (maybe?):
&lt;tt class="docutils literal"&gt;$ file /usr/local/lib/libgcc_s.1.dylib/usr/local/lib/libgcc_s.1.dylib: &lt;span class="pre"&gt;Mach-O&lt;/span&gt; universal binary with 4 architectures/usr/local/lib/libgcc_s.1.dylib (for architecture i386): &lt;span class="pre"&gt;Mach-O&lt;/span&gt; dynamically linked shared library i386/usr/local/lib/libgcc_s.1.dylib (for architecture x86_64): &lt;span class="pre"&gt;Mach-O&lt;/span&gt; &lt;span class="pre"&gt;64-bit&lt;/span&gt; dynamically linked shared library x86_64/usr/local/lib/libgcc_s.1.dylib (for architecture ppc): &lt;span class="pre"&gt;Mach-O&lt;/span&gt; dynamically linked shared library ppc/usr/local/lib/libgcc_s.1.dylib (for architecture ppc64): &lt;span class="pre"&gt;Mach-O&lt;/span&gt; &lt;span class="pre"&gt;64-bit&lt;/span&gt; dynamically linked shared library ppc64$ otool &lt;span class="pre"&gt;-L&lt;/span&gt; /usr/local/lib/libgcc_s.1.dylib/usr/local/lib/libgcc_s.1.dylib: /usr/local/lib/libgcc_s.1.dylib (compatibility version 1.0.0, current version 1.0.0) /usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 88.3.9)&lt;/tt&gt;&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="matplotlib"></category><category term="computer"></category></entry><entry><title>Mercurial - behave like SVN?</title><link href="https://keflavich.github.io/blog/mercurial-behave-like-svn.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/mercurial-behave-like-svn.html</id><summary type="html">&lt;p&gt;I'm trying to use hooks to make mercurial behave like svn when
committing. I like the idea that I can commit changes to my cloned repo
while I'm away from the internet, but I never want that behavior when I
do have internet access. Therefore, I want to attempt to …&lt;/p&gt;</summary><content type="html">&lt;p&gt;I'm trying to use hooks to make mercurial behave like svn when
committing. I like the idea that I can commit changes to my cloned repo
while I'm away from the internet, but I never want that behavior when I
do have internet access. Therefore, I want to attempt to pull before
updating and attempt to push after committing. Every time. I have been
consistently very unhappy with the &lt;tt class="docutils literal"&gt;hg merge&lt;/tt&gt; command.
&lt;tt class="docutils literal"&gt;[hooks]precommit = hg pull; hg uppostcommit= hg &lt;span class="pre"&gt;pushpost-pull&lt;/span&gt; = hg up&lt;/tt&gt;
However, this doesn't work. precommit freezes with the error
&lt;tt class="docutils literal"&gt;waiting for lock on working directory of [dir] held by [procnum]&lt;/tt&gt;
and pre-commit results in other errors:
&lt;tt class="docutils literal"&gt;running hook &lt;span class="pre"&gt;pre-commit:&lt;/span&gt; hg pull; hg uppulling from [source]searching for changesno changes foundrunning hook &lt;span class="pre"&gt;post-pull:&lt;/span&gt; hg upabort: outstanding uncommitted mergeswarning: &lt;span class="pre"&gt;post-pull&lt;/span&gt; hook exited with status 255abort: outstanding uncommitted mergeswarning: &lt;span class="pre"&gt;pre-commit&lt;/span&gt; hook exited with status 255&lt;/tt&gt;
&lt;a class="reference external" href="http://casa.colorado.edu/~ginsbura/index.htm"&gt;AG&lt;/a&gt;&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="mercurial"></category><category term="subversion"></category></entry><entry><title>mercurial merge</title><link href="https://keflavich.github.io/blog/mercurial-merge.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/mercurial-merge.html</id><summary type="html">&lt;p&gt;&lt;p&gt;&lt;a class="reference external" href="http://casa.colorado.edu/~ginsbura/index.htm"&gt;AG&lt;/a&gt;
My most hated behavior of mercurial:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
searching for changesadding changesetsadding manifestsadding file changesadded 1 changesets with 3 changes to 3 files (+1 heads)(run 'hg heads' to see heads, 'hg merge' to merge)remote: 1 changesets foundrunning hook post-pull: hg upabort: crosses branches (merge branches or use --clean to …&lt;/pre&gt;&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;p&gt;&lt;a class="reference external" href="http://casa.colorado.edu/~ginsbura/index.htm"&gt;AG&lt;/a&gt;
My most hated behavior of mercurial:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
searching for changesadding changesetsadding manifestsadding file changesadded 1 changesets with 3 changes to 3 files (+1 heads)(run 'hg heads' to see heads, 'hg merge' to merge)remote: 1 changesets foundrunning hook post-pull: hg upabort: crosses branches (merge branches or use --clean to discard changes)warning: post-pull hook exited with status 255$ hg mergeabort: outstanding uncommitted changes (use 'hg status' to list changes)$ hg commitnothing changed
&lt;/pre&gt;
&lt;p&gt;Solution:
`` hg merge --force ``
Hopefully there are other solutions that I'll eventually add to this.&lt;/p&gt;
&lt;/p&gt;</content><category term="misc"></category><category term="googlepost"></category><category term="mercurial"></category></entry><entry><title>Merging postscripts</title><link href="https://keflavich.github.io/blog/merging-postscripts.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/merging-postscripts.html</id><summary type="html">&lt;p&gt;This is essential and really difficult to find answers to, but this guy
gave it:
&lt;a class="reference external" href="http://ludo.qix.it/archive/2005/08/merge-postscript-files.html"&gt;http://ludo.qix.it/archive/2005/08/merge-postscript-files.html&lt;/a&gt;
The keywords I would have liked to see:
&lt;a class="reference external" href="http://ludo.qix.it/archive/2005/08/merge-postscript-files.html"&gt;&amp;quot;merge postscripts into multi-page document&amp;quot;&lt;/a&gt;
or &lt;a class="reference external" href="http://ludo.qix.it/archive/2005/08/merge-postscript-files.html"&gt;&amp;quot;combine postscript multiple page&amp;quot;&lt;/a&gt;
e.g.
&lt;tt class="docutils literal"&gt;gs &lt;span class="pre"&gt;-sDEVICE=pswrite&lt;/span&gt; &lt;span class="pre"&gt;-sOutputFile=output.ps …&lt;/span&gt;&lt;/tt&gt;&lt;/p&gt;</summary><content type="html">&lt;p&gt;This is essential and really difficult to find answers to, but this guy
gave it:
&lt;a class="reference external" href="http://ludo.qix.it/archive/2005/08/merge-postscript-files.html"&gt;http://ludo.qix.it/archive/2005/08/merge-postscript-files.html&lt;/a&gt;
The keywords I would have liked to see:
&lt;a class="reference external" href="http://ludo.qix.it/archive/2005/08/merge-postscript-files.html"&gt;&amp;quot;merge postscripts into multi-page document&amp;quot;&lt;/a&gt;
or &lt;a class="reference external" href="http://ludo.qix.it/archive/2005/08/merge-postscript-files.html"&gt;&amp;quot;combine postscript multiple page&amp;quot;&lt;/a&gt;
e.g.
&lt;tt class="docutils literal"&gt;gs &lt;span class="pre"&gt;-sDEVICE=pswrite&lt;/span&gt; &lt;span class="pre"&gt;-sOutputFile=output.ps&lt;/span&gt; &lt;span class="pre"&gt;-dNOPAUSE&lt;/span&gt; &lt;span class="pre"&gt;-dBATCH&lt;/span&gt; file1.ps file2.ps file3.psorgs &lt;span class="pre"&gt;-sDEVICE=pswrite&lt;/span&gt; &lt;span class="pre"&gt;-sOutputFile=05358spectra.ps&lt;/span&gt; &lt;span class="pre"&gt;-dNOPAUSE&lt;/span&gt; &lt;span class="pre"&gt;-dEPSFitPage&lt;/span&gt; &lt;span class="pre"&gt;-dBATCH&lt;/span&gt; `ls &lt;span class="pre"&gt;05358_*.eps`(the&lt;/span&gt; added option is to make sure the .eps isn't cropped)&lt;/tt&gt;&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="computer"></category><category term="postscript"></category></entry><entry><title>meta</title><link href="https://keflavich.github.io/blog/meta.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/meta.html</id><summary type="html">&lt;p&gt;Why a blog? I've been strongly opposed to blogs for the longest time
(after all, Desert Strike coined the word BLOG as an acronym for
building), so why use one now?
1. link power - more links to my own pages if done correctly
2. google owns the blogger
2.a …&lt;/p&gt;</summary><content type="html">&lt;p&gt;Why a blog? I've been strongly opposed to blogs for the longest time
(after all, Desert Strike coined the word BLOG as an acronym for
building), so why use one now?
1. link power - more links to my own pages if done correctly
2. google owns the blogger
2.a. google made it really easy
3. it's easier to add content here than to my real 'web page' which is
already too content-heavy. Still, my &lt;a class="reference external" href="http://casa.colorado.edu/~ginsbura/index.htm"&gt;web page&lt;/a&gt; is more useful for
displaying code, my cv, etc.
4. needed a place to post beer reviews / brewing related content that
doesn't fit on a normal web page unless I made a blog there
5. easiest way to take notes that I can't just accidentally delete...
and now that I've made this post,
6. because I like metahumour&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="meta"></category></entry><entry><title>Molecular Clouds</title><link href="https://keflavich.github.io/blog/molecular-clouds.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/molecular-clouds.html</id><summary type="html">&lt;p&gt;&lt;a class="reference external" href="http://casa.colorado.edu/~ginsbura/"&gt;I&lt;/a&gt;'m starting a blog on Molecular Clouds partly for the International
Year of Astronomy. Ideally, I'd like to present a tour of the W3/4/5
region, but at the moment that's more of a research blog than a public
blog. This is partly in response to &lt;a class="reference external" href="http://www.starstryder.com/2008/08/05/building-a-portal-to-the-universe/"&gt;Pamela Gay's …&lt;/a&gt;&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;a class="reference external" href="http://casa.colorado.edu/~ginsbura/"&gt;I&lt;/a&gt;'m starting a blog on Molecular Clouds partly for the International
Year of Astronomy. Ideally, I'd like to present a tour of the W3/4/5
region, but at the moment that's more of a research blog than a public
blog. This is partly in response to &lt;a class="reference external" href="http://www.starstryder.com/2008/08/05/building-a-portal-to-the-universe/"&gt;Pamela Gay's request for astronomy
blog feeds&lt;/a&gt;.
I've generally spent more time maintaining my personal web page than my
blog pages. The most interesting are:
&lt;a class="reference external" href="http://casa.colorado.edu/~ginsbura/w5_public.htm"&gt;W5&lt;/a&gt;
&lt;a class="reference external" href="http://casa.colorado.edu/~ginsbura/pcygni_public.htm"&gt;P Cygni&lt;/a&gt;
&lt;a class="reference external" href="http://casa.colorado.edu/~ginsbura/astropix.htm"&gt;Some pictures&lt;/a&gt;
but feel free to browse around.&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="intro"></category></entry><entry><title>Montage wrapper</title><link href="https://keflavich.github.io/blog/montage-wrapper.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/montage-wrapper.html</id><summary type="html">&lt;p&gt;(I'm going to try to gradually shift my blogging to this one...)
I wrote a bash wrapper for Tom Robitaille's montage wrapper to allow
fits wildcards.
&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;#!/bin/bashorigdir=`pwd`#echo&lt;/span&gt; $# $*if [ $# &lt;span class="pre"&gt;-gt&lt;/span&gt; 0 ]then&amp;nbsp;&amp;nbsp;&amp;nbsp; for ii in $*&amp;nbsp;&amp;nbsp;&amp;nbsp; do&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; if [ &lt;span class="pre"&gt;${ii%=*}&lt;/span&gt; == 'header' ]&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; then&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; /usr/local/bin/montage/mGetHdr &lt;span class="pre"&gt;${ii#*=}&lt;/span&gt; mosaic.hdr …&lt;/tt&gt;&lt;/p&gt;</summary><content type="html">&lt;p&gt;(I'm going to try to gradually shift my blogging to this one...)
I wrote a bash wrapper for Tom Robitaille's montage wrapper to allow
fits wildcards.
&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;#!/bin/bashorigdir=`pwd`#echo&lt;/span&gt; $# $*if [ $# &lt;span class="pre"&gt;-gt&lt;/span&gt; 0 ]then&amp;nbsp;&amp;nbsp;&amp;nbsp; for ii in $*&amp;nbsp;&amp;nbsp;&amp;nbsp; do&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; if [ &lt;span class="pre"&gt;${ii%=*}&lt;/span&gt; == 'header' ]&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; then&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; /usr/local/bin/montage/mGetHdr &lt;span class="pre"&gt;${ii#*=}&lt;/span&gt; mosaic.hdr&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; elif [ &lt;span class="pre"&gt;${ii%=*}&lt;/span&gt; == 'outfile' ]&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; then&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &lt;span class="pre"&gt;outfile=${ii#*=}&lt;/span&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; elif [ `echo $ii | grep =` ]&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; then&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &lt;span class="pre"&gt;params=&amp;quot;$params,${ii%=*}='${ii#*=}'&amp;quot;&lt;/span&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; elif [ `echo $ii | grep &amp;quot;.fits&amp;quot;` ]&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; then&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; files=( &lt;span class="pre"&gt;${files[&amp;#64;]}&lt;/span&gt; $ii )&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; fi&amp;nbsp;&amp;nbsp;&amp;nbsp; donefiecho &lt;span class="pre"&gt;${files[&amp;#64;]}&lt;/span&gt; &lt;span class="pre"&gt;${#files}&lt;/span&gt; if [ &lt;span class="pre"&gt;${#files}&lt;/span&gt; &lt;span class="pre"&gt;-gt&lt;/span&gt; 0 ] then&amp;nbsp;&amp;nbsp;&amp;nbsp; mkdir tmp&amp;nbsp;&amp;nbsp;&amp;nbsp; cp &lt;span class="pre"&gt;${files[&amp;#64;]}&lt;/span&gt; tmp/&amp;nbsp;&amp;nbsp;&amp;nbsp; cp mosaic.hdr tmp/&amp;nbsp;&amp;nbsp;&amp;nbsp; cd tmp/fiif [ &lt;span class="pre"&gt;-f&lt;/span&gt; mosaic.hdr ] then&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; echo &amp;quot;mosaic.hdr exists, continuing&amp;quot;&amp;nbsp;&amp;nbsp;&amp;nbsp; &lt;span class="pre"&gt;dir=`pwd`&lt;/span&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; echo python &lt;span class="pre"&gt;-c&lt;/span&gt; &amp;quot;import montage; &lt;span class="pre"&gt;montage.wrappers.mosaic('$dir','$dir/mosaic',header='$dir/mosaic.hdr'$params)&amp;quot;&lt;/span&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; python &lt;span class="pre"&gt;-c&lt;/span&gt; &amp;quot;import montage; &lt;span class="pre"&gt;montage.wrappers.mosaic('$dir','$dir/mosaic',header='$dir/mosaic.hdr'$params)&amp;quot;&lt;/span&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; cd $origdir&amp;nbsp;&amp;nbsp;&amp;nbsp; if [ &lt;span class="pre"&gt;-d&lt;/span&gt; tmp ]&amp;nbsp;&amp;nbsp;&amp;nbsp; then&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; if [ $outfile ]&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; then&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; mv tmp/mosaic/mosaic.fits $outfile&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; else&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; mv tmp/mosaic mosaic&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; fi&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; rm &lt;span class="pre"&gt;-r&lt;/span&gt; tmp&amp;nbsp;&amp;nbsp;&amp;nbsp; fielse&amp;nbsp;&amp;nbsp;&amp;nbsp; echo &amp;quot;mosaic.hdr does not exist.&amp;nbsp; Quitting.&amp;quot;&amp;nbsp;&amp;nbsp;&amp;nbsp; cd $origdirfi&lt;/tt&gt;&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="code"></category></entry><entry><title>More beer tastes</title><link href="https://keflavich.github.io/blog/more-beer-tastes.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/more-beer-tastes.html</id><summary type="html">&lt;p&gt;Stone Vertical Epic 8: described as an overhopped Belgian, and I think
they hit the mark exactly. It was pleasant and drinkable, with a strong
hop flavor but weak hop bitterness. 8.6% ABV
Fort Collins brewery double chocolate stout: a reasonable dessert beer.
Not nearly as dry as Stone's …&lt;/p&gt;</summary><content type="html">&lt;p&gt;Stone Vertical Epic 8: described as an overhopped Belgian, and I think
they hit the mark exactly. It was pleasant and drinkable, with a strong
hop flavor but weak hop bitterness. 8.6% ABV
Fort Collins brewery double chocolate stout: a reasonable dessert beer.
Not nearly as dry as Stone's Oatmeal Chocolate, but not as sweet as
Young's double chocolate. Chocolate undertones stayed undertones, which
is not what I expect from a double chocolate stout. 8.1% ABV
Avery / Liquor Mart 40th anniversary: Just a hoppy ale, nothing special.
Had a stronger hop aftertaste than most, not up to Avery's standard. No
ABV label.
Steamworks Kolsch: Very light kolsch. I think it may have had a crisp
flavor to it, but it was the last in line and unremarkable enough that
my comments on it are untrustworthy. 4.86% ABV.
Also, talked to Bobby again, he recommends St Bernard as a good Belgian.
That's on the list.&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="beer tasting"></category></entry><entry><title>More tastings</title><link href="https://keflavich.github.io/blog/more-tastings.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/more-tastings.html</id><content type="html">&lt;p&gt;Deschutes Black Butte XX - good for a porter, reasonably drinkable, but
still a porter
Rogue Chocolate Stout - a bit bitterer than I want in a chocolate stout
Victory 12 - pretty good, tasted a bit like a trippel
Sketch Wheat - much more drinkable than last time; &amp;quot;weirdness&amp;quot; gone&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category></entry><entry><title>MOSAIC data reduction</title><link href="https://keflavich.github.io/blog/mosaic-data-reduction.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/mosaic-data-reduction.html</id><summary type="html">&lt;p&gt;MOSAIC reduction is very difficult.
&lt;a class="reference external" href="http://www.noao.edu/noao/noaodeep/ReductionOpt/frames.html"&gt;http://www.noao.edu/noao/noaodeep/ReductionOpt/frames.html&lt;/a&gt; has the
official instructions.
Important things:
Have the latest version of &lt;a class="reference external" href="http://iraf.noao.edu/iraf/ftp/iraf/extern/mscred/"&gt;MSCRED&lt;/a&gt; and &lt;a class="reference external" href="http://iraf.noao.edu/iraf/ftp/iraf/extern/mscdb/"&gt;MSCDB&lt;/a&gt; installed. Both will
give cryptic errors or &amp;quot;cannot open file&amp;quot; errors (because the files
don't exist) otherwise.
&lt;tt class="docutils literal"&gt;mscredsetinstrument kpno CCDMosaThin1msccmatch &lt;span class="pre"&gt;obj09*.fits …&lt;/span&gt;&lt;/tt&gt;&lt;/p&gt;</summary><content type="html">&lt;p&gt;MOSAIC reduction is very difficult.
&lt;a class="reference external" href="http://www.noao.edu/noao/noaodeep/ReductionOpt/frames.html"&gt;http://www.noao.edu/noao/noaodeep/ReductionOpt/frames.html&lt;/a&gt; has the
official instructions.
Important things:
Have the latest version of &lt;a class="reference external" href="http://iraf.noao.edu/iraf/ftp/iraf/extern/mscred/"&gt;MSCRED&lt;/a&gt; and &lt;a class="reference external" href="http://iraf.noao.edu/iraf/ftp/iraf/extern/mscdb/"&gt;MSCDB&lt;/a&gt; installed. Both will
give cryptic errors or &amp;quot;cannot open file&amp;quot; errors (because the files
don't exist) otherwise.
&lt;tt class="docutils literal"&gt;mscredsetinstrument kpno CCDMosaThin1msccmatch &lt;span class="pre"&gt;obj09*.fits&lt;/span&gt; &lt;span class="pre"&gt;coords=&amp;quot;!mscgetcat&lt;/span&gt; $I $C&amp;quot; search=60 rsearch=1 nfit=30 accept=yes interactive=no fit=no&lt;/tt&gt;&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="iraf"></category></entry><entry><title>Most important astronomical publications</title><link href="https://keflavich.github.io/blog/most-important-astronomical-publications.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/most-important-astronomical-publications.html</id><content type="html">&lt;p&gt;I'm interested to hear input on this. Some I know of:
Cardelli, Clayton, Mathis 1989 - determined interstellar extinction law
Kurucz 1993 - possibly a book? Stellar atmosphere calculations&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="astronomy"></category></entry><entry><title>Mountain Sun</title><link href="https://keflavich.github.io/blog/mountain-sun.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/mountain-sun.html</id><summary type="html">&lt;p&gt;Went to the Mountain Sun, had the Thunderhead Stout and Stone's
Levitation IPA.
The Thunderhead Stout is one of my favorites. It's rich, slightly sweet,
full bodied. I can't identify any particular flavors, but it's
delicious.
Stone's Levitation IPA is dark brown for an IPA. It's hoppy and pretty
tasty …&lt;/p&gt;</summary><content type="html">&lt;p&gt;Went to the Mountain Sun, had the Thunderhead Stout and Stone's
Levitation IPA.
The Thunderhead Stout is one of my favorites. It's rich, slightly sweet,
full bodied. I can't identify any particular flavors, but it's
delicious.
Stone's Levitation IPA is dark brown for an IPA. It's hoppy and pretty
tasty, but nowhere near as good as the Dogfish Head IPAs.&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="beer tasting"></category></entry><entry><title>MOVIES!</title><link href="https://keflavich.github.io/blog/movies.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/movies.html</id><summary type="html">&lt;p&gt;Making movies is surprisingly difficult. No matter what language you
use, apparently true movie files can only be made by stringing together
images, i.e. there is no native movie-producing feature. Gnuplot can do
some simple animations but to do anything sophisticated you need to
start delving into variables, and …&lt;/p&gt;</summary><content type="html">&lt;p&gt;Making movies is surprisingly difficult. No matter what language you
use, apparently true movie files can only be made by stringing together
images, i.e. there is no native movie-producing feature. Gnuplot can do
some simple animations but to do anything sophisticated you need to
start delving into variables, and for that I switch to a real language.
So, I returned to python. As usual, it took no more than a few hours of
coding and learning to come up with something. But it bothers me that it
took that long: I still think python is most deficient in its failure to
create a default column-text reader like 'readcol' in IDL. I can't
complain that much, though: I wrote &lt;a class="reference external" href="http://casa.colorado.edu/~ginsbura/pyreadcol.htm"&gt;my own&lt;/a&gt; in about 5 minutes.
Anyway, the key is to use the &lt;tt class="docutils literal"&gt;.set_xdata&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;.set_ydata&lt;/tt&gt;
functions of a plot to update a canvas. I still don't have nearly as
high a plotting speed as I'd like, but it works alright if I don't
display to screen. Probably a different backend would be more effective
but I don't like to mess with backends.
I use `` savefig(filename,dpi=50) `` to reduce the image quality so that
it's easier for the animator to handle.
ImageMagick's convert can be used to stitch any kind of image into a
movie given that you've installed an mpeg2 encoder (fink gave me
&lt;tt class="docutils literal"&gt;mpeg2vidcodec&lt;/tt&gt;).&lt;/p&gt;
&lt;p&gt;The command is very simple:
&lt;tt class="docutils literal"&gt;convert &lt;span class="pre"&gt;-size&lt;/span&gt; 300x300 *.png movie.mpg&lt;/tt&gt;&lt;/p&gt;
&lt;p&gt;I had to use a smaller image size because a series of 1000x12kb files
somehow chomped ~6-8 GB of RAM and swap space.&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="animation"></category><category term="computer"></category></entry><entry><title>my scipy install...</title><link href="https://keflavich.github.io/blog/my-scipy-install.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/my-scipy-install.html</id><summary type="html">&lt;p&gt;As far as I was able to reconstruct, my scipy install looked like this
when it went well:
&lt;tt class="docutils literal"&gt;mkdir &lt;span class="pre"&gt;scipy-bincp&lt;/span&gt; &lt;span class="pre"&gt;../scipy-svn/site.cfg&lt;/span&gt; .export &lt;span class="pre"&gt;PATH=/Users/adam/repos/scipy.git/scipy-bin:$PATHln&lt;/span&gt; &lt;span class="pre"&gt;-s&lt;/span&gt; &lt;span class="pre"&gt;/usr/bin/g++-4.0&lt;/span&gt; &lt;span class="pre"&gt;scipy-bin/g++-4.0ln&lt;/span&gt; &lt;span class="pre"&gt;-s&lt;/span&gt; &lt;span class="pre"&gt;/usr/bin/g++-4.0&lt;/span&gt; &lt;span class="pre"&gt;scipy-bin/c …&lt;/span&gt;&lt;/tt&gt;&lt;/p&gt;</summary><content type="html">&lt;p&gt;As far as I was able to reconstruct, my scipy install looked like this
when it went well:
&lt;tt class="docutils literal"&gt;mkdir &lt;span class="pre"&gt;scipy-bincp&lt;/span&gt; &lt;span class="pre"&gt;../scipy-svn/site.cfg&lt;/span&gt; .export &lt;span class="pre"&gt;PATH=/Users/adam/repos/scipy.git/scipy-bin:$PATHln&lt;/span&gt; &lt;span class="pre"&gt;-s&lt;/span&gt; &lt;span class="pre"&gt;/usr/bin/g++-4.0&lt;/span&gt; &lt;span class="pre"&gt;scipy-bin/g++-4.0ln&lt;/span&gt; &lt;span class="pre"&gt;-s&lt;/span&gt; &lt;span class="pre"&gt;/usr/bin/g++-4.0&lt;/span&gt; &lt;span class="pre"&gt;scipy-bin/c++export&lt;/span&gt; &lt;span class="pre"&gt;CC=/usr/bin/gcc-4.0&lt;/span&gt; ln &lt;span class="pre"&gt;-s&lt;/span&gt; &lt;span class="pre"&gt;/usr/bin/gcc-4.0&lt;/span&gt; &lt;span class="pre"&gt;scipy-bin/ln&lt;/span&gt; &lt;span class="pre"&gt;-s&lt;/span&gt; &lt;span class="pre"&gt;/usr/bin/gcc-4.0&lt;/span&gt; &lt;span class="pre"&gt;scipy-bin/gccln&lt;/span&gt; &lt;span class="pre"&gt;-s&lt;/span&gt; &lt;span class="pre"&gt;/usr/local/bin/gfortran-4.0&lt;/span&gt; &lt;span class="pre"&gt;scipy-bin/gfortran-4.0ln&lt;/span&gt; &lt;span class="pre"&gt;-s&lt;/span&gt; &lt;span class="pre"&gt;/usr/local/bin/gfortran-4.0&lt;/span&gt; &lt;span class="pre"&gt;scipy-bin/gfortranln&lt;/span&gt; &lt;span class="pre"&gt;-s&lt;/span&gt; /usr/local/bin/g95 &lt;span class="pre"&gt;scipy-bin/g95ln&lt;/span&gt; &lt;span class="pre"&gt;-s&lt;/span&gt; &lt;span class="pre"&gt;/usr/local/bin/i686-apple-darwin8-gfortran-4.2&lt;/span&gt; &lt;span class="pre"&gt;scipy-bin/python2.7&lt;/span&gt; setup.py buildpython2.7 setup.py install&lt;/tt&gt;
However, site.cfg included pointers to AMD and UMFPACK that were
installed via the incredibly complicated series of steps listed here:
&lt;a class="reference external" href="http://blog.hyperjeff.net/?p=160"&gt;http://blog.hyperjeff.net/?p=160&lt;/a&gt;
&lt;a class="reference external" href="http://casa.colorado.edu/~ginsbura/index.htm"&gt;AG&lt;/a&gt;&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="python"></category></entry><entry><title>My starred reader articles</title><link href="https://keflavich.github.io/blog/my-starred-reader-articles.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/my-starred-reader-articles.html</id><summary type="html">&lt;p&gt;Just posting up a few papers I found interesting.
&lt;a class="reference external" href="http://iopscience.iop.org/0004-637X/709/1/27/"&gt;Peng Wang and Tom Abel's paper on outflow feedback in clusters&lt;/a&gt;
&lt;a class="reference external" href="http://arxiv.org/abs/1008.0409"&gt;A somewhat less interesting follow-up to the previous&lt;/a&gt;
&lt;a class="reference external" href="http://arxiv.org/abs/1008.0365"&gt;HARP mapping of the Serpens cloud core&lt;/a&gt;
&lt;a class="reference external" href="http://arxiv.org/abs/1007.5214"&gt;Neal Evans' review of low mass star formation observations&lt;/a&gt;
&lt;a class="reference external" href="http://www3.interscience.wiley.com/journal/123593472/abstract?CRETRY=1&amp;amp;SRETRY=0"&gt;the MNRAS paper on supermassive stars …&lt;/a&gt;&lt;/p&gt;</summary><content type="html">&lt;p&gt;Just posting up a few papers I found interesting.
&lt;a class="reference external" href="http://iopscience.iop.org/0004-637X/709/1/27/"&gt;Peng Wang and Tom Abel's paper on outflow feedback in clusters&lt;/a&gt;
&lt;a class="reference external" href="http://arxiv.org/abs/1008.0409"&gt;A somewhat less interesting follow-up to the previous&lt;/a&gt;
&lt;a class="reference external" href="http://arxiv.org/abs/1008.0365"&gt;HARP mapping of the Serpens cloud core&lt;/a&gt;
&lt;a class="reference external" href="http://arxiv.org/abs/1007.5214"&gt;Neal Evans' review of low mass star formation observations&lt;/a&gt;
&lt;a class="reference external" href="http://www3.interscience.wiley.com/journal/123593472/abstract?CRETRY=1&amp;amp;SRETRY=0"&gt;the MNRAS paper on supermassive stars in the LMC&lt;/a&gt;
&lt;a class="reference external" href="http://arxiv.org/abs/1007.3627"&gt;Identification of molecular clouds from the FCRAO OGS&lt;/a&gt;&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="papers"></category></entry><entry><title>NaN-friendly convolution</title><link href="https://keflavich.github.io/blog/nan-friendly-convolution.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/nan-friendly-convolution.html</id><summary type="html">&lt;p&gt;NaN-friendly convolution is important for, e.g., masked data sets in
which you want to interpolate across the masked region.&lt;/p&gt;
&lt;p&gt;Astropy has gained this functionality with pull request 155:
&lt;a class="reference external" href="https://github.com/astropy/astropy/pull/155"&gt;https://github.com/astropy/astropy/pull/155&lt;/a&gt; but this is a &amp;quot;direct&amp;quot; convolution parallel to IDL's 'convol'
routine.&lt;/p&gt;
&lt;p&gt;My FFT-based version …&lt;/p&gt;</summary><content type="html">&lt;p&gt;NaN-friendly convolution is important for, e.g., masked data sets in
which you want to interpolate across the masked region.&lt;/p&gt;
&lt;p&gt;Astropy has gained this functionality with pull request 155:
&lt;a class="reference external" href="https://github.com/astropy/astropy/pull/155"&gt;https://github.com/astropy/astropy/pull/155&lt;/a&gt; but this is a &amp;quot;direct&amp;quot; convolution parallel to IDL's 'convol'
routine.&lt;/p&gt;
&lt;p&gt;My FFT-based version now works in N dimensions and is a little cleaner:
&lt;a class="reference external" href="http://code.google.com/p/agpy/source/browse/trunk/AG_fft_tools/convolve_nd.py"&gt;http://code.google.com/p/agpy/source/browse/trunk/AG_fft_tools/convolve_nd.py&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;I'm still working on writing unit tests, and I'm really not sure what
the &amp;quot;correct&amp;quot; behavior at the edges is for the different cases... right
now, it seems counterintuitive to me, but the code is doing what I
expect it to.&lt;/p&gt;
&lt;p&gt;Also, Boxcar kernels always result in shifts for me... they're never
supposed to. This is a bug.&lt;/p&gt;
&lt;p&gt;Currently, other links to these codes:
&lt;a class="reference external" href="http://stackoverflow.com/questions/1100100/fft-based-2d-convolution-and-correlation-in-python/8454010#8454010"&gt;http://stackoverflow.com/questions/1100100/fft-based-2d-convolution-and-correlation-in-python/8454010#8454010&lt;/a&gt;&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="python"></category><category term="code"></category></entry><entry><title>Neat new things....</title><link href="https://keflavich.github.io/blog/neat-new-things.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/neat-new-things.html</id><summary type="html">&lt;p&gt;1. &lt;a class="reference external" href="http://www.pas.rochester.edu/~mpecaut/sptool/"&gt;sptool&lt;/a&gt; is a quick way to compare standards to stellar spectra.
Nice, I'd been looking for a tool like that.
2. &lt;a class="reference external" href="http://blog.bigsmoke.us/2008/12/04/gnu-screen-window-captions-as-xterm-tabs"&gt;GNU screen captions&lt;/a&gt; are useful especially when working in a
screen-within-a-screen environment (who does that, really?)
3. finally got &lt;a class="reference external" href="http://www.starlink.ac.uk/splat/"&gt;SPLAT&lt;/a&gt; to work... turns out I just hadn't reduced …&lt;/p&gt;</summary><content type="html">&lt;p&gt;1. &lt;a class="reference external" href="http://www.pas.rochester.edu/~mpecaut/sptool/"&gt;sptool&lt;/a&gt; is a quick way to compare standards to stellar spectra.
Nice, I'd been looking for a tool like that.
2. &lt;a class="reference external" href="http://blog.bigsmoke.us/2008/12/04/gnu-screen-window-captions-as-xterm-tabs"&gt;GNU screen captions&lt;/a&gt; are useful especially when working in a
screen-within-a-screen environment (who does that, really?)
3. finally got &lt;a class="reference external" href="http://www.starlink.ac.uk/splat/"&gt;SPLAT&lt;/a&gt; to work... turns out I just hadn't reduced my
damned data
4. &lt;a class="reference external" href="http://www.serverwatch.com/tutorials/article.php/3607246/Fresh-From-the-Linux-Kill.htm"&gt;kill -STOP and kill -CONT&lt;/a&gt; are really useful ways to pause programs
that are sucking up resources if you want to resume them later. Haven't
tried this on &amp;quot;real&amp;quot; code yet.&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="astronomy"></category><category term="computer"></category></entry><entry><title>New python software</title><link href="https://keflavich.github.io/blog/new-python-software.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/new-python-software.html</id><content type="html">&lt;p&gt;&lt;a class="reference external" href="http://idlsave.sourceforge.net/"&gt;IDLsave&lt;/a&gt; was released on my birthday. It does what you'd expect - read
IDL save files into Python.
&lt;a class="reference external" href="http://aplpy.sourceforge.net/"&gt;APLpy&lt;/a&gt;has a make_RGB_cube function now that takes care of all the
internals of making an RGB image.... haven't tried it yet but I need to
because it is awesome.&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="astronomy"></category><category term="computer"></category></entry><entry><title>Next Generation Astronomy</title><link href="https://keflavich.github.io/blog/next-generation-astronomy.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/next-generation-astronomy.html</id><summary type="html">&lt;p&gt;A brief commentary on a recent article &lt;a class="reference external" href="http://arxiv.org/abs/1009.6027"&gt;Next Generation Astronomy&lt;/a&gt;:
I'm probably one of the folks who will be working on making that future
happen, in the sense of being the intermediary between the end-user and
the instrumentalist. Scientists are still needed to build instruments,
but those who build the …&lt;/p&gt;</summary><content type="html">&lt;p&gt;A brief commentary on a recent article &lt;a class="reference external" href="http://arxiv.org/abs/1009.6027"&gt;Next Generation Astronomy&lt;/a&gt;:
I'm probably one of the folks who will be working on making that future
happen, in the sense of being the intermediary between the end-user and
the instrumentalist. Scientists are still needed to build instruments,
but those who build the instruments don't necessarily have the time or
expertise to build the software pipelines that generate high-quality
data.
At the same time, the &lt;a class="reference external" href="http://starlink.jach.hawaii.edu/starlink/"&gt;STARLINK&lt;/a&gt; folks do a much better job than I do,
and I already spend about half of my time comparing different archival
data sets... so I think his crystal ball is overall very accurate.&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="meta-astronomy"></category></entry><entry><title>Observing 10/20</title><link href="https://keflavich.github.io/blog/observing-1020.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/observing-1020.html</id><summary type="html">&lt;p&gt;I don't have a better place to post this one, so here it is:&lt;/p&gt;
&lt;img alt="" src="http://sites.google.com/site/iras05358/figure-discussion/figures/iras05358_triple_17.29.png?attredirects=0" /&gt;
&lt;p&gt;My automated fitter (&lt;a class="reference external" href="http://casa.colorado.edu/~ginsbura/pygausscollapse.htm"&gt;Gaussfitting Cube Collapser&lt;/a&gt;) has come a long
way. I now adaptively choose to fit 1, 2, or 3 Gaussian components to
output to a data cube.
The purpose of that code is primarily …&lt;/p&gt;</summary><content type="html">&lt;p&gt;I don't have a better place to post this one, so here it is:&lt;/p&gt;
&lt;img alt="" src="http://sites.google.com/site/iras05358/figure-discussion/figures/iras05358_triple_17.29.png?attredirects=0" /&gt;
&lt;p&gt;My automated fitter (&lt;a class="reference external" href="http://casa.colorado.edu/~ginsbura/pygausscollapse.htm"&gt;Gaussfitting Cube Collapser&lt;/a&gt;) has come a long
way. I now adaptively choose to fit 1, 2, or 3 Gaussian components to
output to a data cube.
The purpose of that code is primarily to find a two-dimensional way to
display information about the 3D structure, specifically about the
presence/absence of outflows. Outflows will inevitably be confused with
multiple velocity components, but they are also likely to be convolved
with them.&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="python"></category><category term="observing"></category></entry><entry><title>Observing @ GBT: Signs of good &amp; bad data</title><link href="https://keflavich.github.io/blog/observing-gbt-signs-of-good-bad-data.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/observing-gbt-signs-of-good-bad-data.html</id><summary type="html">&lt;p&gt;So far, all of the observations for the H&lt;sub&gt;2&lt;/sub&gt;CO densitometry
project have been performed at the Green Bank Telescope. During a 10-day
long observing trip here, I've learned a lot about diagnosing bad data.&lt;/p&gt;
&lt;img alt="" src="http://2.bp.blogspot.com/_lsgW26mWZnU/TGyf_Sx-Z-I/AAAAAAAAFzw/1wCgkpI11WI/s400/session92_if0_feed0_trec.png" /&gt;
&lt;p&gt;This first image shows TSYS vs Airmass for good data. The high outliers
are …&lt;/p&gt;</summary><content type="html">&lt;p&gt;So far, all of the observations for the H&lt;sub&gt;2&lt;/sub&gt;CO densitometry
project have been performed at the Green Bank Telescope. During a 10-day
long observing trip here, I've learned a lot about diagnosing bad data.&lt;/p&gt;
&lt;img alt="" src="http://2.bp.blogspot.com/_lsgW26mWZnU/TGyf_Sx-Z-I/AAAAAAAAFzw/1wCgkpI11WI/s400/session92_if0_feed0_trec.png" /&gt;
&lt;p&gt;This first image shows TSYS vs Airmass for good data. The high outliers
are just sources with continuum in them - the continuum is the source of
the extra signal, not atmosphere.&amp;nbsp; The receiver temperature is a nice
20.6 K, and you get about 5 K extra per airmass, suggesting a zenith
optical depth of 0.018 assuming a round atmospheric temperature of 300K.&lt;/p&gt;
&lt;img alt="" src="http://3.bp.blogspot.com/_lsgW26mWZnU/TGyer8CZzVI/AAAAAAAAFzI/zoU1K0cIu7Q/s400/session04_if0_feed0_trec.png" /&gt;
&lt;p&gt;In the same style plot, there is a set of observations with low system
temperatures: that stuff is good. There is also a set with clearly
rising system temperatures, even at constant elevation. These data are
bad. During this observation, the &amp;quot;blowers&amp;quot; that are meant to keep dew
off of the receivers failed. Dew buildup on the receiver covers lead to
higher optical depths and therefore system temperatures.&lt;/p&gt;
&lt;img alt="" src="http://2.bp.blogspot.com/_lsgW26mWZnU/TGyf9RwmbRI/AAAAAAAAFzo/n0gyG81oOns/s400/session91_if0_feed0_trec.png" /&gt;
&lt;p&gt;Finally, this data set was totally useless. Ku-band is not particularly
sensitive to water in the atmosphere... but it's still not a good idea
to observe during a rain storm.&amp;nbsp; Note that the fitted receiver
temperature TREC is nonsensical.&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="GBT"></category></entry><entry><title>Observing run summary</title><link href="https://keflavich.github.io/blog/observing-run-summary.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/observing-run-summary.html</id><summary type="html">&lt;p&gt;3 nights of worse than grade 4 weather (tau ~.4, i.e. the atmosphere is
nearly opaque) have given me a few interesting results.
1. Non-detections of CS 5-4 in a few bright BGPS cores. My best guess is
that the pointing was off, though, because I definitely got down …&lt;/p&gt;</summary><content type="html">&lt;p&gt;3 nights of worse than grade 4 weather (tau ~.4, i.e. the atmosphere is
nearly opaque) have given me a few interesting results.
1. Non-detections of CS 5-4 in a few bright BGPS cores. My best guess is
that the pointing was off, though, because I definitely got down to a
noise level around 50mK.
2. Lots of CO 2-1 mapping, 13CO/C18O too. That means I can now use this
plot: &lt;a class="reference external" href="http://dustem.astro.umd.edu/pdrt/co3221web.html"&gt;http://dustem.astro.umd.edu/pdrt/co3221web.html&lt;/a&gt; to try to
measure the incident flux.
3. I can't do homework at the summit. Maybe it's just that I can't do
stellar structures homework, but I really am not processing this stuff
well. Damn.
4. Running at altitude uphill is really, really hard. All the running
I've been doing the past N months has not even come close to preparing
me. Need to correct that...
5. &amp;quot;I am inappropriate.&amp;quot; I probably violate a bunch of those rules...
the important ones...
6. gotta get back to the mountains. Really. Seriously. OMFG.
7. ARGH those papers need writing! Lots of it!
For the next observing run, need the following:
1. Pre-prepared A3 rasters
2. Larger selection of summit music
3. Better sleep schedule preparation
4. More caffeinated drinks per night
5. Cloud cannons.&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="observing"></category></entry><entry><title>Observing this weekend</title><link href="https://keflavich.github.io/blog/observing-this-weekend.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/observing-this-weekend.html</id><content type="html">&lt;p&gt;whoops, never made this post. Turns out I got rained out - 3 inches of
rain on my night. Sad, no DIS time for P Cyg.&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="astronomy"></category></entry><entry><title>Offset symbols?</title><link href="https://keflavich.github.io/blog/offset-symbols.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/offset-symbols.html</id><content type="html">&lt;p&gt;&lt;a class="reference external" href="http://casa.colorado.edu/~ginsbura/index.htm"&gt;AG&lt;/a&gt;&lt;/p&gt;
&lt;img alt="" src="http://3.bp.blogspot.com/-JHXnGh8Vy7s/TkQYDKMQR8I/AAAAAAAAGaE/Os-k-k3WeCQ/s320/WidthDifferenceMeasurement.png" /&gt;
</content><category term="misc"></category><category term="googlepost"></category></entry><entry><title>Orion in the Infrared and Millimeter</title><link href="https://keflavich.github.io/blog/orion-in-the-infrared-and-millimeter.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/orion-in-the-infrared-and-millimeter.html</id><summary type="html">&lt;img alt="" src="https://lh5.googleusercontent.com/-lUlzplbIvGM/T8VTYm05J8I/AAAAAAAAHMc/gNoFfwuZ7uI/s1500/OrionA_4096sq_WISE_bolo_mosaic_rotated_blackbg_small.png" /&gt;
&lt;p&gt;This composite image of the Orion A Giant Molecular Cloud star-forming
complex shows infrared emission from the WISE and MSX missions in 4
micron (red), 12 micron (blue), and 22 micron (green) emission with
Bolocam Galactic Plane Survey 1.1mm emission overlaid in yellow/orange.
The Orion A region is …&lt;/p&gt;</summary><content type="html">&lt;img alt="" src="https://lh5.googleusercontent.com/-lUlzplbIvGM/T8VTYm05J8I/AAAAAAAAHMc/gNoFfwuZ7uI/s1500/OrionA_4096sq_WISE_bolo_mosaic_rotated_blackbg_small.png" /&gt;
&lt;p&gt;This composite image of the Orion A Giant Molecular Cloud star-forming
complex shows infrared emission from the WISE and MSX missions in 4
micron (red), 12 micron (blue), and 22 micron (green) emission with
Bolocam Galactic Plane Survey 1.1mm emission overlaid in yellow/orange.
The Orion A region is frequently featured in astronomical images:&lt;/p&gt;
&lt;blockquote&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;a class="reference external" href="http://apod.nasa.gov/apod/ap110917.html"&gt;http://apod.nasa.gov/apod/ap110917.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://apod.nasa.gov/apod/ap120212.html"&gt;http://apod.nasa.gov/apod/ap120212.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://apod.nasa.gov/apod/ap120206.html"&gt;http://apod.nasa.gov/apod/ap120206.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://www.eso.org/public/images/eso1219c/"&gt;http://www.eso.org/public/images/eso1219c/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://www.eso.org/public/news/eso1209/"&gt;http://www.eso.org/public/news/eso1209/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;p&gt;but its tail tends to be ignored. This quiescent region is the source of
the next generation of stars, although the relatively small mass
concentrations imply that no massive stars like the bright Theta 1C that
powers the Orion Nebula will form.
The infrared colors show all sorts of stars including protostars. The
infrared can pierce through the dust and find young stars still forming.
The green and blue bands also see diffuse clouds of dust being
illuminated by the central stars of the Orion nebula.
The yellow 1.1 mm dust emission shows the coldest dust that is shielded
from external radiation. These cold clumps contain enough mass to form
new stars...&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category></entry><entry><title>Outreach Observing</title><link href="https://keflavich.github.io/blog/outreach-observing.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/outreach-observing.html</id><summary type="html">&lt;p&gt;&lt;p&gt;Some notes for this Friday...
the &lt;a class="reference external" href="http://www.nightskies.net/satellites/custom.html?latitude=42.383&amp;amp;longitude=71.133&amp;amp;tzone=-5"&gt;ISS will rise&lt;/a&gt; at about 10:55 on Friday, July 18th, and 9:43 on
Saturday, July 19th.
Jupiter will be in the sky, but Venus and Mercury will not. &lt;a class="reference external" href="http://www.skyandtelescope.com/observing/ataglance"&gt;Jupiter
will rise in the Southeast&lt;/a&gt;&lt;/p&gt;
&lt;pre class="literal-block"&gt;
Denver, CO   2008/07/16  10:15 pm …&lt;/pre&gt;&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;p&gt;Some notes for this Friday...
the &lt;a class="reference external" href="http://www.nightskies.net/satellites/custom.html?latitude=42.383&amp;amp;longitude=71.133&amp;amp;tzone=-5"&gt;ISS will rise&lt;/a&gt; at about 10:55 on Friday, July 18th, and 9:43 on
Saturday, July 19th.
Jupiter will be in the sky, but Venus and Mercury will not. &lt;a class="reference external" href="http://www.skyandtelescope.com/observing/ataglance"&gt;Jupiter
will rise in the Southeast&lt;/a&gt;&lt;/p&gt;
&lt;pre class="literal-block"&gt;
Denver, CO   2008/07/16  10:15 pm   Sunrise/set: 05:46 am / 08:26 pmPredicted passes for: ISS         daylight-saving time enabled             Local   Duration   Date       Time    (min)   Approach     Max. elevation    Departure------------------------------------------------------------------------2008/07/17   02:57 am   &amp;lt;1  10° above N     10° above N     10° above NNE2008/07/17   04:30 am   5   12° above NNW   31° above NE    10° above E  2008/07/17   10:30 pm   &amp;lt;1  13° above WSW   15° above WSW   15° above WSW2008/07/18   03:19 am   4   10° above NNW   16° above NNE   10° above ENE2008/07/18   04:54 am   5   15° above NW    78° above W     10° above SE 2008/07/18   09:19 pm   5   13° above SSW   29° above SE    11° above ENE2008/07/18   10:55 pm   4   17° above WNW   25° above NNW   10° above NNE2008/07/19   03:42 am   5   13° above NNW   32° above NNE   12° above E  2008/07/19   05:18 am   4   16° above W     22° above SW    11° above S  2008/07/19   09:43 pm   5   19° above WSW   71° above N     10° above NE
&lt;/pre&gt;
&lt;/p&gt;</content><category term="misc"></category><category term="googlepost"></category><category term="astronomy"></category></entry><entry><title>Outreach this past weekend</title><link href="https://keflavich.github.io/blog/outreach-this-past-weekend.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/outreach-this-past-weekend.html</id><content type="html">&lt;p&gt;I did the thing at Vail, Starry Nights, and it went well.&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category></entry><entry><title>P Cygni</title><link href="https://keflavich.github.io/blog/p-cygni.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/p-cygni.html</id><content type="html">&lt;p&gt;&lt;a class="reference external" href="http://casa.colorado.edu/~ginsbura/pcygni_public.htm"&gt;P Cygni&lt;/a&gt; is a neglected LBV. You search for Eta Carinae on google and
get hundreds of epic images of the fella, but nothing of P Cyg! Not even
my Fe II image, which is now reproduced here:&lt;/p&gt;
&lt;img alt="" src="http://casa.colorado.edu/~ginsbura/images/astropix/pcygnineb.jpg" /&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="picture"></category></entry><entry><title>Parallactic Angle</title><link href="https://keflavich.github.io/blog/parallactic-angle.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/parallactic-angle.html</id><summary type="html">&lt;p&gt;So it turns out parallactic angle and field rotation are essentially the
same thing. While working on the data pipeline for the Bolocam Galactic
Plane Survey, I've needed to deal with this. The parallactic angle is
dependent on the alt/az, and therefore the time, of the observation. So
using …&lt;/p&gt;</summary><content type="html">&lt;p&gt;So it turns out parallactic angle and field rotation are essentially the
same thing. While working on the data pipeline for the Bolocam Galactic
Plane Survey, I've needed to deal with this. The parallactic angle is
dependent on the alt/az, and therefore the time, of the observation. So
using an RA/Dec in J2000 coordinates to get alt/az isn't going to work,
because my observations weren't in 2000.0.... my best hope is that the
PA in the NCDF files is actually the correct parallactic angle.
YARGH!&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="astronomy"></category></entry><entry><title>Photo Contest</title><link href="https://keflavich.github.io/blog/photo-contest.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/photo-contest.html</id><content type="html">&lt;p&gt;&lt;a class="reference external" href="http://www.nrao.edu/index.php/learn/gallery/imagecontest"&gt;http://www.nrao.edu/index.php/learn/gallery/imagecontest&lt;/a&gt;&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="photo"></category><category term="nrao"></category></entry><entry><title>Photos featured in an article</title><link href="https://keflavich.github.io/blog/photos-featured-in-an-article.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/photos-featured-in-an-article.html</id><content type="html">&lt;p&gt;My photos, article by Jeff Marlow:
&lt;a class="reference external" href="http://www.atmagazine.co.uk/content/view/853/94/"&gt;http://www.atmagazine.co.uk/content/view/853/94/&lt;/a&gt;&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category></entry><entry><title>PHP and CGI working in the same directory</title><link href="https://keflavich.github.io/blog/php-and-cgi-working-in-the-same-directory.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/php-and-cgi-working-in-the-same-directory.html</id><summary type="html">&lt;p&gt;&lt;p&gt;While it's not possible to get CGI and PHP to work within the same file,
you can get .html and .htm files to use cgi/php scripts alternately in
the same directory with the following .htaccess file:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
RemoveHandler  .htmlAddType text/html  .htmAddHandler application/x-httpd-php .php .html AddHandler server-parsed .htm .html …&lt;/pre&gt;&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;p&gt;While it's not possible to get CGI and PHP to work within the same file,
you can get .html and .htm files to use cgi/php scripts alternately in
the same directory with the following .htaccess file:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
RemoveHandler  .htmlAddType text/html  .htmAddHandler application/x-httpd-php .php .html AddHandler server-parsed .htm .html
&lt;/pre&gt;
&lt;p&gt;If anyone can prove the previous statement false, please do! I spent
hours googling and hacking to try to get php and cgi to work within the
same file.
Also, the way the above file is parsed makes no sense to me. It is
inverted from how I would have thought it should work.&lt;/p&gt;
&lt;/p&gt;</content><category term="misc"></category><category term="googlepost"></category><category term="computer"></category></entry><entry><title>Port vs Fink</title><link href="https://keflavich.github.io/blog/port-vs-fink.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/port-vs-fink.html</id><summary type="html">&lt;p&gt;Port failed to install:
&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;adam-macbook&lt;/span&gt; ~$ sudo port install &lt;span class="pre"&gt;py25-matplotlib---&amp;gt;&lt;/span&gt;&amp;nbsp; Building &lt;span class="pre"&gt;py25-hashlib&lt;/span&gt; with target &lt;span class="pre"&gt;build---&amp;gt;&lt;/span&gt;&amp;nbsp; Staging &lt;span class="pre"&gt;py25-hashlib&lt;/span&gt; into &lt;span class="pre"&gt;destroot---&amp;gt;&lt;/span&gt;&amp;nbsp; Installing &lt;span class="pre"&gt;py25-hashlib&lt;/span&gt; &lt;span class="pre"&gt;2.5.2_0---&amp;gt;&lt;/span&gt;&amp;nbsp; Activating &lt;span class="pre"&gt;py25-hashlib&lt;/span&gt; &lt;span class="pre"&gt;2.5.2_0---&amp;gt;&lt;/span&gt;&amp;nbsp; Cleaning &lt;span class="pre"&gt;py25-hashlib---&amp;gt;&lt;/span&gt;&amp;nbsp; Fetching &lt;span class="pre"&gt;py25-zlib---&amp;gt;&lt;/span&gt;&amp;nbsp; Verifying checksum(s) for &lt;span class="pre"&gt;py25-zlib---&amp;gt;&lt;/span&gt;&amp;nbsp; Extracting &lt;span class="pre"&gt;py25-zlib---&amp;gt;&lt;/span&gt;&amp;nbsp; Configuring &lt;span class="pre"&gt;py25-zlib---&amp;gt;&lt;/span&gt;&amp;nbsp; Building &lt;span class="pre"&gt;py25-zlib&lt;/span&gt; with target &lt;span class="pre"&gt;build---&amp;gt;&lt;/span&gt;&amp;nbsp; Staging &lt;span class="pre"&gt;py25-zlib …&lt;/span&gt;&lt;/tt&gt;&lt;/p&gt;</summary><content type="html">&lt;p&gt;Port failed to install:
&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;adam-macbook&lt;/span&gt; ~$ sudo port install &lt;span class="pre"&gt;py25-matplotlib---&amp;gt;&lt;/span&gt;&amp;nbsp; Building &lt;span class="pre"&gt;py25-hashlib&lt;/span&gt; with target &lt;span class="pre"&gt;build---&amp;gt;&lt;/span&gt;&amp;nbsp; Staging &lt;span class="pre"&gt;py25-hashlib&lt;/span&gt; into &lt;span class="pre"&gt;destroot---&amp;gt;&lt;/span&gt;&amp;nbsp; Installing &lt;span class="pre"&gt;py25-hashlib&lt;/span&gt; &lt;span class="pre"&gt;2.5.2_0---&amp;gt;&lt;/span&gt;&amp;nbsp; Activating &lt;span class="pre"&gt;py25-hashlib&lt;/span&gt; &lt;span class="pre"&gt;2.5.2_0---&amp;gt;&lt;/span&gt;&amp;nbsp; Cleaning &lt;span class="pre"&gt;py25-hashlib---&amp;gt;&lt;/span&gt;&amp;nbsp; Fetching &lt;span class="pre"&gt;py25-zlib---&amp;gt;&lt;/span&gt;&amp;nbsp; Verifying checksum(s) for &lt;span class="pre"&gt;py25-zlib---&amp;gt;&lt;/span&gt;&amp;nbsp; Extracting &lt;span class="pre"&gt;py25-zlib---&amp;gt;&lt;/span&gt;&amp;nbsp; Configuring &lt;span class="pre"&gt;py25-zlib---&amp;gt;&lt;/span&gt;&amp;nbsp; Building &lt;span class="pre"&gt;py25-zlib&lt;/span&gt; with target &lt;span class="pre"&gt;build---&amp;gt;&lt;/span&gt;&amp;nbsp; Staging &lt;span class="pre"&gt;py25-zlib&lt;/span&gt; into &lt;span class="pre"&gt;destroot---&amp;gt;&lt;/span&gt;&amp;nbsp; Installing &lt;span class="pre"&gt;py25-zlib&lt;/span&gt; &lt;span class="pre"&gt;2.5.2_0---&amp;gt;&lt;/span&gt;&amp;nbsp; Activating &lt;span class="pre"&gt;py25-zlib&lt;/span&gt; &lt;span class="pre"&gt;2.5.2_0---&amp;gt;&lt;/span&gt;&amp;nbsp; Cleaning &lt;span class="pre"&gt;py25-zlib---&amp;gt;&lt;/span&gt;&amp;nbsp; Fetching &lt;span class="pre"&gt;py25-setuptools---&amp;gt;&lt;/span&gt;&amp;nbsp; Attempting to fetch &lt;span class="pre"&gt;setuptools-0.6c8.tar.gz&lt;/span&gt; from &lt;span class="pre"&gt;http://cheeseshop.python.org/packages/source/s/setuptools/---&amp;gt;&lt;/span&gt;&amp;nbsp; Verifying checksum(s) for &lt;span class="pre"&gt;py25-setuptools---&amp;gt;&lt;/span&gt;&amp;nbsp; Extracting &lt;span class="pre"&gt;py25-setuptools---&amp;gt;&lt;/span&gt;&amp;nbsp; Applying patches to &lt;span class="pre"&gt;py25-setuptools---&amp;gt;&lt;/span&gt;&amp;nbsp; Configuring &lt;span class="pre"&gt;py25-setuptools---&amp;gt;&lt;/span&gt;&amp;nbsp; Building &lt;span class="pre"&gt;py25-setuptools&lt;/span&gt; with target &lt;span class="pre"&gt;build---&amp;gt;&lt;/span&gt;&amp;nbsp; Staging &lt;span class="pre"&gt;py25-setuptools&lt;/span&gt; into &lt;span class="pre"&gt;destroot---&amp;gt;&lt;/span&gt;&amp;nbsp; Installing &lt;span class="pre"&gt;py25-setuptools&lt;/span&gt; &lt;span class="pre"&gt;0.6c8_2---&amp;gt;&lt;/span&gt;&amp;nbsp; Activating &lt;span class="pre"&gt;py25-setuptools&lt;/span&gt; &lt;span class="pre"&gt;0.6c8_2---&amp;gt;&lt;/span&gt;&amp;nbsp; Cleaning &lt;span class="pre"&gt;py25-setuptools---&amp;gt;&lt;/span&gt;&amp;nbsp; Fetching &lt;span class="pre"&gt;py25-tz---&amp;gt;&lt;/span&gt;&amp;nbsp; Attempting to fetch &lt;span class="pre"&gt;pytz-2007k.tar.bz2&lt;/span&gt; from &lt;span class="pre"&gt;http://cheeseshop.python.org/packages/source/p/pytz/---&amp;gt;&lt;/span&gt;&amp;nbsp; Verifying checksum(s) for &lt;span class="pre"&gt;py25-tz---&amp;gt;&lt;/span&gt;&amp;nbsp; Extracting &lt;span class="pre"&gt;py25-tz---&amp;gt;&lt;/span&gt;&amp;nbsp; Configuring &lt;span class="pre"&gt;py25-tz---&amp;gt;&lt;/span&gt;&amp;nbsp; Building &lt;span class="pre"&gt;py25-tz&lt;/span&gt; with target &lt;span class="pre"&gt;build---&amp;gt;&lt;/span&gt;&amp;nbsp; Staging &lt;span class="pre"&gt;py25-tz&lt;/span&gt; into &lt;span class="pre"&gt;destroot---&amp;gt;&lt;/span&gt;&amp;nbsp; Installing &lt;span class="pre"&gt;py25-tz&lt;/span&gt; &lt;span class="pre"&gt;2007k_0---&amp;gt;&lt;/span&gt;&amp;nbsp; Activating &lt;span class="pre"&gt;py25-tz&lt;/span&gt; &lt;span class="pre"&gt;2007k_0---&amp;gt;&lt;/span&gt;&amp;nbsp; Cleaning &lt;span class="pre"&gt;py25-tz---&amp;gt;&lt;/span&gt;&amp;nbsp; Fetching &lt;span class="pre"&gt;py25-dateutil---&amp;gt;&lt;/span&gt;&amp;nbsp; Attempting to fetch &lt;span class="pre"&gt;python-dateutil-1.4.1.tar.gz&lt;/span&gt; from &lt;span class="pre"&gt;http://labix.org/download/python-dateutil---&amp;gt;&lt;/span&gt;&amp;nbsp; Verifying checksum(s) for &lt;span class="pre"&gt;py25-dateutil---&amp;gt;&lt;/span&gt;&amp;nbsp; Extracting &lt;span class="pre"&gt;py25-dateutil---&amp;gt;&lt;/span&gt;&amp;nbsp; Configuring &lt;span class="pre"&gt;py25-dateutil---&amp;gt;&lt;/span&gt;&amp;nbsp; Building &lt;span class="pre"&gt;py25-dateutil&lt;/span&gt; with target &lt;span class="pre"&gt;build---&amp;gt;&lt;/span&gt;&amp;nbsp; Staging &lt;span class="pre"&gt;py25-dateutil&lt;/span&gt; into &lt;span class="pre"&gt;destroot---&amp;gt;&lt;/span&gt;&amp;nbsp; Installing &lt;span class="pre"&gt;py25-dateutil&lt;/span&gt; &lt;span class="pre"&gt;1.4.1_0---&amp;gt;&lt;/span&gt;&amp;nbsp; Activating &lt;span class="pre"&gt;py25-dateutil&lt;/span&gt; &lt;span class="pre"&gt;1.4.1_0---&amp;gt;&lt;/span&gt;&amp;nbsp; Cleaning &lt;span class="pre"&gt;py25-dateutil---&amp;gt;&lt;/span&gt;&amp;nbsp; Fetching &lt;span class="pre"&gt;fftw-3---&amp;gt;&lt;/span&gt;&amp;nbsp; Attempting to fetch &lt;span class="pre"&gt;fftw-3.1.3.tar.gz&lt;/span&gt; from &lt;span class="pre"&gt;http://www.fftw.org/---&amp;gt;&lt;/span&gt;&amp;nbsp; Verifying checksum(s) for &lt;span class="pre"&gt;fftw-3---&amp;gt;&lt;/span&gt;&amp;nbsp; Extracting &lt;span class="pre"&gt;fftw-3---&amp;gt;&lt;/span&gt;&amp;nbsp; Configuring &lt;span class="pre"&gt;fftw-3---&amp;gt;&lt;/span&gt;&amp;nbsp; Building &lt;span class="pre"&gt;fftw-3&lt;/span&gt; with target &lt;span class="pre"&gt;all---&amp;gt;&lt;/span&gt;&amp;nbsp; Staging &lt;span class="pre"&gt;fftw-3&lt;/span&gt; into &lt;span class="pre"&gt;destroot---&amp;gt;&lt;/span&gt;&amp;nbsp; Installing &lt;span class="pre"&gt;fftw-3&lt;/span&gt; &lt;span class="pre"&gt;3.1.3_0---&amp;gt;&lt;/span&gt;&amp;nbsp; Activating &lt;span class="pre"&gt;fftw-3&lt;/span&gt; &lt;span class="pre"&gt;3.1.3_0---&amp;gt;&lt;/span&gt;&amp;nbsp; Cleaning &lt;span class="pre"&gt;fftw-3---&amp;gt;&lt;/span&gt;&amp;nbsp; Fetching &lt;span class="pre"&gt;py25-nose---&amp;gt;&lt;/span&gt;&amp;nbsp; Attempting to fetch &lt;span class="pre"&gt;nose-0.10.4.tar.gz&lt;/span&gt; from &lt;span class="pre"&gt;http://somethingaboutorange.com/mrl/projects/nose/---&amp;gt;&lt;/span&gt;&amp;nbsp; Verifying checksum(s) for &lt;span class="pre"&gt;py25-nose---&amp;gt;&lt;/span&gt;&amp;nbsp; Extracting &lt;span class="pre"&gt;py25-nose---&amp;gt;&lt;/span&gt;&amp;nbsp; Configuring &lt;span class="pre"&gt;py25-nose---&amp;gt;&lt;/span&gt;&amp;nbsp; Building &lt;span class="pre"&gt;py25-nose&lt;/span&gt; with target &lt;span class="pre"&gt;build---&amp;gt;&lt;/span&gt;&amp;nbsp; Staging &lt;span class="pre"&gt;py25-nose&lt;/span&gt; into &lt;span class="pre"&gt;destroot---&amp;gt;&lt;/span&gt;&amp;nbsp; Installing &lt;span class="pre"&gt;py25-nose&lt;/span&gt; &lt;span class="pre"&gt;0.10.4_0---&amp;gt;&lt;/span&gt;&amp;nbsp; Activating &lt;span class="pre"&gt;py25-nose&lt;/span&gt; &lt;span class="pre"&gt;0.10.4_0---&amp;gt;&lt;/span&gt;&amp;nbsp; Cleaning &lt;span class="pre"&gt;py25-nose---&amp;gt;&lt;/span&gt;&amp;nbsp; Fetching &lt;span class="pre"&gt;py25-numpy---&amp;gt;&lt;/span&gt;&amp;nbsp; Attempting to fetch &lt;span class="pre"&gt;numpy-1.2.0.tar.gz&lt;/span&gt; from &lt;span class="pre"&gt;http://downloads.sourceforge.net/numpy---&amp;gt;&lt;/span&gt;&amp;nbsp; Verifying checksum(s) for &lt;span class="pre"&gt;py25-numpy---&amp;gt;&lt;/span&gt;&amp;nbsp; Extracting &lt;span class="pre"&gt;py25-numpy---&amp;gt;&lt;/span&gt;&amp;nbsp; Applying patches to &lt;span class="pre"&gt;py25-numpy---&amp;gt;&lt;/span&gt;&amp;nbsp; Configuring &lt;span class="pre"&gt;py25-numpy---&amp;gt;&lt;/span&gt;&amp;nbsp; Building &lt;span class="pre"&gt;py25-numpy&lt;/span&gt; with target buildError: Target org.macports.build returned: shell command &amp;quot; cd &lt;span class="pre"&gt;&amp;quot;/opt/local/var/macports/build/_opt_local_var_macports_sources_rsync.macports.org_release_ports_python_py25-numpy/work/numpy-1.2.0&amp;quot;&lt;/span&gt; &amp;amp;&amp;amp; /opt/local/bin/python2.5 setup.py build &amp;quot; returned error 1Command output:&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; setup_package()&amp;nbsp; File &amp;quot;setup.py&amp;quot;, line 89, in setup_package&amp;nbsp;&amp;nbsp;&amp;nbsp; configuration=configuration )&amp;nbsp; File &lt;span class="pre"&gt;&amp;quot;/opt/local/var/macports/build/_opt_local_var_macports_sources_rsync.macports.org_release_ports_python_py25-numpy/work/numpy-1.2.0/numpy/distutils/core.py&amp;quot;,&lt;/span&gt; line 184, in setup&amp;nbsp;&amp;nbsp;&amp;nbsp; return &lt;span class="pre"&gt;old_setup(**new_attr)&lt;/span&gt;&amp;nbsp; File &amp;quot;/opt/local/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/distutils/core.py&amp;quot;, line 151, in setup&amp;nbsp;&amp;nbsp;&amp;nbsp; dist.run_commands()&amp;nbsp; File &amp;quot;/opt/local/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/distutils/dist.py&amp;quot;, line 974, in run_commands&amp;nbsp;&amp;nbsp;&amp;nbsp; self.run_command(cmd)&amp;nbsp; File &amp;quot;/opt/local/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/distutils/dist.py&amp;quot;, line 994, in run_command&amp;nbsp;&amp;nbsp;&amp;nbsp; cmd_obj.run()&amp;nbsp; File &lt;span class="pre"&gt;&amp;quot;/opt/local/var/macports/build/_opt_local_var_macports_sources_rsync.macports.org_release_ports_python_py25-numpy/work/numpy-1.2.0/numpy/distutils/command/build.py&amp;quot;,&lt;/span&gt; line 37, in run&amp;nbsp;&amp;nbsp;&amp;nbsp; old_build.run(self)&amp;nbsp; File &amp;quot;/opt/local/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/distutils/command/build.py&amp;quot;, line 112, in run&amp;nbsp;&amp;nbsp;&amp;nbsp; self.run_command(cmd_name)&amp;nbsp; File &amp;quot;/opt/local/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/distutils/cmd.py&amp;quot;, line 333, in run_command&amp;nbsp;&amp;nbsp;&amp;nbsp; self.distribution.run_command(command)&amp;nbsp; File &amp;quot;/opt/local/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/distutils/dist.py&amp;quot;, line 994, in run_command&amp;nbsp;&amp;nbsp;&amp;nbsp; cmd_obj.run()&amp;nbsp; File &lt;span class="pre"&gt;&amp;quot;/opt/local/var/macports/build/_opt_local_var_macports_sources_rsync.macports.org_release_ports_python_py25-numpy/work/numpy-1.2.0/numpy/distutils/command/build_src.py&amp;quot;,&lt;/span&gt; line 130, in run&amp;nbsp;&amp;nbsp;&amp;nbsp; self.build_sources()&amp;nbsp; File &lt;span class="pre"&gt;&amp;quot;/opt/local/var/macports/build/_opt_local_var_macports_sources_rsync.macports.org_release_ports_python_py25-numpy/work/numpy-1.2.0/numpy/distutils/command/build_src.py&amp;quot;,&lt;/span&gt; line 147, in build_sources&amp;nbsp;&amp;nbsp;&amp;nbsp; self.build_extension_sources(ext)&amp;nbsp; File &lt;span class="pre"&gt;&amp;quot;/opt/local/var/macports/build/_opt_local_var_macports_sources_rsync.macports.org_release_ports_python_py25-numpy/work/numpy-1.2.0/numpy/distutils/command/build_src.py&amp;quot;,&lt;/span&gt; line 250, in build_extension_sources&amp;nbsp;&amp;nbsp;&amp;nbsp; sources = self.generate_sources(sources, ext)&amp;nbsp; File &lt;span class="pre"&gt;&amp;quot;/opt/local/var/macports/build/_opt_local_var_macports_sources_rsync.macports.org_release_ports_python_py25-numpy/work/numpy-1.2.0/numpy/distutils/command/build_src.py&amp;quot;,&lt;/span&gt; line 307, in generate_sources&amp;nbsp;&amp;nbsp;&amp;nbsp; source = func(extension, build_dir)&amp;nbsp; File &amp;quot;numpy/core/setup.py&amp;quot;, line 87, in generate_config_h&amp;nbsp;&amp;nbsp;&amp;nbsp; raise &lt;span class="pre"&gt;SystemError,&amp;quot;Failed&lt;/span&gt; to test configuration. &amp;quot;\SystemError: Failed to test configuration. See previous error messages for more information.Error: The following dependencies failed to build: &lt;span class="pre"&gt;py25-numpy&lt;/span&gt; &lt;span class="pre"&gt;py25-tkinter&lt;/span&gt; tcl tkError: Status 1 encountered during processing.&lt;/tt&gt;
I don't want to deal with it so I'm just using Fink.&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="python"></category><category term="computer"></category></entry><entry><title>Postscript to PDF conversion</title><link href="https://keflavich.github.io/blog/postscript-to-pdf-conversion.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/postscript-to-pdf-conversion.html</id><content type="html">&lt;p&gt;&lt;tt class="docutils literal"&gt;ls *.ps | sed &lt;span class="pre"&gt;'s/\(.*\).ps/ps2pdf&lt;/span&gt; \1.ps \1.pdf/' | bash&lt;/tt&gt;
because it's impossible to view multiple postscripts in a single
window.... how annoying.
Corollary:
&lt;tt class="docutils literal"&gt;ls *.pdf | sed &lt;span class="pre"&gt;'s/\(.*\).pdf/pdf2jpeg&lt;/span&gt; \1.pdf \1.jpg/' | bash&lt;/tt&gt;&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="computer"></category><category term="postscript"></category></entry><entry><title>ps2pdf keep resolution, crop to bounding box</title><link href="https://keflavich.github.io/blog/ps2pdf-keep-resolution-crop-to-bounding-box.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/ps2pdf-keep-resolution-crop-to-bounding-box.html</id><content type="html">&lt;p&gt;``  ps2pdf -dEPSCrop -dAutoRotatePages=/None -dAutoFilterColorImages=false -dColorImageFilter=/FlateEncode -dUseFlateCompression=true l007_displaycrop.ps ``
ref: &lt;a class="reference external" href="http://groups.google.com/group/comp.lang.postscript/browse_thread/thread/c7570a90f8b96848?ie=UTF-8&amp;amp;q=ps2pdf+image+quality#62fe763939a66789"&gt;this post&lt;/a&gt;&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="pdf"></category><category term="postscript"></category></entry><entry><title>PSDs, cross-correlation...</title><link href="https://keflavich.github.io/blog/psds-cross-correlation.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/psds-cross-correlation.html</id><summary type="html">&lt;p&gt;scipy is capable of doing fft-base cross-correlation, convolution, etc.,
but it requires the stsci package, which is not generally easy to
install. For that matter, scipy can be a pain some of the time. So agpy
now includes a 2D cross-correlation code and a power spectrum / power
spectral density code …&lt;/p&gt;</summary><content type="html">&lt;p&gt;scipy is capable of doing fft-base cross-correlation, convolution, etc.,
but it requires the stsci package, which is not generally easy to
install. For that matter, scipy can be a pain some of the time. So agpy
now includes a 2D cross-correlation code and a power spectrum / power
spectral density code. These are pure-numpy codes that should be easy to
use without any other bothersome dependencies.
EDIT: I have them check for scipy (which can cause crashes if you have a
bad scipy install, e.g. 32 bit executables on a 64 bit system) because
scipy uses FFTW and numpy appears not to. Also, this code &amp;amp; related
stuff has been &lt;a class="reference external" href="http://www.astrobetter.com/fourier-transforms-of-images-in-python/"&gt;discussed on astrobetyter&lt;/a&gt;
&lt;a class="reference external" href="http://code.google.com/p/agpy/"&gt;agpy&lt;/a&gt;
&lt;a class="reference external" href="http://code.google.com/p/agpy/source/browse/trunk/agpy/correlate2d.py"&gt;correlate2d&lt;/a&gt;
&lt;a class="reference external" href="http://code.google.com/p/agpy/source/browse/trunk/agpy/psds.py"&gt;psds&lt;/a&gt;&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="python"></category><category term="agpy"></category></entry><entry><title>pstopng</title><link href="https://keflavich.github.io/blog/pstopng.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/pstopng.html</id><summary type="html">&lt;p&gt;Following &lt;a class="reference external" href="http://studio.imagemagick.org/discourse-server/viewtopic.php?f=1&amp;amp;t=8545&amp;amp;start=0"&gt;this thread&lt;/a&gt; and my need to convert IDL .ps files to .pngs
so that I can view them in Mac Preview without having to go through an
(often failed) conversion process led to a few discoveries.
First, it is challenging to get ImageMagick's convert to make an opaque
background …&lt;/p&gt;</summary><content type="html">&lt;p&gt;Following &lt;a class="reference external" href="http://studio.imagemagick.org/discourse-server/viewtopic.php?f=1&amp;amp;t=8545&amp;amp;start=0"&gt;this thread&lt;/a&gt; and my need to convert IDL .ps files to .pngs
so that I can view them in Mac Preview without having to go through an
(often failed) conversion process led to a few discoveries.
First, it is challenging to get ImageMagick's convert to make an opaque
background for the .ps file without seriously degrading the resolution.
This can be accomplished by passing &lt;em&gt;both&lt;/em&gt; the &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-alpha&lt;/span&gt; Off&lt;/tt&gt; and the
`` -density 300`` simultaneously. This is slow, though, and
recommendations to speed it up using the
&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-limit&lt;/span&gt; area 4096 &lt;span class="pre"&gt;-limit&lt;/span&gt; memory 4096&lt;/tt&gt; tags actually made it slower!
However, the thread pointed out that ghostscript can do the conversion
directly:
&lt;tt class="docutils literal"&gt;gs &lt;span class="pre"&gt;-dBATCH&lt;/span&gt; &lt;span class="pre"&gt;-sDEVICE=png16m&lt;/span&gt; &lt;span class="pre"&gt;-r300&lt;/span&gt; &lt;span class="pre"&gt;-dEPSCrop&lt;/span&gt; &lt;span class="pre"&gt;-dNOPAUSE&lt;/span&gt; &lt;span class="pre"&gt;-sOutputFile=XXX.png&lt;/span&gt; XXX.ps&lt;/tt&gt;
&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-sDEVICE&lt;/span&gt;&lt;/tt&gt; sets the output to png, &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-r300&lt;/span&gt;&lt;/tt&gt; tag sets the density to
be 300 pixels/inch, &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-dEPSCrop&lt;/span&gt;&lt;/tt&gt; is necessary to get the right sized
image out (otherwise it defaults to a portrait 8.5x11), and
`` -dBATCH `` prevents the gs command line from activating after the
command is executed. I'm not sure if &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-dNOPAUSE&lt;/span&gt;&lt;/tt&gt; is necessary, but
apparently if you don't activate it you have to do something after every
page is processed.
My code to do batch ps-to-png conversion is available at
&lt;a class="reference external" href="http://code.google.com/p/agpy/source/browse/trunk/agpy/pstopng"&gt;http://code.google.com/p/agpy/source/browse/trunk/agpy/pstopng&lt;/a&gt;.
Timing demonstrations (units are seconds, R is 'real' or clock time, 'U'
is user time, and 'S' is system time):
&lt;tt class="docutils literal"&gt;/usr/local/bin/convert &lt;span class="pre"&gt;-density&lt;/span&gt; 300 &lt;span class="pre"&gt;-alpha&lt;/span&gt; Off deline_zero_10hz_timestreams_003.ps deline_zero_10hz_timestreams_003.png TIMING: R: 3.126&amp;nbsp; U: 2.948&amp;nbsp; S: 0.084/usr/local/bin/convert &lt;span class="pre"&gt;-limit&lt;/span&gt; area 4096 &lt;span class="pre"&gt;-limit&lt;/span&gt; memory 4096 &lt;span class="pre"&gt;-density&lt;/span&gt; 300 &lt;span class="pre"&gt;-alpha&lt;/span&gt; Off deline_zero_10hz_timestreams_003.ps deline_zero_10hz_timestreams_003.png TIMING: R: 3.800&amp;nbsp; U: 2.970&amp;nbsp; S: 0.161gs &lt;span class="pre"&gt;-dBATCH&lt;/span&gt; &lt;span class="pre"&gt;-sDEVICE=png16m&lt;/span&gt; &lt;span class="pre"&gt;-r300&lt;/span&gt; &lt;span class="pre"&gt;-dEPSCrop&lt;/span&gt; &lt;span class="pre"&gt;-dNOPAUSE&lt;/span&gt; &lt;span class="pre"&gt;-sOutputFile=deline_zero_10hz_timestreams_003.png&lt;/span&gt; deline_zero_10hz_timestreams_003.psTIMING: R: 0.801&amp;nbsp; U: 0.781&amp;nbsp; S: 0.017&lt;/tt&gt;&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="postscript"></category></entry><entry><title>pwv</title><link href="https://keflavich.github.io/blog/pwv.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/pwv.html</id><content type="html">&lt;p&gt;precipitable water vapor, precipitable water vapor, go away, come again
some other observer's day
little HARPy wants to receive
so clear up before I leave
stupid bumping-head old man.&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="song"></category></entry><entry><title>pyspeckit: an astronomical spectroscopic toolkit</title><link href="https://keflavich.github.io/blog/pyspeckit-an-astronomical-spectroscopic-toolkit.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/pyspeckit-an-astronomical-spectroscopic-toolkit.html</id><content type="html">&lt;p&gt;Jordan and I have been working on our python-based spectroscopic
analysis tool for a while now:
&lt;a class="reference external" href="http://pyspeckit.bitbucket.org/"&gt;pyspeckit&lt;/a&gt; is a pretty awesome, now functional but incomplete (and
incompletely documented) tool.&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="python"></category><category term="code"></category><category term="astronomy"></category></entry><entry><title>Python 64 bit!</title><link href="https://keflavich.github.io/blog/python-64-bit.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/python-64-bit.html</id><summary type="html">&lt;p&gt;I got python 64 bit to compile, but it required a number of tricky
steps.
First, this guy has the instructions I followed:
&lt;a class="reference external" href="http://blog.captnswing.net/2009/04/19/python-mod_wsgi-64bit-mac-os-x-105/"&gt;captnswing&lt;/a&gt;
However, it didn't work entirely as advertised. I ran the configure as
advertised:
&lt;tt class="docutils literal"&gt;./configure &lt;span class="pre"&gt;--enable-framework=/Library/Frameworks&lt;/span&gt; &lt;span class="pre"&gt;\--enable-universalsdk=/&lt;/span&gt; \MACOSX_DEPLOYMENT_TARGET=10.5 &lt;span class="pre"&gt;\--with-universal-archs=all&lt;/span&gt; &lt;span class="pre"&gt;\--with-readline-dir …&lt;/span&gt;&lt;/tt&gt;&lt;/p&gt;</summary><content type="html">&lt;p&gt;I got python 64 bit to compile, but it required a number of tricky
steps.
First, this guy has the instructions I followed:
&lt;a class="reference external" href="http://blog.captnswing.net/2009/04/19/python-mod_wsgi-64bit-mac-os-x-105/"&gt;captnswing&lt;/a&gt;
However, it didn't work entirely as advertised. I ran the configure as
advertised:
&lt;tt class="docutils literal"&gt;./configure &lt;span class="pre"&gt;--enable-framework=/Library/Frameworks&lt;/span&gt; &lt;span class="pre"&gt;\--enable-universalsdk=/&lt;/span&gt; \MACOSX_DEPLOYMENT_TARGET=10.5 &lt;span class="pre"&gt;\--with-universal-archs=all&lt;/span&gt; &lt;span class="pre"&gt;\--with-readline-dir=/usr/local&lt;/span&gt;&lt;/tt&gt;
then the make install, but /usr/local/bin/python pointed to the wrong
place, so I replaced the symbolic link in my python path with the
correct one:
&lt;tt class="docutils literal"&gt;sudo rm /Library/Frameworks/Python.framework/Versions/2.6/bin/python sudo ln &lt;span class="pre"&gt;-s&lt;/span&gt; &lt;span class="pre"&gt;/Library/Frameworks/Python.framework/Versions/2.6/bin/python-64&lt;/span&gt; /Library/Frameworks/Python.framework/Versions/2.6/bin/python&lt;/tt&gt;
Now python is 64 bit:
&lt;tt class="docutils literal"&gt;eta ~$ python &lt;span class="pre"&gt;-c&lt;/span&gt; &amp;quot;import sys; print sys.maxint&amp;quot;9223372036854775807&lt;/tt&gt;
I haven't checked whether it works yet though...
Update: Had to reinstall with gnu readline installed. Also have to
install PyQt4 and might have to recompile numpy...
numpy won't compile with python 2.6.2:
&lt;tt class="docutils literal"&gt;C compiler: gcc &lt;span class="pre"&gt;-arch&lt;/span&gt; i386 &lt;span class="pre"&gt;-arch&lt;/span&gt; ppc &lt;span class="pre"&gt;-arch&lt;/span&gt; ppc64 &lt;span class="pre"&gt;-arch&lt;/span&gt; x86_64 &lt;span class="pre"&gt;-isysroot&lt;/span&gt; / &lt;span class="pre"&gt;-fno-strict-aliasing&lt;/span&gt; &lt;span class="pre"&gt;-fno-common&lt;/span&gt; &lt;span class="pre"&gt;-dynamic&lt;/span&gt; &lt;span class="pre"&gt;-DNDEBUG&lt;/span&gt; &lt;span class="pre"&gt;-g&lt;/span&gt; &lt;span class="pre"&gt;-fwrapv&lt;/span&gt; &lt;span class="pre"&gt;-O3&lt;/span&gt; &lt;span class="pre"&gt;-Wall&lt;/span&gt; &lt;span class="pre"&gt;-Wstrict-prototypescompile&lt;/span&gt; options: &lt;span class="pre"&gt;'-Inumpy/core/include&lt;/span&gt; &lt;span class="pre"&gt;-Ibuild/src.macosx-10.5-universal-2.6/numpy/core/include/numpy&lt;/span&gt; &lt;span class="pre"&gt;-Inumpy/core/src&lt;/span&gt; &lt;span class="pre"&gt;-Inumpy/core/include&lt;/span&gt; &lt;span class="pre"&gt;-I/Library/Frameworks/Python.framework/Versions/2.6/include/python2.6&lt;/span&gt; &lt;span class="pre"&gt;-c'gcc:&lt;/span&gt; &lt;span class="pre"&gt;build/src.macosx-10.5-universal-2.6/numpy/core/src/_sortmodule.cIn&lt;/span&gt; file included from numpy/core/include/numpy/ndarrayobject.h:26,&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; from numpy/core/include/numpy/noprefix.h:7,&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; from numpy/core/src/_sortmodule.c.src:29:numpy/core/include/numpy/npy_endian.h:33:10: error: #error Unknown CPU: can not set endiannesslipo: can't figure out the architecture type of: &lt;span class="pre"&gt;/var/folders/ni/ni+DtdqFGMeSMH13AvkNkU+++TI/-Tmp-//cceaWIvZ.outIn&lt;/span&gt; file included from numpy/core/include/numpy/ndarrayobject.h:26,&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; from numpy/core/include/numpy/noprefix.h:7,&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; from numpy/core/src/_sortmodule.c.src:29:numpy/core/include/numpy/npy_endian.h:33:10: error: #error Unknown CPU: can not set endiannesslipo: can't figure out the architecture type of: &lt;span class="pre"&gt;/var/folders/ni/ni+DtdqFGMeSMH13AvkNkU+++TI/-Tmp-//cceaWIvZ.outerror:&lt;/span&gt; Command &amp;quot;gcc &lt;span class="pre"&gt;-arch&lt;/span&gt; i386 &lt;span class="pre"&gt;-arch&lt;/span&gt; ppc &lt;span class="pre"&gt;-arch&lt;/span&gt; ppc64 &lt;span class="pre"&gt;-arch&lt;/span&gt; x86_64 &lt;span class="pre"&gt;-isysroot&lt;/span&gt; / &lt;span class="pre"&gt;-fno-strict-aliasing&lt;/span&gt; &lt;span class="pre"&gt;-fno-common&lt;/span&gt; &lt;span class="pre"&gt;-dynamic&lt;/span&gt; &lt;span class="pre"&gt;-DNDEBUG&lt;/span&gt; &lt;span class="pre"&gt;-g&lt;/span&gt; &lt;span class="pre"&gt;-fwrapv&lt;/span&gt; &lt;span class="pre"&gt;-O3&lt;/span&gt; &lt;span class="pre"&gt;-Wall&lt;/span&gt; &lt;span class="pre"&gt;-Wstrict-prototypes&lt;/span&gt; &lt;span class="pre"&gt;-Inumpy/core/include&lt;/span&gt; &lt;span class="pre"&gt;-Ibuild/src.macosx-10.5-universal-2.6/numpy/core/include/numpy&lt;/span&gt; &lt;span class="pre"&gt;-Inumpy/core/src&lt;/span&gt; &lt;span class="pre"&gt;-Inumpy/core/include&lt;/span&gt; &lt;span class="pre"&gt;-I/Library/Frameworks/Python.framework/Versions/2.6/include/python2.6&lt;/span&gt; &lt;span class="pre"&gt;-c&lt;/span&gt; &lt;span class="pre"&gt;build/src.macosx-10.5-universal-2.6/numpy/core/src/_sortmodule.c&lt;/span&gt; &lt;span class="pre"&gt;-o&lt;/span&gt; &lt;span class="pre"&gt;build/temp.macosx-10.5-universal-2.6/build/src.macosx-10.5-universal-2.6/numpy/core/src/_sortmodule.o&amp;quot;&lt;/span&gt; failed with exit status 1&lt;/tt&gt;
That sucks.&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="computer"></category></entry><entry><title>Python 64-bit on Mac OS X 10.6 Snow Leopard</title><link href="https://keflavich.github.io/blog/python-64-bit-on-mac-os-x-106-snow-leopard.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/python-64-bit-on-mac-os-x-106-snow-leopard.html</id><summary type="html">&lt;p&gt;After &lt;a class="reference external" href="http://buffalothedestroyer.blogspot.com/2010/02/installing-snow-leopard.html"&gt;yesterday's disastrous attempt&lt;/a&gt; to install various python
packages, I started from scratch. First, I got rid of all of my python
frameworks (backed up but removed from the path). Then, I compiled
python 2.7 from scratch:&lt;/p&gt;
&lt;p&gt;I got some help from
&lt;a class="reference external" href="http://blog.mahmoudimus.com/2009/12/python-2-6-4-and-twisted-9-on-os-x-10-6-snow-leopard/"&gt;http://blog.mahmoudimus.com/2009/12/python-2-6-4-and-twisted-9-on-os-x-10-6-snow-leopard …&lt;/a&gt;&lt;/p&gt;</summary><content type="html">&lt;p&gt;After &lt;a class="reference external" href="http://buffalothedestroyer.blogspot.com/2010/02/installing-snow-leopard.html"&gt;yesterday's disastrous attempt&lt;/a&gt; to install various python
packages, I started from scratch. First, I got rid of all of my python
frameworks (backed up but removed from the path). Then, I compiled
python 2.7 from scratch:&lt;/p&gt;
&lt;p&gt;I got some help from
&lt;a class="reference external" href="http://blog.mahmoudimus.com/2009/12/python-2-6-4-and-twisted-9-on-os-x-10-6-snow-leopard/"&gt;http://blog.mahmoudimus.com/2009/12/python-2-6-4-and-twisted-9-on-os-x-10-6-snow-leopard/&lt;/a&gt;
&lt;tt class="docutils literal"&gt;./configure &lt;span class="pre"&gt;--enable-framework&lt;/span&gt; &lt;span class="pre"&gt;--enable-universalsdk=/Developer/SDKs/MacOSX10.6.sdk&lt;/span&gt; MACOSX_DEPLOYMENT_TARGET=10.6 &lt;span class="pre"&gt;--with-universal-archs=intel&lt;/span&gt; &lt;span class="pre"&gt;-with-readline-dir=/usr/localmake&lt;/span&gt; &lt;span class="pre"&gt;-j&lt;/span&gt; 17make &lt;span class="pre"&gt;-j&lt;/span&gt; 17 test&lt;/tt&gt;
&lt;tt class="docutils literal"&gt;make&lt;/tt&gt; results:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
Python build finished, but the necessary bits to build these modules were
not found:
    _bsddb
    dl
    gdbm
    imageop
    linuxaudiodev
    ossaudiodev
    spwd
    sunaudiodev
To find the necessary bits, look in setup.py in detect_modules() for the
module's name.
&lt;/pre&gt;
&lt;p&gt;I'm not concerned about these - I don't use any of them and I assume I
need to install some other packages to get them to work.
During make test, I had two failures that resulted in &amp;quot;python crash&amp;quot;
pop-up boxes:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
test_subprocess.
this bit of output is from a test of stdout in a different process ....
this bit of output is from a test of stdout in a different process ...
test_sunaudiodev
&lt;/pre&gt;
&lt;p&gt;Then, I got some malloc errors:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
test_ioTesting large file ops skipped on darwin.It requires 2147483648
bytes and a long time.Use 'regrtest.py -u largefile test_io' to run
it.Testing large file ops skipped on darwin.It requires 2147483648 bytes
and a long time.Use 'regrtest.py -u largefile test_io' to run
it.python.exe(22914,0x7fff70d3ebe0) malloc: ***
mmap(size=9223372036854775808) failed (error code=12)*** error: can't
allocate region*** set a breakpoint in malloc_error_break to
debugpython.exe(22914,0x7fff70d3ebe0) malloc: ***
mmap(size=9223372036854775808) failed (error code=12)*** error: can't
allocate region*** set a breakpoint in malloc_error_break to
debugpython.exe(22914,0x7fff70d3ebe0) malloc: ***
mmap(size=9223372036854775808) failed (error code=12)*** error: can't
allocate region*** set a breakpoint in malloc_error_break to
debugtest_ioctl
&lt;/pre&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="python"></category></entry><entry><title>Python magic / advanced numpy indexing</title><link href="https://keflavich.github.io/blog/python-magic-advanced-numpy-indexing.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/python-magic-advanced-numpy-indexing.html</id><content type="html">&lt;p&gt;Yeah, indexing python arrays should really be easy.
&lt;a class="reference external" href="http://mentat.za.net/numpy/numpy_advanced_slides/"&gt;Stefan van der Walt's page&lt;/a&gt;
&lt;tt class="docutils literal"&gt;In [85]: bi = &lt;span class="pre"&gt;(f.bolo_indices[np.newaxis,:]&lt;/span&gt; + &lt;span class="pre"&gt;zeros([7751,1])).astype('int')In&lt;/span&gt; [86]: whc = &lt;span class="pre"&gt;(whscan[:,np.newaxis]&lt;/span&gt; + &lt;span class="pre"&gt;zeros([1,107])).astype('int')In&lt;/span&gt; [87]: array2d[whc,bi] = temp2d&lt;/tt&gt;&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="python"></category></entry><entry><title>Python: one-line arrays</title><link href="https://keflavich.github.io/blog/python-one-line-arrays.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/python-one-line-arrays.html</id><content type="html">&lt;p&gt;Ahhh, refreshing:
``      whscan = asarray([arange(scanlen)+i for i in scans_info[:,0]]).ravel()``
Not like IDL, which takes at least 4 lines b/c of the variable
declaration. There's probably a better way to do that too.&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="python"></category></entry><entry><title>Python: setting matplotlib defaults</title><link href="https://keflavich.github.io/blog/python-setting-matplotlib-defaults.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/python-setting-matplotlib-defaults.html</id><content type="html">&lt;p&gt;Setting matplotlib defaults is a lot more difficult than it should be.
&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;matplotlib.defaultParams['image.origin']='lower'matplotlib.defaultParams['image.interpolation']='nearest'&lt;/span&gt;&lt;/tt&gt;&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="python"></category><category term="computer"></category></entry><entry><title>python stuff</title><link href="https://keflavich.github.io/blog/python-stuff.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/python-stuff.html</id><content type="html">&lt;p&gt;to get imshow defaults to be nearest neighbor, need to edit
~/.matplotlib/matplotlibrc. Still don't know how to change default
command-line output format.&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="computer"></category></entry><entry><title>Quicksilver and Awesome</title><link href="https://keflavich.github.io/blog/quicksilver-and-awesome.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/quicksilver-and-awesome.html</id><content type="html">&lt;p&gt;Set up f17-19 today to play amusing sounds. Also, recalled that I use
ScreenSaverEngine to lock my screen with a shortcut key.
Quicksilver triggers are the way to do it. Mac is stupid w/o
quicksilver.&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="computer"></category></entry><entry><title>Quicksilver sounds</title><link href="https://keflavich.github.io/blog/quicksilver-sounds.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/quicksilver-sounds.html</id><summary type="html">&lt;p&gt;To switch sound source from the command line:
&lt;a class="reference external" href="http://code.google.com/p/switchaudio-osx/"&gt;switchaudio&lt;/a&gt;
Use this to make scripts such as:
&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;#!/bin/bash/Users/adam/humor/SwitchAudioSource&lt;/span&gt; &lt;span class="pre"&gt;-s&lt;/span&gt; &lt;span class="pre"&gt;&amp;quot;Built-in&lt;/span&gt; Line Output&amp;quot;afplay /Users/adam/humor/losinghorn.wav/Users/adam/humor/SwitchAudioSource &lt;span class="pre"&gt;-s&lt;/span&gt; &lt;span class="pre"&gt;&amp;quot;Built-in&lt;/span&gt; Output&amp;quot;&lt;/tt&gt;
Then make triggers in Quicksilver by:&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;Go to trigger pane, make …&lt;/li&gt;&lt;/ol&gt;</summary><content type="html">&lt;p&gt;To switch sound source from the command line:
&lt;a class="reference external" href="http://code.google.com/p/switchaudio-osx/"&gt;switchaudio&lt;/a&gt;
Use this to make scripts such as:
&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;#!/bin/bash/Users/adam/humor/SwitchAudioSource&lt;/span&gt; &lt;span class="pre"&gt;-s&lt;/span&gt; &lt;span class="pre"&gt;&amp;quot;Built-in&lt;/span&gt; Line Output&amp;quot;afplay /Users/adam/humor/losinghorn.wav/Users/adam/humor/SwitchAudioSource &lt;span class="pre"&gt;-s&lt;/span&gt; &lt;span class="pre"&gt;&amp;quot;Built-in&lt;/span&gt; Output&amp;quot;&lt;/tt&gt;
Then make triggers in Quicksilver by:&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;Go to trigger pane, make new hotkey trigger&lt;/li&gt;
&lt;li&gt;press &amp;quot;.&amp;quot; to allow you to type a command&lt;/li&gt;
&lt;li&gt;make sure the action is &amp;quot;Run&amp;quot;&lt;/li&gt;
&lt;li&gt;hook up a hotkey&lt;/li&gt;
&lt;li&gt;if it doesn't work, just try again. Persist through crashes, they
happen often.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Follow-up: You can also control the volume!
&lt;a class="reference external" href="http://discussions.apple.com/thread.jspa?threadID=585781"&gt;http://discussions.apple.com/thread.jspa?threadID=585781&lt;/a&gt;
`` osascript -e 'set volume output volume 100'``&lt;/p&gt;
&lt;/p&gt;</content><category term="misc"></category><category term="googlepost"></category><category term="computer"></category></entry><entry><title>RATRAN on Mac OS X</title><link href="https://keflavich.github.io/blog/ratran-on-mac-os-x.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/ratran-on-mac-os-x.html</id><summary type="html">&lt;p&gt;Mac OS X doesn't like the defaults built in to &lt;a class="reference external" href="http://www.sron.rug.nl/~vdtak/ratran/frames.html"&gt;RATRAN&lt;/a&gt;. It died
unhappily with errors like:
&lt;tt class="docutils literal"&gt;ld_classic: can't locate file for: &lt;span class="pre"&gt;-lcrt0.o&lt;/span&gt;&lt;/tt&gt;
and
&lt;tt class="docutils literal"&gt;ld: warning: in &lt;span class="pre"&gt;/usr/local/lib//libcfitsio.a,&lt;/span&gt; file is not of required architecture&lt;/tt&gt;
In order to get it to run, I had to …&lt;/p&gt;</summary><content type="html">&lt;p&gt;Mac OS X doesn't like the defaults built in to &lt;a class="reference external" href="http://www.sron.rug.nl/~vdtak/ratran/frames.html"&gt;RATRAN&lt;/a&gt;. It died
unhappily with errors like:
&lt;tt class="docutils literal"&gt;ld_classic: can't locate file for: &lt;span class="pre"&gt;-lcrt0.o&lt;/span&gt;&lt;/tt&gt;
and
&lt;tt class="docutils literal"&gt;ld: warning: in &lt;span class="pre"&gt;/usr/local/lib//libcfitsio.a,&lt;/span&gt; file is not of required architecture&lt;/tt&gt;
In order to get it to run, I had to do the following:&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;Install CFITSIO with &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;CFLAGS=&amp;quot;-arch&lt;/span&gt; x86_64 &lt;span class="pre"&gt;-arch&lt;/span&gt; i386 &lt;span class="pre"&gt;-g&lt;/span&gt; &lt;span class="pre"&gt;-O2&amp;quot;&lt;/span&gt;&lt;/tt&gt; to
/usr/local/lib&lt;/li&gt;
&lt;li&gt;Edit the sky/Makefile OPT variable (line 23) to read:
&lt;tt class="docutils literal"&gt;OPT = &lt;span class="pre"&gt;-I.&lt;/span&gt; &lt;span class="pre"&gt;-O2&lt;/span&gt; &lt;span class="pre"&gt;-fno-automatic&lt;/span&gt; &lt;span class="pre"&gt;-arch&lt;/span&gt; x86_64&lt;/tt&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Also, you need to set up system variables:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
export RATRAN=/path/to/Ratran export RATRANRUN=/path/to/Ratran/run
&lt;/pre&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="astronomy"></category><category term="computer"></category></entry><entry><title>Rebuilding python from scratch again</title><link href="https://keflavich.github.io/blog/rebuilding-python-from-scratch-again.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/rebuilding-python-from-scratch-again.html</id><summary type="html">&lt;p&gt;I got scipy working a week or two ago, but doing so killed matplotib's
tkagg. So, I switched to the MacOSX backend, which worked ok until I
realized that the interactive (connect) features of macosx failed
miserably. This led me to try to get matplotlib working.... which broke
with those …&lt;/p&gt;</summary><content type="html">&lt;p&gt;I got scipy working a week or two ago, but doing so killed matplotib's
tkagg. So, I switched to the MacOSX backend, which worked ok until I
realized that the interactive (connect) features of macosx failed
miserably. This led me to try to get matplotlib working.... which broke
with those awful &amp;quot;symbol not found&amp;quot; errors in ft2font.so and _path.so,
which I've determined all have to do with linking to the wrong library
files.
The most worrisome part of this process was discovering that a full Time
Machine recovery of /usr and /Library/Frameworks and /Library/Python did
*not* restore python - it stayed dead with IDENTICAL errors. So there
are probably additional layers of hidden links.
The process below is based on &lt;a class="reference external" href="http://blog.hyperjeff.net/?p=160"&gt;hyperjeff's blog post&lt;/a&gt; but differs
substantially based on &lt;a class="reference external" href="http://casa.colorado.edu/~skillman/research_and_codes/files/649710e82f85745eb65a90535f0f3098-5.html"&gt;Sam Skillman's recommendations&lt;/a&gt; and the very
big issue I ran into that my /usr/local files appeared to be corrupted.
After this install, my path no longer includes /usr/local/bin and /sw
has been moved to /_sw... hopefully one of these days I'll be ballsy
enough to delete it.&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;Install python 2.6.4&lt;ol class="arabic"&gt;
&lt;li&gt;Needed a clean terminal with no flags set at all. Don't know why -
all I had set were a bunch of -arch x86_64 flags.
&lt;tt class="docutils literal"&gt;export &lt;span class="pre"&gt;LD_LIBRARY_PATH=&amp;quot;/usr/local/lib:/usr/X11/lib&amp;quot;./configure&lt;/span&gt; &lt;span class="pre"&gt;--enable-framework=/Library/Frameworks&lt;/span&gt; MACOSX_DEPLOYMENT_TARGET=10.6 make &lt;span class="pre"&gt;-j&lt;/span&gt; 17sudo make install&lt;/tt&gt;&lt;/li&gt;
&lt;li&gt;Reset PYTHONPATH to blank&lt;/li&gt;
&lt;li&gt;`` alias clearflags='export CFLAGS=&amp;quot;&amp;quot;; export CCFLAGS=&amp;quot;&amp;quot;; export CXXFLAGS=&amp;quot;&amp;quot;; export LDFLAGS=&amp;quot;&amp;quot;; export FFLAGS=&amp;quot;&amp;quot;;'``
to make sure&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;Install FFTW
&lt;tt class="docutils literal"&gt;cd ~/tmpcurl &lt;span class="pre"&gt;-O&lt;/span&gt; &lt;span class="pre"&gt;http://www.fftw.org/fftw-3.2.2.tar.gztar&lt;/span&gt; xf &lt;span class="pre"&gt;fftw-3.2.2.tar.gzcd&lt;/span&gt; &lt;span class="pre"&gt;fftw-3.2.2clearflags./configure&lt;/span&gt; &lt;span class="pre"&gt;CC=&amp;quot;gcc&lt;/span&gt; &lt;span class="pre"&gt;-arch&lt;/span&gt; x86_64&amp;quot; &lt;span class="pre"&gt;CXX=&amp;quot;g++&lt;/span&gt; &lt;span class="pre"&gt;-arch&lt;/span&gt; x86_64&amp;quot; &lt;span class="pre"&gt;CPP=&amp;quot;gcc&lt;/span&gt; &lt;span class="pre"&gt;-E&amp;quot;&lt;/span&gt; &lt;span class="pre"&gt;CXXCPP=&amp;quot;g++&lt;/span&gt; &lt;span class="pre"&gt;-E&amp;quot;make&lt;/span&gt; &lt;span class="pre"&gt;-j&lt;/span&gt; 17sudo make install&lt;/tt&gt;&lt;/li&gt;
&lt;li&gt;Install UMFPACK
&lt;tt class="docutils literal"&gt;cd ~/tmpcurl &lt;span class="pre"&gt;-O&lt;/span&gt; &lt;span class="pre"&gt;http://www.cise.ufl.edu/research/sparse/umfpack/current/UMFPACK.tar.gzcurl&lt;/span&gt; &lt;span class="pre"&gt;-O&lt;/span&gt; &lt;span class="pre"&gt;http://www.cise.ufl.edu/research/sparse/UFconfig/current/UFconfig.tar.gzcurl&lt;/span&gt; &lt;span class="pre"&gt;-O&lt;/span&gt; &lt;span class="pre"&gt;http://www.cise.ufl.edu/research/sparse/amd/current/AMD.tar.gztar&lt;/span&gt; xf AMD.tar.gztar xf UFconfig.tar.gztar xf UMFPACK.tar.gzsed &lt;span class="pre"&gt;-ibck&lt;/span&gt; 's/F77 = f77/F77 = gfortran/' UFconfig/UFconfig.mk sed &lt;span class="pre"&gt;-ibck&lt;/span&gt; '299,303s/# //' UFconfig/UFconfig.mkcp UFconfig/UFconfig.h AMD/Include/cp UFconfig/UFconfig.h UMFPACK/Include/cd UMFPACKmake &lt;span class="pre"&gt;-j&lt;/span&gt; 17make hbmake clean&lt;/tt&gt;&lt;/li&gt;
&lt;li&gt;Install numpy&lt;ol class="arabic"&gt;
&lt;li&gt;Set environment variables
&lt;tt class="docutils literal"&gt;export MACOSX_DEPLOYMENT_TARGET=10.6export &lt;span class="pre"&gt;CFLAGS=&amp;quot;-arch&lt;/span&gt; x86_64&amp;quot;export &lt;span class="pre"&gt;FFLAGS=&amp;quot;-m64&amp;quot;export&lt;/span&gt; &lt;span class="pre"&gt;LDFLAGS=&amp;quot;-Wall&lt;/span&gt; &lt;span class="pre"&gt;-undefined&lt;/span&gt; dynamic_lookup &lt;span class="pre"&gt;-bundle&lt;/span&gt; &lt;span class="pre"&gt;-arch&lt;/span&gt; x86_64&amp;quot;export &lt;span class="pre"&gt;PYTHONPATH=&amp;quot;/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/&amp;quot;echo&lt;/span&gt; &amp;quot;[amd]library_dirs = /Users/adam/tmp/AMD/Libinclude_dirs = /Users/adam/tmp/AMD/Includeamd_libs = amd[umfpack]library_dirs = /Users/adam/tmp/UMFPACK/Libinclude_dirs = /Users/adam/tmp/UMFPACK/Includeumfpack_libs = umfpack&amp;quot; &amp;gt; site.cfg&lt;/tt&gt;&lt;/li&gt;
&lt;li&gt;Setup &amp;amp; Install
&lt;tt class="docutils literal"&gt;python setup.py build &lt;span class="pre"&gt;--fcompiler=gnu95sudo&lt;/span&gt; python setup.py install&lt;/tt&gt;&lt;/li&gt;
&lt;li&gt;Test: python -c &amp;quot;import numpy&amp;quot;&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;Install scipy. The important thing is to use g++-4.2 because g++-4.5
doesn't accept the -arch flag. Also, get rid of /sw if it's on your
computer at all.
&lt;tt class="docutils literal"&gt;sudo mv /System/Library/Frameworks/Python.framework/Versions/2.6/Extras/lib/python/numpy /System/Library/Frameworks/Python.framework/Versions/2.6/Extras/lib/python/numpyXcd &lt;span class="pre"&gt;~/repos/scipy-0.7.1python&lt;/span&gt; setup.py cleanrm &lt;span class="pre"&gt;-rf&lt;/span&gt; &lt;span class="pre"&gt;buildclearflagsFFLAGS=&amp;quot;-m64&amp;quot;&lt;/span&gt; &lt;span class="pre"&gt;CFLAGS=&amp;quot;-arch&lt;/span&gt; x86_64 &lt;span class="pre"&gt;-I/usr/local/include/freetype2&lt;/span&gt; &lt;span class="pre"&gt;-I/usr/X11/include&lt;/span&gt; &lt;span class="pre"&gt;-L/usr/X11/lib&amp;quot;&lt;/span&gt;&amp;nbsp; &lt;span class="pre"&gt;LDFLAGS=&amp;quot;-Wall&lt;/span&gt; &lt;span class="pre"&gt;-undefined&lt;/span&gt; dynamic_lookup &lt;span class="pre"&gt;-bundle&lt;/span&gt;&amp;nbsp; &lt;span class="pre"&gt;-lpng&lt;/span&gt; &lt;span class="pre"&gt;-arch&lt;/span&gt; x86_64&amp;quot; &lt;span class="pre"&gt;CXX=&amp;quot;/usr/bin/g++-4.2&amp;quot;&lt;/span&gt; &lt;span class="pre"&gt;CC=&amp;quot;/usr/bin/gcc-4.2&amp;quot;&lt;/span&gt; python setup.py buildpython setup.py install&lt;/tt&gt;
Test the install:
&lt;tt class="docutils literal"&gt;python &lt;span class="pre"&gt;-c&lt;/span&gt; &amp;quot;import scipy, scipy.fftpack, scipy.interpolate&amp;quot;&lt;/tt&gt;&lt;/li&gt;
&lt;li&gt;&lt;ol class="first arabic"&gt;
&lt;li&gt;Install matplotlib. MAKE SURE /usr/bin/texbin is in front of
/usr/local/bin and /sw/bin so that dvipng comes from MacTEX. I
also ended up having to remove /usr/local/bin from my path
completely
&lt;tt class="docutils literal"&gt;sudo mv /System/Library/Frameworks/Python.framework/Versions/2.6/Extras/lib/python/numpy /System/Library/Frameworks/Python.framework/Versions/2.6/Extras/lib/python/numpyXcd &lt;span class="pre"&gt;~/repos/matplotlib-svnpython&lt;/span&gt; setup.py cleanrm &lt;span class="pre"&gt;-rf&lt;/span&gt; buildclearflags&lt;/tt&gt;&lt;/li&gt;
&lt;li&gt;Do hyperjeff's recommended edits except don't use /usr/local
because it's f'd:
make.osx:
&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;MACOSX_DEPLOYMENT_TARGET=10.6PREFIX=/usrPYTHON=/Library/Frameworks/Python.framework/Versions/Current/bin/python##&lt;/span&gt; You shouldn't need to configure past this point (and &lt;span class="pre"&gt;yet…)PKG_CONFIG_PATH=&amp;quot;${PREFIX}/lib/pkgconfig&amp;quot;CFLAGS=&amp;quot;-arch&lt;/span&gt; i386 &lt;span class="pre"&gt;-arch&lt;/span&gt; x86_64 &lt;span class="pre"&gt;-I${PREFIX}/include&lt;/span&gt; &lt;span class="pre"&gt;-I${PREFIX}/include/freetype2&lt;/span&gt; &lt;span class="pre"&gt;-isysroot&lt;/span&gt; &lt;span class="pre"&gt;/Developer/SDKs/MacOSX10.6.sdk&amp;quot;LDFLAGS=&amp;quot;-arch&lt;/span&gt; i386 &lt;span class="pre"&gt;-arch&lt;/span&gt; x86_64 &lt;span class="pre"&gt;-L${PREFIX}/lib&lt;/span&gt; &lt;span class="pre"&gt;-syslibroot,/Developer/SDKs/MacOSX10.6.sdk&amp;quot;FFLAGS=&amp;quot;-arch&lt;/span&gt; i386 &lt;span class="pre"&gt;-arch&lt;/span&gt; x86_64&amp;quot;&lt;/tt&gt;
setup.cfg:
&lt;tt class="docutils literal"&gt;wxagg = False&lt;/tt&gt;&lt;/li&gt;
&lt;li&gt;Do the install (different from hyperjeff b/c I don't want root)
`` sudo make -f make.osx fetch deps make -f mpl_build mpl_installpython setup.py install``&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;Install setuptools&lt;/li&gt;
&lt;li&gt;easy_install ipython&lt;/li&gt;
&lt;li&gt;install everything else pythonically&lt;/li&gt;
&lt;/ol&gt;
&lt;/p&gt;</content><category term="misc"></category><category term="googlepost"></category><category term="python"></category><category term="mac"></category></entry><entry><title>Reinstalling a system</title><link href="https://keflavich.github.io/blog/reinstalling-a-system.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/reinstalling-a-system.html</id><summary type="html">&lt;p&gt;Python died tonight when I foolishly tried to update numpy or
matplotlib. One was not compatible with the other in upgraded form, and
the update for matplotlib wouldn't install because of GTK issues that
were totally opaque.
So, I reinstalled EVERYTHING - fink AND macports - from scratch. If I
don't get …&lt;/p&gt;</summary><content type="html">&lt;p&gt;Python died tonight when I foolishly tried to update numpy or
matplotlib. One was not compatible with the other in upgraded form, and
the update for matplotlib wouldn't install because of GTK issues that
were totally opaque.
So, I reinstalled EVERYTHING - fink AND macports - from scratch. If I
don't get things running by morning I'm going to have to do a restore,
which is ugly as death.
Things I need to do post-install:
``        sudo port install python_select          sudo python_select python25``
test ipython
test matplotlib
test numpy&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="python"></category><category term="computer"></category></entry><entry><title>Repositories for observers</title><link href="https://keflavich.github.io/blog/repositories-for-observers.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/repositories-for-observers.html</id><summary type="html">&lt;p&gt;I should have posted these a while ago....
&lt;a class="reference external" href="http://code.google.com/p/casaradio/"&gt;casaradio&lt;/a&gt; is a subversion repository for folks at &lt;a class="reference external" href="http://casa.colorado.edu"&gt;The Center for
Astrophysics and Space Astronomy at CU Boulder&lt;/a&gt; to post radio astronomy
related codes. So far, emphasizes single dish (GBT, Arecibo), but will
include EVLA, CARMA, and ALMA eventually.
&lt;a class="reference external" href="http://code.google.com/p/aposoftware/"&gt;aposoftware&lt;/a&gt; is a …&lt;/p&gt;</summary><content type="html">&lt;p&gt;I should have posted these a while ago....
&lt;a class="reference external" href="http://code.google.com/p/casaradio/"&gt;casaradio&lt;/a&gt; is a subversion repository for folks at &lt;a class="reference external" href="http://casa.colorado.edu"&gt;The Center for
Astrophysics and Space Astronomy at CU Boulder&lt;/a&gt; to post radio astronomy
related codes. So far, emphasizes single dish (GBT, Arecibo), but will
include EVLA, CARMA, and ALMA eventually.
&lt;a class="reference external" href="http://code.google.com/p/aposoftware/"&gt;aposoftware&lt;/a&gt; is a similar page, but is a mercurial repository and is
meant to include instrument-specific software for the &lt;a class="reference external" href="http://www.apo.nmsu.edu/"&gt;Apache Point
Observatory&lt;/a&gt; &lt;a class="reference external" href="http://www.apo.nmsu.edu/arc35m/GeneralInfo_ARC35m.html"&gt;3.5m telescope&lt;/a&gt;. Right now includes a TUI script or two
and the TSPEC and DIS IRAF-twodspec pipelines.
I'd be remiss to leave out the &lt;a class="reference external" href="http://code.google.com/p/bgpspipeline/"&gt;BGPS pipeline&lt;/a&gt; even though it's
mentioned on the previous post.
Also, &lt;a class="reference external" href="http://code.google.com/p/agpy/"&gt;agpy&lt;/a&gt; is my personal code repository.&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="internet"></category><category term="agpy"></category><category term="astronomy"></category></entry><entry><title>Review: Fruition restaurant</title><link href="https://keflavich.github.io/blog/review-fruition-restaurant.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/review-fruition-restaurant.html</id><summary type="html">&lt;p&gt;I ate at &lt;a class="reference external" href="http://www.fruitionrestaurant.com/cuisine.html"&gt;Fruition restaurant&lt;/a&gt; last night with the family. They serve
&lt;a class="reference external" href="http://en.wikipedia.org/wiki/haute_cuisine"&gt;haute cuisine&lt;/a&gt;. I had the beef coulotte. It was pretty tasty, but
overall a bit too creamy for my taste. The wine had a hint of cherry
flavor to it. The dinner was pretty good, but overall a …&lt;/p&gt;</summary><content type="html">&lt;p&gt;I ate at &lt;a class="reference external" href="http://www.fruitionrestaurant.com/cuisine.html"&gt;Fruition restaurant&lt;/a&gt; last night with the family. They serve
&lt;a class="reference external" href="http://en.wikipedia.org/wiki/haute_cuisine"&gt;haute cuisine&lt;/a&gt;. I had the beef coulotte. It was pretty tasty, but
overall a bit too creamy for my taste. The wine had a hint of cherry
flavor to it. The dinner was pretty good, but overall a little
disappointing for the price. The French press coffee was a bit much as I
would have preferred a small cup of cappuccino. I wouldn't object to
going back when they switch to a new seasonal menu, but I'm not going
out of my way.&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="review"></category></entry><entry><title>running at altitude</title><link href="https://keflavich.github.io/blog/running-at-altitude.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/running-at-altitude.html</id><content type="html">&lt;p&gt;wow dude. I suck at that.
I swear there were some other things I had to write down but I can't
remember them now.
precipitable water vapor precipitates and that can be good&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category></entry><entry><title>Russell Owen, DS9</title><link href="https://keflavich.github.io/blog/russell-owen-ds9.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/russell-owen-ds9.html</id><summary type="html">&lt;p&gt;As I might have expected, Russell Owen from the University of Washington
- the man responsible for the Telescope User Interface, TUI, on the
Apache Point Observatory telescope - has written up a &lt;a class="reference external" href="http://www.astro.washington.edu/owen/ds9andxpa.html"&gt;help page for XPA
access points on ds9&lt;/a&gt;. He knows his stuff... I think I need to aspire
to …&lt;/p&gt;</summary><content type="html">&lt;p&gt;As I might have expected, Russell Owen from the University of Washington
- the man responsible for the Telescope User Interface, TUI, on the
Apache Point Observatory telescope - has written up a &lt;a class="reference external" href="http://www.astro.washington.edu/owen/ds9andxpa.html"&gt;help page for XPA
access points on ds9&lt;/a&gt;. He knows his stuff... I think I need to aspire
to that.&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="ds9"></category></entry><entry><title>sage casjobs</title><link href="https://keflavich.github.io/blog/sage-casjobs.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/sage-casjobs.html</id><content type="html">&lt;p&gt;annoying feature of sage casjobs: no spaces are allowed, no matter what,
even if quoted. so when importing must remove all spaces. gurrh.&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category></entry><entry><title>SAVE / RESTORE in Python</title><link href="https://keflavich.github.io/blog/save-restore-in-python.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/save-restore-in-python.html</id><summary type="html">&lt;p&gt;Save/Restore is probably the single best feature of IDL that, sadly, is
very poorly replicated in Python. For 1 or 2 dimensional variables, you
can use Pylab's &lt;tt class="docutils literal"&gt;save/load&lt;/tt&gt;, but I never use such piddling tiny
arrays. For higher dimensional objects, either using FITS files (a pain
because of …&lt;/p&gt;</summary><content type="html">&lt;p&gt;Save/Restore is probably the single best feature of IDL that, sadly, is
very poorly replicated in Python. For 1 or 2 dimensional variables, you
can use Pylab's &lt;tt class="docutils literal"&gt;save/load&lt;/tt&gt;, but I never use such piddling tiny
arrays. For higher dimensional objects, either using FITS files (a pain
because of header definitions) or pickling ought to work.
e.g.:
&lt;tt class="docutils literal"&gt;import numpyimport &lt;span class="pre"&gt;picklex=ones([10,10,10,10],dtype='float64')pickle.dump(x,open('x.pysav','w'))X&lt;/span&gt; = &lt;span class="pre"&gt;pickle.load(open('x.pysav','r'))&lt;/span&gt;&lt;/tt&gt;&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="python"></category><category term="computer"></category></entry><entry><title>scary</title><link href="https://keflavich.github.io/blog/scary.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/scary.html</id><content type="html">&lt;p&gt;I think this is my worst nightmare:
&lt;a class="reference external" href="http://antwrp.gsfc.nasa.gov/apod/ap081203.html"&gt;http://antwrp.gsfc.nasa.gov/apod/ap081203.html&lt;/a&gt;
LA. Not the smiley.&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category></entry><entry><title>Screen cont'd</title><link href="https://keflavich.github.io/blog/screen-contd.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/screen-contd.html</id><content type="html">&lt;p&gt;&lt;a class="reference external" href="http://news.softpedia.com/news/GNU-Screen-Tutorial-44274.shtml"&gt;Guide to screen&lt;/a&gt;
Particularly useful features:
Scrollback:
&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;ctrl-a&lt;/span&gt; [[scroll keys]&lt;/tt&gt;
Switch to a numbered screen (doesn't work for me so far):
&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;ctrl-a&lt;/span&gt; [number]&lt;/tt&gt;&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="computer"></category></entry><entry><title>Screen, nohup, ssh, scp</title><link href="https://keflavich.github.io/blog/screen-nohup-ssh-scp.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/screen-nohup-ssh-scp.html</id><summary type="html">&lt;p&gt;I learned a lot about the above in the past day, but I didn't keep track
of the links.
First, screen is very useful: it allows you to run any task, detach the
screen, and let it run in the background. You can resume it later.
Example:
&lt;tt class="docutils literal"&gt;screenipython &lt;span class="pre"&gt;run_fitter …&lt;/span&gt;&lt;/tt&gt;&lt;/p&gt;</summary><content type="html">&lt;p&gt;I learned a lot about the above in the past day, but I didn't keep track
of the links.
First, screen is very useful: it allows you to run any task, detach the
screen, and let it run in the background. You can resume it later.
Example:
&lt;tt class="docutils literal"&gt;screenipython &lt;span class="pre"&gt;run_fitter.py&amp;lt;ctrl-a&amp;gt;&lt;/span&gt; dscreen &lt;span class="pre"&gt;-r&lt;/span&gt;&lt;/tt&gt;
Second, it's a huge pain to type a password every time I use scp and
ssh. The solution is to make a key on your computer and put it in the
authorized_keys file.
&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;ssh-keygen&lt;/span&gt; &lt;span class="pre"&gt;-t&lt;/span&gt; rsascp &lt;span class="pre"&gt;~/.ssh/id_rsa&lt;/span&gt; &lt;span class="pre"&gt;ginsbura&amp;#64;milkyway.colorado.edu:.ssh&lt;/span&gt; ginsbura&amp;#64;milkyway.colorado.educat id_rsa &amp;gt;&amp;gt; &lt;span class="pre"&gt;~/.ssh/authorized_keysssh&lt;/span&gt; &lt;span class="pre"&gt;-v&lt;/span&gt; ginsbura&amp;#64;milkyway.colorado.edu&lt;/tt&gt;
Use ssh -v to figure out why it fails if it still asks you for a
password. In one case, this happened because the computer I was using
expected the id to be in ~/.ssh/identity instead of ~/.ssh/id_rsa.
There may also be permissions issues (i.e. you want restrictive
permissions on your ssh keys).
With the latter, you can still use nohup, which is helpful if you want
to pipe your output to a log file.&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="ssh"></category><category term="security"></category><category term="computer"></category></entry><entry><title>SETI</title><link href="https://keflavich.github.io/blog/seti.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/seti.html</id><summary type="html">&lt;p&gt;I read a &lt;a class="reference external" href="http://arxiv.org/abs/0807.4518"&gt;paper on ArXiv&lt;/a&gt; today about SETI, and talked to &lt;a class="reference external" href="http://casa.colorado.edu/~jdarling/"&gt;Jeremy
Darling&lt;/a&gt; about water masers. This got me thinking: the best way to
signal your presence to the universe as an intelligent civilization is
to take advantage of natural amplification. So, say, you go find a big
cloud …&lt;/p&gt;</summary><content type="html">&lt;p&gt;I read a &lt;a class="reference external" href="http://arxiv.org/abs/0807.4518"&gt;paper on ArXiv&lt;/a&gt; today about SETI, and talked to &lt;a class="reference external" href="http://casa.colorado.edu/~jdarling/"&gt;Jeremy
Darling&lt;/a&gt; about water masers. This got me thinking: the best way to
signal your presence to the universe as an intelligent civilization is
to take advantage of natural amplification. So, say, you go find a big
cloud of water molecules in the right state to start masing, and blast
them with some of the right frequency radio emission: you get a strongly
enhanced isotropic emitter. Maybe SETI should look for those, then
search for nearby coherent sources....
EDIT: Isotropic? No.&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="astronomy"></category></entry><entry><title>skill set</title><link href="https://keflavich.github.io/blog/skill-set.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/skill-set.html</id><content type="html">&lt;p&gt;is it a marketable skill that I can bring down almost any computer
system I'm given access too entirely unintentionally?&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="marketable skills"></category></entry><entry><title>Skim: a PDF reader that allows annotations</title><link href="https://keflavich.github.io/blog/skim-a-pdf-reader-that-allows-annotations.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/skim-a-pdf-reader-that-allows-annotations.html</id><content type="html">&lt;p&gt;from Sam: &lt;a class="reference external" href="http://skim-app.sourceforge.net/"&gt;http://skim-app.sourceforge.net/&lt;/a&gt;
neat&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="pdf"></category></entry><entry><title>some comics</title><link href="https://keflavich.github.io/blog/some-comics.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/some-comics.html</id><summary type="html">&lt;p&gt;&lt;a class="reference external" href="http://ableandbaker.net/index.php?comic=198"&gt;http://ableandbaker.net/index.php?comic=198&lt;/a&gt;
&lt;a class="reference external" href="http://ableandbaker.net/index.php?comic=222"&gt;http://ableandbaker.net/index.php?comic=222&lt;/a&gt;
&lt;a class="reference external" href="http://ableandbaker.net/index.php?comic=357"&gt;http://ableandbaker.net/index.php?comic=357&lt;/a&gt;
&lt;a class="reference external" href="http://ableandbaker.net/index.php?comic=396"&gt;http://ableandbaker.net/index.php?comic=396&lt;/a&gt;
&lt;a class="reference external" href="http://ableandbaker.net/index.php?comic=471"&gt;http://ableandbaker.net/index.php?comic=471&lt;/a&gt;
545 &amp;quot;Put on your snuggle trunks and jump in the cuddle pool.&amp;quot;
&lt;a class="reference external" href="http://ableandbaker.net/index.php?comic=905"&gt;http://ableandbaker.net …&lt;/a&gt;&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;a class="reference external" href="http://ableandbaker.net/index.php?comic=198"&gt;http://ableandbaker.net/index.php?comic=198&lt;/a&gt;
&lt;a class="reference external" href="http://ableandbaker.net/index.php?comic=222"&gt;http://ableandbaker.net/index.php?comic=222&lt;/a&gt;
&lt;a class="reference external" href="http://ableandbaker.net/index.php?comic=357"&gt;http://ableandbaker.net/index.php?comic=357&lt;/a&gt;
&lt;a class="reference external" href="http://ableandbaker.net/index.php?comic=396"&gt;http://ableandbaker.net/index.php?comic=396&lt;/a&gt;
&lt;a class="reference external" href="http://ableandbaker.net/index.php?comic=471"&gt;http://ableandbaker.net/index.php?comic=471&lt;/a&gt;
545 &amp;quot;Put on your snuggle trunks and jump in the cuddle pool.&amp;quot;
&lt;a class="reference external" href="http://ableandbaker.net/index.php?comic=905"&gt;http://ableandbaker.net/index.php?comic=905&lt;/a&gt;
&lt;a class="reference external" href="http://ableandbaker.net/index.php?comic=922"&gt;http://ableandbaker.net/index.php?comic=922&lt;/a&gt;&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="comic"></category></entry><entry><title>specanpy</title><link href="https://keflavich.github.io/blog/specanpy.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/specanpy.html</id><content type="html">&lt;p&gt;&lt;a class="reference external" href="http://casa.colorado.edu/~ginsbura/index.htm"&gt;AG&lt;/a&gt;
There are now 2 clones of PySpecKit:
&lt;a class="reference external" href="https://bitbucket.org/sPecAnPy/specanpy/"&gt;sPecAnPy&lt;/a&gt;
&lt;a class="reference external" href="https://bitbucket.org/keflavich/spectroscopic-toolkit-astronomy/"&gt;Spectroscopic Toolkit (Astronomy)&lt;/a&gt;&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="python"></category><category term="code"></category></entry><entry><title>SSH</title><link href="https://keflavich.github.io/blog/ssh.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/ssh.html</id><content type="html">&lt;p&gt;Learned something knew about ssh... keys are stored in
~/.ssh/known_hosts. If a remote key changes, you may be denied access
if your saved key is wrong.&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="computer"></category></entry><entry><title>Stone 12th Anniversary Bitter Chocolate Stout</title><link href="https://keflavich.github.io/blog/stone-12th-anniversary-bitter-chocolate-stout.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/stone-12th-anniversary-bitter-chocolate-stout.html</id><summary type="html">&lt;p&gt;Tried this 9.2% bomber last night, and even drinking it over the course
of an hour and a half I could feel my nose not feeling afterwards.
The pour was probably the most exciting part of this beer. It came out
an extremely dark, rich, thick motor-oil looking thing …&lt;/p&gt;</summary><content type="html">&lt;p&gt;Tried this 9.2% bomber last night, and even drinking it over the course
of an hour and a half I could feel my nose not feeling afterwards.
The pour was probably the most exciting part of this beer. It came out
an extremely dark, rich, thick motor-oil looking thing with nearly no
head. The flavor, though, is of a very bitter and very dry imperial
stout. I didn't get much of the chocolate tone, because I only taste
chocolate when it is sweetened - bakers chocolate doesn't taste like
chocolate to me. I think this beer would have been better if kept a
little bit sweeter, much unlike the other Imperial stouts I've tried
lately.&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="beer tasting"></category></entry><entry><title>SUCCESS! 64 bit python with 64 bit tcl/tk!!!</title><link href="https://keflavich.github.io/blog/success-64-bit-python-with-64-bit-tcltk.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/success-64-bit-python-with-64-bit-tcltk.html</id><summary type="html">&lt;p&gt;After a long, tedious process (see previous posts), I got 64 bit python,
64 bit tcl/tk, and 64 bit tkinter all to work! I can now use the TkAgg
backend in matplotlib!
Python 64 bit on Mac OS X: &lt;a class="reference external" href="http://solo.colorado.edu/~skillman/www/Code_Blog/Entries/2009/6/24_64-bit_Python_on_os_x.html"&gt;Sam Skillman's post&lt;/a&gt;
Tcl/Tk 64 bit: &lt;a class="reference external" href="http://www.nabble.com/Error-compiling-tk-8.5.7-on-Mac-OS-X-10.5-td23790967.html"&gt;a post on …&lt;/a&gt;&lt;/p&gt;</summary><content type="html">&lt;p&gt;After a long, tedious process (see previous posts), I got 64 bit python,
64 bit tcl/tk, and 64 bit tkinter all to work! I can now use the TkAgg
backend in matplotlib!
Python 64 bit on Mac OS X: &lt;a class="reference external" href="http://solo.colorado.edu/~skillman/www/Code_Blog/Entries/2009/6/24_64-bit_Python_on_os_x.html"&gt;Sam Skillman's post&lt;/a&gt;
Tcl/Tk 64 bit: &lt;a class="reference external" href="http://www.nabble.com/Error-compiling-tk-8.5.7-on-Mac-OS-X-10.5-td23790967.html"&gt;a post on the tcl/tk forums&lt;/a&gt;
tkinter 64 bit: &lt;a class="reference external" href="http://bugs.python.org/issue4017"&gt;python bug report 4017 (last two posts give the
solution)&lt;/a&gt; and &lt;a class="reference external" href="http://bugs.python.org/issue6441"&gt;my posted solution&lt;/a&gt;&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="python"></category></entry><entry><title>Sync a fork with the original repository on Git</title><link href="https://keflavich.github.io/blog/sync-a-fork-with-the-original-repository-on-git.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/sync-a-fork-with-the-original-repository-on-git.html</id><summary type="html">&lt;p&gt;A seemingly simple operation that I just can't seem to get right.
&lt;a class="reference external" href="http://groups.google.com/group/github/browse_thread/thread/6196487279beb2a8/181b7bc4bf7a3e16"&gt;This page&lt;/a&gt; gives me useless information:
&lt;tt class="docutils literal"&gt;$ git checkout &lt;span class="pre"&gt;-b&lt;/span&gt; upstream/master $ git remote add upstream &lt;span class="pre"&gt;git://github.com/upstream_maintainer/master.git&lt;/span&gt; $ git pull upstream remote $ git checkout master $ git merge upstream/master ``
If you do that, it …&lt;/tt&gt;&lt;/p&gt;</summary><content type="html">&lt;p&gt;A seemingly simple operation that I just can't seem to get right.
&lt;a class="reference external" href="http://groups.google.com/group/github/browse_thread/thread/6196487279beb2a8/181b7bc4bf7a3e16"&gt;This page&lt;/a&gt; gives me useless information:
&lt;tt class="docutils literal"&gt;$ git checkout &lt;span class="pre"&gt;-b&lt;/span&gt; upstream/master $ git remote add upstream &lt;span class="pre"&gt;git://github.com/upstream_maintainer/master.git&lt;/span&gt; $ git pull upstream remote $ git checkout master $ git merge upstream/master ``
If you do that, it frankly doesn't work. Why? &amp;quot;upstream/master&amp;quot; etc. all
have special meanings.
Here's the real process &amp;amp; explanation (thanks to Erik Tollerud for some
help):
``git checkout master&amp;nbsp; # (assuming you have a local branch named master - otherwise, pick whatever branch you want synced)git remote add original git&amp;#64;github.com:thing/thing.git # &amp;quot;upstream&amp;quot; = &amp;quot;original&amp;quot; = &amp;quot;remote&amp;quot; - the place you're trying to sync fromgit fetch original # 'original' being the name YOU gave for the &amp;quot;remote/original&amp;quot; repositorygit merge master original/master # now merge the &amp;quot;original/master&amp;quot; branch (they should have&amp;nbsp; a branch named &amp;quot;master&amp;quot; too, otherwise you have to figure out which branch to get) into your mastergit push # push your &lt;span class="pre"&gt;now-merged&lt;/span&gt; stuff back to github# I was instructed to use these commands.&amp;nbsp; They didn't work.# git reset original # the word &amp;quot;original&amp;quot; here matches the word &amp;quot;original&amp;quot; on the previous line# git reset &lt;span class="pre"&gt;--hard&lt;/span&gt; original # this will overwrite local changes&lt;/tt&gt;&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="git"></category></entry><entry><title>Testing trackbacks?</title><link href="https://keflavich.github.io/blog/testing-trackbacks.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/testing-trackbacks.html</id><content type="html">&lt;p&gt;I just want to see if &amp;quot;trackbacks&amp;quot; work at all. I recently posted about
&lt;a class="reference external" href="http://buffalothedestroyer.blogspot.com/2010/07/histogram-in-google-spreadsheet.html"&gt;histograms on google spreadsheets&lt;/a&gt;.
While I'm at it, might as well throw up a link to &lt;a class="reference external" href="http://code.google.com/p/agpy/"&gt;my google code
site&lt;/a&gt;.&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="blog"></category><category term="code"></category></entry><entry><title>usetex failure in latex documents</title><link href="https://keflavich.github.io/blog/usetex-failure-in-latex-documents.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/usetex-failure-in-latex-documents.html</id><summary type="html">&lt;p&gt;When I use matplotlib's internal tex (rcParams['text.useTex']=False),
the postscript files generated cause errors that look like this when you
try to ps2pdf them:
&lt;tt class="docutils literal"&gt;ps2pdf h2co_pilot.psError: /rangecheck in &lt;span class="pre"&gt;--get--Operand&lt;/span&gt; stack:&amp;nbsp;&amp;nbsp; &lt;span class="pre"&gt;--dict:20/25(ro)(L)--&lt;/span&gt;&amp;nbsp;&amp;nbsp; &lt;span class="pre"&gt;--nostringval--&lt;/span&gt;&amp;nbsp;&amp;nbsp; 71Execution stack:&amp;nbsp;&amp;nbsp; %interp_exit&amp;nbsp;&amp;nbsp; .runexec2&amp;nbsp;&amp;nbsp; &lt;span class="pre"&gt;--nostringval--&lt;/span&gt;&amp;nbsp;&amp;nbsp; &lt;span class="pre"&gt;--nostringval--&lt;/span&gt;&amp;nbsp;&amp;nbsp; &lt;span class="pre"&gt;--nostringval--&lt;/span&gt;&amp;nbsp;&amp;nbsp; 2&amp;nbsp;&amp;nbsp; %stopped …&lt;/tt&gt;&lt;/p&gt;</summary><content type="html">&lt;p&gt;When I use matplotlib's internal tex (rcParams['text.useTex']=False),
the postscript files generated cause errors that look like this when you
try to ps2pdf them:
&lt;tt class="docutils literal"&gt;ps2pdf h2co_pilot.psError: /rangecheck in &lt;span class="pre"&gt;--get--Operand&lt;/span&gt; stack:&amp;nbsp;&amp;nbsp; &lt;span class="pre"&gt;--dict:20/25(ro)(L)--&lt;/span&gt;&amp;nbsp;&amp;nbsp; &lt;span class="pre"&gt;--nostringval--&lt;/span&gt;&amp;nbsp;&amp;nbsp; 71Execution stack:&amp;nbsp;&amp;nbsp; %interp_exit&amp;nbsp;&amp;nbsp; .runexec2&amp;nbsp;&amp;nbsp; &lt;span class="pre"&gt;--nostringval--&lt;/span&gt;&amp;nbsp;&amp;nbsp; &lt;span class="pre"&gt;--nostringval--&lt;/span&gt;&amp;nbsp;&amp;nbsp; &lt;span class="pre"&gt;--nostringval--&lt;/span&gt;&amp;nbsp;&amp;nbsp; 2&amp;nbsp;&amp;nbsp; %stopped_push&amp;nbsp;&amp;nbsp; &lt;span class="pre"&gt;--nostringval--&lt;/span&gt;&amp;nbsp;&amp;nbsp; &lt;span class="pre"&gt;--nostringval--&lt;/span&gt;&amp;nbsp;&amp;nbsp; &lt;span class="pre"&gt;--nostringval--&lt;/span&gt;&amp;nbsp;&amp;nbsp; false&amp;nbsp;&amp;nbsp; 1&amp;nbsp;&amp;nbsp; %stopped_push&amp;nbsp;&amp;nbsp; 1862&amp;nbsp;&amp;nbsp; 1&amp;nbsp;&amp;nbsp; 3&amp;nbsp;&amp;nbsp; %oparray_pop&amp;nbsp;&amp;nbsp; 1861&amp;nbsp;&amp;nbsp; 1&amp;nbsp;&amp;nbsp; 3&amp;nbsp;&amp;nbsp; %oparray_pop&amp;nbsp;&amp;nbsp; 1845&amp;nbsp;&amp;nbsp; 1&amp;nbsp;&amp;nbsp; 3&amp;nbsp;&amp;nbsp; %oparray_pop&amp;nbsp;&amp;nbsp; 1739&amp;nbsp;&amp;nbsp; 1&amp;nbsp;&amp;nbsp; 3&amp;nbsp;&amp;nbsp; %oparray_pop&amp;nbsp;&amp;nbsp; &lt;span class="pre"&gt;--nostringval--&lt;/span&gt;&amp;nbsp;&amp;nbsp; %errorexec_pop&amp;nbsp;&amp;nbsp; .runexec2&amp;nbsp;&amp;nbsp; &lt;span class="pre"&gt;--nostringval--&lt;/span&gt;&amp;nbsp;&amp;nbsp; &lt;span class="pre"&gt;--nostringval--&lt;/span&gt;&amp;nbsp;&amp;nbsp; &lt;span class="pre"&gt;--nostringval--&lt;/span&gt;&amp;nbsp;&amp;nbsp; 2&amp;nbsp;&amp;nbsp; %stopped_push&amp;nbsp;&amp;nbsp; &lt;span class="pre"&gt;--nostringval--&lt;/span&gt;&amp;nbsp;&amp;nbsp; %finish_show&amp;nbsp;&amp;nbsp; &lt;span class="pre"&gt;--nostringval--&lt;/span&gt;&amp;nbsp;&amp;nbsp; &lt;span class="pre"&gt;--nostringval--&lt;/span&gt;&amp;nbsp;&amp;nbsp; 9&amp;nbsp;&amp;nbsp; 6&amp;nbsp;&amp;nbsp; 0&amp;nbsp;&amp;nbsp; &lt;span class="pre"&gt;--nostringval--&lt;/span&gt;&amp;nbsp;&amp;nbsp; (pdf_text_enum_t)&amp;nbsp;&amp;nbsp; %op_show_continue&amp;nbsp;&amp;nbsp; &lt;span class="pre"&gt;--nostringval--Dictionary&lt;/span&gt; stack:&amp;nbsp;&amp;nbsp; &lt;span class="pre"&gt;--dict:1147/1684(ro)(G)--&lt;/span&gt;&amp;nbsp;&amp;nbsp; &lt;span class="pre"&gt;--dict:0/20(G)--&lt;/span&gt;&amp;nbsp;&amp;nbsp; &lt;span class="pre"&gt;--dict:70/200(L)--&lt;/span&gt;&amp;nbsp;&amp;nbsp; &lt;span class="pre"&gt;--dict:116/300(L)--&lt;/span&gt;&amp;nbsp;&amp;nbsp; &lt;span class="pre"&gt;--dict:44/200(L)--&lt;/span&gt;&amp;nbsp;&amp;nbsp; &lt;span class="pre"&gt;--dict:25/42(L)--Current&lt;/span&gt; allocation mode is localLast OS error: 2Current file position is 791626GPL Ghostscript 8.64: Unrecoverable error, exit code 1make: *** [h2co_pilot.pdf] Error 1&lt;/tt&gt;
They will not open in MacOS's Preview.app either.
Solution: Make figures with rcParams['text.useTex'] = True&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="latex"></category><category term="matplotlib"></category></entry><entry><title>Using AWK to fixed-format print in VIM</title><link href="https://keflavich.github.io/blog/using-awk-to-fixed-format-print-in-vim.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/using-awk-to-fixed-format-print-in-vim.html</id><content type="html">&lt;p&gt;&lt;pre class="literal-block"&gt;
24,42!awk '{printf(&amp;quot;\%30s\%20f\%15g\%15g\%15g\%15g\%15g\%15g\%15g\%5i\n&amp;quot; , $1,$2,$3,$4,$5,$6,$7,$8,$9,$10)}'
&lt;/pre&gt;
&lt;p&gt;It's important that the %'s must be escaped, otherwise they print the
current filename.&lt;/p&gt;
&lt;/p&gt;</content><category term="misc"></category><category term="googlepost"></category><category term="computer"></category></entry><entry><title>wget</title><link href="https://keflavich.github.io/blog/wget.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/wget.html</id><summary type="html">&lt;p&gt;wget is very useful for acquiring data from, e.g., IRSA, the NASA
Infrared Science Archive.
&lt;tt class="docutils literal"&gt;wget &lt;span class="pre"&gt;-nd&lt;/span&gt; &lt;span class="pre"&gt;-r&lt;/span&gt; &lt;span class="pre"&gt;-l1&lt;/span&gt; &lt;span class="pre"&gt;-A*g09*_b4_20.fits&lt;/span&gt; &lt;span class="pre"&gt;http://irsa.ipac.caltech.edu/data/IGA/images/&lt;/span&gt;&lt;/tt&gt;
The important elements:
-nd: don't reproduce the host directory structure
-r: recursive. Grab the files referred to …&lt;/p&gt;</summary><content type="html">&lt;p&gt;wget is very useful for acquiring data from, e.g., IRSA, the NASA
Infrared Science Archive.
&lt;tt class="docutils literal"&gt;wget &lt;span class="pre"&gt;-nd&lt;/span&gt; &lt;span class="pre"&gt;-r&lt;/span&gt; &lt;span class="pre"&gt;-l1&lt;/span&gt; &lt;span class="pre"&gt;-A*g09*_b4_20.fits&lt;/span&gt; &lt;span class="pre"&gt;http://irsa.ipac.caltech.edu/data/IGA/images/&lt;/span&gt;&lt;/tt&gt;
The important elements:
-nd: don't reproduce the host directory structure
-r: recursive. Grab the files referred to by the page, not just the page
itself
-l#: number of recursion levels
-A: &amp;quot;accept&amp;quot; wildcard&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="computer"></category></entry><entry><title>Why astronomy is important</title><link href="https://keflavich.github.io/blog/why-astronomy-is-important.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/why-astronomy-is-important.html</id><summary type="html">&lt;p&gt;Preface: This is not a good argument for why astronomy is important now.
But it may be in the future.
Earth is a limited habitat. Bacteria in a petri dish show the same
growth curve as humanity: exponential growth. An exponential curve grows
very quickly, but we are in a …&lt;/p&gt;</summary><content type="html">&lt;p&gt;Preface: This is not a good argument for why astronomy is important now.
But it may be in the future.
Earth is a limited habitat. Bacteria in a petri dish show the same
growth curve as humanity: exponential growth. An exponential curve grows
very quickly, but we are in a finite (non-growing) environment.
If humanity is to continue its growth, we must find new worlds to
inhabit. There is always a moral question of whether we should continue
our growth and attempt to conquer significant portions of the galaxy,
but we probably won't (and maybe shouldn't) start examining the morality
of our survival until it's ensured.
Consider what happens if humanity stops growing. Our current economic
system is completely dependent on continued growth. The financial
markets can't survive unless more wealth is constantly being generated.
Interesting calculation to try: Divide the total solar energy input to
Earth by the average energy consumed per person, or the minimum energy
(theoretically) per person. It's probably not as large as you think when
you take into account efficiency factors.&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category></entry><entry><title>Why can't numpy do duplicate index assignment</title><link href="https://keflavich.github.io/blog/why-cant-numpy-do-duplicate-index-assignment.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/why-cant-numpy-do-duplicate-index-assignment.html</id><summary type="html">&lt;p&gt;&lt;a class="reference external" href="http://casa.colorado.edu/~ginsbura/index.htm"&gt;AG&lt;/a&gt;
I want to do drizzling with numpy. It should be trivial, but it's
impossible (without a for loop, afaik) instead.
&lt;tt class="docutils literal"&gt;In [2]: a = &lt;span class="pre"&gt;array([1,1,2,2])In&lt;/span&gt; [3]: b = arange(5)In [4]: b[a] += 1In [5]: bOut[5]: &lt;span class="pre"&gt;array([0,&lt;/span&gt; 2, 3, 3, &lt;span class="pre"&gt;4])In&lt;/span&gt; [6 …&lt;/tt&gt;&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;a class="reference external" href="http://casa.colorado.edu/~ginsbura/index.htm"&gt;AG&lt;/a&gt;
I want to do drizzling with numpy. It should be trivial, but it's
impossible (without a for loop, afaik) instead.
&lt;tt class="docutils literal"&gt;In [2]: a = &lt;span class="pre"&gt;array([1,1,2,2])In&lt;/span&gt; [3]: b = arange(5)In [4]: b[a] += 1In [5]: bOut[5]: &lt;span class="pre"&gt;array([0,&lt;/span&gt; 2, 3, 3, &lt;span class="pre"&gt;4])In&lt;/span&gt; [6]: # but b should really be:In [7]: b[a] += 1In [8]: bOut[8]: &lt;span class="pre"&gt;array([0,&lt;/span&gt; 3, 4, 3, 4])&lt;/tt&gt;&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="numpy"></category></entry><entry><title>Why do astronomers have such a strong presence on the web?</title><link href="https://keflavich.github.io/blog/why-do-astronomers-have-such-a-strong-presence-on-the-web.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/why-do-astronomers-have-such-a-strong-presence-on-the-web.html</id><summary type="html">&lt;p&gt;I'm not making this a complete post, just a few examples of blogs and
websites I'm aware of. But we do have a strong presence on the web -
astronomers have an unusually high google ranking etc. Is it just
because 'we' were here first ('we' excludes me, I'm just jumping …&lt;/p&gt;</summary><content type="html">&lt;p&gt;I'm not making this a complete post, just a few examples of blogs and
websites I'm aware of. But we do have a strong presence on the web -
astronomers have an unusually high google ranking etc. Is it just
because 'we' were here first ('we' excludes me, I'm just jumping on the
bandwagon and getting a free ride)?
Examples:
&lt;a class="reference external" href="http://www.starstryder.com/"&gt;Pamela Gay&lt;/a&gt;
&lt;a class="reference external" href="http://dustchick.blogspot.com/"&gt;Dr Lisa&lt;/a&gt;
Science writers who write on astronomy:
&lt;a class="reference external" href="http://blogs.discovery.com/space_disco/"&gt;Dave Mosher&lt;/a&gt;&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="astronomers"></category></entry><entry><title>wrapping text around a figure in latex</title><link href="https://keflavich.github.io/blog/wrapping-text-around-a-figure-in-latex.html" rel="alternate"></link><published>2012-09-20T20:02:00-06:00</published><updated>2012-09-20T20:02:00-06:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2012-09-20:/blog/wrapping-text-around-a-figure-in-latex.html</id><content type="html">&lt;p&gt;An example from Devin:
%\begin{wrapfigure}{l}{0.5\textwidth}
% \vspace{-27pt}
% \begin{center}
% \includegraphics[width=0.48\textwidth]{nsf_fig3.ps}
% \end{center}
% \vspace{-27pt}
% \caption{\it{}}
% \vspace{-12pt}
%\end{wrapfigure}
1:16
\usepackage{wrapfig}&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="latex"></category></entry><entry><title>Non-greedy vim</title><link href="https://keflavich.github.io/blog/non-greedy-vim.html" rel="alternate"></link><published>2008-09-05T01:12:00-06:00</published><updated>2008-09-05T01:12:00-06:00</updated><author><name>Adam</name></author><id>tag:keflavich.github.io,2008-09-05:/blog/non-greedy-vim.html</id><content type="html">&lt;p&gt;To make .* in VIM be non-greedy (i.e. match just &lt;tt class="docutils literal"&gt;&amp;lt;a href=x&amp;gt;&lt;/tt&gt; out of &lt;tt class="docutils literal"&gt;&amp;quot;&amp;lt;a href=x&amp;gt; &amp;lt;/a&amp;gt;&amp;quot;&lt;/tt&gt;), use:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
.\{-}
&lt;/pre&gt;
</content><category term="misc"></category><category term="googlepost"></category></entry><entry><title>Galactic Center Photo Contest</title><link href="https://keflavich.github.io/blog/galactic-center-photo-contest.html" rel="alternate"></link><published>2008-01-01T00:00:00-07:00</published><updated>2008-01-01T00:00:00-07:00</updated><author><name>Adam (keflavich@gmail.com)</name></author><id>tag:keflavich.github.io,2008-01-01:/blog/galactic-center-photo-contest.html</id><summary type="html">&lt;img alt="" src="http://casa.colorado.edu/%7Eginsbura/images/gc/gc_winner_800x800.jpg" /&gt;
&lt;p&gt;&lt;a class="reference external" href="http://www.nrao.edu/index.php/learn/gallery/imagecontest"&gt;The NRAO Photo Contest&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;The Galactic Center and the surrounding Central Molecular Zone comprise
the most active star formation region in the Milky Way. This 2 x 1
degree field was imaged at 20 cm (purple) with the NRAO Very Large
Array, tracing H II regions that are illuminated by …&lt;/p&gt;</summary><content type="html">&lt;img alt="" src="http://casa.colorado.edu/%7Eginsbura/images/gc/gc_winner_800x800.jpg" /&gt;
&lt;p&gt;&lt;a class="reference external" href="http://www.nrao.edu/index.php/learn/gallery/imagecontest"&gt;The NRAO Photo Contest&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;The Galactic Center and the surrounding Central Molecular Zone comprise
the most active star formation region in the Milky Way. This 2 x 1
degree field was imaged at 20 cm (purple) with the NRAO Very Large
Array, tracing H II regions that are illuminated by hot, massive stars,
supernova remnants, and synchrotron emission. Emission at 1.1 mm
(orange) was observed with the Caltech Submillimeter Observatory and
highlights cold (20-30 K) dust associated with molecular gas. Some of
this material will form stars within in the next few million years; the
remainder will be blown away. The diffuse cyan and colored star images
are from the Spitzer Space Observatory's Infrared Array Camera. The cyan
is primarily emission from stars, the point sources, and from polycyclic
aromatic hydrocarbons (PAHs), the diffuse component.&lt;/p&gt;
&lt;p&gt;My view of the Galactic Center is the winner of this year's NRAO photo
contest. It displays a multiwavelength view of the galactic center. The
caption at the NRAO photo contest (reproduced above) describes it well,
but I will go into further depth here.&lt;/p&gt;
&lt;p&gt;The 'arches' are the large purple filamentary structures seen near the
brightest point in the map, Sgr A*, the center of our galaxy. They are
thought to be large scale magnetic fields &lt;a class="reference external" href="http://cdsads.u-strasbg.fr/abs/2007ASPC..367..651Y"&gt;possibly generated by winds
from hot stars&lt;/a&gt;. &lt;a class="reference external" href="http://www.physics.northwestern.edu/research/zadeh.html"&gt;Farhad Yusef-Zadeh&lt;/a&gt;, my collaborator on the photo,
leads the study of radio emission from the Galactic Center.
The orange color is 1.1mm emission, which means that we're seeing
something completely different. This light actually comes from dust. We
usually see &lt;a class="reference external" href="http://apod.nasa.gov/apod/ap051130.html"&gt;dust in absorption&lt;/a&gt; because in the optical, it blocks
light. There is so much dust between us and the Galactic Center that we
can't see it at all at optical wavelengths.&lt;/p&gt;
&lt;p&gt;Sagittarius B2 is the bright blob just to the left of center. It is the
most massive collection of gas and dust in our galaxy. It is full of
different types of molecules including complex organic molecules. A new
generation of massive stars is thought to be forming there.
Spitzer's 8 micron view is presented in cyan. Mostly this comes from
PAH, Polycyclic Aromatic Hydrocarbon, emission. PAHs are big molecules
with lots of Carbon and Hydrogen chained together. Stars are visible at
these wavelengths because the dust isn't as effective at blocking out
infrared light - but look closely at the orange regions on the right
side of the image. You might notice that not only is there dust there,
but there's also less PAH emission visible. This is because on the right
side of the Galactic Center, the spiral arm is behind the dust, and on
the left side it is in front. When dust blocks out infrared light, the
object we see is called an 'infrared dark cloud'. These clouds are
usually places where star formation has not yet started, but will soon.
This image was created using GIMP, the Gnu Image Manipulation Program,
using a variety of layers, opacities, etc.&lt;/p&gt;
</content><category term="misc"></category><category term="googlepost"></category><category term="photo"></category><category term="millimeter"></category><category term="galactic center"></category></entry></feed>